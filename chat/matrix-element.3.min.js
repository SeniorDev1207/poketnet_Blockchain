(window["matrixElement_jsonp"]=window["matrixElement_jsonp"]||[]).push([[3],{"0826":function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"typingBlock",staticStyle:{position:"relative"}},[o("div",{staticClass:"typingBlockWrapper"},[e._m(0),o("div",[o("PulseLoader",{attrs:{color:e.color,size:e.size,loading:!0}})],1)])])},n=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("span",[e._v("typing")])])}],i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"v-spinner"},[o("div",{staticClass:"v-pulse v-pulse1",style:[e.spinnerStyle,e.spinnerDelay1]}),o("div",{staticClass:"v-pulse v-pulse2",style:[e.spinnerStyle,e.spinnerDelay2]}),o("div",{staticClass:"v-pulse v-pulse3",style:[e.spinnerStyle,e.spinnerDelay3]})])},r=[],s={name:"PulseLoader",props:{loading:{type:Boolean,default:!0},color:{type:String,default:"#5dc596"},size:{type:String,default:"15px"},margin:{type:String,default:"2px"},radius:{type:String,default:"100%"}},data:function(){return{spinnerStyle:{backgroundColor:this.color,width:this.size,height:this.size,margin:this.margin,borderRadius:this.radius,display:"inline-block",animationName:"v-pulseStretchDelay",animationDuration:"0.75s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.2,.68,.18,1.08)",animationFillMode:"both"},spinnerDelay1:{animationDelay:"0.12s"},spinnerDelay2:{animationDelay:"0.24s"},spinnerDelay3:{animationDelay:"0.36s"}}}},c=s,d=o("2877");function l(e){var t=o("671b");t.__inject__&&t.__inject__(e)}var u=Object(d["a"])(c,i,r,!1,l,null,null,!0),f=u.exports,p={name:"typing",props:{},components:{PulseLoader:f},data:function(){return{color:"#868686",size:"2px",loading:!0}},methods:{},computed:{}},m=p;function h(e){var t=o("1b86");t.__inject__&&t.__inject__(e)}var v=Object(d["a"])(m,a,n,!1,h,null,null,!0);t["a"]=v.exports},1259:function(e,t,o){var a=o("3459");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=o("35d6").default;e.exports.__inject__=function(e){n("919c9172",a,e)}},1679:function(e,t,o){var a=o("24fb");t=a(!1),t.push([e.i,"#matrix-root[theme=black] #topheader.minimized.fix[data-v-b9f8e6da]{background:transparent}#matrix-root[theme=black] .donationModalBody span[data-v-b9f8e6da]{color:#12488a}#matrix-root[theme=black] .donationModalBody input[data-v-b9f8e6da],#matrix-root[theme=black] .donationModalBody select[data-v-b9f8e6da]{border:1px solid #12488a;border-radius:3px}#matrix-root[theme=black] .donationModalBody input.disabled[data-v-b9f8e6da],#matrix-root[theme=black] .donationModalBody select.disabled[data-v-b9f8e6da]{color:rgba(176,191,198,.8);border:1px solid rgba(176,191,198,.5)}#matrix-root[theme=black] .donationModalBody .error[data-v-b9f8e6da]{color:#ff0c39}",""]),e.exports=t},"1b86":function(e,t,o){"use strict";o.r(t);var a=o("5f7e");for(var n in a)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(n)},2122:function(e,t,o){"use strict";o.r(t);var a=o("c046");for(var n in a)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(n)},3459:function(e,t,o){var a=o("24fb");t=a(!1),t.push([e.i,"@-webkit-keyframes v-pulseStretchDelay{0%,80%{transform:scale(1);-webkit-opacity:1;opacity:1}45%{transform:scale(.1);-webkit-opacity:.7;opacity:.7}}@keyframes v-pulseStretchDelay{0%,80%{transform:scale(1);-webkit-opacity:1;opacity:1}45%{transform:scale(.1);-webkit-opacity:.7;opacity:.7}}",""]),e.exports=t},"50eb":function(e,t,o){var a=o("24fb");t=a(!1),t.push([e.i,".nameWrapper[data-v-b9f8e6da]{display:flex;align-items:center;justify-content:center}.roomMuted[data-v-b9f8e6da]{margin-left:3px}.roomMuted i[data-v-b9f8e6da]{font-size:.7em}.editButton[data-v-b9f8e6da]{display:flex;justify-content:center;align-items:center}.editButton i[data-v-b9f8e6da]{font-size:1.5em}.nameline[data-v-b9f8e6da]{max-width:250px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}#topheader.minimized.fix[data-v-b9f8e6da]{background:transparent;overflow:inherit}.donationModalBody[data-v-b9f8e6da]{padding:1em;display:flex;flex-direction:column}.donationModalBody span[data-v-b9f8e6da]{color:#12488a}.donationModalBody input[data-v-b9f8e6da],.donationModalBody select[data-v-b9f8e6da]{margin-top:.5em;margin-bottom:1.5em;border:1px solid #12488a;border-radius:3px;padding:.5em}.donationModalBody input.disabled[data-v-b9f8e6da],.donationModalBody select.disabled[data-v-b9f8e6da]{color:rgba(176,191,198,.8);border:1px solid rgba(176,191,198,.5)}.donationModalBody button[data-v-b9f8e6da]{margin-top:1em}.donationModalBody button i[data-v-b9f8e6da]{margin-right:.2em}.donationModalBody .totalAmount[data-v-b9f8e6da]{font-weight:700;margin-left:.5em;margin-top:.5em;margin-bottom:1em}.donationModalBody .error[data-v-b9f8e6da]{color:#ff0c39;text-align:center}.donationModalBody .linepreloader[data-v-b9f8e6da]{text-align:center;height:29px;margin-top:1em}",""]),e.exports=t},"5f7e":function(e,t,o){var a=o("bd86");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=o("35d6").default;e.exports.__inject__=function(e){n("3c4a7888",a,e)}},"671b":function(e,t,o){"use strict";o.r(t);var a=o("1259");for(var n in a)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(n)},6972:function(e,t,o){"use strict";o.r(t);var a=o("c4bb");for(var n in a)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(n)},"6ec0":function(e,t,o){var a=o("24fb");t=a(!1),t.push([e.i,"#matrix-root[theme=white] #topheader.minimized.fix[data-v-b9f8e6da]{background:transparent}#matrix-root[theme=white] .donationModalBody span[data-v-b9f8e6da]{color:#12488a}#matrix-root[theme=white] .donationModalBody input[data-v-b9f8e6da],#matrix-root[theme=white] .donationModalBody select[data-v-b9f8e6da]{border:1px solid #12488a;border-radius:3px}#matrix-root[theme=white] .donationModalBody input.disabled[data-v-b9f8e6da],#matrix-root[theme=white] .donationModalBody select.disabled[data-v-b9f8e6da]{color:rgba(176,191,198,.8);border:1px solid rgba(176,191,198,.5)}#matrix-root[theme=white] .donationModalBody .error[data-v-b9f8e6da]{color:#ff0c39}",""]),e.exports=t},"7b69":function(e,t,o){"use strict";o.r(t);var a=o("e96a");for(var n in a)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(n)},"94d3":function(e,t,o){var a=o("24fb");t=a(!1),t.push([e.i,".topheader[data-v-2120d13f]{width:100%;top:0;z-index:999}.aboutContact[data-v-2120d13f]{position:absolute;left:0;right:0;top:100px;bottom:0;z-index:999;background:#fff}[data-v-2120d13f] #maincontent .headerSpacerWrapper{bottom:0}",""]),e.exports=t},9585:function(e,t,o){var a=o("50eb");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=o("35d6").default;e.exports.__inject__=function(e){n("156289ac",a,e)}},a79d:function(e,t,o){"use strict";var a=o("23e7"),n=o("c430"),i=o("fea9"),r=o("d039"),s=o("d066"),c=o("4840"),d=o("cdf9"),l=o("6eeb"),u=!!i&&r((function(){i.prototype["finally"].call({then:function(){}},(function(){}))}));a({target:"Promise",proto:!0,real:!0,forced:u},{finally:function(e){var t=c(this,s("Promise")),o="function"==typeof e;return this.then(o?function(o){return d(t,e()).then((function(){return o}))}:e,o?function(o){return d(t,e()).then((function(){throw o}))}:e)}}),n||"function"!=typeof i||i.prototype["finally"]||l(i.prototype,"finally",s("Promise").prototype["finally"])},ba10:function(e,t,o){var a=o("24fb");t=a(!1),t.push([e.i,"#matrix-root[theme=classic] #topheader.minimized.fix[data-v-b9f8e6da]{background:transparent}#matrix-root[theme=classic] .donationModalBody span[data-v-b9f8e6da]{color:#12488a}#matrix-root[theme=classic] .donationModalBody input[data-v-b9f8e6da],#matrix-root[theme=classic] .donationModalBody select[data-v-b9f8e6da]{border:1px solid #12488a;border-radius:3px}#matrix-root[theme=classic] .donationModalBody input.disabled[data-v-b9f8e6da],#matrix-root[theme=classic] .donationModalBody select.disabled[data-v-b9f8e6da]{color:rgba(176,191,198,.8);border:1px solid rgba(176,191,198,.5)}#matrix-root[theme=classic] .donationModalBody .error[data-v-b9f8e6da]{color:#ff0c39}",""]),e.exports=t},bd86:function(e,t,o){var a=o("24fb");t=a(!1),t.push([e.i,".typingBlock{position:relative}.typingBlock .typingBlockWrapper{position:absolute;left:50%;transform:translateX(-50%);top:-5px;display:flex;align-items:center}.typingBlock .typingBlockWrapper>div{padding:0 .5em}.typingBlock .typingBlockWrapper span{font-size:.7em;color:#707070;opacity:.8}",""]),e.exports=t},c046:function(e,t,o){var a=o("94d3");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=o("35d6").default;e.exports.__inject__=function(e){n("31c7092c",a,e)}},c4bb:function(e,t,o){var a=o("6ec0");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=o("35d6").default;e.exports.__inject__=function(e){n("20bf988b",a,e)}},cb7f:function(e,t,o){var a=o("ba10");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=o("35d6").default;e.exports.__inject__=function(e){n("2a34a9a6",a,e)}},e411:function(e,t,o){"use strict";o.r(t);var a=o("9585");for(var n in a)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(n)},e67c:function(e,t,o){"use strict";o.r(t);var a=o("cb7f");for(var n in a)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(n)},e96a:function(e,t,o){var a=o("1679");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=o("35d6").default;e.exports.__inject__=function(e){n("ef6cf768",a,e)}},ee79:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"page chat"},[o("topheader",{staticClass:"topheader",attrs:{u:e.u,chat:e.chat},on:{addMember:e.addMemberModal}}),e.roomInfo?e._e():o("maincontent",{scopedSlots:e._u([{key:"content",fn:function(){return[o("chat",{attrs:{u:e.u,chat:e.chat},on:{sending:e.sending,newchat:e.newchat,getEvents:e.eventsRoom}})]},proxy:!0}],null,!1,2636658855)}),e.openInviteModal?o("modal",{on:{close:e.closeModal},scopedSlots:e._u([{key:"header",fn:function(){return[o("span",[e._v("Invite User")])]},proxy:!0},{key:"body",fn:function(){return[o("contacts",{attrs:{mode:"inviteUsers",chatRoomId:e.chat.roomId},on:{closeModal:e.closeContactModal}})]},proxy:!0},{key:"footer",fn:function(){},proxy:!0}],null,!1,1239787889)}):e._e()],1)},n=[],i=o("5530"),r=o("b163"),s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"chatTopheader"}},[e.chat||e.u?o("topheader",{scopedSlots:e._u([{key:"left",fn:function(){return[o("backButton",{attrs:{action:"back"}})]},proxy:!0},{key:"info",fn:function(){return[e.chat?o("router-link",{attrs:{to:"chatInfo?id="+e.chat.roomId}},[e.m_chat?o("div",[o("div",{staticClass:"nameWrapper"},[e.roomInfo?e._e():o("chatName",{attrs:{preview:!0,chat:e.chat,m_chat:e.m_chat}}),e.roomMuted?o("div",{staticClass:"roomMuted"},[o("i",{staticClass:"fas fa-bell-slash"})]):e._e()],1),o("transition",{attrs:{name:"fade"}},[e.m_chat_typing?o("chatTyping"):e._e()],1)],1):e._e(),!e.m_chat&&e.userinfo?o("div",[o("span",{staticClass:"nameline"},[e._v(e._s(e.userinfo.name))])]):e._e()]):e._e()]},proxy:!0},{key:"right",fn:function(){return[e.chat?o("router-link",{attrs:{to:"chatInfo?id="+e.chat.roomId}},[o("div",{staticClass:"iconbutton"},[o("i",{staticClass:"fas fa-ellipsis-h"})])]):e._e()]},proxy:!0}],null,!1,739412723)}):e._e(),e.donateUserOpened?o("modal",{on:{close:e.closeDonateModal},scopedSlots:e._u([{key:"header",fn:function(){return[o("span",[e._v("Donate")])]},proxy:!0},{key:"body",fn:function(){return[o("div",{staticClass:"donationModalBody"},[o("span",[e._v("Source")]),o("input",{staticClass:"disabled",attrs:{type:"text",value:"Account Address",disabled:!0}}),o("span",[e._v("Amount")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.donationAmount,expression:"donationAmount",modifiers:{number:!0}}],attrs:{type:"number",disabled:e.sending},domProps:{value:e.donationAmount},on:{keyup:function(t){return e.resetDonation()},input:function(t){t.target.composing||(e.donationAmount=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),o("span",[e._v("Receiver")]),o("input",{staticClass:"disabled",attrs:{type:"text",disabled:!0},domProps:{value:e.receiver?e.receiver.name:""}}),o("span",[e._v("Message")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.donationMessage,expression:"donationMessage"}],attrs:{type:"text",placeholder:"Your message",disabled:e.sending},domProps:{value:e.donationMessage},on:{input:function(t){t.target.composing||(e.donationMessage=t.target.value)}}}),e.showFeesError&&"money"==e.showFeesError?o("span",{staticClass:"error"},[e._v("Balance too low")]):e.showFeesError?o("span",{staticClass:"error"},[e._v("Error, can't calculate the fees")]):e._e(),1!=e.calculatingFees?o("button",{staticClass:"button small",attrs:{disabled:!e.donationAmount||null!=e.calculatedFees},on:{click:e.onCalculateFeesClick}},[o("i",{staticClass:"fas fa-chevron-circle-right"}),e._v(" Calculate Fees ")]):e._e(),1==e.calculatingFees?o("div",{staticClass:"linepreloader"},[o("linepreloader")],1):e._e()]),null!=e.calculatedFees?o("div",{staticClass:"donationModalBody"},[o("span",[e._v("Include Fees in Amount")]),o("select",{directives:[{name:"model",rawName:"v-model",value:e.feesDirection,expression:"feesDirection"}],attrs:{disabled:e.sending},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.feesDirection=t.target.multiple?o:o[0]}}},e._l(e.feesDirectionPossibleValues,(function(t){return o("option",{domProps:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),0),o("span",[e._v("Transaction Fees")]),o("input",{staticClass:"disabled",attrs:{type:"number",disabled:!0},domProps:{value:e.calculatedFees}}),o("span",[e._v("Total amount")]),o("span",{staticClass:"totalAmount"},[e._v(e._s(+e.totalDonationAmount.toFixed(5))+" PKOIN")]),e.showTransactionError&&"balance too low"==e.showTransactionError?o("span",{staticClass:"error"},[e._v("Balance too low")]):e.showTransactionError?o("span",{staticClass:"error"},[e._v("Error, can't make the transaction")]):e._e(),1!=e.sending?o("button",{staticClass:"button small",attrs:{disabled:e.sending},on:{click:e.sendDonation}},[o("i",{staticClass:"fas fa-arrow-alt-circle-right"}),e._v(" Send ")]):e._e(),1==e.sending?o("div",{staticClass:"linepreloader"},[o("linepreloader")],1):e._e()]):e._e()]},proxy:!0},{key:"footer",fn:function(){},proxy:!0}],null,!1,3274686846)}):e._e()],1)},c=[],d=o("1da1"),l=o("a34a"),u=o.n(l),f=(o("7db0"),o("159b"),o("b0c0"),o("d3b7"),o("e6cf"),o("a79d"),o("d81d"),o("2f62")),p=o("aa20"),m=o("3094"),h=o("0826"),v=o("71da"),b=o("3139"),y={name:"chatTopheader",props:{chat:Object,u:String,roomInfo:!1,aboutUser:!1},components:{chatName:p["a"],chatIcon:m["a"],chatTyping:h["a"],contacts:v["a"]},data:function(){return{menuItems:[{click:"callupVideoHandler",title:"Video Call",icon:"fas fa-camera"},{click:"callupHandler",title:"Call",icon:"fas fa-phone"}],menuItemsRoom:[{click:"AddMember",title:"Add",icon:"fas fa-user-plus"},{click:"MuteRoom",title:"Mute",icon:"fas fa-bell-slash"},{click:"LeaveFromRoom",title:"Leave and Delete",icon:"fas fa-sign-out-alt"}],menuItemsRoomMuted:[{click:"AddMember",title:"Add",icon:"fas fa-user-plus"},{click:"MuteRoom",title:"UnMute",icon:"fas fa-bell"},{click:"LeaveFromRoom",title:"Leave and Delete",icon:"fas fa-sign-out-alt"}],oneToOne:[{click:"MuteRoom",title:"Mute",icon:"fas fa-bell-slash"},{click:"Donate",title:"Donate",icon:"fas fa-money-bill-wave"}],oneToOneMuted:[{click:"MuteRoom",title:"UnMute",icon:"fas fa-bell"},{click:"LeaveFromRoom",title:"Leave and Delete",icon:"fas fa-sign-out-alt"},{click:"Donate",title:"Donate",icon:"fas fa-money-bill-wave"}],donateMenu:[{click:"Donate",title:"Donate",icon:"fas fa-money-bill-wave"}],loading:!1,typing:!1,userinfo:null,aboutUserShow:!1,roomBanned:!1,roomMuted:!1,donateUserOpened:!1,receiver:null,donationAmount:0,donationMessage:"",calculatedFees:null,showFeesError:"",showTransactionError:"",calculatingFees:!1,sending:!1,feesDirection:"include",feesDirectionPossibleValues:[{value:"include",label:"To be paid by Receiver"},{value:"exclude",label:"To be paid by Sender"}]}},watch:{},mounted:function(){this.getuserinfo()},computed:Object(f["c"])({auth:function(e){return e.auth},m_chat:function(){if(this.chat&&this.chat.roomId){var e=this.core.mtrx.client._pushProcessor.getPushRuleById(this.chat.roomId);null!==e&&(this.roomMuted=!0);var t=this.core.mtrx.client.getRoom(this.chat.roomId);return t||{}}},m_chat_typing:function(){var e=this;if(!this.chat)return!1;var t=this.chat.roomId,o=this.$store.state.typing[t]||{},a=_.find(o,(function(t,o){var a;if(t)return o!=(null===(a=e.core.user.userinfo)||void 0===a?void 0:a.id)}));return a||!1},totalDonationAmount:function(){return"include"==this.feesDirection?this.donationAmount:this.donationAmount+this.calculatedFees}}),methods:{navigateToProfile:function(e){this.$router.push({path:"/contact?id=".concat(b["a"].getmatrixid(e))})},getuserinfo:function(){var e=this;this.u&&this.core.user.usersInfo(this.u).then((function(t){e.userinfo=t[0]}))},findOtherUser:function(){var e,t=this.m_chat.myUserId,o=this.m_chat.currentState.getMembers();return o.forEach((function(o){o&&o.userId!==t&&(e=o)})),e},addMember:function(){this.modalInviteUser()},menuItemClickHandler:function(e,t){var o=this;if("AddMember"===e.click&&(this.$emit("addMember",!0),this.$refs.dropdownMenu.hidePopup()),"MuteRoom"===e.click){var a=this.chat.roomId,n=(this.core.mtrx.client.deviceId,this),i=this.core.mtrx.client._pushProcessor.getPushRuleById(this.chat.roomId);null!==i?(n.core.mtrx.client.deletePushRule("global","room",a),this.roomMuted=!1):(n.core.mtrx.client.setRoomMutePushRule("global",a,"true"),this.roomMuted=!0),this.$refs.dropdownMenu.hidePopup()}if("LeaveFromRoom"===e.click){this.core.mtrx.client.leave(this.chat.roomId).then((function(e){o.core.mtrx.client.forget(o.chat.roomId,!0).then((function(e){o.$store.commit("DELETE_ROOM",o.chat.roomId)})).then((function(e){o.$router.push({path:"/chats"})}))})),this.$refs.dropdownMenu.hidePopup()}if("BanRoom"===e.click){var r="",s=this.findOtherUser();s&&s.userId&&(r=s.userId);var c=this.chat.roomId;this.core.mtrx.client.ban(c,r,"ban").then((function(e){})),this.roomBanned=!0,this.$refs.dropdownMenu.hidePopup()}if("Unban"===e.click){var d="",l=this.findOtherUser();l&&l.userId&&(d=l.userId),this.core.mtrx.client.unban(this.chat.roomId,d).then((function(e){o.core.mtrx.client.invite(o.chat.roomId,d)})),this.roomBanned=!1,this.$refs.dropdownMenu.hidePopup()}if("Donate"===e.click){this.donateUserOpened=!0,this.$refs.dropdownMenu.hidePopup();var u=this.findOtherUser();this.receiver=u?this.$f.deep(this,"$store.state.users."+this.$f.getmatrixid(u.name)):null}},closeDonateModal:function(){this.donateUserOpened=!1},onCalculateFeesClick:function(){var e=this;this.calculatingFees=!0,this.calculateFees().finally((function(){return e.calculatingFees=!1}))},calculateFees:function(){var e=this,t=this;return this.showFeesError="",new Promise((function(o,a){if(e.donationAmount<=0||!e.receiver||!e.receiver.source||!e.receiver.source.address)return e.showFeesError="invalid",a("Missing amount or receiver");try{var n=window.POCKETNETINSTANCE.platform.sdk;n.node.fee.estimate((function(e){var i=[{address:t.receiver.source.address,amount:t.donationAmount}];n.wallet.txbase([n.address.pnet().address],i,0,t.feesDirection,(function(i,r,s){if(i)return console.error(i),t.showFeesError=i,a(i);var c=n.node.transactions.create.wallet(r,s),d=Math.min(c.virtualSize()*e.feerate,.0999);return t.calculatedFees=d,o()}))}))}catch(i){return console.error(i),t.showFeesError=i,a(i)}}))},sendDonation:function(){var e=this;return Object(d["a"])(u.a.mark((function t(){var o,a;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e,e.sending=!0,e.showTransactionError="",t.prev=3,t.next=6,e.calculateFees();case 6:t.next=13;break;case 8:return t.prev=8,t.t0=t["catch"](3),e.showTransactionError="error",e.sending=!1,t.abrupt("return");case 13:a=window.POCKETNETINSTANCE.platform.sdk,a.node.transactions.get.canSpend(a.address.pnet().address,(function(e){if(!e||isNaN(e)||e<o.totalDonationAmount)return o.showTransactionError="balance too low",void(o.sending=!1);try{var t=[{address:o.receiver.source.address,amount:o.donationAmount}];a.wallet.embed(t,o.donationMessage),a.wallet.txbase([a.address.pnet().address],t,o.calculatedFees,o.feesDirection,(function(e,t,n){if(e)return console.error(e),o.showTransactionError="error",o.sending=!1,reject(e);var i=a.node.transactions.create.wallet(t,n);t.forEach((function(e){e.cantspend=!0})),a.node.transactions.send(i,(function(e,i){if(i)return a.node.transactions.releaseCS(t),o.showTransactionError="error",void(o.sending=!1);var r=t.map((function(e){return e.txid}));a.node.transactions.clearUnspents(r),a.wallet.saveTempInfoWallet(e,t,n),o.core.mtrx.client.sendEvent(o.chat.roomId,"m.room.message",{from:o.$f.getmatrixid(o.m_chat.myUserId),to:o.receiver.id,amount:o.donationAmount,txId:e,msgtype:"m.notice"},""),o.closeDonateModal()}))}))}catch(n){console.error(n),o.showTransactionError="error",o.sending=!1}}));case 15:case"end":return t.stop()}}),t,null,[[3,8]])})))()},resetDonation:function(){this.calculatedFees=null,this.showFeesError="",this.showTransactionError=""}}},g=y,x=o("2877");function M(e){var t=o("e411");t.__inject__&&t.__inject__(e);var a=o("6972");a.__inject__&&a.__inject__(e);var n=o("7b69");n.__inject__&&n.__inject__(e);var i=o("e67c");i.__inject__&&i.__inject__(e)}var w=Object(x["a"])(g,s,c,!1,M,"b9f8e6da",null,!0),k=w.exports,I={name:"pagechat",components:{chat:r["a"],topheader:k,contacts:v["a"]},data:function(){return{roomInfo:!1,m_chat:{},events:[],openInviteModal:!1}},computed:Object(i["a"])({u:function(){return this.$route.query.u},chat:function(){var e=this.$route.query.id;return this.$store.state.chatsMap[e]}},Object(f["c"])({pocketnet:function(e){return e.pocketnet},minimized:function(e){return e.minimized}})),mounted:function(){},methods:{closeModal:function(){this.openInviteModal=!1},closeContactModal:function(e){this.openInviteModal=e},addMemberModal:function(e){this.openInviteModal=e},newchat:function(e){},sending:function(){},eventsRoom:function(e){this.events=e}}},B=I;function C(e){var t=o("2122");t.__inject__&&t.__inject__(e)}var D=Object(x["a"])(B,a,n,!1,C,"2120d13f",null,!0);t["default"]=D.exports}}]);
//# sourceMappingURL=matrix-element.3.min.js.map