!function(factory){"function"==typeof define&&define.amd?define(["jquery","handlebars/runtime","medium-editor","blueimp-file-upload","jquery-sortable"],factory):"object"==typeof module&&module.exports?module.exports=function(jQuery,Handlebars){if("undefined"==typeof window)throw new Error("medium-editor-insert-plugin runs only in a browser.");void 0===jQuery&&(jQuery=require("jquery")),window.jQuery=jQuery,Handlebars||(Handlebars=require("handlebars/runtime"));var MediumEditor=require("medium-editor");return factory(jQuery,Handlebars,MediumEditor),jQuery}:factory(jQuery,Handlebars,MediumEditor)}(function($,Handlebars,MediumEditor){this.MediumInsert=this.MediumInsert||{},this.MediumInsert.Templates=this.MediumInsert.Templates||{},this.MediumInsert.Templates["src/js/templates/core-buttons.hbs"]=Handlebars.template({1:function(container,depth0,helpers,partials,data){var stack1,helper,alias1=null!=depth0?depth0:container.nullContext||{},alias2=helpers.helperMissing,alias3="function";return'            <li><button data-addon="'+container.escapeExpression(typeof(helper=null!=(helper=helpers.key||data&&data.key)?helper:alias2)===alias3?helper.call(alias1,{name:"key",hash:{},data:data}):helper)+'" data-action="add" class="medium-insert-action" type="button">'+(null!=(stack1=typeof(helper=null!=(helper=helpers.label||(null!=depth0?depth0.label:depth0))?helper:alias2)===alias3?helper.call(alias1,{name:"label",hash:{},data:data}):helper)?stack1:"")+"</button></li>\n"},compiler:[7,">= 4.0.0"],main:function(container,depth0,helpers,partials,data){var stack1;return'<div class="medium-insert-buttons" contenteditable="false" style="display: none">\n    <button class="medium-insert-buttons-show" type="button"><span>+</span></button>\n    <ul class="medium-insert-buttons-addons" style="display: none">\n'+(null!=(stack1=helpers.each.call(null!=depth0?depth0:container.nullContext||{},null!=depth0?depth0.addons:depth0,{name:"each",hash:{},fn:container.program(1,data,0),inverse:container.noop,data:data}))?stack1:"")+"    </ul>\n</div>\n"},useData:!0}),this.MediumInsert.Templates["src/js/templates/core-caption.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(container,depth0,helpers,partials,data){var helper;return'<figcaption contenteditable="true" class="medium-insert-caption-placeholder" data-placeholder="'+container.escapeExpression("function"==typeof(helper=null!=(helper=helpers.placeholder||(null!=depth0?depth0.placeholder:depth0))?helper:helpers.helperMissing)?helper.call(null!=depth0?depth0:container.nullContext||{},{name:"placeholder",hash:{},data:data}):helper)+'"></figcaption>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/core-empty-line.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(container,depth0,helpers,partials,data){return"<p><br></p>\n"},useData:!0}),this.MediumInsert.Templates["src/js/templates/embeds-toolbar.hbs"]=Handlebars.template({1:function(container,depth0,helpers,partials,data){var stack1;return'    <div class="medium-insert-embeds-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active">\n        <ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(stack1=helpers.each.call(null!=depth0?depth0:container.nullContext||{},null!=depth0?depth0.styles:depth0,{name:"each",hash:{},fn:container.program(2,data,0),inverse:container.noop,data:data}))?stack1:"")+"        </ul>\n    </div>\n"},2:function(container,depth0,helpers,partials,data){var stack1;return null!=(stack1=helpers.if.call(null!=depth0?depth0:container.nullContext||{},null!=depth0?depth0.label:depth0,{name:"if",hash:{},fn:container.program(3,data,0),inverse:container.noop,data:data}))?stack1:""},3:function(container,depth0,helpers,partials,data){var stack1,helper,alias1=null!=depth0?depth0:container.nullContext||{},alias2=helpers.helperMissing,alias3="function";return'                    <li>\n                        <button class="medium-editor-action" data-action="'+container.escapeExpression(typeof(helper=null!=(helper=helpers.key||data&&data.key)?helper:alias2)===alias3?helper.call(alias1,{name:"key",hash:{},data:data}):helper)+'">'+(null!=(stack1=typeof(helper=null!=(helper=helpers.label||(null!=depth0?depth0.label:depth0))?helper:alias2)===alias3?helper.call(alias1,{name:"label",hash:{},data:data}):helper)?stack1:"")+"</button>\n                    </li>\n"},5:function(container,depth0,helpers,partials,data){var stack1;return'    <div class="medium-insert-embeds-toolbar2 medium-editor-toolbar medium-editor-toolbar-active">\n        <ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(stack1=helpers.each.call(null!=depth0?depth0:container.nullContext||{},null!=depth0?depth0.actions:depth0,{name:"each",hash:{},fn:container.program(2,data,0),inverse:container.noop,data:data}))?stack1:"")+"        </ul>\n    </div>\n"},compiler:[7,">= 4.0.0"],main:function(container,depth0,helpers,partials,data){var stack1,alias1=null!=depth0?depth0:container.nullContext||{};return(null!=(stack1=helpers.if.call(alias1,null!=depth0?depth0.styles:depth0,{name:"if",hash:{},fn:container.program(1,data,0),inverse:container.noop,data:data}))?stack1:"")+"\n"+(null!=(stack1=helpers.if.call(alias1,null!=depth0?depth0.actions:depth0,{name:"if",hash:{},fn:container.program(5,data,0),inverse:container.noop,data:data}))?stack1:"")},useData:!0}),this.MediumInsert.Templates["src/js/templates/embeds-wrapper.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(container,depth0,helpers,partials,data){var stack1,helper;return'<div class="medium-insert-embeds" contenteditable="false">\n\t<figure>\n\t\t<div class="medium-insert-embed">\n\t\t\t'+(null!=(stack1="function"==typeof(helper=null!=(helper=helpers.html||(null!=depth0?depth0.html:depth0))?helper:helpers.helperMissing)?helper.call(null!=depth0?depth0:container.nullContext||{},{name:"html",hash:{},data:data}):helper)?stack1:"")+'\n\t\t</div>\n\t</figure>\n\t<div class="medium-insert-embeds-overlay"></div>\n</div>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-fileupload.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(container,depth0,helpers,partials,data){return'<input type="file" multiple>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-image.hbs"]=Handlebars.template({1:function(container,depth0,helpers,partials,data){return'        <div class="medium-insert-images-progress"></div>\n'},compiler:[7,">= 4.0.0"],main:function(container,depth0,helpers,partials,data){var stack1,helper,alias1=null!=depth0?depth0:container.nullContext||{};return'<figure contenteditable="false">\n    <img src="'+container.escapeExpression("function"==typeof(helper=null!=(helper=helpers.img||(null!=depth0?depth0.img:depth0))?helper:helpers.helperMissing)?helper.call(alias1,{name:"img",hash:{},data:data}):helper)+'" alt="" />\n'+(null!=(stack1=helpers.if.call(alias1,null!=depth0?depth0.progress:depth0,{name:"if",hash:{},fn:container.program(1,data,0),inverse:container.noop,data:data}))?stack1:"")+"</figure>\n"},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-progressbar.hbs"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(container,depth0,helpers,partials,data){return'<progress min="0" max="100" value="0">0</progress>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-toolbar.hbs"]=Handlebars.template({1:function(container,depth0,helpers,partials,data){var stack1;return null!=(stack1=helpers.if.call(null!=depth0?depth0:container.nullContext||{},null!=depth0?depth0.label:depth0,{name:"if",hash:{},fn:container.program(2,data,0),inverse:container.noop,data:data}))?stack1:""},2:function(container,depth0,helpers,partials,data){var stack1,helper,alias1=null!=depth0?depth0:container.nullContext||{},alias2=helpers.helperMissing,alias3="function";return'                <li>\n                    <button class="medium-editor-action" data-action="'+container.escapeExpression(typeof(helper=null!=(helper=helpers.key||data&&data.key)?helper:alias2)===alias3?helper.call(alias1,{name:"key",hash:{},data:data}):helper)+'">'+(null!=(stack1=typeof(helper=null!=(helper=helpers.label||(null!=depth0?depth0.label:depth0))?helper:alias2)===alias3?helper.call(alias1,{name:"label",hash:{},data:data}):helper)?stack1:"")+"</button>\n                </li>\n"},4:function(container,depth0,helpers,partials,data){var stack1;return'\t<div class="medium-insert-images-toolbar2 medium-editor-toolbar medium-editor-toolbar-active">\n\t\t<ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(stack1=helpers.each.call(null!=depth0?depth0:container.nullContext||{},null!=depth0?depth0.actions:depth0,{name:"each",hash:{},fn:container.program(5,data,0),inverse:container.noop,data:data}))?stack1:"")+"    \t</ul>\n    </div>\n"},5:function(container,depth0,helpers,partials,data){var stack1;return null!=(stack1=helpers.if.call(null!=depth0?depth0:container.nullContext||{},null!=depth0?depth0.label:depth0,{name:"if",hash:{},fn:container.program(6,data,0),inverse:container.noop,data:data}))?stack1:""},6:function(container,depth0,helpers,partials,data){var stack1,helper,alias1=null!=depth0?depth0:container.nullContext||{},alias2=helpers.helperMissing,alias3="function";return'        \t        <li>\n        \t            <button class="medium-editor-action" data-action="'+container.escapeExpression(typeof(helper=null!=(helper=helpers.key||data&&data.key)?helper:alias2)===alias3?helper.call(alias1,{name:"key",hash:{},data:data}):helper)+'">'+(null!=(stack1=typeof(helper=null!=(helper=helpers.label||(null!=depth0?depth0.label:depth0))?helper:alias2)===alias3?helper.call(alias1,{name:"label",hash:{},data:data}):helper)?stack1:"")+"</button>\n        \t        </li>\n"},compiler:[7,">= 4.0.0"],main:function(container,depth0,helpers,partials,data){var stack1,alias1=null!=depth0?depth0:container.nullContext||{};return'<div class="medium-insert-images-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active">\n    <ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(stack1=helpers.each.call(alias1,null!=depth0?depth0.styles:depth0,{name:"each",hash:{},fn:container.program(1,data,0),inverse:container.noop,data:data}))?stack1:"")+"    </ul>\n</div>\n\n"+(null!=(stack1=helpers.if.call(alias1,null!=depth0?depth0.actions:depth0,{name:"if",hash:{},fn:container.program(4,data,0),inverse:container.noop,data:data}))?stack1:"")},useData:!0}),function($,window,document,undefined){"use strict";var pluginName="mediumInsert",defaults={editor:null,enabled:!0,addons:{images:!0,embeds:!0}};function ucfirst(str){return str.charAt(0).toUpperCase()+str.slice(1)}function Core(el,options){var editor;this.el=el,this.$el=$(el),this.templates=window.MediumInsert.Templates,options&&(editor=options.editor,options.editor=null),this.options=$.extend(!0,{},defaults,options),this.options.editor=editor,options&&(options.editor=editor),this._defaults=defaults,this._name=pluginName,this.options&&this.options.editor&&(this.options.editor._serialize===undefined&&(this.options.editor._serialize=this.options.editor.serialize),this.options.editor._destroy===undefined&&(this.options.editor._destroy=this.options.editor.destroy),this.options.editor._setup===undefined&&(this.options.editor._setup=this.options.editor.setup),this.options.editor._hideInsertButtons=this.hideButtons,this.options.editor.serialize=this.editorSerialize,this.options.editor.destroy=this.editorDestroy,this.options.editor.setup=this.editorSetup,this.options.editor.getExtensionByName("placeholder")!==undefined&&(this.options.editor.getExtensionByName("placeholder").updatePlaceholder=this.editorUpdatePlaceholder))}Core.prototype.init=function(){this.$el.addClass("medium-editor-insert-plugin"),"object"==typeof this.options.addons&&0!==Object.keys(this.options.addons).length||this.disable(),this.initAddons(),this.clean(),this.events()},Core.prototype.events=function(){var that=this;this.$el.on("dragover drop",function(e){e.preventDefault()}).on("keyup click",$.proxy(this,"toggleButtons")).on("selectstart mousedown",".medium-insert, .medium-insert-buttons",$.proxy(this,"disableSelection")).on("click",".medium-insert-buttons-show",$.proxy(this,"toggleAddons")).on("click",".medium-insert-action",$.proxy(this,"addonAction")).on("paste",".medium-insert-caption-placeholder",function(e){$.proxy(that,"removeCaptionPlaceholder")($(e.target))}),$(window).on("resize",$.proxy(this,"positionButtons",null))},Core.prototype.getEditor=function(){return this.options.editor},Core.prototype.editorSerialize=function(){var data=this._serialize();return $.each(data,function(key){var $data=$("<div />").html(data[key].value);$data.find(".medium-insert-buttons").remove(),$data.find(".medium-insert-active").removeClass("medium-insert-active"),$data.find("[data-embed-code]").each(function(){var $this=$(this),html=$("<div />").html($this.attr("data-embed-code")).text();$this.html(html)}),data[key].value=$data.html()}),data},Core.prototype.editorDestroy=function(){$.each(this.elements,function(key,el){$(el).data("plugin_"+pluginName)instanceof Core&&$(el).data("plugin_"+pluginName).disable()}),this._destroy()},Core.prototype.editorSetup=function(){this._setup(),$.each(this.elements,function(key,el){$(el).data("plugin_"+pluginName)instanceof Core&&$(el).data("plugin_"+pluginName).enable()})},Core.prototype.editorUpdatePlaceholder=function(el,dontShow){var contents=$(el).children().not(".medium-insert-buttons").contents();dontShow||1!==contents.length||"br"!==contents[0].nodeName.toLowerCase()?this.hidePlaceholder(el):(this.showPlaceholder(el),this.base._hideInsertButtons($(el)))},Core.prototype.triggerInput=function(){this.getEditor()&&this.getEditor().trigger("editableInput",null,this.el)},Core.prototype.deselect=function(){document.getSelection().removeAllRanges()},Core.prototype.disable=function(){this.options.enabled=!1,this.$el.find(".medium-insert-buttons").addClass("hide")},Core.prototype.enable=function(){this.options.enabled=!0,this.$el.find(".medium-insert-buttons").removeClass("hide")},Core.prototype.disableSelection=function(e){var $el=$(e.target);(!1===$el.is("img")||$el.hasClass("medium-insert-buttons-show"))&&e.preventDefault()},Core.prototype.initAddons=function(){var that=this;this.options.addons&&0!==this.options.addons.length&&$.each(this.options.addons,function(addon,options){var addonName=pluginName+ucfirst(addon);!1!==options?(that.$el[addonName](options),that.options.addons[addon]=that.$el.data("plugin_"+addonName).options):delete that.options.addons[addon]})},Core.prototype.clean=function(){var that=this,$buttons,$lastEl,$text;!1!==this.options.enabled&&(0===this.$el.html().length&&this.$el.html(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),($text=this.$el.contents().filter(function(){return"#text"===this.nodeName&&""!==$.trim($(this).text())||"br"===this.nodeName.toLowerCase()})).each(function(){$(this).wrap("<p />"),that.moveCaret($(this).parent(),$(this).text().length)}),this.addButtons(),($lastEl=($buttons=this.$el.find(".medium-insert-buttons")).prev()).attr("class")&&$lastEl.attr("class").match(/medium\-insert(?!\-active)/)&&$buttons.before(this.templates["src/js/templates/core-empty-line.hbs"]().trim()))},Core.prototype.getButtons=function(){if(!1!==this.options.enabled)return this.templates["src/js/templates/core-buttons.hbs"]({addons:this.options.addons}).trim()},Core.prototype.addButtons=function(){0===this.$el.find(".medium-insert-buttons").length&&this.$el.append(this.getButtons())},Core.prototype.toggleButtons=function(e){var $el=$(e.target),selection=window.getSelection(),that=this,range,$current,$p,activeAddon;!1!==this.options.enabled&&(selection&&0!==selection.rangeCount?(range=selection.getRangeAt(0),$current=$(range.commonAncestorContainer)):$current=$el,$current.hasClass("medium-editor-insert-plugin")&&($current=$current.find("p:first")),$p=$current.is("p")?$current:$current.closest("p"),this.clean(),!1===$el.hasClass("medium-editor-placeholder")&&0===$el.closest(".medium-insert-buttons").length&&0===$current.closest(".medium-insert-buttons").length&&(this.$el.find(".medium-insert-active").removeClass("medium-insert-active"),$.each(this.options.addons,function(addon){if($el.closest(".medium-insert-"+addon).length&&($current=$el),$current.closest(".medium-insert-"+addon).length)return $p=$current.closest(".medium-insert-"+addon),void(activeAddon=addon)}),$p.length&&(""===$p.text().trim()&&!activeAddon||"images"===activeAddon)?($p.addClass("medium-insert-active"),"images"===activeAddon?this.$el.find(".medium-insert-buttons").attr("data-active-addon",activeAddon):this.$el.find(".medium-insert-buttons").removeAttr("data-active-addon"),setTimeout(function(){that.positionButtons(activeAddon),that.showButtons(activeAddon)},activeAddon?100:0)):this.hideButtons()))},Core.prototype.showButtons=function(activeAddon){var $buttons=this.$el.find(".medium-insert-buttons");$buttons.show(),$buttons.find("li").show(),activeAddon&&($buttons.find("li").hide(),$buttons.find('button[data-addon="'+activeAddon+'"]').parent().show())},Core.prototype.hideButtons=function($el){($el=$el||this.$el).find(".medium-insert-buttons").hide(),$el.find(".medium-insert-buttons-addons").hide(),$el.find(".medium-insert-buttons-show").removeClass("medium-insert-buttons-rotate")},Core.prototype.positionButtons=function(activeAddon){var $buttons=this.$el.find(".medium-insert-buttons"),$p=this.$el.find(".medium-insert-active"),$lastCaption=$p.hasClass("medium-insert-images-grid")?[]:$p.find("figure:last figcaption"),elementsContainer=this.getEditor()?this.getEditor().options.elementsContainer:$("body").get(0),elementsContainerAbsolute=["absolute","fixed"].indexOf(window.getComputedStyle(elementsContainer).getPropertyValue("position"))>-1,position={},offset={};$p.length&&(position.left=$p.position().left,position.top=$p.position().top,offset.left=$p.offset().left,offset.top=$p.offset().top,activeAddon?(position.left+=$p.width()-$buttons.find(".medium-insert-buttons-show").width()-10,position.top+=$p.height()-20+($lastCaption.length?-$lastCaption.height()-parseInt($lastCaption.css("margin-top"),10):10)):(position.left+=-parseInt($buttons.find(".medium-insert-buttons-addons").css("left"),10)-parseInt($buttons.find(".medium-insert-buttons-addons button:first").css("margin-left"),10),position.top+=parseInt($p.css("margin-top"),10)),elementsContainerAbsolute&&(position.top+=elementsContainer.scrollTop),!1===this.$el.hasClass("medium-editor-placeholder")&&position.left<0&&(position.left=$p.position().left,position.top+=$p.height()+10),$buttons.css(position))},Core.prototype.toggleAddons=function(){"images"!==this.$el.find(".medium-insert-buttons").attr("data-active-addon")?(this.$el.find(".medium-insert-buttons-addons").fadeToggle(),this.$el.find(".medium-insert-buttons-show").toggleClass("medium-insert-buttons-rotate")):this.$el.find(".medium-insert-buttons").find('button[data-addon="images"]').click()},Core.prototype.hideAddons=function(){this.$el.find(".medium-insert-buttons-addons").hide(),this.$el.find(".medium-insert-buttons-show").removeClass("medium-insert-buttons-rotate")},Core.prototype.addonAction=function(e){var $a=$(e.currentTarget),addon=$a.data("addon"),action=$a.data("action");this.$el.data("plugin_"+pluginName+ucfirst(addon))[action]()},Core.prototype.moveCaret=function($el,position){var range,sel,el,textEl;position=position||0,range=document.createRange(),sel=window.getSelection(),(el=$el.get(0)).childNodes.length||(textEl=document.createTextNode(" "),el.appendChild(textEl)),range.setStart(el.childNodes[0],position),range.collapse(!0),sel.removeAllRanges(),sel.addRange(range)},Core.prototype.addCaption=function($el,placeholder){var $caption;0===$el.find("figcaption").length&&$el.append(this.templates["src/js/templates/core-caption.hbs"]({placeholder:placeholder}))},Core.prototype.removeCaptions=function($ignore){var $captions=this.$el.find("figcaption");$ignore&&($captions=$captions.not($ignore)),$captions.each(function(){($(this).hasClass("medium-insert-caption-placeholder")||""===$(this).text().trim())&&$(this).remove()})},Core.prototype.removeCaptionPlaceholder=function($el){var $caption=$el.is("figcaption")?$el:$el.find("figcaption");$caption.length&&$caption.removeClass("medium-insert-caption-placeholder").removeAttr("data-placeholder")},$.fn[pluginName]=function(options){return this.each(function(){var that=this,textareaId;$(that).is("textarea")&&(textareaId=$(that).attr("medium-editor-textarea-id"),that=$(that).siblings('[medium-editor-textarea-id="'+textareaId+'"]').get(0)),$.data(that,"plugin_"+pluginName)?"string"==typeof options&&$.data(that,"plugin_"+pluginName)[options]&&$.data(that,"plugin_"+pluginName)[options]():($.data(that,"plugin_"+pluginName,new Core(that,options)),$.data(that,"plugin_"+pluginName).init())})}}(jQuery,window,document),function($,window,document,undefined){"use strict";var pluginName="mediumInsert",addonName="Embeds",defaults={label:'<span class="fas fa-play"></span>',placeholder:"Paste a YouTube, Vimeo, Facebook, Twitter or Instagram link and press Enter",captions:!0,captionPlaceholder:"Type caption (optional)",storeMeta:!1,styles:{wide:{label:'<span class="fa fa-align-justify"></span>'},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(){var $event=$.Event("keydown");$event.which=8,$(document).trigger($event)}}},parseOnPaste:!1};function Embeds(el,options){this.el=el,this.$el=$(el),this.templates=window.MediumInsert.Templates,this.core=this.$el.data("plugin_"+pluginName),this.options=$.extend(!0,{},defaults,options),this._defaults=defaults,this._name=pluginName,this.core.getEditor()&&(this.core.getEditor()._serializePreEmbeds=this.core.getEditor().serialize,this.core.getEditor().serialize=this.editorSerialize),this.init()}Embeds.prototype.init=function(){var $embeds=this.$el.find(".medium-insert-embeds");$embeds.attr("contenteditable",!1),$embeds.each(function(){0===$(this).find(".medium-insert-embeds-overlay").length&&$(this).append($("<div />").addClass("medium-insert-embeds-overlay"))}),this.events(),this.backwardsCompatibility()},Embeds.prototype.events=function(){$(document).on("click",$.proxy(this,"unselectEmbed")).on("keydown",$.proxy(this,"removeEmbed")).on("click",".medium-insert-embeds-toolbar .medium-editor-action",$.proxy(this,"toolbarAction")).on("click",".medium-insert-embeds-toolbar2 .medium-editor-action",$.proxy(this,"toolbar2Action")),this.$el.on("keyup click paste",$.proxy(this,"togglePlaceholder")).on("keydown",$.proxy(this,"processLink")).on("click",".medium-insert-embeds-overlay",$.proxy(this,"selectEmbed")).on("contextmenu",".medium-insert-embeds-placeholder",$.proxy(this,"fixRightClickOnPlaceholder")),this.options.parseOnPaste&&this.$el.on("paste",$.proxy(this,"processPasted")),$(window).on("resize",$.proxy(this,"autoRepositionToolbars"))},Embeds.prototype.backwardsCompatibility=function(){var that=this;this.$el.find(".mediumInsert-embeds").removeClass("mediumInsert-embeds").addClass("medium-insert-embeds"),this.$el.find(".medium-insert-embeds").each(function(){0===$(this).find(".medium-insert-embed").length&&($(this).after(that.templates["src/js/templates/embeds-wrapper.hbs"]({html:$(this).html()})),$(this).remove())})},Embeds.prototype.editorSerialize=function(){var data=this._serializePreEmbeds();return $.each(data,function(key){var $data=$("<div />").html(data[key].value),$embeds=$data.find(".medium-insert-embeds");$embeds.removeAttr("contenteditable"),$embeds.find("figcaption").removeAttr("contenteditable"),$data.find(".medium-insert-embeds-overlay").remove(),data[key].value=$data.html()}),data},Embeds.prototype.add=function(){var $place=this.$el.find(".medium-insert-active");$place.html(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),$place.is("p")&&($place.replaceWith('<div class="medium-insert-active">'+$place.html()+"</div>"),$place=this.$el.find(".medium-insert-active"),this.core.moveCaret($place)),$place.addClass("medium-insert-embeds medium-insert-embeds-input medium-insert-embeds-active"),this.togglePlaceholder({target:$place.get(0)}),$place.click(),this.core.hideButtons()},Embeds.prototype.togglePlaceholder=function(e){var $place=$(e.target),selection=window.getSelection(),range,$current,text;selection&&0!==selection.rangeCount&&(range=selection.getRangeAt(0),($current=$(range.commonAncestorContainer)).hasClass("medium-insert-embeds-active")?$place=$current:$current.closest(".medium-insert-embeds-active").length&&($place=$current.closest(".medium-insert-embeds-active")),$place.hasClass("medium-insert-embeds-active")?""===(text=$place.text().trim())&&!1===$place.hasClass("medium-insert-embeds-placeholder")?$place.addClass("medium-insert-embeds-placeholder").attr("data-placeholder",this.options.placeholder):""!==text&&$place.hasClass("medium-insert-embeds-placeholder")&&$place.removeClass("medium-insert-embeds-placeholder").removeAttr("data-placeholder"):this.$el.find(".medium-insert-embeds-active").remove())},Embeds.prototype.fixRightClickOnPlaceholder=function(e){this.core.moveCaret($(e.target))},Embeds.prototype.processLink=function(e){var $place=this.$el.find(".medium-insert-embeds-active"),url;$place.length&&(""!==(url=$place.text().trim())||-1===[8,46,13].indexOf(e.which)?13===e.which&&(e.preventDefault(),e.stopPropagation(),this.options.oembedProxy?this.oembed(url):this.parseUrl(url)):$place.remove())},Embeds.prototype.processPasted=function(e){var pastedUrl,linkRegEx;$(".medium-insert-embeds-active").length||(pastedUrl=e.originalEvent.clipboardData.getData("text"),(linkRegEx=new RegExp("^(http(s?):)?//","i")).test(pastedUrl)&&(this.options.oembedProxy?this.oembed(pastedUrl,!0):this.parseUrl(pastedUrl,!0)))},Embeds.prototype.oembed=function(url,pasted){var that=this;console.log("oembed0, ",url,pasted),$.support.cors=!0,$.ajax({crossDomain:!0,cache:!1,url:this.options.oembedProxy,dataType:"json",data:{url:url},success:function(data){var html=data&&data.html;that.options.storeMeta&&(html+='<div class="medium-insert-embeds-meta"><script type="text/json">'+JSON.stringify(data)+"<\/script></div>"),data&&!html&&"photo"===data.type&&data.url&&(html='<img src="'+data.url+'" alt="">'),html?pasted?$.proxy(that,"embed",html,url)():$.proxy(that,"embed",html)():$.proxy(that,"convertBadEmbed",url)()},error:function(jqXHR,textStatus,errorThrown){var responseJSON=function(){try{return JSON.parse(jqXHR.responseText)}catch(e){}}();void 0!==window.console?window.console.log(responseJSON&&responseJSON.error||jqXHR.status||errorThrown.message):window.alert("Error requesting media from "+that.options.oembedProxy+" to insert: "+errorThrown+" (response status: "+jqXHR.status+")"),$.proxy(that,"convertBadEmbed",url)()}})},Embeds.prototype.parseUrl=function(url,pasted){var html;return new RegExp(["youtube","youtu.be","vimeo","bitchute","instagram","twitter","facebook"].join("|")).test(url)?(html=url.replace(/\n?/g,"").replace(/^((http(s)?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/(watch\?v=|v\/)?)([a-zA-Z0-9\-_]+)(.*)?$/,'<div class="video video-youtube  plyrvideo" provider="youtube" eid="$7"><div class="js-player" data-plyr-provider="youtube" data-plyr-embed-id="$7"></div> </div>').replace(/^https?:\/\/vimeo\.com(\/.+)?\/([0-9]+)$/,'<div class="video video-vimeo plyrvideo" provider="vimeo" eid="$2"><div class="js-player" data-plyr-provider="vimeo" data-plyr-embed-id="$2"></div></div>').replace(/^((http(s)?:\/\/)?(www\.)?(bitchute\.com)\/(video\/)?)([a-zA-Z0-9\-_]+)(.*)?$/,'<div class="video video-bitchute  plyrvideo" provider="bitchute" eid="$7"><div class="js-player" data-plyr-provider="bitchute" data-plyr-embed-id="$7"></div> </div>').replace(/^https:\/\/twitter\.com\/(\w+)\/status\/(\d+)\/?$/,'<blockquote class="twitter-tweet" align="center" lang="en"><a href="https://twitter.com/$1/statuses/$2"></a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8"><\/script>').replace(/^(https:\/\/www\.facebook\.com\/(.*))$/,'<script src="//connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v2.2" async><\/script><div class="fb-post" data-href="$1"><div class="fb-xfbml-parse-ignore"><a href="$1">Loading Facebook post...</a></div></div>').replace(/^https?:\/\/instagram\.com\/p\/(.+)\/?$/,'<span class="instagram"><iframe src="//instagram.com/p/$1/embed/" width="612" height="710" frameborder="0" scrolling="no" allowtransparency="true"></iframe></span>'),this.options.storeMeta&&(html+='<div class="medium-insert-embeds-meta"><script type="text/json">'+JSON.stringify({})+"<\/script></div>"),!1===/<("[^"]*"|'[^']*'|[^'">])*>/.test(html)?($.proxy(this,"convertBadEmbed",url)(),!1):(console.log(html,url),void(pasted?this.embed(html,url):this.embed(html)))):($.proxy(this,"convertBadEmbed",url)(),!1)},Embeds.prototype.embed=function(html,pastedUrl){var $place=this.$el.find(".medium-insert-embeds-active"),$div;if(!html)return alert("Incorrect URL format specified"),!1;html.indexOf("<\/script>")>-1&&($div=$("<div>").attr("data-embed-code",$("<div />").text(html).html()).html(html),html=$("<div>").append($div).html()),pastedUrl?(($place=this.$el.find(":not(iframe, script, style, .js-player)").contents().filter(function(){return 3===this.nodeType&&this.textContent.indexOf(pastedUrl)>-1}).parent()).after(this.templates["src/js/templates/embeds-wrapper.hbs"]({html:html})),$place.text($place.text().replace(pastedUrl,""))):($place.after(this.templates["src/js/templates/embeds-wrapper.hbs"]({html:html})),$place.remove());var players=Plyr.setup(".js-player");this.core.triggerInput(),-1!==html.indexOf("facebook")&&"undefined"!=typeof FB&&setTimeout(function(){FB.XFBML.parse()},2e3)},Embeds.prototype.convertBadEmbed=function(content){var $place,$empty,$content,emptyTemplate=this.templates["src/js/templates/core-empty-line.hbs"]().trim();$place=this.$el.find(".medium-insert-embeds-active"),$content=$(emptyTemplate),$place.before($content),$place.remove(),$content.html(content),$empty=$(emptyTemplate),$content.after($empty),this.core.triggerInput(),this.core.moveCaret($empty)},Embeds.prototype.selectEmbed=function(e){var that=this,$embed;this.core.options.enabled&&(($embed=$(e.target).hasClass("medium-insert-embeds")?$(e.target):$(e.target).closest(".medium-insert-embeds")).addClass("medium-insert-embeds-selected"),setTimeout(function(){that.addToolbar(),that.options.captions&&that.core.addCaption($embed.find("figure"),that.options.captionPlaceholder)},50))},Embeds.prototype.unselectEmbed=function(e){var $el=$(e.target).hasClass("medium-insert-embeds")?$(e.target):$(e.target).closest(".medium-insert-embeds"),$embed=this.$el.find(".medium-insert-embeds-selected");if($el.hasClass("medium-insert-embeds-selected"))return $embed.not($el).removeClass("medium-insert-embeds-selected"),$(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),this.core.removeCaptions($el.find("figcaption")),void(($(e.target).is(".medium-insert-caption-placeholder")||$(e.target).is("figcaption"))&&($el.removeClass("medium-insert-embeds-selected"),this.core.removeCaptionPlaceholder($el.find("figure"))));$embed.removeClass("medium-insert-embeds-selected"),$(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),$(e.target).is(".medium-insert-caption-placeholder")?this.core.removeCaptionPlaceholder($el.find("figure")):!1===$(e.target).is("figcaption")&&this.core.removeCaptions()},Embeds.prototype.removeEmbed=function(e){var $embed,$empty;8!==e.which&&46!==e.which||($embed=this.$el.find(".medium-insert-embeds-selected")).length&&(e.preventDefault(),$(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),$empty=$(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),$embed.before($empty),$embed.remove(),this.core.hideAddons(),this.core.moveCaret($empty),this.core.triggerInput())},Embeds.prototype.addToolbar=function(){var $embed=this.$el.find(".medium-insert-embeds-selected"),active=!1,$toolbar,$toolbar2,mediumEditor,toolbarContainer;0!==$embed.length&&(toolbarContainer=(mediumEditor=this.core.getEditor()).options.elementsContainer||"body",$(toolbarContainer).append(this.templates["src/js/templates/embeds-toolbar.hbs"]({styles:this.options.styles,actions:this.options.actions}).trim()),$toolbar=$(".medium-insert-embeds-toolbar"),$toolbar2=$(".medium-insert-embeds-toolbar2"),$toolbar.find("button").each(function(){$embed.hasClass("medium-insert-embeds-"+$(this).data("action"))&&($(this).addClass("medium-editor-button-active"),active=!0)}),!1===active&&$toolbar.find("button").first().addClass("medium-editor-button-active"),this.repositionToolbars(),$toolbar.fadeIn(),$toolbar2.fadeIn())},Embeds.prototype.autoRepositionToolbars=function(){setTimeout(function(){this.repositionToolbars(),this.repositionToolbars()}.bind(this),0)},Embeds.prototype.repositionToolbars=function(){var $toolbar=$(".medium-insert-embeds-toolbar"),$toolbar2=$(".medium-insert-embeds-toolbar2"),$embed=this.$el.find(".medium-insert-embeds-selected"),elementsContainer=this.core.getEditor().options.elementsContainer,elementsContainerAbsolute=["absolute","fixed"].indexOf(window.getComputedStyle(elementsContainer).getPropertyValue("position"))>-1,elementsContainerBoundary=elementsContainerAbsolute?elementsContainer.getBoundingClientRect():null,containerWidth=$(window).width(),position={};$toolbar2.length&&(position.top=$embed.offset().top+2,position.left=$embed.offset().left+$embed.width()-$toolbar2.width()-4,elementsContainerAbsolute&&(position.top+=elementsContainer.scrollTop-elementsContainerBoundary.top,position.left-=elementsContainerBoundary.left,containerWidth=$(elementsContainer).width()),position.left+$toolbar2.width()>containerWidth&&(position.left=containerWidth-$toolbar2.width()),$toolbar2.css(position)),$toolbar.length&&(position.left=$embed.offset().left+$embed.width()/2-$toolbar.width()/2,position.top=$embed.offset().top-$toolbar.height()-8-2-5,elementsContainerAbsolute&&(position.top+=elementsContainer.scrollTop-elementsContainerBoundary.top,position.left-=elementsContainerBoundary.left),position.top<0&&(position.top=0),$toolbar.css(position))},Embeds.prototype.toolbarAction=function(e){var $button=$(e.target).is("button")?$(e.target):$(e.target).closest("button"),$li=$button.closest("li"),$ul,$lis=$li.closest("ul").find("li"),$embed=this.$el.find(".medium-insert-embeds-selected"),that=this;$button.addClass("medium-editor-button-active"),$li.siblings().find(".medium-editor-button-active").removeClass("medium-editor-button-active"),$lis.find("button").each(function(){var className="medium-insert-embeds-"+$(this).data("action");$(this).hasClass("medium-editor-button-active")?($embed.addClass(className),that.options.styles[$(this).data("action")].added&&that.options.styles[$(this).data("action")].added($embed)):($embed.removeClass(className),that.options.styles[$(this).data("action")].removed&&that.options.styles[$(this).data("action")].removed($embed))}),this.core.triggerInput()},Embeds.prototype.toolbar2Action=function(e){var $button=$(e.target).is("button")?$(e.target):$(e.target).closest("button"),callback=this.options.actions[$button.data("action")].clicked;callback&&callback(this.$el.find(".medium-insert-embeds-selected")),this.core.triggerInput()},$.fn[pluginName+"Embeds"]=function(options){return this.each(function(){$.data(this,"plugin_"+pluginName+"Embeds")||$.data(this,"plugin_"+pluginName+"Embeds",new Embeds(this,options))})}}(jQuery,window,document),function($,window,document,Util,undefined){"use strict";var pluginName="mediumInsert",addonName="Images",defaults={label:'<span class="fa fa-camera"></span>',deleteMethod:"POST",deleteScript:"delete.php",preview:!0,captions:!0,captionPlaceholder:"Type caption for image (optional)",autoGrid:3,fileUploadOptions:{url:null,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i},fileDeleteOptions:{},styles:{wide:{label:'<span class="fa fa-align-justify"></span>'},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'},grid:{label:'<span class="fa fa-th"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(){var $event=$.Event("keydown");$event.which=8,$(document).trigger($event)}}},sorting:function(){var that=this;$(".medium-insert-images").sortable({group:"medium-insert-images",containerSelector:".medium-insert-images",itemSelector:"figure",placeholder:'<figure class="placeholder">',handle:"img",nested:!1,vertical:!1,afterMove:function(){that.core.triggerInput()}})},messages:{acceptFileTypesError:"This file is not in a supported format: ",maxFileSizeError:"This file is too big: "}};function Images(el,options){this.el=el,this.$el=$(el),this.$currentImage=null,this.templates=window.MediumInsert.Templates,this.core=this.$el.data("plugin_"+pluginName),this.options=$.extend(!0,{},defaults,options),this._defaults=defaults,this._name=pluginName,this.options.preview&&!window.FileReader&&(this.options.preview=!1),this.core.getEditor()&&(this.core.getEditor()._serializePreImages=this.core.getEditor().serialize,this.core.getEditor().serialize=this.editorSerialize),this.init()}Images.prototype.init=function(){var $images=this.$el.find(".medium-insert-images");$images.find("figcaption").attr("contenteditable",!0),$images.find("figure").attr("contenteditable",!1),this.events(),this.backwardsCompatibility(),this.sorting()},Images.prototype.events=function(){$(document).on("click",$.proxy(this,"unselectImage")).on("keydown",$.proxy(this,"removeImage")).on("click",".medium-insert-images-toolbar .medium-editor-action",$.proxy(this,"toolbarAction")).on("click",".medium-insert-images-toolbar2 .medium-editor-action",$.proxy(this,"toolbar2Action")),this.$el.on("click",".medium-insert-images img",$.proxy(this,"selectImage")),$(window).on("resize",$.proxy(this,"autoRepositionToolbars"))},Images.prototype.backwardsCompatibility=function(){this.$el.find(".mediumInsert").removeClass("mediumInsert").addClass("medium-insert-images"),this.$el.find(".medium-insert-images.small").removeClass("small").addClass("medium-insert-images-left")},Images.prototype.editorSerialize=function(){var data=this._serializePreImages();return $.each(data,function(key){var $data=$("<div />").html(data[key].value);$data.find(".medium-insert-images").find("figcaption, figure").removeAttr("contenteditable"),$data.find(".medium-insert-images-progress").remove(),data[key].value=$data.html()}),data},Images.prototype.add=function(){var that=this,$file=$(this.templates["src/js/templates/images-fileupload.hbs"]()),fileUploadOptions={dataType:"json",add:function(e,data){$.proxy(that,"uploadAdd",e,data)()},done:function(e,data){}};(new XMLHttpRequest).upload&&(fileUploadOptions.progress=function(e,data){$.proxy(that,"uploadProgress",e,data)()},fileUploadOptions.progressall=function(e,data){$.proxy(that,"uploadProgressall",e,data)()}),$file.fileupload($.extend(!0,{},this.options.fileUploadOptions,fileUploadOptions)),$file.click()},Images.prototype.uploadAdd=function(e,data){var $place=this.$el.find(".medium-insert-active"),that=this,uploadErrors=[],file=data.files[0],acceptFileTypes=this.options.fileUploadOptions.acceptFileTypes,maxFileSize=this.options.fileUploadOptions.maxFileSize,reader;if(acceptFileTypes&&!acceptFileTypes.test(file.type)?uploadErrors.push(this.options.messages.acceptFileTypesError+file.name):maxFileSize&&file.size>maxFileSize&&uploadErrors.push(this.options.messages.maxFileSizeError+file.name),uploadErrors.length>0)return this.options.uploadFailed&&"function"==typeof this.options.uploadFailed?void this.options.uploadFailed(uploadErrors,data):void alert(uploadErrors.join("\n"));this.core.hideButtons(),$place.is("p")&&($place.replaceWith('<div class="medium-insert-active">'+$place.html()+"</div>"),($place=this.$el.find(".medium-insert-active")).next().is("p")?this.core.moveCaret($place.next()):($place.after("<p><br></p>"),this.core.moveCaret($place.next()))),$place.addClass("medium-insert-images"),!1===this.options.preview&&0===$place.find("progress").length&&(new XMLHttpRequest).upload&&$place.append(this.templates["src/js/templates/images-progressbar.hbs"]()),(data.autoUpload||!1!==data.autoUpload&&$(e.target).fileupload("option","autoUpload"))&&data.process().done(function(){that.options.preview?((reader=new FileReader).onload=function(e){$.proxy(that,"showImage",e.target.result,data)()},reader.readAsDataURL(data.files[0])):that.options.upload(img,function(url){$.proxy(that,"uploadDone",url,data)()})})},Images.prototype.uploadProgressall=function(e,data){var progress,$progressbar;!1===this.options.preview&&(progress=parseInt(data.loaded/data.total*100,10),($progressbar=this.$el.find(".medium-insert-active").find("progress")).attr("value",progress).text(progress),100===progress&&$progressbar.remove())},Images.prototype.uploadProgress=function(e,data){var progress,$progressbar;console.log("uploadProgress"),this.options.preview&&(progress=100-parseInt(data.loaded/data.total*100,10),($progressbar=data.context.find(".medium-insert-images-progress")).css("width",progress+"%"),0===progress&&$progressbar.remove())},Images.prototype.uploadDone=function(url,data){$.proxy(this,"showImage",url,data)(),data.loaded=100,data.total=100,$.proxy(this,"uploadProgress",null,data)(),this.core.clean(),this.sorting()},Images.prototype.showImage=function(img,data){var $place=this.$el.find(".medium-insert-active"),domImage,that;return $place.click(),that=this,this.options.preview&&data.context?((domImage=this.getDOMImage()).onload=function(){data.context.find("img").attr("src",img),this.options.uploadCompleted&&this.options.uploadCompleted(data.context,data),that.core.triggerInput()}.bind(this),domImage.src=img):(data.context=$(this.templates["src/js/templates/images-image.hbs"]({img:img,progress:this.options.preview})).appendTo($place),$place.find("br").remove(),this.options.autoGrid&&$place.find("figure").length>=this.options.autoGrid&&($.each(this.options.styles,function(style,options){var className="medium-insert-images-"+style;$place.removeClass(className),options.removed&&options.removed($place)}),$place.addClass("medium-insert-images-grid"),this.options.styles.grid.added&&this.options.styles.grid.added($place)),this.options.preview?(console.log("DATA",data),that.options.upload(img,function(url){$.proxy(that,"uploadDone",url,data)()})):this.options.uploadCompleted&&this.options.uploadCompleted(data.context,data)),this.core.triggerInput(),data.context},Images.prototype.getDOMImage=function(){return new window.Image},Images.prototype.selectImage=function(e){var that=this,$image;this.core.options.enabled&&($image=$(e.target),this.$currentImage=$image,this.$el.blur(),$image.addClass("medium-insert-image-active"),$image.closest(".medium-insert-images").addClass("medium-insert-active"),setTimeout(function(){that.addToolbar(),that.options.captions&&that.core.addCaption($image.closest("figure"),that.options.captionPlaceholder)},50))},Images.prototype.unselectImage=function(e){var $el=$(e.target),$image=this.$el.find(".medium-insert-image-active");if($el.is("img")&&$el.hasClass("medium-insert-image-active"))return $image.not($el).removeClass("medium-insert-image-active"),$(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),void this.core.removeCaptions($el);$image.removeClass("medium-insert-image-active"),$(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),$el.is(".medium-insert-caption-placeholder")?this.core.removeCaptionPlaceholder($image.closest("figure")):!1===$el.is("figcaption")&&this.core.removeCaptions(),this.$currentImage=null},Images.prototype.removeImage=function(e){var images=[],$selectedImage=this.$el.find(".medium-insert-image-active"),$parent,$empty,selection,range,current,caretPosition,$current,$sibling,selectedHtml,i;if(console.log(e.which),8===e.which||46===e.which){if($selectedImage.length&&images.push($selectedImage),(selection=window.getSelection())&&selection.rangeCount){$current="#text"===(current=(range=selection.getRangeAt(0)).commonAncestorContainer).nodeName||"BR"===current.nodeName?$(current).parent():$(current),caretPosition=MediumEditor.selection.getCaretOffsets(current).left;var n=null;if(8===e.which&&0===caretPosition?($sibling=$current.prev(),n=!0):46===e.which&&caretPosition===$current.text().length&&($sibling=$current.next(),n=!1),$sibling&&$sibling.hasClass("medium-insert-images")&&!images.length){var _cs="figure:nth-last-child(1) ";n&&(_cs="figure:nth-child(1) "),images.push($sibling.find(_cs+"img"))}(selectedHtml=MediumEditor.selection.getSelectionHtml(document))&&$("<div></div>").html(selectedHtml).find(".medium-insert-images img").each(function(){images.push($(this))})}if(images.length){for(i=0;i<images.length;i++)this.deleteFile(images[i].attr("src"),images[i]),$parent=images[i].closest(".medium-insert-images"),images[i].closest("figure").remove(),0===$parent.find("figure").length&&(!1!==($empty=$parent.next()).is("p")&&""===$empty.text()||($empty=$(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),$parent.before($empty)),$parent.remove());this.core.hideAddons(),!selectedHtml&&$empty&&(e.preventDefault(),this.core.moveCaret($empty)),$(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),this.core.triggerInput()}}},Images.prototype.deleteFile=function(file,$el){this.options.deleteScript&&("function"==typeof this.options.deleteScript?this.options.deleteScript(file,$el):$.ajax($.extend(!0,{},{url:this.options.deleteScript,type:this.options.deleteMethod||"POST",data:{file:file}},this.options.fileDeleteOptions)))},Images.prototype.addToolbar=function(){var $image,$p=this.$el.find(".medium-insert-image-active").closest(".medium-insert-images"),active=!1,mediumEditor,toolbarContainer=this.core.getEditor().options.elementsContainer||"body",$toolbar,$toolbar2;$(toolbarContainer).append(this.templates["src/js/templates/images-toolbar.hbs"]({styles:this.options.styles,actions:this.options.actions}).trim()),$toolbar=$(".medium-insert-images-toolbar"),$toolbar2=$(".medium-insert-images-toolbar2"),$toolbar.find("button").each(function(){$p.hasClass("medium-insert-images-"+$(this).data("action"))&&($(this).addClass("medium-editor-button-active"),active=!0)}),!1===active&&$toolbar.find("button").first().addClass("medium-editor-button-active"),this.repositionToolbars(),$toolbar.fadeIn(),$toolbar2.fadeIn()},Images.prototype.autoRepositionToolbars=function(){setTimeout(function(){this.repositionToolbars(),this.repositionToolbars()}.bind(this),0)},Images.prototype.repositionToolbars=function(){var $toolbar=$(".medium-insert-images-toolbar"),$toolbar2=$(".medium-insert-images-toolbar2"),$image=this.$el.find(".medium-insert-image-active"),elementsContainer=this.core.getEditor().options.elementsContainer,elementsContainerAbsolute=["absolute","fixed"].indexOf(window.getComputedStyle(elementsContainer).getPropertyValue("position"))>-1,elementsContainerBoundary=elementsContainerAbsolute?elementsContainer.getBoundingClientRect():null,containerWidth=$(window).width(),position={};$toolbar2.length&&(position.top=$image.offset().top+2,position.left=$image.offset().left+$image.width()-$toolbar2.width()-4,elementsContainerAbsolute&&(position.top+=elementsContainer.scrollTop-elementsContainerBoundary.top,position.left-=elementsContainerBoundary.left,containerWidth=$(elementsContainer).width()),position.left+$toolbar2.width()>containerWidth&&(position.left=containerWidth-$toolbar2.width()),$toolbar2.css(position)),$toolbar.length&&($image.closest(".medium-insert-images-grid-active").length&&($image=$image.closest(".medium-insert-images-grid-active")),position.top=$image.offset().top-$toolbar.height()-8-2-5,position.left=$image.offset().left+$image.width()/2-$toolbar.width()/2,elementsContainerAbsolute&&(position.top+=elementsContainer.scrollTop-elementsContainerBoundary.top,position.left-=elementsContainerBoundary.left),position.top<0&&(position.top=0),$toolbar.css(position))},Images.prototype.toolbarAction=function(e){var that=this,$button,$li,$ul,$lis,$p;null!==this.$currentImage&&($lis=($ul=($li=($button=$(e.target).is("button")?$(e.target):$(e.target).closest("button")).closest("li")).closest("ul")).find("li"),$p=this.$el.find(".medium-insert-active"),$button.addClass("medium-editor-button-active"),$li.siblings().find(".medium-editor-button-active").removeClass("medium-editor-button-active"),$lis.find("button").each(function(){var className="medium-insert-images-"+$(this).data("action");$(this).hasClass("medium-editor-button-active")?($p.addClass(className),that.options.styles[$(this).data("action")].added&&that.options.styles[$(this).data("action")].added($p)):($p.removeClass(className),that.options.styles[$(this).data("action")].removed&&that.options.styles[$(this).data("action")].removed($p))}),this.core.hideButtons(),this.core.triggerInput())},Images.prototype.toolbar2Action=function(e){var $button,callback;null!==this.$currentImage&&($button=$(e.target).is("button")?$(e.target):$(e.target).closest("button"),(callback=this.options.actions[$button.data("action")].clicked)&&callback(this.$el.find(".medium-insert-image-active")),this.core.hideButtons(),this.core.triggerInput())},Images.prototype.sorting=function(){$.proxy(this.options.sorting,this)()},$.fn[pluginName+"Images"]=function(options){return this.each(function(){$.data(this,"plugin_"+pluginName+"Images")||$.data(this,"plugin_"+pluginName+"Images",new Images(this,options))})}}(jQuery,window,document,MediumEditor.util)});