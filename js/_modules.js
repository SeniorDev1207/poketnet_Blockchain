
 /*_____*/ 
var applications=function(){var r=new nModule,t={},i=function(n){var t,o=deep(n,"history"),i=function(a,e){a&&a.github&&$.get(a.github.url,{},function(n){var o=deep(n,"assets")||[],t=_.find(o,function(n){return n.name==a.github.name});if(t){r.app.platform.m.log("registration_application_download",a.github.name);var i=document.createElement("a");i.setAttribute("href",t.browser_download_url),i.setAttribute("download","download"),i.click(),e&&e(t.browser_download_url)}})},a=function(){var n=os();r.app.platform.m.log("registration_application"),n&&r.app.platform.applications[n]&&"undefined"==typeof _Electron&&!window.cordova?e.os(r.app.platform.applications[n]):clbk()},e={os:function(o){r.shell({turi:"registration",name:"os",el:t.c.find(".currentos"),data:{os:o,last:!1}},function(n){n.el.find(".downloadOs").on("click",function(){i(o,function(n){t.c.find(".os").addClass("rundownloading"),t.c.find(".skipositem").html('<div class="downloadstart">You will now continue your registration after you install Pocketnet Desktop.</div><div><a href="'+n+'"><b>If Pocketnet for Windows did not start downloading, please click here to install it</b></a></div>')})})})}},l=function(){};return{primary:o,getdata:function(n){n({})},destroy:function(){t={}},init:function(n){l(),(t={}).c=n.el.find("#"+r.map.id),a(),n.clbk(null,n)}}};return r.run=function(n){var o=r.addEssense(t,i,n);r.init(o,n)},r.stop=function(){_.each(t,function(n){n.destroy()})},r}();"undefined"!=typeof module?module.exports=applications:(app.modules.applications={},app.modules.applications.module=applications);
 /*_____*/ 
var terms=function(){var i=new nModule,e={},o=function(n){var t,e=deep(n,"history"),o=function(){i.shell({name:i.app.localization.key,el:t.c,data:{}},function(n){})},u=function(){};return{primary:e,getdata:function(n){n({})},destroy:function(){t={}},init:function(n){u(),(t={}).c=n.el.find("#"+i.map.id),o(),n.clbk(null,n)},wnd:{class:"withoutButtons allscreen black a100"}}};return i.run=function(n){var t=i.addEssense(e,o,n);i.init(t,n)},i.stop=function(){_.each(e,function(n){n.destroy()})},i}();"undefined"!=typeof module?module.exports=terms:(app.modules.terms={},app.modules.terms.module=terms);
 /*_____*/ 
var page404=function(){var t=new nModule,o={},u=function(n){var e=deep(n,"history"),o=function(){};return{primary:e,getdata:function(n){n({})},destroy:function(){({})},init:function(n){o(),{}.c=n.el.find("#"+t.map.id),n.clbk(null,n)}}};return t.run=function(n){var e=t.addEssense(o,u,n);t.init(e,n)},t.stop=function(){_.each(o,function(n){n.destroy()})},t}();"undefined"!=typeof module?module.exports=page404:(app.modules.page404={},app.modules.page404.module=page404);
 /*_____*/ 
var anothersite=function(){var i=new nModule,t={},o=function(n){var e=deep(n,"history"),t=function(){};return{primary:e,getdata:function(n,e){n({link:e.settings.essenseData.link})},destroy:function(){({})},init:function(n){t(),{}.c=n.el.find("#"+i.map.id),n.clbk(null,n)},wnd:{header:"Another site",class:"transparent small anothersite"}}};return i.run=function(n){var e=i.addEssense(t,o,n);i.init(e,n)},i.stop=function(){_.each(t,function(n){n.destroy()})},i}();"undefined"!=typeof module?module.exports=anothersite:(app.modules.anothersite={},app.modules.anothersite.module=anothersite);
 /*_____*/ 
var token=function(){var a=new nModule,n={},o=function(e){var t=deep(e,"history"),o=function(){var e=parameters().token||null;return{type:parameters().type||null,token:e}};return{primary:t,getdata:function(t){var n=o();if("activate"!=n.type)a.app.platform.ws.addBlock();else{var e=a.app.platform.ws.messages.CUSTOMER.ACTIVE;delete e.clbks.successDialog,e.clbks.success=function(){var e=deep(a,"app.modules.menu.module");e&&e.restart()}}a.app.platform.sdk.tokens.check(n.token,function(e){n.result=e,t(n)})},destroy:function(){a.app.platform.ws.removeBlock(),{}},init:function(e){o(),{}.c=e.el.find("#"+a.map.id),e.clbk(null,e)}}};return a.run=function(e){var t=a.addEssense(n,o,e);a.init(t,e)},a.stop=function(){_.each(n,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=token:(app.modules.token={},app.modules.token.module=token);
 /*_____*/ 
var usersettings=function(){var u=new nModule,t={},o=function(n){var e,t,o=deep(n,"history"),s=function(){u.shell({name:"options",el:e.options,data:{composed:t.c}},function(n){ParametersLive(t.o,n.el)})},i=function(){};return{primary:o,getdata:function(n){t=u.app.platform.sdk.usersettings.compose();n({})},destroy:function(){e={}},init:function(n){i(),(e={}).c=n.el.find("#"+u.map.id),e.options=e.c.find(".options"),s(),n.clbk(null,n)}}};return u.run=function(n){var e=u.addEssense(t,o,n);u.init(e,n)},u.stop=function(){_.each(t,function(n){n.destroy()})},u}();"undefined"!=typeof module?module.exports=usersettings:(app.modules.usersettings={},app.modules.usersettings.module=usersettings);
 /*_____*/ 
var accounts=function(){var v=new nModule,s={},n=function(e){var n,t,o,a=deep(e,"history"),s=function(o){v.app.platform.sdk.pool.expand(t,function(e){var a=_.indexOf(e.addresses,o);if(-1<a){var s=e.private[a],n=v.app.user.stay;v.app.user.signout(function(){v.app.user.stay=n,v.user.signin(s,function(e){v.app.reloadLight(function(){var e="userpage?id=accounts&s="+makeid(),a=!1;v.app.user.validate()||(e="filluser",a=!0),v.app.nav.api.load({open:!0,href:e,history:a})})})})}})},d=function(n){v.app.platform.sdk.pool.expand(t,function(e){var a=_.indexOf(e.addresses,n);if(-1<a){var s=e.private[a];f.dumpkey(n,s)}})},i=function(e){v.app.platform.sdk.pool.remove(t,e),v.app.platform.sdk.pool.save(),f.addresses()},p=function(){5<=deep(t,"addresses.length")?sitemessage("You have reached a maximum of 5 accounts. No more can be added "):v.app.nav.api.load({open:!0,id:"addaccount",inWnd:!0,essenseData:{success:function(a){v.app.platform.sdk.pool.expand(t,function(e){v.app.platform.sdk.pool.add(e,a,function(e,a){a?dialog({html:v.app.localization.e("aused"),class:"one"}):v.app.platform.sdk.pool.export(e,function(e){v.app.platform.sdk.pool.current.packs[o]=e,v.app.platform.sdk.pool.save(),t=e,v.app.platform.sdk.pool.info(e,function(){f.addresses()})})})})}}})},c=function(){console.log("bakc"),n.dumpkey.html(""),n.c.find(".dumpaddress").html(""),n.c.removeClass("privatedump")},r=function(){var e=$(this).closest(".addressTable").attr("address");dialog({html:"Do you really want to see private key for this address?",btn1text:"See Private Key",btn2text:"Cancel",class:"zindex",success:function(){d(e)}})},l=function(){var e=$(this).closest(".addressTable").attr("address");dialog({html:"Do you really want to remove this address from this device?",btn1text:"Remove",btn2text:"Cancel",class:"zindex",success:function(){i(e)}})},u=function(){var e=$(this).closest(".addressTable").attr("address");s(e)},f={qrcode:function(e,a){new QRCode(e[0],{text:a,width:256,height:256})},dumpkey:function(e,a){n.c.addClass("privatedump"),n.c.find(".dumpaddress").html(e);var s=bitcoin.ECPair.fromPrivateKey(Buffer.from(a,"hex")).toWIF().toString("hex");v.shell({name:"dumpkey",el:n.dumpkey,data:{private:a,address:e,privateWif:s},animation:"fadeIn"},function(e){f.qrcode(e.el.find(".code"),a),e.el.find(".copyvalue").on("click",function(){var e=$(this).closest(".infotable").find(".value");copyText(e),sitemessage("Value was successfully copied")})})},addresses:function(a){v.shell({name:"addresses",el:n.addresses,data:{current:v.app.platform.sdk.address.pnet().address,pack:t},animation:"fadeIn"},function(e){e.el.find(".remove").on("click",l),e.el.find(".dumpkey").on("click",r),e.el.find(".ncurrent .label").on("click",u),a&&a()})}},m=function(){};return{primary:a,getdata:function(e){o=t=null;e({})},destroy:function(){n={}},init:function(e){var a,s;m(),(n={}).c=e.el.find("#"+v.map.id),n.addresses=n.c.find(".addresses"),n.dumpkey=n.c.find(".dumpkey"),n.c.find(".add").on("click",p),n.c.find(".back").on("click",c),a=v.app.platform.sdk.address.pnet().address,(s=v.app.platform.sdk.pool.getPack(a))?(t=s[0],o=s[1],v.app.platform.sdk.pool.info(t,function(){f.addresses()})):sitemessage("ERROR"),e.clbk(null,e)}}};return v.run=function(e){var a=v.addEssense(s,n,e);v.init(a,e)},v.stop=function(){_.each(s,function(e){e.destroy()})},v}();"undefined"!=typeof module?module.exports=accounts:(app.modules.accounts={},app.modules.accounts.module=accounts);
 /*_____*/ 
var messenger=function(){var k=new nModule,a={},t=function(a){var n,t,c,e=deep(a,"history"),r=function(e){n.c.addClass("toChat"),h.chat(e)},o=function(e){var s=k.app.platform.clientrtc.rtchttp,a=0,t=deep(s,"storage.chat."+e);return t&&(a=t.messages.unreaded),a},i=function(){var e=$(this).closest(".chat").attr("chat");r(e)},s=function(){n.c.addClass("toNewChat"),c=[],h.userslist()},l=function(){n.c.removeClass("toNewChat"),n.c.removeClass("toChat")},u=function(){var e=$(this);e.toggleClass("active");var s=e.attr("address");e.hasClass("active")?c.push(s):removeEqual(c,s)},d=function(){if(c.length){var e=_.sortBy(c,function(e){return e});e.unshift(k.app.platform.sdk.address.pnet().address);var s=_.reduce(e,function(e,s){return e+""+s},""),a=k.app.platform.sdk.chats.add(bitcoin.crypto.hash256(s).toString("hex"),"messenger");a.users=_.clone(e),k.app.platform.sdk.chats.save(),k.app.platform.sdk.messenger.getChat(a),t=k.app.platform.sdk.chats.get("messenger"),g(),r(a.id)}else dialog({html:"You must select at least one user",class:"one"})},f=function(e,s){k.app.platform.sdk.users.get(e,s)},p=function(e){k.app.platform.clientrtc.rtchttp;k.app.platform.clientrtc.rtchttp.info.allchats(function(){e&&e()})},h={chat:function(t){k.shell({name:"chat",el:n.chat,data:{chatid:t}},function(e){var s=k.app.platform.sdk.chats.storage[t],a={open:!0,href:"mchat",animation:!1,history:!0,history:!1};a.el=e.el.find(".chatWrapper"),a.essenseData={view:"buildin",chat:s,destroyClbk:function(){openedChat=null,l()}},a.clbk=function(e,s){openedChat=s},k.nav.api.load(a)})},chats:function(e,s){k.app.platform.sdk.chats.info(e,function(){k.shell({name:"chats",el:n.chats,data:{chats:e}},function(e){e.el.find(".chatBody").on("click",i),s&&s()})})},userslist:function(){var s=[],e=deep(k.app,"platform.sdk.users.storage."+k.app.platform.sdk.address.pnet().address);_.each(deep(e,"subscribes")||[],function(e){s.push(e.adddress)}),_.each(deep(e,"subscribers")||[],function(e){s.push(e)}),s=_.uniq(s),f(s,function(){k.shell({name:"userslist",el:n.userslist,data:{list:s}},function(e){e.el.find(".addressTable").on("click",u)})})},newmessages:function(e,s){var a=n.chats.find('[chat="'+e+'"] .newMessages');o(e)?k.shell({name:"newmessages",el:a,data:{count:o(e)},display:"table-cell"},function(e){s&&s()}):(a.css("display","none"),s&&s())},newmessagesAll:function(e){lazyEach({array:_.toArray(t),action:function(e){h.newmessages(e.item.id,e.success)},all:{success:function(){e&&e()}}})}},m=function(){},g=function(){h.chats(t,function(){p(function(){h.newmessagesAll()})})};return{primary:e,getdata:function(e){var s={};t=k.app.platform.sdk.chats.get("messenger"),k.loadTemplate({name:"newmessages"},function(){e(s)})},destroy:function(){delete k.app.platform.sdk.messenger.clbks.messenger,n={}},init:function(e){m(),(n={}).c=e.el.find("#"+k.map.id),n.newChat=n.c.find(".newMessage"),n.back=n.c.find(".back"),n.messengerSearch=n.c.find(".messengerSearch"),n.usersSearch=n.c.find(".usersSearch"),n.createChat=n.c.find(".createChat"),n.userslist=n.c.find(".usersListWrapper"),n.chats=n.c.find(".mchatsContent"),n.chat=n.c.find(".currentChat"),n.newChat.on("click",s),n.back.on("click",l),n.createChat.on("click",d),search(n.messengerSearch,{placeholder:"Search",clbk:function(e){},events:{fastsearch:function(e,s){s(null)},search:function(e,s){}}}),search(n.usersSearch,{icon:'<i class="fas fa-users"></i> Recievers',class:"recievers",clbk:function(e){},collectresults:!0,events:{fastsearch:function(e,s){s(["asdads","asdasd","assaddss"])},search:function(e,s){}}}),k.app.platform.sdk.messenger.clbks.messenger=function(e,s){"chat"==e&&(t=k.app.platform.sdk.chats.get("messenger"),g()),"message"==e&&h.newmessages(s.id,a.success)},g(),e.clbk(null,e)}}};return k.run=function(e){var s=k.addEssense(a,t,e);k.init(s,e)},k.stop=function(){_.each(a,function(e){e.destroy()})},k}();"undefined"!=typeof module?module.exports=messenger:(app.modules.messenger={},app.modules.messenger.module=messenger);
 /*_____*/ 
var tagcloud=function(){var d=new nModule,a={},o=function(n){var a,t=deep(n,"history"),o=function(n,t){n.length?(a.c.removeClass("hidden"),d.shell({name:"tags",el:a.tags,data:{tags:n}},function(n){n.el.find(".showhidealltags").on("click",function(){console.log("sad"),a.c.toggleClass("showedalltags")}),t&&t()})):a.c.addClass("hidden")},e=function(){},l=function(){var a;a=function(n,t){t&&(d.iclbks.main=l),o(n)},d.app.platform.sdk.tags.cloud(function(n,t){n=d.app.platform.sdk.tags.filterEx(n),a&&a(n,t)})};return{primary:t,getdata:function(n){n({})},destroy:function(){delete d.iclbks.main,a={}},init:function(n){e(),(a={}).c=n.el.find("#"+d.map.id),a.tags=a.c.find(".tags"),l(),n.clbk(null,n)}}};return d.run=function(n){var t=d.addEssense(a,o,n);d.init(t,n)},d.stop=function(){_.each(a,function(n){n.destroy()})},d}();"undefined"!=typeof module?module.exports=tagcloud:(app.modules.tagcloud={},app.modules.tagcloud.module=tagcloud);
 /*_____*/ 
var articles=function(){var f=new nModule,n={},e=function(a){var t,n=deep(a,"history"),e=function(){f.nav.api.load({open:!0,href:"article?aid="+makeid(),inWnd:!0,history:!0,essenseData:{save:function(t){f.app.platform.sdk.articles.storage||(f.app.platform.sdk.articles.storage=[]),_.find(f.app.platform.sdk.articles.storage,function(a){if(t.id==a.id)return!0})||f.app.platform.sdk.articles.storage.unshift(t),f.app.platform.sdk.articles.save()},close:function(){d.articles()},complete:function(){f.closeContainer()},closeContainer:function(){f.closeContainer()}}})},i=function(a){f.nav.api.load({open:!0,href:"article?aid="+a.id,inWnd:!0,history:!0,essenseData:{art:a,save:function(a){f.app.platform.sdk.articles.save()},close:function(){d.articles()},complete:function(){f.closeContainer()},closeContainer:function(){f.closeContainer()}}})},r=function(a){removeEqual(f.app.platform.sdk.articles.storage,{id:a}),t.c.find('.art[art="'+a+'"]').remove(),f.app.platform.sdk.articles.save(),d.ini()},o=function(){var a=$(this).closest(".art").attr("art");dialog({html:"Do You really want to remove this article?",btn1text:f.app.localization.e("dyes"),btn2text:f.app.localization.e("dno"),class:"zindex",success:function(){r(a)}})},s=function(){e()},c=function(){var t=$(this).closest(".art").attr("art"),a=_.find(f.app.platform.sdk.articles.storage,function(a){return a.id==t});i(a)},l=function(){f.nav.api.load({open:!0,href:"author?address="+f.app.user.address.value.toString("hex"),history:!0}),f.closeContainer()},d={ini:function(){f.app.platform.sdk.articles.storage.length?t.c.removeClass("initial"):t.c.addClass("initial")},articles:function(){d.ini(),f.shell({name:"articles",el:t.articles.find(".artwrapper"),data:{articles:f.app.platform.sdk.articles.storage}},function(a){a.el.find(".artcnt").on("click",c),a.el.find(".remove").on("click",o)})}},p=function(){};return{primary:n,auto:function(){var t=parameters(),a=null;t.marticle&&!f.app.nav.wnds.article&&(t.aid&&(a=_.find(f.app.platform.sdk.articles.storage,function(a){return a.id==t.aid})),a?i(a):e())},getdata:function(a){a({})},destroy:function(){t={}},init:function(a){p(),(t={}).c=a.el.find("#"+f.map.id),t.articles=t.c.find(".articles"),t.add=t.c.find(".add"),t.add.on("click",s),t.c.find(".top").on("click",l),d.articles(),a.clbk(null,a)},wnd:{class:"allscreen a100 article "}}};return f.run=function(a){var t=f.addEssense(n,e,a);f.init(t,a)},f.stop=function(){_.each(n,function(a){a.destroy()})},f}();"undefined"!=typeof module?module.exports=articles:(app.modules.articles={},app.modules.articles.module=articles);
 /*_____*/ 
var lastcomments=function(){var l=new nModule,s={},e=function(n){var s,t=deep(n,"history"),e=function(n,t,s){l.app.platform.app.nav.api.load({open:!0,href:"post?s="+n,inWnd:!0,clbk:function(n,t){app.nav.wnds.post=t},essenseData:{share:n,hr:"index?",reply:{answerid:t,parentid:s||"",noaction:!0}}})},a=function(){var n=$(this).attr("id"),t=$(this).attr("pid"),s=$(this).closest(".commentgroup").attr("share");e(s,n,t)},o=function(n){l.shell({name:"lastcommentslist",el:s.c,data:{comments:n}},function(n){n.el.find(".comment").on("click",a),n.el.find(".image").imagesLoaded({background:!0},function(n){})})},c=function(){},i=function(){var c;c=function(n,t){if(t)return l.iclbks.main=i,void s.c.addClass("hidden");s.c.removeClass("hidden"),o(n)},l.app.platform.sdk.comments.last(function(t,a){var o=group(t,function(n){return n.txid}),n=_.map(o,function(n,t){return t});l.app.platform.sdk.node.shares.getbyid(n,function(n,s){var e=[];_.each(t,function(n){var t=app.platform.sdk.node.shares.storage.trx[n.txid];e.push(t.address),e.push(n.address)}),e=_.uniq(e),l.sdk.users.get(e,function(n,t){c&&c(o,a||s||t)},!0)})})};return{primary:t,getdata:function(n){n({})},destroy:function(){s={},delete l.app.platform.ws.messages.newblocks.clbks.lastcomments,delete l.app.platform.ws.messages["new block"].clbks.lastcomments,delete l.app.platform.clbks._focus.lastcomments},init:function(n){c(),(s={}).c=n.el.find("#"+l.map.id),l.app.platform.ws.messages.newblocks.clbks.lastcomments=l.app.platform.ws.messages["new block"].clbks.lastcomments=function(){i()},l.app.platform.clbks._focus.lastcomments=function(n){120<n&&"undefined"!=typeof _Electron&&i()},i(),n.clbk(null,n)}}};return l.run=function(n){var t=l.addEssense(s,e,n);l.init(t,n)},l.stop=function(){_.each(s,function(n){n.destroy()})},l}();"undefined"!=typeof module?module.exports=lastcomments:(app.modules.lastcomments={},app.modules.lastcomments.module=lastcomments);
 /*_____*/ 
var video=function(){var d=new nModule,i={},o=function(e){var a,r,n=deep(e,"history"),c=[{key:"gMrKZfHJSxA",width:560,height:315,source:"youtube",loc:{en:{title:"Pocketnet - Decentralized Social Network on the Blockchain",id:"gMrKZfHJSxA",description:"Pocketnet is a fully decentralized publishing and social platform. Based on the blockchain technology, it runs on a set of computers around the world, not controlled by any single entity.No corporation behind it to take fruits of your labor. All advertising revenue is split equally between node operators and those who publish highly rated content. Your subscribers always see your content, unless they decide to unsubscribe. Pocketnet is self-policed by the platform participants with good reputation. Nobody records your keystrokes, viewing habits or searches. Join The New Peer-To-Peer Internet: Go to Pocketnet.app and join for free now"}}}],l={validateEmail:function(e){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)},saveEmail:function(e,n,i,o){o||(o="4");var t={Email:e,Name:n};t.Action||(t.Action="ADDTOMAILLIST"),t.TemplateID||(t.TemplateID=o),$.ajax({type:"POST",url:"https://pocketnet.app/Shop/AJAXMain.aspx",data:t,dataType:"json",success:function(){i&&i()}})},joinSuccess:function(e){d.fastTemplate("joinSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})},{email:e})},join:function(e){d.fastTemplate("join",function(e){dialog({html:e,wrap:!0,success:function(e){var n=e.el.find(".email"),i=e.el.find(".name"),o=n.val(),t=i.val();if(l.validateEmail(o)&&t)return l.saveEmail(o,t),l.joinSuccess(o,t),!0},clbk:function(e){var i=e.find(".name"),o=e.find(".email"),n=function(){var e=o.val(),n=i.val();return l.validateEmail(e)&&n?(t.removeClass("disabled"),!0):(t.addClass("disabled"),!1)},t=e.find(".btn1");t.addClass("disabled"),t.on("click",function(){}),i.focus(),i.on("change",n),i.on("keyup",n),o.on("change",n),o.on("keyup",n)},class:"one joinbeta"})},{action:e})}},i=function(){l.join()},s=function(){var e='<iframe width="560" height="315" src="https://www.youtube.com/embed/'+r.id+'?rel=0&amp;autoplay=1" frameborder="0" allow="autoplay;" allowfullscreen></iframe>';"vimeo"==r.source&&(e='<iframe src="https://player.vimeo.com/video/'+r.id+'?title=0&byline=0&portrait=0" width="560" height="315" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),"bitchute"==r.source&&(e='<iframe width="560" height="315" scrolling="no" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen src="https://www.bitchute.com/embed/'+r.id+'/"></iframe>'),a.c.find(".container").html(e),r.description&&a.c.find(".description").html(r.description)};return{primary:n,getdata:function(e,n){var i=parameters();i.v||(i.v="gMrKZfHJSxA");var o,t,a=_.find(c,function(e){return e.key==i.v}),l=function(){d.nav.api.load({open:!0,href:"page404",history:!0})};a?(d.app.el.menu.addClass("logoview").addClass("landing"),r=_.clone(a),o=r,(t=deep(o,"loc.en")||null)&&(o=_.extend(o,t)),r.id?e(r):l()):l()},destroy:function(){a={},d.app.el.menu.removeClass("logoview").removeClass("landing"),d.app.el.app.removeClass("videoActive")},init:function(t){(a={}).c=t.el.find("#"+d.map.id),a.container=a.c.find(".container"),a.c.click&&a.c.click(),d.app.el.app.addClass("videoActive"),a.c.find(".joinbeta").on("click",i),setTimeout(function(){var e,n,i,o;s(),e=r,n=a.container,i=n.width(),o=i/(e.width/e.height),n.find("iframe").width(i),n.find("iframe").height(o),a.container.find("iframe").fadeIn(200),a.c.find(".description").fadeIn(200),t.clbk(null,t)},100)},animation:!1}};return d.run=function(e){var n=d.addEssense(i,o,e);d.init(n,e)},d.stop=function(){_.each(i,function(e){e.destroy()})},d}();"undefined"!=typeof module?module.exports=video:(app.modules.video={},app.modules.video.module=video);
 /*_____*/ 
var help=function(){var p=new nModule,a={},t=function(e){var a,n,t,o=deep(e,"history"),i={roadmap:[{d:"February 2019",n:"Social Network Beta Test Starts",r:!0},{d:"March 2019",n:"Windows Desktop App",r:!0},{d:"March 2019",n:"Search users, posts",r:!1},{d:"July 2019",n:"Linux Desktop App",r:!1},{d:"July 2019",n:"Android App",r:!1},{d:"August 2019",n:"Search by tags, recommended users, poll transactions",r:!1},{d:"August 2019",n:"Personal link Pocketnet.app/username plus history of personal posts and ability to search users’ posts (decentralized free blog hosting on Pocketnet blockchain)",r:!1},{d:"September 2019",n:"WebTorrent hosting of videos/images",r:!1},{d:"October 2019",n:"Boost posts for Pocketcoin",r:!1},{d:"June 2019",n:"Chinese, French, German, Russian, Spanish versions",r:!1},{d:"July 2020",n:"Peer-to-peer encrypted chat, including group chat",r:!1},{d:"August 2020",n:"Decentralized Internet!!! Ability for any user to create sidechains that hold sites/groups by locking POS in the main chain, with nodes having ability to merge stake them with the main chain optionally",r:!1},{d:"October 2020",n:"Decentralized reputation platform and crypto store",r:!1}]},c=function(e){t&&(t.destroy(),t=null),a.menuitem.removeClass("active"),a.c.find('.tipitem[page="'+e+'"]').addClass("active"),n=e,d.save(),s[e]?s[e](e):s.page(e)},r=function(){var e=$(this).attr("page");c(e)},s={application:function(n){this.page(n,function(e){console.log("PAGE",n)})},faq:function(n){this.page(n,function(e){console.log("PAGE",n),p.nav.api.load({open:!0,id:"faq",el:e.find(".faqWrapper"),clbk:function(e,n){console.log("EXTERNAL",n),t=n}})})},node:function(e){this.page(e,function(e){p.app.platform.papi.post("fe88f86430a018803921b338a7e629f9c9a52a2b4e3a36056d2adc0f0c74b5b4",e.find(".lenta"),function(e,n){t=n})})},videos:function(e){this.page(e,function(e){p.nav.api.load({open:!0,id:"lenta",el:e.find(".lenta"),animation:!1,mid:"videos",essenseData:{byauthor:!0,notscrollloading:!0,nocomments:!0,txids:["9f73a1efbfb4b0feb88c134740afa0ab293f8072a80ecbe9fe65ed85591910e6","ad9067c72a7be97c1752a00566940f372e5b526291278cf9bc203b99f81bbaf0","df4064b9e2c8b311fd097804f36802ceb68337dca396bfdea732c0f94c977a3a","986a6acba795482894876ac87440124e176cc02cff40558a3ec3d423850e2e93"]},clbk:function(e,n){t=n}})})},page:function(e,n){p.shell({name:e,el:a.page,data:{c:i}},function(e){n&&n(e.el)})}},d={save:function(){p.app.nav.api.history.addParameters({page:n})},load:function(){n=parameters().page||"faq"}};return{primary:o,getdata:function(e){d.load();var n=null;"undefined"!=typeof _Electron&&(n=require("electron").remote.app.getVersion());e({version:n})},destroy:function(){console.log("help"),t&&(t.destroy(),t=null),a={}},init:function(e){d.load(),(a={}).c=e.el.find("#"+p.map.id),a.page=a.c.find(".page"),a.menuitem=a.c.find(".tipitem"),a.caption=a.c.find(".bgCaption"),a.menuitem.on("click",r),a.caption.find(".checkversion").on("click",function(){if("undefined"!=typeof _Electron){a.caption.find(".checking").addClass("active");var e=require("electron");setTimeout(function(){e.ipcRenderer.send("electron-checkForUpdates"),e.ipcRenderer.on("updater-message",function(e,n){("update-downloaded"==n.msg||"update-not-available"==n.msg||n.linux&&"update-available"==n.msg)&&a.caption.find(".checking").removeClass("active")})},100)}}),c(n),e.clbk(null,e)}}};return p.run=function(e){var n=p.addEssense(a,t,e);p.init(n,e)},p.stop=function(){_.each(a,function(e){e.destroy()})},p}();"undefined"!=typeof module?module.exports=help:(app.modules.help={},app.modules.help.module=help);
 /*_____*/ 
var embeding=function(){var m=new nModule,i={},a=function(e){var s,a,n,i=deep(e,"history"),o=null,t={url:new Parameter({type:"URL",id:"url",placeholder:"Add link to external site",onType:!0}),images:{isValid:function(){return!0},value:[]}},l={url:"Url doesn't valid",imagesLength:"Max 6 Images Allowed"},c={check:function(e){if(t[e].isValid(t[e].value))return s.error.html(""),!0;s.error.html(l[e])},removeImage:function(e){removeEqual(t.images.value,{id:e}),r.images(),s.error.html("")},add:{url:function(){c.check("url")&&(a.added(t.url.value),m.closeContainer())},images:function(){if(c.check("images")){var n=[];_.each(t.images.value,function(e){e.base64&&n.push(e.base64)}),a.added(n),m.closeContainer()}}},slowUploadGif:function(e,n){e.id=makeid(),e.slow=!0,e.base64=e.base64,t.images.value.push(e),n&&n()},slowUpload:function(i,a){resize(i.base64,1080,1080,function(e){var n=e.split(",");console.log(i),n[1]&&(i.id=makeid(),i.slow=!0,i.base64=e,t.images.value.push(i)),a&&a()})},upload:function(i,a){resize(i.base64,1080,1080,function(e){var n=e.split(",");if(n[1]){5<t.images.value.length?s.error.html(l.imagesLength):(s.error.html(""),i.id=makeid(),i.loading=!0,t.images.value.push(i),r.images(),m.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:n[1]},success:function(e){i.loading=!1,i.src=deep(e,"data.link")||"https://pocketnet.app/img/imagenotuploaded.jpg",r.images(),a&&a()},fail:function(){i.src="https://pocketnet.app/img/imagenotuploaded.jpg",r.images(),a&&a()}}))}})}},u=function(){var e=$(this).attr("action")||o;c.add[e]()},d=function(){var e=$(this).closest(".imageContainer").attr("value");c.removeImage(e)},r={images:function(e,n){e||(e=t.images.value),e.length&&m.shell({name:"images",el:s.images,data:{images:e}},function(e){e.el.find(".remove").on("click",d),e.el.find(".image").each(function(){$(this)}),n&&n()})}},g=function(){};return{primary:i,getdata:function(e,i){o=i.settings.essenseData.type,a=i.settings.essenseData.on,n=i.settings.essenseData,i.settings.essenseData.subtype||null,i.settings.essenseData.storage&&_.each(t,function(e,n){e.value=i.settings.essenseData.storage[n],"images"==n&&(e.value=[])}),e({type:o,options:t})},destroy:function(){s={}},init:function(e){g(),(s={}).c=e.el.find("#"+m.map.id),s.error=s.c.find(".error"),s.action=s.c.find(".action"),s.upload=s.c.find(".upload"),s.images=s.c.find(".imagesMi"),function(){if(s.c.find("input").focus().on("change",u),s.action.on("click",u),"images"==o){if(r.images(),n.value){var e={base64:n.value};c.slowUpload(e)}initUpload({el:s.upload,ext:["png","jpeg","jpg","gif"],dropZone:s.c.closest(".wnd"),multiple:!0,action:function(e,n){console.log("DSD"),"gif"==e.ext?c.slowUploadGif(e,n):c.slowUpload(e,n)},onSuccess:function(){c.add.images()}})}else ParametersLive([t[o]],s.c)}(),e.clbk(null,e)},wnd:{header:"",buttons:{close:{class:"close",html:'<i class="fa fa-check"></i> Finish',fn:function(e,n){c.add[o]()}}},close:function(){n.on.close&&n.on.close()},success:function(e,n){wndObj=n,wnd=e},offScroll:!0,noInnerScroll:!0,class:"embeding",swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30}}};return m.run=function(e){var n=m.addEssense(i,a,e);m.init(n,e)},m.stop=function(){_.each(i,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=embeding:(app.modules.embeding={},app.modules.embeding.module=embeding);
 /*_____*/ 
var embeding20=function(){var m=new nModule,a={},i=function(e){var l,n=deep(e,"history"),i={},t="Max 6 Images Allowed",a=function(e,n){if(l.c){var a=l.c.find("."+e+"Part .partPreloader");n?a.fadeIn(200):a.fadeOut(200)}},u=function(e,n){var a={};5<i.images.value.length?sitemessage(t):(a.id=makeid(),a.src=e,i.images.value.push(a),c.images()),n&&n()},o=function(e,n){var a={};resize(e,1080,1080,function(e){if(e.split(",")[1]){5<i.images.value.length?sitemessage(t):(a.id=makeid(),a.base64=e,i.images.value.push(a),c.images())}n&&n()})},r=function(e){removeEqual(i.images.value,{id:e}),c.images()},s=function(){var e=$(this).closest(".imageContainer").attr("value");r(e)},c={url:function(n,a){var i=m.app.platform.parseUrl(n),t=m.app.platform.sdk.remote.storage[n];m.shell({name:"url",inner:html,el:l.url,data:{url:n,og:t,remove:!0},turi:"share"},function(e){n&&!t&&("youtube"==i.type||"vimeo"==i.type||"bitchute"==i.type?Plyr.setup(".js-player",function(e){}):m.app.platform.sdk.remote.get(i.url,function(e){e&&c.url(n)})),a&&a()})},images:function(e,n){e||(e=i.images.value),e.length&&m.shell({name:"images",el:l.images,data:{images:e}},function(e){e.el.find(".remove").on("click",s),e.el.find(".image").each(function(){}),n&&n()})}},d=function(){};return{primary:n,getdata:function(e){(i={url:new Parameter({type:"URL",id:"url",placeholder:"Add link to external site",value:""}),images:{isValid:function(){return!0},value:[]}}).url._onChange=function(e){a("left",!0),checkUrlForImage(e)?u(e,function(){a("left",!1),i.url.value="",i.url.el.val("")}):c.url(e,function(){a("left",!1)})},i.images.value=[],i.url.value="",e({options:i})},destroy:function(){l={}},init:function(e){d(),(l={}).c=e.el.find("#"+m.map.id),l.upload=l.c.find(".upload"),l.images=l.c.find(".images"),l.error=l.c.find(".error"),l.url=l.c.find(".url"),ParametersLive([i.url],l.c),initUpload({el:l.upload,ext:["png","jpeg","jpg"],dropZone:l.c.closest(".wnd"),multiple:!0,action:function(e,n){o(e.base64,n)},onSuccess:function(){l.c.addClass("right"),l.c.removeClass("left")}}),e.clbk(null,e)},wnd:{header:"",buttons:{close:{class:"close",html:'<i class="fa fa-times"></i> Close',fn:function(e,n){}}},close:function(){},success:function(e,n){wndObj=n,wnd=e},noInnerScroll:!0,class:"embeding20"}}};return m.run=function(e){var n=m.addEssense(a,i,e);m.init(n,e)},m.stop=function(){_.each(a,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=embeding20:(app.modules.embeding20={},app.modules.embeding20.module=embeding20);
 /*_____*/ 
var s=function(){var v=new nModule,t={},n=function(s){var n,a,o,r,i,e=deep(s,"history"),t=0,u=10,l="list",c={clickNext:function(){h("users",t+=u,30),c.displayArrows()},clickArrow:function(s){"left"==s&&(t-=u)<0&&(t=0),"right"==s&&((t+=u)>=o.users.count&&(t=o.users.count-1),h("users",t,u)),c.slideCarousel()},displayArrows:function(){0<t?c.displayArrow("left",!0):c.displayArrow("left",!1),t+u<o.users.count?(c.displayArrow("right",!0),c.displayNext(!0)):(c.displayArrow("right",!1),c.displayNext(!1))},displayNext:function(s){s?n.unext.addClass("active"):n.unext.removeClass("active")},displayArrow:function(s,e){var t=n.ea;s&&(t=n["u"+s]),e?t.addClass("active"):t.removeClass("active")},slideCarousel:function(){var s=n.c.find(".user").width(),e=t*s;n.userslist.css("margin-left","-"+e+"px"),c.displayArrows()},applyCarousel:function(){if("list"==l){var s=n.c.find(".user").width(),e=n.c.find(".userslistwrapper").width();u=Math.min(Number((e/s).toFixed(0)),10),n.c.find(".user").width((e/u).toFixed(0)+"px"),n.userslist.width((o.users.data.length*(e/u)).toFixed(0)+1),c.slideCarousel()}else n.userslist.css("margin-left","0px"),n.userslist.css("width","auto"),n.c.find(".user").css("width","auto")},changeUsersView:function(){"list"==l?l="full":(l="list",t=0),n.users.attr("view",l),c.applyCarousel()}},d=function(){var s=$(this).attr("arrow");c.clickArrow(s)},p=function(){c.clickNext()},f={users:function(s,e){v.shell({name:"userslist",el:n.users.find(".userslist"),data:{users:s},inner:append,bgImages:{clbk:function(s){$(s.elements[0]).addClass("active")}}},function(s){"list"==l&&c.applyCarousel(),e&&e(s)})},posts:function(){var s=!1;v.nav.api.load({open:!0,id:"lenta",el:n.lenta,animation:!1,mid:"search",essenseData:{search:!0,hr:"index?",searchValue:a,loader:function(t){var e=function(s){var e=v.app.platform.sdk.node.shares.transform(s);t&&t(e,null,{count:10})};s?h("posts",o.posts.data.length,10,function(s){e(s)}):(s=!0,e(o.posts.data))}},clbk:function(s,e){i=e}})}},h=function(e,s,t,n){var a=o[e].data.length,r=o[e].count;if(!(s+t<=a)){if(s<a){var i=a-s;s=a,t-=i}r<s+t&&(t=r-s),t<=0||m[e](function(s){n?n(s):f[e](s)},s,t)}},m={users:function(e,s,t){v.app.platform.sdk.search.get(a,"users",s,t,r,function(s){e(s.data)})},posts:function(e,s,t){v.app.platform.sdk.search.get(a,"posts",s,t,r,function(s){e(s.data)})}},w=function(){};return{primary:e,getdata:function(t){var n={};i=null,a=(parameters().ss||"").replace("tag:","#");var s=deep(v,"app.modules.menu.module.showsearch");s&&s(a),v.app.platform.sdk.search.clear(),v.app.platform.sdk.search.get(a,"all",0,10,null,function(s,e){r=e,o=s,n.result=s,n.value=a,t(n)})},destroy:function(s){if(s!=v.app.nav.current.href){var e=deep(v,"app.modules.menu.module.closesearch");e&&e()}i&&i.destroy(),i=null,n={}},init:function(s){t=0,u=10,w(),(n={}).c=s.el.find("#"+v.map.id),n.users=n.c.find(".users"),n.userslist=n.c.find(".userslist"),n.posts=n.c.find(".posts"),n.uleft=n.c.find(".uleft"),n.uright=n.c.find(".uright"),n.ua=n.c.find(".arrow"),n.showmore=n.c.find(".showmore"),n.unext=n.c.find(".nextpage"),n.lenta=n.c.find(".lentasearch"),n.ua.on("click",d),n.showmore.on("click",c.changeUsersView),n.userslist.swipe({swipe:function(s,e,t,n,a,r){console.log(e,t)}}),n.unext.on("click",p),deep(o,"users.data.length")&&f.users(o.users.data),deep(o,"posts.data.length")&&f.posts(),s.clbk(null,s)}}};return v.run=function(s){var e=v.addEssense(t,n,s);v.init(e,s)},v.stop=function(e){_.each(t,function(s){s.destroy(e)})},v}();"undefined"!=typeof module?module.exports=s:(app.modules.s={},app.modules.s.module=s);
 /*_____*/ 
var send=function(){var d=new nModule,a={},t=function(n){var e,a,t=deep(n,"history"),i={stateAction:function(e,a){d.app.user.isState(function(n){n?a():d.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{loginText:d.app.localization.e("llogin"),successHref:e,signInClbk:function(){a&&a()}}})})},send:function(){i.stateAction("_this",function(){d.nav.api.load({open:!0,history:!0,href:"userpage?id=wallet&action=send&address="+a.address+"&amount="+a.amount})})}},s=function(){},o=function(){var n;e.c.find(".send").on("click",i.send),e.am.on("change",function(){var n=$(this).val();a.amount=n}),0<(n={alias:"numeric",groupSeparator:",",radixPoint:".",digits:6,digitsOptional:!1,autoGroup:!0,allowMinus:!1}).digits&&(n.placeholder="0.000000"),e.am.inputmask(n),parameters().setammount||e.am.blur()};return{primary:t,getdata:function(n){var e=parameters();a={},e.address&&bitcoin.address.fromBase58Check(e.address)&&(a.address=e.address),e.amount&&(a.amount=Number(e.amount)),e.label&&(a.label=clearScripts(donottrustLink(findAndReplaceLink(e.label,!0)))),e.message&&(a.message=clearScripts(donottrustLink(findAndReplaceLink(hexDecode(e.message,!0))))),a.amount&&a.address&&a.message?n(a):d.nav.api.load({open:!0,href:"page404",history:!0})},destroy:function(){e={}},init:function(n){s(),(e={}).c=n.el.find("#"+d.map.id),e.am=e.c.find(".amredit"),o(),n.clbk(null,n)}}};return d.run=function(n){var e=d.addEssense(a,t,n);d.init(e,n)},d.stop=function(){_.each(a,function(n){n.destroy()})},d}();"undefined"!=typeof module?module.exports=send:(app.modules.send={},app.modules.send.module=send);
 /*_____*/ 
var imagegallery=function(){var p=new nModule,i={},n=function(e){var n,t,a,i=deep(e,"history"),r=null,o=0,l={back:function(){1<t.images.length&&(l.prepareImages(),--o<0&&(o=t.images.length-1),d())},next:function(){1<t.images.length&&(l.prepareImages(),++o>=t.images.length&&(o=0),d())},initialValue:function(){l.prepareImages(),t.initialValue&&(o=findIndex(t.images,function(e){var a="name";if(t.idName&&(a=t.idName),e[a]==t.initialValue)return!0}))},prepareImages:function(){t.getImages&&(t.images=t.getImages())},prepareImage:function(e,a){t.getImage?t.getImage(e,function(e){a&&a(e)}):a&&a(e)}},s={resize:function(){s.bestFit(n.imagesWrapper.find(".image"),r)},bestFit:function(e,a){var i=e.closest(".imagesAbsWrapper"),n=e.find(".imgWrapper"),t=a.naturalWidth||a.width,r=a.naturalHeight||a.height,o=r/t;e.css("padding-top","0px");var l=e.width(),s=e.height(),c=i.width(),g=i.height();c<l&&(l=c),g<s&&(s=g),l<t&&(r=(t=l)*o),s<=r&&(t=(r=s)/o);var m=(s-r)/2;e.css("padding-top",m+"px"),a.width=t,a.height=r,$(a).attr("data-camanwidth",t),$(a).attr("data-camanheight",r),$(a).animate({opacity:1}),n.width(t),n.height(r)},nFormat:function(e){return e<10&&(e="0"+e),e}},c=function(){if(!a){var e=$(this).attr("action");return l[e](),!1}},g=function(e){a||e.pageY<80||(action="next",e.pageX<$(window).width()/2&&(action="back"),l[action]())},m=function(e){n.imageNavigation.find(".number").html(s.nFormat(o+1)),$(window).off("resize",s.resize),e||(e={}),p.shell({name:"image",el:n.images,inner:html,display:"table",data:{data:t,image:e.image}},function(e){e.el.find("img").imagesLoaded(function(e){n.c.removeClass("loading"),a=!1,(r=deep(e,"images.0.img"))&&(s.resize(),$(window).on("resize",s.resize))})})},u=function(){},d=function(){n.c.addClass("loading"),a=!0;var e=t.images[o];p.app.nav.api.history.addParameters({num:o.toString()}),l.prepareImage(e,function(e){m({image:e})})};return{primary:i,parametersHandler:function(){var e=parameters().num;void 0!==e&&(o=Number(e),l.prepareImages(),d())},getdata:function(e){e({})},destroy:function(){r=null,$(window).off("resize",s.resize),a=!1,n={}},clearparameters:["i","num","s","com"],init:function(e){r=null,a=!1,t=e.essenseData||{},u(),l.initialValue(),(n={}).c=e.el.find("#"+p.map.id),n.imagesWrapper=e.el.find(".imagesWrapper"),n.images=e.el.find(".images"),n.imageNavigation=e.el.find(".imageNavigation"),n.arrows=n.imageNavigation.find(".arrow"),d(),function(){n.arrows.on("click",c),n.c.on("click",g);var i=n.c.find(".imagesTableWrapper").closest(".wnd"),e={up:{trueshold:150,mintrueshold:50,cancellable:!0,positionclbk:function(e){var a=(150-Math.abs(e))/150;0<a&&i.css("opacity",a)},clbk:function(){p.closeContainer()}}};1<t.images.length&&(e.left={trueshold:100,mintrueshold:50,cancellable:!0,restrict:!0,positionclbk:function(e){Math.abs(e)},clbk:function(){console.log("SSS2"),l.next(),setTimeout(a.renew,200)}},e.right={trueshold:100,mintrueshold:50,cancellable:!0,restrict:!0,positionclbk:function(e){Math.abs(e)},clbk:function(){console.log("SSS"),l.back(),setTimeout(a.renew,200)}});var a=new SwipeParallax({el:n.c.find(".imagesTableWrapper"),directions:e}).init()}(),e.clbk(null,e)},wnd:{class:"allscreen black withoutButtons imageGallery"}}};return p.run=function(e){var a=p.addEssense(i,n,e);p.init(a,e)},p.stop=function(){_.each(i,function(e){e.destroy()})},p}();"undefined"!=typeof module?module.exports=imagegallery:(app.modules.imagegallery={},app.modules.imagegallery.module=imagegallery);
 /*_____*/ 
var aboutus=function(){var t=new nModule,o={},e=function(n){var u=deep(n,"history"),o=function(){};return{primary:u,getdata:function(n){n({})},destroy:function(){({})},init:function(n){o(),{}.c=n.el.find("#"+t.map.id),n.clbk(null,n)}}};return t.run=function(n){var u=t.addEssense(o,e,n);t.init(u,n)},t.stop=function(){_.each(o,function(n){n.destroy()})},t}();"undefined"!=typeof module?module.exports=aboutus:(app.modules.aboutus={},app.modules.aboutus.module=aboutus);
 /*_____*/ 
var navigation=function(){var s=new nModule,o={},i=function(n){var i,o,e=deep(n,"history"),a=function(){250<o.scrollTop()?i.c.addClass("scrolled"):i.c.removeClass("scrolled")},t=function(){console.log("asdsadsadasd"),_scrollTop(0,null,0)},d=function(n){var e=localStorage.lentakey||"index?b=true";"index"==e&&(e="index?b=true"),-1==e.indexOf("?")&&(e="index?r="+e);var o=s.app.nav.api.backChainGet();s.shell({name:"menu",inner:html,el:i.menu,data:{back:o,href:n,lentakey:e}},function(n){n.el.find(".toup").on("click",t)})},l=function(){console.log("INIEVC1"),i.c&&i.c.closest("#navigationWrapper").addClass("hidden")},r=function(){console.log("INIEVC2"),i.c&&i.c.closest("#navigationWrapper").removeClass("hidden")},c=function(){};return{primary:e,getdata:function(n,e){o=$(window),n({})},destroy:function(){window.removeEventListener("scroll",a),window.cordova&&(window.removeEventListener("keyboardWillShow",l),window.removeEventListener("keyboardWillHide",r)),delete s.app.nav.clbks.history.navigation,i={}},init:function(n){c(),(i={}).c=n.el.find("#"+s.map.id),i.menu=i.c.find(".nmenu"),s.app.nav.clbks.history.navigation=function(n){d(s.app.nav.get.pathname())},window.addEventListener("scroll",a),window.cordova&&(console.log("INIEVC"),window.addEventListener("keyboardWillShow",l),window.addEventListener("keyboardWillHide",r)),n.clbk(null,n),d(s.app.nav.get.pathname())}}};return s.run=function(n){var e=s.addEssense(o,i,n);s.init(e,n)},s.stop=function(){_.each(o,function(n){n.destroy()})},s}();"undefined"!=typeof module?module.exports=navigation:(app.modules.navigation={},app.modules.navigation.module=navigation);
 /*_____*/ 
var toppanel=function(){var p=new nModule,t={},a=function(e){var a,n=deep(e,"history"),o={index:"index",sub:"index?r=sub",recommended:"index?r=recommended"},r=function(){var e=_.toArray(o),n=parameters(p.app.nav.current.completeHref,!0).r||"index",t=new Parameter({type:"VALUES",name:"Contents",id:"contents",possibleValues:e,possibleValuesLabels:["All Posts","Your Pocket","Top posts"],defaultValue:o[n]});return t.value=o[n],t._onChange=function(e){var n=e;p.nav.api.load({open:!0,href:n,history:!0})},t},t=function(n){var t=r();p.app.user.isState(function(e){e&&isMobile()&&"index"!=n?a.c.addClass("hidden"):(a.c.removeClass("hidden"),p.shell({name:"menu",el:a.menu,data:{pathname:n,state:e,mobile:isTablet(),selector:t}},function(e){ParametersLive([t],e.el)}))})},i=function(){};return{primary:n,getdata:function(e){e({})},destroy:function(){delete p.app.nav.clbks.history.toppanel,a={}},init:function(e){i(),(a={}).c=e.el.find("#"+p.map.id),a.menu=a.c.find(".panelitems"),p.app.nav.clbks.history.toppanel=function(e){t(app.nav.current.href)},t(p.app.nav.current.href),e.clbk(null,e)}}};return p.run=function(e){var n=p.addEssense(t,a,e);p.init(n,e)},p.stop=function(){_.each(t,function(e){e.destroy()})},p}();"undefined"!=typeof module?module.exports=toppanel:(app.modules.toppanel={},app.modules.toppanel.module=toppanel);
 /*_____*/ 
var footer=function(){var t=new nModule,o={},n=function(a){var e,o=deep(a,"history"),n=new Parameter({type:"VALUES",name:"Localization",id:"localization",defaultValue:app.localization.current().name,possibleValues:app.localization.availableMap("name"),possibleValuesLabels:app.localization.availableMap("name"),format:{right:!0},_onChange:function(a){var e=app.localization.findByName(a);e&&e.key!=app.localization.key&&app.localization.set(e.key)}}),i=function(){};return{primary:o,getdata:function(a){var e={};e._SEO=_SEO,e.loc=n,a(e)},destroy:function(){e={}},init:function(a){i(),(e={}).c=a.el.find("#"+t.map.id),ParametersLive([n],e.c),a.clbk(null,a)}}};return t.run=function(a){var e=t.addEssense(o,n,a);t.init(e,a)},t.stop=function(){_.each(o,function(a){a.destroy()})},t}();"undefined"!=typeof module?module.exports=footer:(app.modules.footer={},app.modules.footer.module=footer);
 /*_____*/ 
var support=function(){var r=new nModule,t={},e=function(n){var o,t=deep(n,"history"),e={send:function(){var n=e.values();n?(o.c.removeClass("showError"),topPreloader(20),r.app.platform.sdk.user.support(n,function(){topPreloader(100),dialog({html:r.app.localization.e("contactSuccess"),class:"one"}),$.each(o.inputs,function(){$(this).val("")})})):o.c.addClass("showError")},values:function(){var e={},s=!0;return $.each(o.inputs,function(){var n=$(this),o=n.val(),t=n.attr("systemId");o?e[t]=o:s=!1}),s?e:null}},s=function(){e.send()},u=function(){};return{primary:t,getdata:function(n){n({})},destroy:function(){o={}},init:function(n){u(),(o={}).c=n.el.find("#"+r.map.id),o.send=o.c.find(".send"),o.inputs=o.c.find(".forminput"),o.send.on("click",s),n.clbk(null,n)}}};return r.run=function(n){var o=r.addEssense(t,e,n);r.init(o,n)},r.stop=function(){_.each(t,function(n){n.destroy()})},r}();"undefined"!=typeof module?module.exports=support:(app.modules.support={},app.modules.support.module=support);
 /*_____*/ 
var panel=function(){var u=new nModule,t={},s=function(n){var d,e=deep(n,"history"),t=null,s=null,i=null,a=null,o={tags:function(){u.nav.api.load({open:!0,id:"tagcloud",el:d.tags,animation:!1,clbk:function(n,e){s=e}})},recommendationslist:function(n,e){n.length&&d.c&&u.shell({name:"recommendationslist",el:d.r.find(".userslist"),data:{users:n},bgImages:{clbk:function(n){$(n.elements[0]).addClass("active")}}},function(n){e&&e()})},lastcomments:function(n,e){u.nav.api.load({open:!0,id:"lastcomments",el:d.comments,animation:!1,clbk:function(n,e){e}})},recommendations:function(c,n){c.length&&d.c?u.shell({name:"recommendations",el:d.r,data:{users:c}},function(r){o.recommendationslist(c,function(){var t=0,s=4,i=r.el.find(".userslist"),a=r.el.find(".arrow"),o={uleft:r.el.find(".uleft"),uright:r.el.find(".uright")},l={clickArrow:function(n){"left"==n&&(t-=s)<0&&(t=0),"right"==n&&(t+=s)>=c.count&&(t=c.count-1),l.slideCarousel()},displayArrows:function(){0<t?l.displayArrow("left",!0):l.displayArrow("left",!1),t+s<c.length?l.displayArrow("right",!0):l.displayArrow("right",!1)},displayArrow:function(n,e){var t=a;n&&(t=o["u"+n]),e?t.addClass("active"):t.removeClass("active")},slideCarousel:function(){var n=d.c.find(".user").width(),e=t*n;i.css("margin-left","-"+e+"px"),l.displayArrows()},applyCarousel:function(){var n=r.el.find(".user").width(),e=r.el.find(".userslistwrapper").width();s=Math.min(Number((e/n).toFixed(0)),4),d.c.find(".user").width((e/s).toFixed(0)+"px"),i.width((c.length*(e/s)).toFixed(0)+1),l.slideCarousel()}},n=function(){var n=$(this).attr("arrow");l.clickArrow(n)};l.applyCarousel(),r.el.find(".arrow").on("click",n)})}):d.r.html("")},discussions:function(){var n=a.discussions||{};n.view="fixedin",u.nav.api.load({open:!0,id:"discussions",el:d.cnt,animation:!1,essenseData:n,clbk:function(n,e){t=e}})}},l=function(t){u.app.user.isState(function(n){if(n){var e=u.sdk.address.pnet().address;u.sdk.users.get(e,function(){var n=deep(u,"sdk.users.storage."+e+".recomendedSubscribes");n&&n.length?u.sdk.users.get(n,function(){t&&t(n)}):t&&t([])})}else t&&t([])})},r=function(){};return{primary:e,getdata:function(n,e){a=e.settings.essenseData||{};n({})},destroy:function(){delete u.app.platform.clbks.api.actions.subscribe.panelrec,t&&(t.destroy(),t=null),s&&(s.destroy(),s=null),i&&(i.destroy(),i=null),d={}},init:function(n){r(),(d={}).c=n.el.find("#"+u.map.id),d.cnt=d.c.find(".panelcnt"),d.tags=d.c.find(".tagscnt"),d.comments=d.c.find(".lastcommentscnt"),d.r=d.c.find(".recommendationscnt"),u.app.platform.clbks.api.actions.subscribe.panelrec=function(){l(function(n){o.recommendations(n)})},u.app.platform.sdk.usersettings.meta.vidgetchat.value&&o.discussions(),u.app.platform.sdk.usersettings.meta.vidgettags.value&&o.tags(),u.app.platform.sdk.usersettings.meta.vidgetlastcomments.value&&o.lastcomments(),n.clbk(null,n)}}};return u.run=function(n){var e=u.addEssense(t,s,n);u.init(e,n)},u.stop=function(){_.each(t,function(n){n.destroy()})},u}();"undefined"!=typeof module?module.exports=panel:(app.modules.panel={},app.modules.panel.module=panel);
 /*_____*/ 
var addaccount=function(){var c=new nModule,o={},t=function(n){var i,e,o=deep(n,"history"),t="secondary";o&&(t="primary"),n.inWnd&&(t="window");var a=function(){var n=trim(i.login.val());e.success&&e.success(n),c.closeContainer()};return{primary:o,id:t,getdata:function(n,e){n({})},destroy:function(){i={}},init:function(n){(i={}).c=n.el.find("#"+c.map.id),i.login=i.c.find(".loginValue"),i.enter=i.c.find(".enter"),e=n.essenseData||{},n,i.enter.on("click",a),i.login.on("focus",function(){i.c.find(".inputTable").addClass("typeactive")}),i.login.on("blur",function(){i.c.find(".inputTable").removeClass("typeactive")}),initUpload({el:i.c.find(".uploadFile"),notexif:!0,ext:["txt","png","jpeg","jpg"],dropZone:i.c,action:function(n,e){if("png"==n.ext||"jpeg"==n.ext||"jpg"==n.ext)grayscaleImage(n.base64,function(n){qrscanner.q.callback=function(n){"error decoding QR Code"==n?sitemessage(c.app.localization.e("filedamaged")):(i.login.val(trim(n)),a())},qrscanner.q.decode(n)});else{var o=n.base64.split(",")[1],t=b64_to_utf8(o).split("/");t[1]?(i.login.val(trim(t[1])),a()):sitemessage(c.app.localization.e("filedamaged"))}}}),n.clbk(null,n)},tooltip:{options:{position:"left",functionPosition:function(n,e,o){return o.coord.top=10,o.coord.left+=10,o}},event:"mouseenter"},wnd:{class:"withoutButtons allscreen"}}};return c.run=function(n){var e=c.addEssense(o,t,n);c.init(e,n)},c.stop=function(){_.each(o,function(n){n.destroy()})},c}();"undefined"!=typeof module?module.exports=addaccount:(app.modules.addaccount={},app.modules.addaccount.module=addaccount);
 /*_____*/ 
var complain=function(){var h=new nModule,i={},a=function(e){var t,i,a,o,s,n=deep(e,"history"),r={post:[{name:"Sexual content",gid:1,group:[{name:"Graphic sexual activity",id:"1"},{name:"Nudity",id:"2"},{name:"Suggestive, but without nudity",id:"3"},{name:"Content involving minors",id:"4"},{name:"Abusive title or description",id:"5"},{name:"Other sexual content",id:"6"}]},{name:"Violent or repulsive content",gid:2,group:[{name:"Adults fighting",id:"7"},{name:"Physical attack",id:"8"},{name:"Youth violence",id:"9"},{name:"Animal abuse",id:"10"}]},{name:"Hateful or abusive content",gid:3,group:[{name:"Promotes hatred or violence",id:"11"},{name:"Abusing vulnerable individuals",id:"12"},{name:"Bullying",id:"13"},{name:"Abusive title or description",id:"14"}]},{name:"Harmful dangerous acts",gid:4,group:[{name:"Pharmaceutical or drug abuse",id:"19"},{name:"Abuse of fire or explosives",id:"20"},{name:"Suicide or self injury",id:"21"},{name:"Other dangerous acts",id:"22"}]},{name:"Child abuse",id:"23"},{name:"Promotes terrorism",id:"24"},{name:"Spam or misleading",gid:6,group:[{name:"Mass advertising",id:"25"},{name:"Pharmaceutical drugs for sale",id:"26"},{name:"Misleading text",id:"27"},{name:"Misleading thumbnail",id:"28"},{name:"Scams / fraud",id:"29"}]},{name:"Infringes my rights",gid:7,group:[{name:"Infringes my copyright",id:"30"},{name:"Invades my privacy",id:"31"},{name:"Other legal claim",id:"32"}]}]},d=function(n){return _.find(r[i],function(e){return(e.gid||e.id)==n})},l=function(i){var e=a.complain(o);topPreloader(30),h.sdk.node.transactions.create.commonFromUnspent(e,function(e,n){console.log(e,n),topPreloader(100),e?i&&i(!0):(h.app.platform.errorHandler(n,!0),i&&i())})},u=function(){o?t.next.removeClass("disabled"):t.next.addClass("disabled")},c=function(){h.closeContainer()},m=function(){!t.next.hasClass("disabled")&&o&&l(function(e){e&&(h.closeContainer(),s.success&&s.success())})},p=function(){var e=$(this).attr("reason"),n=d(e);n&&($(this).hasClass("active")||(t.c.find(".reason").removeClass("active"),o=null,$(this).addClass("active"),n.group?f.selector(n):o=n.id,u()))},f={reasons:function(){h.shell({name:"reasons",inner:html,el:t.reasons,data:{reasons:r[i]}},function(e){e.el.find(".reason").on("click",p)})},selector:function(e){var n=t.c.find('.reason[reason="'+e.gid+'"] .reasongroupIn'),i=_.map(e.group,function(e){return e.name}),a=_.map(e.group,function(e){return e.id}),s=new Parameter({type:"VALUES",name:e.name,id:e.gid,possibleValues:a,possibleValuesLabels:i,placeholder:"Choose one"});s._onChange=function(e){o=e||null,u()},h.shell({name:"selector",inner:html,el:n,data:{selector:s}},function(e){ParametersLive([s],e.el)})}},g=function(){};return{primary:n,getdata:function(e,n){(o=null,i=deep(n,"settings.essenseData.item")||"post",a=deep(n,"settings.essenseData.obj")||null,s=n.settings.essenseData||{},a)&&e({ess:i})},destroy:function(){t={}},init:function(e){g(),(t={}).c=e.el.find("#"+h.map.id),t.reasons=t.c.find(".reasons"),t.next=t.c.find(".next"),t.c.find(".cancel").on("click",c),t.next.on("click",m),f.reasons(),e.clbk(null,e)},wnd:{class:"withoutButtons transparent small complain"}}};return h.run=function(e){var n=h.addEssense(i,a,e);h.init(n,e)},h.stop=function(){_.each(i,function(e){e.destroy()})},h}();"undefined"!=typeof module?module.exports=complain:(app.modules.complain={},app.modules.complain.module=complain);
 /*_____*/ 
var authorization=function(){var c=new nModule,o={},a=function(e){var i,a,t,r=deep(e,"history"),n="secondary";r&&(n="primary"),e.inWnd&&(n="window");var s=new Parameter({type:"BOOLEAN",name:"stay",id:"stay",name:"Stay Signed",_onChange:function(e){e||(console.log("stayH"),localStorage.stay="0",localStorage.mnemonic,c.app.user.stay=0)}}),l={login:function(){var o={},e=trim(i.login.val());localStorage.stay=boolToNumber(s.value).toString(),c.user.stay=s.value,c.user.signin(e,function(e){if(e){var n={};n.href=a.successHref,!n.href&&r&&(n.href=function(){return c.app.user.validate()?"index":c.app.errors.connection()?"userpage?id=test":"filluser"}),n.nav=a.nav,n.clbk=function(){topPreloader(100);var e=deep(t,"container.close");e&&e(),a.signInClbk&&a.signInClbk()},"_this"==deep(a,"successHref")?c.app.reloadModules(function(){if(c.app.user.validate()){var e=deep(t,"container.close");e&&e(),a.signInClbk&&a.signInClbk()}else c.nav.api.loadSameThis("filluser",o)}):c.app.reload(n)}else sitemessage("You entered not valid private key")})}};return{primary:r,id:n,getdata:function(e,n){if(n.state&&r)c.nav.api.load({open:!0,href:"index",history:!0});else{s.value=numberToBool(c.app.user.stay);localStorage.mnemonic;e({stay:s,mnemonic:""})}},destroy:function(){i={}},init:function(e){var n,o;(i={}).c=e.el.find("#"+c.map.id),i.login=i.c.find(".loginValue"),i.pwd=i.c.find(".pwdValue"),i.enter=i.c.find(".enter"),i.toRegistration=i.c.find(".toRegistration"),i.forgotPassword=i.c.find(".forgotPassword"),a=e.essenseData||{},n=t=e,i.enter.on("click",l.login),i.toRegistration.on("click",function(){c.nav.api.loadSameThis("registration",n)}),initUpload({el:i.c.find(".uploadFile"),ext:["txt","png","jpeg","jpg"],notexif:!0,dropZone:i.c,action:function(e,n){if("png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext)console.log("QRSCANNER"),grayscaleImage(e.base64,function(e){qrscanner.q.debug=!0,qrscanner.q.callback=function(e){console.log(e),"error decoding QR Code"==e?sitemessage(c.app.localization.e("filedamaged")):(i.login.val(trim(e)),l.login())},qrscanner.q.decode(e)});else{var o=e.base64.split(",")[1],a=b64_to_utf8(o).split("/");a[1]?(i.login.val(trim(a[1])),l.login()):sitemessage(c.app.localization.e("filedamaged"))}}}),i.c.find(".loginValue").on("focus",function(){i.c.find(".inputTable").addClass("typeactive")}),i.c.find(".loginValue").on("blur",function(){i.c.find(".inputTable").removeClass("typeactive")}),o=parameters(),ParametersLive([s],i.c),o.restore&&l.forgotPassword(),e.clbk(null,e)},tooltip:{options:{position:"left",functionPosition:function(e,n,o){return o.coord.top=10,o.coord.left+=10,o}},event:"mouseenter"},wnd:{class:"withoutButtons allscreen"}}};return c.run=function(e){var n=c.addEssense(o,a,e);c.init(n,e)},c.stop=function(){_.each(o,function(e){e.destroy()})},c}();"undefined"!=typeof module?module.exports=authorization:(app.modules.authorization={},app.modules.authorization.module=authorization);
 /*_____*/ 
var surveyiframe=function(){var o=new nModule,r={},i=function(e){var n,r=deep(e,"history"),i=function(e){"endsurvey"==(e.originalEvent.data||{}).message&&o.closeContainer()},a=function(){};return{primary:r,getdata:function(e){e({})},destroy:function(){n={}},init:function(e){localStorage.survey1=!0,a(),(n={}).c=e.el.find("#"+o.map.id),$(n.c.find("iframe")[0].contentWindow).on("message",i),e.clbk(null,e)},wnd:{class:"allscreen black surveyiframe"}}};return o.run=function(e){var n=o.addEssense(r,i,e);o.init(n,e)},o.stop=function(){_.each(r,function(e){e.destroy()})},o}();"undefined"!=typeof module?module.exports=surveyiframe:(app.modules.surveyiframe={},app.modules.surveyiframe.module=surveyiframe);
 /*_____*/ 
var userslist=function(){var g=new nModule,n={},t=function(s){var n,t,e=deep(s,"history"),o=[],i=!1,r=0,a=function(s){dialog({html:"Do you really want to unfollow user?",btn1text:"Unfollow",btn2text:"Cancel",class:"zindex",success:function(){g.app.platform.api.actions.unsubscribe(s,function(s,e){s||g.app.platform.errorHandler(e,!0)})}})},c=function(s){g.app.platform.api.actions.subscribe(s,function(s,e){s||g.app.platform.errorHandler(e,!0)})},l=function(){$(window).scrollTop()+$(window).height()>$(document).height()-400&&!t&&!i&&b()},u=function(){var s=$(this).closest(".user").attr("address");a(s)},d=function(){var s=$(this).closest(".user").attr("address");c(s)},p=function(s,e){g.shell({name:"users",el:n.users,data:{addresses:s},inner:append},function(s){e&&e()})},f=function(s,e){t||(t=!0,topPreloader(80),n.c.addClass("loading"),g.sdk.users.get(s,function(){n.c.removeClass("loading"),t=!1,topPreloader(100),e&&e()}))},b=function(s){var e=_.filter(o,function(s,e){if(50*r<=e&&e<50*(r+1))return!0});e.length?(f(e,function(){p(e,s)}),r++):i=!0},m=function(){};return{primary:e,getdata:function(s,e){r=0,t=i=!1;var n={};o=deep(e.settings,"essenseData.addresses")||[],n.addresses=o,n.empty=deep(e.settings,"essenseData.empty"),n.caption=deep(e.settings,"essenseData.caption"),s(n)},destroy:function(){window.removeEventListener("scroll",l),delete g.app.platform.clbks.api.actions.subscribe.userlist,delete g.app.platform.clbks.api.actions.unsubscribe.userlist,delete g.app.platform.clbks.api.actions.blocking.userlist,n={}},init:function(s){m(),(n={}).c=s.el.find("#"+g.map.id),n.users=n.c.find(".users"),g.app.platform.clbks.api.actions.subscribe.userlist=function(s){console.log("SUC",s),n.c.find('.user[address="'+s+'"] .subscribebuttonstop').addClass("following")},g.app.platform.clbks.api.actions.unsubscribe.userlist=function(s){console.log("USUC",s),n.c.find('.user[address="'+s+'"] .subscribebuttonstop').removeClass("following")},g.app.platform.clbks.api.actions.blocking.userlist=function(s){n.c.find('.user[address="'+s+'"] .subscribebuttonstop').addClass("blocking")},g.app.platform.clbks.api.actions.unblocking.userlist=function(s){n.c.find('.user[address="'+s+'"] .subscribebuttonstop').removeClass("blocking")},n.c.on("click",".subscribe",d),n.c.on("click",".unsubscribe",u),n.c.on("click",".unblocking",u),b(function(){window.addEventListener("scroll",l)}),s.clbk(null,s)}}};return g.run=function(s){var e=g.addEssense(n,t,s);g.init(e,s)},g.stop=function(){_.each(n,function(s){s.destroy()})},g}();"undefined"!=typeof module?module.exports=userslist:(app.modules.userslist={},app.modules.userslist.module=userslist);
 /*_____*/ 
var ustate=function(){var r=new nModule,n={},o=function(e){var o,l,s,t=deep(e,"history"),n=makeid(),a={post:{key:"post",vis:"scale",name:r.app.localization.e("spc"),bad:function(e){if(e<=2)return!0}},score:{key:"score",vis:"scale",name:r.app.localization.e("ssc"),bad:function(e){if(e<=10)return!0}},comment:{key:"comment",vis:"scale",name:r.app.localization.e("ccc"),bad:function(e){if(e<=10)return!0}},comment_score:{key:"comment_score",vis:"scale",name:r.app.localization.e("crc"),bad:function(e){if(e<=10)return!0}}},i={gifts:function(a){console.log("renders"),r.app.platform.sdk.processes.get(function(e){r.app.platform.sdk.processes.gifts(function(o){console.log(e,o,r.app.platform.sdk.processes.level(l.reputation));var s=r.app.platform.sdk.processes.level(l.reputation);s&&_.each(e,function(t){if(t.level){var e=a.find('.level[level="'+t.level+'"]');if(t.level<s.level){var n=_.find(o,function(e){return e.amount==1e8*t.bonus});console.log(n,1e8*t.bonus,o),n?e.removeClass("waitgift"):e.addClass("waitgift")}}})})})},currentLevel:function(a){r.app.platform.sdk.processes.get(function(e){var s=r.app.platform.sdk.processes.level(l.reputation);s&&_.each(e,function(e){if(e.level){var t=a.find('.level[level="'+e.level+'"]'),n="next",o=t.find(".line");e.level<s.level&&(n="completed",o.removeAttr("width")),e.level==s.level&&(n="current",o.width(100*s.perc+"%")),e.level>s.level&&(next="next",o.removeAttr("width")),t.attr("state",n)}})})},reputationsteps:function(n){r.app.platform.sdk.processes.get(function(e){var t=r.app.platform.sdk.processes.level(l.reputation);r.shell({name:"reputation",el:o.c.find(".ustatecontentrep"),data:{reputation:l.reputation,level:t,levels:e}},function(e){i.currentLevel(e.el),i.gifts(e.el),e.el.find(".tooltip").tooltipster({theme:"tooltipster-light",maxWidth:600,zIndex:20}),n&&n()})})},uscnt:function(t){r.shell({name:"uscnt",el:o.c.find(".mwork"),data:{mestate:l,metrics:a}},function(e){t&&t()})},ustatecontent:function(t){var e=a;r.shell({name:"ustatecontentnew",el:o.ustatecontent,data:{metrics:e,mestate:l,waitActions:s}},function(e){t&&t()})}},c=function(){},p=function(n){r.app.platform.sdk.user.waitActions(function(t){r.app.platform.sdk.ustate.me(function(e){s=t,l=e,i.uscnt(function(){o.ustatecontent=o.c.find(".ustatecontent"),i.ustatecontent(),i.reputationsteps(),n&&n()})},!0)})};return{primary:t,getdata:function(e){({});e({})},destroy:function(){o={},delete r.app.platform.ws.messages["new block"].clbks.ustate,delete r.app.platform.sdk.ustate.clbks[n]},init:function(e){c(),(o={}).c=e.el.find("#"+r.map.id),(r.app.platform.sdk.ustate.clbks[n]=p)(function(){r.app.platform.ws.messages["new block"].clbks.ustate=function(e){r.app.platform.sdk.user.waitActions(function(e){s=e,i.ustatecontent()})},e.clbk(null,e)})},tooltip:{options:{minWidth:380,position:"left",functionPosition:function(e,t,n){return n.coord.top=10,n.coord.left+=10,n},theme:"tooltipster-light zindex ustatetooltip"}}}};return r.run=function(e){var t=r.addEssense(n,o,e);r.init(t,e)},r.stop=function(){_.each(n,function(e){e.destroy()})},r}();"undefined"!=typeof module?module.exports=ustate:(app.modules.ustate={},app.modules.ustate.module=ustate);
 /*_____*/ 
var dust=function(){var i=new nModule,t={},n=function(e){var t,a=deep(e,"history"),n={},r=function(){var e=deep(n,"pk.value");n={pk:new Parameter({name:"Private Key",type:"string",id:"pk",placeholder:"Private Key",value:e||""}),reciever:new Parameter({name:i.app.localization.e("wsreciever"),type:"string",id:"reciever",placeholder:i.app.localization.e("wsenter")}),amount:new Parameter({name:i.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:i.app.localization.e("wsamountof"),format:{Precision:6}}),outputs:new Parameter({name:"Count of outputs",id:"outputs",type:"NUMBER",placeholder:"Count of outputs",defaultValue:1,format:{Precision:0,Min:1,Max:200}}),message:new Parameter({name:"Message",id:"message",type:"stringany",placeholder:"Your message",format:{Length:80}})}},s={sendWrapper:function(){if(n.reciever.value){var a=!0;try{bitcoin.address.fromBase58Check(n.reciever.value)}catch(e){a=!1}a?n.amount.value?n.pk.value?s.send(n.pk.value):dialog({html:"Do you want to send coins from current acount?",btn1text:"Yes",btn2text:"No, cancel",success:function(){console.log(";self.app.user.private.value.toString()",i.app.user.private.value.toString()),s.send(i.app.user.private.value.toString("hex"))}}):sitemessage("You must enter Amount"):sitemessage("Address is not valid")}else sitemessage("You Must Enter Reciever Address")},send:function(e){t.c.find(".loader").fadeIn(),i.app.platform.sdk.wallet.sendmanyoutputs(e,n.reciever.value,n.amount.value,n.outputs.value,function(e,a){t.c.find(".loader").fadeOut(),e?i.app.platform.errorHandler(e,!0):(r(),o.parameters(),sitemessage("Success!"))},n.message.value)}},o={parameters:function(){i.shell({name:"parameters",el:t.c.find(".parametersWrapper"),data:{d:{parameters:n}}},function(e){ParametersLive(_.toArray(n),e.el),e.el.find(".sends").on("click",s.sendWrapper)})}},u=function(){};return{primary:a,getdata:function(e){e({})},destroy:function(){t={}},init:function(e){u(),(t={}).c=e.el.find("#"+i.map.id),r(),o.parameters(),e.clbk(null,e)}}};return i.run=function(e){var a=i.addEssense(t,n,e);i.init(a,e)},i.stop=function(){_.each(t,function(e){e.destroy()})},i}();"undefined"!=typeof module?module.exports=dust:(app.modules.dust={},app.modules.dust.module=dust);
 /*_____*/ 
var about=function(){var p=new nModule,n={},a=function(e){var n,t,a,i=deep(e,"history"),o=null,s=null,c={videoWidth:function(e){var t=560,n=315,a=e.width(),i=a/(t/n);e.find("iframe").width(a),e.find("iframe").height(i)},time:function(){today=new Date,today=Math.floor((t-today)/1e3),tsec=today%60,today=Math.floor(today/60),tsec<0?tsec="00":tsec<10&&(tsec="0"+tsec),tmin=today%60,today=Math.floor(today/60),tmin<0?tmin="00":tmin<10&&(tmin="0"+tmin),thour=today%24,today=Math.floor(today/24),thour<0&&(thour="00"),today<0&&(today="00"),n.days.html(today),n.seconds.html(tsec),n.minutes.html(tmin),n.hours.html(thour)},fixed:function(){var e=$(window).scrollTop();n.main.offset().top+n.main.height()<e?n.fixed.addClass("active"):n.fixed.removeClass("active")},explore:function(){var e=n.c.find(".faq");_scrollToTop(e)},validateEmail:function(e){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)},saveEmail:function(e,t,n,a){a||(a="4");var i={Email:e,Name:t};i.Action||(i.Action="ADDTOMAILLIST"),i.TemplateID||(i.TemplateID=a),$.ajax({type:"POST",url:"https://pocketnet.app/Shop/AJAXMain.aspx",data:i,dataType:"json",success:function(){n&&n()}})},joinSuccess:function(e){p.fastTemplate("joinSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})},{email:e})},join:function(e){p.fastTemplate("join",function(e){dialog({html:e,wrap:!0,success:function(e){var t=e.el.find(".email"),n=e.el.find(".name"),a=t.val(),i=n.val();if(c.validateEmail(a)&&i)return c.saveEmail(a,i),c.joinSuccess(a,i),!0},clbk:function(e){var n=e.find(".name"),a=e.find(".email"),t=function(){var e=a.val(),t=n.val();return c.validateEmail(e)&&t?(i.removeClass("disabled"),!0):(i.addClass("disabled"),!1)},i=e.find(".btn1");i.addClass("disabled"),i.on("click",function(){}),n.focus(),n.on("change",t),n.on("keyup",t),a.on("change",t),a.on("keyup",t)},class:"one joinbeta"})},{action:e})},whitepaperSuccess:function(){p.fastTemplate("whitepaperSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})})},whitepaper:function(){p.fastTemplate("whitepaper",function(e){dialog({html:e,wrap:!0,success:function(e){var t=e.el.find("input").val();if(c.validateEmail(t))return c.saveEmail(t,"",null,"5"),c.whitepaperSuccess(),!0},clbk:function(e){var t=function(){var e=$(this).val();return c.validateEmail(e)?(n.removeClass("disabled"),!0):(n.addClass("disabled"),!1)},n=e.find(".btn1");n.addClass("disabled"),n.on("click",function(){});var a=e.find("input");a.focus(),a.on("change",t),a.on("keyup",t)},class:"one joinbeta"})})}},l=function(){c.whitepaper()},d=function(){c.join()},r=function(){var e=$(this).attr("answer");e&&s.send(e,function(){f.survey()})},u=[{name:"Twitter",icon:'<i class="fab fa-twitter"></i>',href:"https://twitter.com/Pocket_Net"},{name:"Telegram",icon:'<i class="fab fa-telegram"></i>',href:"https://t.me/PocketRep"},{name:"Facebook",icon:'<i class="fab fa-facebook"></i>',href:"https://www.facebook.com/PocketNet"},{name:"Minds",image:"https://cdn-assets.minds.com/front/dist/assets/logos/bulb.svg",href:"https://www.minds.com/PocketNet"},{name:"Linkedin",icon:'<i class="fab fa-linkedin"></i>',href:"https://www.linkedin.com/company/cryptolo-io"},{name:"Mastodon",icon:'<i class="fab fa-mastodon"></i>',href:"https://mastodon.social/@PocketRep"},{name:"Gab",image:"https://gab.com/assets/img/logo-dec.png",href:"https://gab.com/PocketNet"},{name:"Sola",image:"https://web.solacore.net/img/logo_medium-3_mNF.png",href:"https://sola.ai/cryptolo_io"},{name:"Medium",icon:'<i class="fab fa-medium"></i>',href:"https://medium.com/@cryptolo.io"}],f={survey:function(t){p.shell({name:"survey",el:n.survey,data:{survey:s},animation:"fadeIn"},function(e){e.el.find(".sendanswer").on("click",r),e.el.find(".resultpercent").each(function(){var e=$(this);e.animate({width:e.attr("w")+"%"},130)}),t&&t()})},tes:function(){var e=n.c.find(".tes");lazyEach({array:e,sync:!0,action:function(e){var t=$(e.item),n=t.attr("time")||600;t.addClass("show"),setTimeout(function(){e.success()},n)}})},lenta:function(){p.nav.api.load({open:!0,id:"lenta",el:n.lenta,animation:!1,mid:"about",essenseData:{author:"PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd",byauthor:!0,authAction:function(e){c.join(e)},notscrollloading:!0},clbk:function(e,t){o=t}})}},m=function(){};return{primary:i,getdata:function(e){o=null,s=new sQuestion({id:"pocketnetlanding",ajax:p.app.ajax,question:"Are you fed up with traditional social media like Facebook, Twitter and others?",answers:[{t:"Yes, very",v:1},{t:"Yes, somewhat",v:2},{t:"Facebook and Twitter are just great",v:3}]}),e({socials:u,survey:s})},destroy:function(){a&&clearInterval(a),o&&(o.destroy(),o=null),window.removeEventListener("scroll",c.fixed),n={}},init:function(e){m(),(n={}).c=e.el.find("#"+p.map.id),n.lenta=e.el.find(".lenta"),n.main=n.c.find(".main"),n.fixed=n.c.find(".fixedButton"),n.join=n.c.find(".ejoin"),n.whitepaper=n.c.find(".whitepaper"),n.days=e.el.find(".days"),n.seconds=e.el.find(".seconds"),n.minutes=e.el.find(".minutes"),n.hours=e.el.find(".hours"),n.survey=e.el.find(".survey"),t=new Date(2019,0,23,23,59),a=setInterval(c.time,1e3),n.join.on("click",d),n.whitepaper.on("click",l),n.c.find(".exploremore").on("click",c.explore),window.addEventListener("scroll",c.fixed),f.tes(),f.lenta(),s.init(function(){f.survey()}),c.videoWidth(n.c.find(".videoContent")),e.clbk(null,e)}}};return p.run=function(e){var t=p.addEssense(n,a,e);p.init(t,e)},p.stop=function(){_.each(n,function(e){e.destroy()})},p}();"undefined"!=typeof module?module.exports=about:(app.modules.about={},app.modules.about.module=about);
 /*_____*/ 
var registration=function(){var v=new nModule,t={},i=function(n){var c,t,i,o=deep(n,"history"),a={last:!1,end:!1},s=null,e={type:"STRING",name:"keyInput",id:"keyInput",placeholder:v.app.localization.e("confirmkey"),autoSearch:function(e,n,t){if(0==a.mnemonicKey.indexOf(e)&&" "!=e[e.length-1]){var i=e.split(" "),o=i.length-1;i[o];t(_.filter(a.mnemonicContent,function(e,n){if(n<=o)return!0}).join(" "))}}};isMobile()&&delete e.autoSearch;var r=new Parameter(e),l={download:function(o){a.os&&a.os.github&&$.get(a.os.github.url,{},function(e){var n=deep(e,"assets")||[],t=_.find(n,function(e){return e.name==a.os.github.name});if(t){v.app.platform.m.log("registration_application_download",a.os.github.name);var i=document.createElement("a");i.setAttribute("href",t.browser_download_url),i.setAttribute("download","download"),i.click(),o&&o(t.browser_download_url)}})},validation:function(){var e=trim(r.value);return e!=a.mnemonicKey&&e!=a.mk?(c.c.find(".note").html(v.app.localization.e("keysnotmatch")),c.c.addClass("error"),!1):(c.c.removeClass("error"),c.c.find(".note").html(""),!0)},registration:function(){l.validation()&&(localStorage.stay="1",v.app.user.stay=1,v.user.signin(a.mnemonicKey,function(e){if(!e)return c.c.find.note.html(v.app.localization.e("id98")),void c.c.addClass("error");a.end=!0,g.confirm(function(){g.success(function(){setTimeout(function(){if("_this"==deep(t,"successHref"))if(v.app.user.validate()){var e=deep(i,"container.close");e&&e(),t.signInClbk&&t.signInClbk()}else v.nav.api.loadSameThis("filluser",n);else t.nav||(t.nav={}),t.nav.history=!0,t.nav.reload=!1,v.app.reload({href:t.successHref||"filluser",nav:t.nav})},2e3)})})}))},generate:function(){c.c.removeClass("begin");var t=bitcoin.bip39.generateMnemonic();l.testqrcodeandkey(t,function(e){if(console.log("result",e),e){a.mnemonicKey=t,a.mnemonicMask=_.shuffle(indexArray(a.mnemonicKey.length)),a.mnemonicContent=a.mnemonicKey.split(" ");var n=v.app.user.keysFromMnemo(a.mnemonicKey);a.mainAddress=app.platform.sdk.address.pnet(n.publicKey).address,a.mk=n.privateKey.toString("hex"),g.key()}else l.generate()})},repeat:function(){a.last=!1,g.confirm(function(){g.tips(function(){setTimeout(function(){c.c.removeClass("last"),setTimeout(function(){l.generate()},300)},300)})})},continue:function(){var e=c.c.find(".mnemonicKey");c.c.find(".keyStep").removeClass("showedPanel"),g.mnemonicEffect(e,!0,function(){a.last=!0,g.key(function(){setTimeout(function(){g.tips(),c.c.addClass("last"),setTimeout(function(){g.confirm()},300)},300)})})},removeDisabled:function(e){e.find(".continue").removeClass("disabled"),e.find(".preloader").remove(),e.find(".save").addClass("black"),e.find(".copy").addClass("black")},testqrcodeandkey:function(e,n){var t=v.app.user.keysFromMnemo(trim(e)).privateKey.toString("hex"),i=g.qrcode(c.c.find(".hiddenqrcode"),t)._oDrawing._oContext.canvas.toDataURL("image/jpeg");grayscaleImage(i,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?n&&n(!1):n&&n(!0)},qrscanner.q.decode(e)})}},d=function(){l.registration()},f=function(){l.generate()},u=function(){$(this).hasClass("disabled")||l.continue()},p=function(){l.repeat()},m=function(){l.download(function(e){c.c.find(".osStep").addClass("rundownloading"),c.c.find(".skipositem").html('<div class="downloadstart">You will now continue your registration after you install Pocketnet Desktop.</div><div><a href="'+e+'"><b>If Pocketnet for Windows did not start downloading, please click here to install it</b></a></div>')})},g={os:function(n){var e=os();v.app.platform.m.log("registration_application"),e&&v.app.platform.applications[e]&&"undefined"==typeof _Electron&&!window.cordova&&!v.app.ref?(a.os=v.app.platform.applications[e],g.step("os",function(e){e.el.find(".downloadOs").on("click",m),e.el.find(".skip").on("click",function(){n&&n()})})):n()},step:function(e,n){v.shell({name:e,el:c.c.find("."+e+"Step"),data:a,animation:{id:"slide"}},function(e){n&&n(e)})},success:function(n){g.step("success",function(e){v.app.platform.m.log("registration_success"),n&&n()})},tips:function(n){v.app.platform.m.log("registration_tips"),g.step("tips",function(e){e.el.find(".generate").on("click",f),n&&n()})},confirm:function(n){r.value="",a.keyInput=r,g.step("confirm",function(e){e.el.find(".repeat").on("click",p),e.el.find(".registrationButton").on("click",d),n?n():(ParametersLive([r],e.el),_scrollTo(e.el,s),initUpload({el:e.el.find(".uploadFile"),ext:["txt","png","jpeg","jpg"],notexif:!0,dropZone:c.c.find(".confirm"),action:function(e,n){if("png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext)grayscaleImage(e.base64,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?(v.app.platform.m.log("registration_qr_damaged"),c.c.find(".note").html(v.app.localization.e("filedamaged"))):(v.app.platform.m.log("registration_qr_success"),r.value=trim(e),r.el.val(r.value),l.registration())},qrscanner.q.decode(e)});else{var t=e.base64.split(",")[1],i=b64_to_utf8(t).split("/");i[1]?(r.value=trim(i[1]),r.el.val(r.value),l.registration()):c.c.find(".note").html(v.app.localization.e("filedamaged"))}}}),setTimeout(function(){e.el.find('input[type="text"]').on("focus",function(){e.el.find(".inputTable").addClass("typeactive")}),e.el.find('input[type="text"]').on("blur",function(){e.el.find(".inputTable").removeClass("typeactive")}),isMobile()||e.el.find(".autosearchInputCnt input").focus()},600))})},qrcode:function(e,n){return new QRCode(e[0],{text:n,width:256,height:256})},key:function(r){g.step("key",function(n){v.app.platform.m.log("registration_key");var e=n.el.find(".mnemonicKey"),t=c.c.find(".keyStep");t.removeClass("showedPanel");var i=n.el.find(".hiddenMnemonicKey").html();if(i){var o=v.app.user.keysFromMnemo(trim(i)).privateKey.toString("hex"),a=g.qrcode(n.el.find(".qrcode"),o);console.log("code",a)}g.mnemonicEffect(e,!1,function(){t.addClass("showedPanel")}),n.el.find(".continue").on("click",u),setTimeout(function(){l.removeDisabled(n.el)},2e3),v.app.platform.clbks._focus.registration=function(){l.removeDisabled(n.el)},n.el.find(".copy").on("click",function(){copyText(n.el.find(".hiddenMnemonicKey")),sitemessage(v.app.localization.e("successfullycopied")),l.removeDisabled(n.el)}),n.el.find(".save").on("click",function(){var e=n.el.find(".qrcode img").attr("src");saveAs({file:e,format:"png",name:"pocketnetkey"})}),window.cordova&&n.el.find(".qrcode").on("click",function(){menuDialog({items:[{text:"Save key on device",class:"itemmain",action:function(e){var n=b64toBlob(a._oDrawing._elImage.currentSrc.split(",")[1],"image/png",512);saveAsWithCordova(n,"pkey"+v.app.platform.currentTime()+".png",function(){e()})}}]})}),r?r():_scrollTo(n.el,s)})},mnemonicEffect:function(t,e,n){var i=indexArray(101);e&&i.reverse();var o=t.height();t.css("min-height",o+"px"),lazyEach({array:i,sync:!0,action:function(e){var n=e.item;t.html(g.mnemonic(n)),o=t.height(),t.css("min-height",o+"px"),setTimeout(e.success,rand(1,5))},all:{success:function(){t.css("min-height","0px"),n&&n()}}})},mnemonic:function(e){var i="",o=(a.mnemonicMask.length*e/100).toFixed(0);return _.each(a.mnemonicKey,function(e,n){var t=_.indexOf(a.mnemonicMask,n);i+=t<o||" "==e?e:v.app.platform.values.alph[rand(0,v.app.platform.values.alph.length-1)]}),i}};return{primary:o,getdata:function(e,n){if(n.state&&o)v.nav.api.load({open:!0,href:"index",history:!0});else{v.app.platform.m.log("registration_open"),a={last:!1,end:!1};e({})}},destroy:function(){delete v.app.platform.clbks._focus.registration,c={}},init:function(e){var n;(c={}).c=e.el.find("#"+v.map.id),c.registrationButton=c.c.find(".registrationButton"),c.toAuthorization=c.c.find(".toAuthorization"),c.login=c.c.find(".loginValue"),c.ler=c.c.find(".ler"),c.key=c.c.find(".key"),t=e.essenseData||{},i=e,(s=c.c.closest(".wndcontent")).length||(s=null),g.os(function(){g.tips()}),n=e,c.toAuthorization.on("click",function(){v.nav.api.loadSameThis("authorization",n)}),e.clbk(null,e)},wnd:{class:"withoutButtons allscreen"}}};return v.run=function(e){var n=v.addEssense(t,i,e);v.init(n,e)},v.stop=function(){_.each(t,function(e){e.destroy()})},v}();"undefined"!=typeof module?module.exports=registration:(app.modules.registration={},app.modules.registration.module=registration);
 /*_____*/ 
var proxylogs=function(){var f=new nModule,s={},e=function(n){var o,t=deep(n,"history"),e={requests:{ws:{path:"ws",name:"Websocket connections",color:"#006CFF"},requests:{path:"requestsIp",name:"Https requests ip",color:"#FF004E"}},blacklists:{black:{path:"iplimiter.black",name:"Black list ip count",color:"#20C02B"},tblack:{path:"iplimiter.black",name:"Temp Black list ip count",color:"#00C0FF"}}},r=function(n){n.find(".expandall").on("click",function(){$(this).closest(".report").toggleClass("active")})},l=function(n){var t={type:"spline",xtype:"datetime"};return"requests"==n&&(t.caption="Connections"),"blacklists"==n&&(t.caption="Black list"),t},a=function(n,t){var o=[],s=e[n];return _.each(s,function(s){var e={color:s.color,data:[],name:s.name};_.each(t,function(n){var t=deep(n,s.path)||0;e.data.push({y:t,x:new Date(n.time)})}),o.push(e)}),o},i={prepare:function(n,t,s){var e=l(n),o=a(n,t);console.log(n,o,t);var r=new f.app.platform.objects.graph({el:s,shell:f.shell,chart:e});return r.series=o,r},make:function(n,t,s,e){var o=i.prepare(n,t,s);o.render({maxPointsCount:100},function(){e&&e(o)})}},c={users:function(n){var t=[],s=n.find(".loadaddress");s.each(function(){var n=$(this).attr("address");n&&t.push(n)}),t.length&&f.shell({name:"user",data:{}},function(n){console.log(n),f.app.platform.sdk.users.get(t,function(n,t){s.each(function(){var n=$(this).attr("address");n&&($(this).removeAttr("address"),f.shell({name:"user",data:{address:n},el:$(this)},function(n){}))})})})},logs:function(e,t){f.shell({name:"logs",data:{logs:e},el:o.logs},function(n){r(n.el),n.el.find(".expand").on("click",function(){var n=$(this).closest(".log"),t=n.attr("ip"),s=_.find(e,function(n){return n.ip==t});n.hasClass("active")?n.toggleClass("active"):c.wslogs(n.find(".wslogswrp"),deep(s,"ws"),function(){n.toggleClass("active")},!0)}),t&&t()})},ws:function(t,s){f.shell({name:"ws",data:{ws:t},el:o.ws},function(n){r(n.el),c.wslogs(n.el.find(".wslogswrp"),t),s&&s()})},block:function(n,t){f.shell({name:"block",data:{block:n},el:o.block},function(n){r(n.el),t&&t()})},wslogs:function(n,t,s,e){f.shell({name:"wslogs",data:{ws:t,users:e},el:n},function(n){e&&c.users(n.el),n.el.find(".clickload").on("click",function(){c.users($(this).closest(".address"))}),s&&s()})},error:function(t){f.shell({name:"error",data:{},el:o.error},function(n){t&&t()})},stats:function(t,s){f.shell({name:"stats",data:{stats:t},el:o.stats},function(n){c.statsChart("requests",t,n.el.find(".chartswrapper")),c.statsChart("blacklists",t,n.el.find(".chartswrapper")),s&&s()})},statsChart:function(n,t,s,e){var o=$("<div></div>",{class:"chartWrapperbs"});s.append(o),i.make(n,t,o,e)}},s=function(e){f.app.platform.sdk.system.get.info(function(n,l){if(console.log(n),l){var a=[],t={},s=group(l.logs,function(n){return n.ip});_.each(s,function(n,s){var t=_.filter(l.ws,function(n){if(n.ip==s)return n.using=!0});t=_.sortBy(t,function(n){return-(n.ws_clients+n.ws_nodes)});var e=_.find(l.iplimiter,function(n,t){if(t==s)return n.using=!0}),o={},r=group(n,function(n){return n.s});_.each(r,function(n,t){o[t]=group(n,function(n){return deep(n,"p.method")||deep(n,"pn")||"others"})}),a.push({ws:t,requests:o,ip:s,block:e,count:n.length})}),a=_.sortBy(a,function(n){return-(n.count+10*n.ws.length)}),t.logs=a,t.ws=_.filter(l.ws,function(n){return!n.using}),t.ws=_.sortBy(t.ws,function(n){return-(n.ws_clients+n.ws_nodes)}),t.blocks=_.filter(l.iplimiter,function(n,t){return n.ip=t,!n.using}),e&&e(t)}else e&&e(null)})},u=function(s){f.app.platform.sdk.system.get.stats(function(n,t){n?s&&s(null):s&&s(t)})},p=function(){};return{primary:t,getdata:function(n){n({})},destroy:function(){o={}},init:function(n){p(),(o={}).c=n.el.find("#"+f.map.id),o.logs=n.el.find(".logsWrapper"),o.ws=n.el.find(".wsWrapper"),o.block=n.el.find(".blockWrapper"),o.stats=n.el.find(".statsWrapper"),o.error=n.el.find(".errorWrapper"),u(function(t){t&&c.stats(t),s(function(n){n&&(c.logs(n.logs),c.ws(n.ws),c.block(n.blocks)),t||n||c.error()})}),n.clbk(null,n)}}};return f.run=function(n){var t=f.addEssense(s,e,n);f.init(t,n)},f.stop=function(){_.each(s,function(n){n.destroy()})},f}();"undefined"!=typeof module?module.exports=proxylogs:(app.modules.proxylogs={},app.modules.proxylogs.module=proxylogs);
 /*_____*/ 
var donations=function(){var f=new nModule,t={},a=function(n){var i,e=deep(n,"history"),t=["PHdW4pwWbFdoofVhSEfPSHgradmrvZdbE5","PTziv8ym7eJRUfyfAFBejJgEYemTdUgFzH","PBE1MLbsFoY3o1YW6t3Goi6spS1y9GY1vj","PRV1eoYkhA5PGkASm2tyD12xwdQnigbpkp","PRCeHituQ5WN2EXRZz4t9qTYyCBqTc4g4M","P9V67HjuApdEhj4DZxNnibxEqSnmCPbxvB","PA57U1QmmowNzSaz6ThG2EPs34QCsLyksL","PL7RNWypccYBPsDAygW3H4aKfzGBwMeWyt","PDUGAwFmRRSnSVTtcAuyVrTLAREm6HN2BC","PPvPW1sUAA1KPxcwbVKVk2EEp3uWkAKn2U","PWkUgSod6FEyVq8Ve1dWChWMC8HcXJcLro"],a={amount:new Parameter({name:f.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:f.app.localization.e("wsamountof"),format:{Precision:6}})},o=[{id:"btc",name:"Bitcoin",action:function(n){u.ways.ltcbtc(n)},qrname:"bitcoin"},{id:"ltc",name:"Litecoin",qrname:"litecoin",action:function(n){u.ways.ltcbtc(n)}},{id:"xmr",name:"Monero",qrname:"monero",action:function(n){u.ways.xmr(n)}},{id:"paypal",name:"Paypal",action:function(n){u.ways.paypal(n)}}],s={},c=null,u={checkFunds:function(n,e,t){u.status(n,e,function(n,e){t&&t(e)})},waitfunds:function(e,t,a,o){s[e]=t,l.save(),r.address(e,t,o,a,function(n){c=setInterval(function(){u.checkFunds(e,t,function(n){"AWAITINGFUNDS"!=n.Status&&"AWAITINGDONATION"!=n.Status&&(clearInterval(c),c=null),"AWAITINGFUNDS"==n.Status||"AWAITINGDONATION"==n.Status||"EXPIREDAWAITINGFUNDS"==n.Status?r.address(e,t,o,n):r.thankyou(o,!1,a)})},6e4)})},ways:{ltcbtc:function(t){var a=t.id;s[a]?(console.log("cur, storage[cur]",a,s[a]),u.status(a,s[a],function(n,e){"AWAITINGFUNDS"==e.Status||"AWAITINGDONATION"==e.Status?u.waitfunds(a,s[a],e,t):"EXPIREDAWAITINGFUNDS"==e.Status?u.address(a,function(n,e){u.waitfunds(a,n,e,t)}):(delete s[a],l.save(),r.thankyou(t,!0,e))})):u.address(a,function(n,e){u.waitfunds(a,n,e,t)})},xmr:function(n){r.xmraddress(n,function(n){})},paypal:function(n){window.open("https://www.paypal.me/pocketnet","_blank").focus(),r.thankyou(n)}},donate:function(){u.hidepage(function(){r.ways()})},hidepage:function(n){i.c.find(".hideprocess").fadeOut(200,n)},showpage:function(n){i.c.find(".hideprocess").fadeIn(200,n)},status:function(n,e,t){f.app.platform.sdk.exchanges.status(n,e,t)},address:function(n,t){f.app.ajax.run({data:{Action:"GETADDRESSFORDONATION",Currency:n.toUpperCase()},success:function(n){var e=deep(n,"Address.Address");e?t&&t(e,n.Address):sitemessage("Something went wrong. Please reload page and try again (error: 0001)")},fail:function(){sitemessage("Something went wrong. Please reload page and try again (error: 0001)")}})}},d=function(){u.donate()},r={thankyou:function(e,t,n){_scrollTop(0),a.amount.value=deep(n,"Amount")||0,f.shell({name:"thankyou",inner:html,el:i.process.find(".step"),data:{second:t,curobj:e,info:n,parameters:a}},function(n){ParametersLive(_.toArray(a),n.el),n.el.find(".send").on("click",function(){0<a.amount.value?$.ajax({type:"POST",url:"https://pocketnet.app/Shop/AJAXMain.aspx",data:{Action:"ADDTOMAILLIST",TemplateID:100,Email:f.app.platform.sdk.address.pnet().address,Name:(e.name||"NAN0")+", "+(a.amount.value||0)},dataType:"json",success:function(){n.el.html(""),setTimeout(function(){u.showpage()},100),dialog({html:"Thank you for supporting our work for freedom. We will make sure every penny counts.",class:"one"})}}):sitemessage("Please fill amount of donation")}),n.el.find(".back").on("click",function(){t?(n.el.html(""),setTimeout(function(){e.action(e)},100)):(n.el.html(""),setTimeout(function(){u.showpage()},100))})})},xmraddress:function(e,t){_scrollTop(0),f.shell({name:"xmraddress",inner:html,el:i.process.find(".step"),data:{curobj:e}},function(n){n.el.find(".back").on("click",function(){n.el.html(""),setTimeout(function(){r.ways()},100)}),n.el.find(".next").on("click",function(){r.thankyou(e,!0)}),n.el.on("click",".copyaddress",function(){copyText(n.el.find(".aw")),sitemessage(f.app.localization.e("waddresswascop"))}),t&&t(n.el)})},address:function(t,a,o,s,e){f.shell({name:"address",inner:html,el:i.process.find(".step"),data:{curobj:o,address:a,currency:t,info:s}},function(n){n.el.find(".back").on("click",function(){n.el.html(""),setTimeout(function(){r.ways()},100),c&&(clearInterval(c),c=null)}),n.el.on("click",".copyaddress",function(){copyText(n.el.find(".aw")),sitemessage(f.app.localization.e("waddresswascop"))}),n.el.find(".reactivate").on("click",function(){f.app.platform.sdk.exchanges.reactivate({address:a,currency:t},function(n,e){n?sitemessage("Something went wrong. Please reload page and try again (error: 0002)"):u.waitfunds(t,a,s,o)})}),n.el.find(".next").on("click",function(){r.thankyou(o,!0),c&&(clearInterval(c),c=null)}),e&&e(n.el)})},ways:function(e){_scrollTop(0),f.shell({name:"ways",inner:html,el:i.process.find(".step"),data:{ways:o}},function(n){n.el.find(".back").on("click",function(){n.el.html(""),setTimeout(function(){u.showpage()},100)}),n.el.find(".way").on("click",function(){var e=$(this).attr("way"),n=_.find(o,function(n){return n.id==e});n&&n.action(n)}),e&&e()})}},l={save:function(){f.app.settings.set(f.map.uri,"storage",JSON.stringify(s))},load:function(){s=JSON.parse(f.app.settings.get(f.map.uri,"storage")||"{}")}};return{primary:e,getdata:function(n){l.load(),f.sdk.users.get(t,function(){n({donated:t})},!0)},destroy:function(){c&&(clearInterval(c),c=null),i={}},init:function(n){(i={}).c=n.el.find("#"+f.map.id),i.process=i.c.find(".process"),i.donate=i.c.find(".donate"),i.donate.on("click",d),n.clbk(null,n)}}};return f.run=function(n){var e=f.addEssense(t,a,n);f.init(e,n)},f.stop=function(){_.each(t,function(n){n.destroy()})},f}();"undefined"!=typeof module?module.exports=donations:(app.modules.donations={},app.modules.donations.module=donations);
 /*_____*/ 
var userpage=function(){var g=new nModule,n={},o=function(e){var r,i,t=deep(e,"history"),a=null,s=null,l=!1,o=null,p=[],c={eachReport:function(a,e,t){e||(e=p);var r=function(e,o,i){o||(o=0),i||(i=""),_.each(e,function(e,t){var n=i;n&&(n+="_"),n+=e.id,e.reports?a.group(e,o,n,function(){r(e.reports,o+1,n)},t):a.report(e,o,n)})};r(e,0,t)},findReport:function(e){var i=function(e,t){var n=t.split("_");if(!n.length)return null;t=n[0];var o=_.find(e||[],function(e){return e.id==t});return o?(n.splice(0,1),(t=n.join("_"))&&o.reports?i(o.reports,t):o):null};return i(p,e)},mobileReports:function(){var i=[];return c.eachReport({group:function(e,t,n,o){e.mobile&&i.push(e),o()},report:function(e){e.mobile&&i.push(e)}}),i.push({name:g.app.localization.e("signout"),id:"signout"}),i},selector:function(){var e=c.mobileReports(),t=_.map(e,function(e){return e.id}),n=_.map(e,function(e){return e.text||e.name}),o=new Parameter({type:"VALUES",name:"Contents",id:"contents",possibleValues:t,possibleValuesLabels:n,defaultValue:t[0]});return o.value=parameters().id||t[0],o._onChange=function(e){if("signout"==e)u.signout();else{var t=c.findReport(e),n=parameters();n.report=t.report,n.id=t.id;var o="userpage"+collectParameters(n);g.nav.api.load({open:!0,href:o,history:!0})}},o}},u={closeGroup:function(e){var t=c.findReport(e);if(t){t.active=!t.active;var n=r.c.find('[levelid="'+e+'"]');t.active?n.addClass("active"):n.removeClass("active")}},openTree:function(a){c.eachReport({group:function(e,t,n,o){var i=r.c.find('[levelid="'+n+'"]');0==a.indexOf(n)?(e.active=!0,i.addClass("active"),o()):(e.active=!1,i.find(".openReport").removeClass("active"))},report:function(e,t,n){var o=r.c.find('[id="'+n+'"]');a==n?(e.active=!0,o.addClass("active")):(e.active=!1,o.removeClass("active"))}})},closeReport:function(){r.report.html("")},openReport:function(e,t){r.c.find(".openReport").removeClass("active"),r.c.find('[rid="'+e+'"]').addClass("active"),u.openTree(e),v.report(e),t&&(g.nav.api.history.addParameters({id:e},{removefromback:!1}),g.app.nav.clbks.history.navigation&&g.app.nav.clbks.history.navigation())},signout:function(){g.app.user.signout(),g.app.reload({href:"authorization"})}},d=function(){var e=$(this).closest("[levelid]").attr("levelid");u.closeGroup(e)},f=function(){var e=$(this).attr("rid");isMobile()&&v.contents(null,e),u.openReport(e,!0)},v={bgcaption:function(e){c.selector();r&&r.bgcaption&&(g.app.user.validate()?g.shell({name:"bgcaption",el:r.bgcaption,data:{}},function(e){}):r.bgcaption.html('<div class="bgCaptionSpacer"></div>'))},contents:function(n,e){if(r.contents){var o=c.selector();e&&isMobile()?(r.contents.html(""),n&&n()):g.app.platform.sdk.node.transactions.get.allBalance(function(e){var t=g.app.platform.sdk.node.transactions.tempBalance();i=e+t,g.shell({name:"contents",el:r.contents,data:{reports:p,each:c.eachReport,selector:o}},function(e){e.el.find(".groupNamePanelWrapper").on("click",d),e.el.find(".openReport").on("click",f),ParametersLive([o],e.el),_scrollTop(0),l&&r.contents.hcSticky("refresh"),n&&n()})})}},userslist:function(e,t,n,o,i){g.nav.api.load({open:!0,id:"userslist",el:e,animation:!1,essenseData:{addresses:t,empty:n,caption:o},clbk:function(e,t){i&&i(e,t)}})},followers:function(e,t){var n=deep(g,"app.user.address.value");if(n){var o=deep(g,"sdk.users.storage."+n),i=_.map(deep(o,"subscribers")||[],function(e){return e}),a=g.app.localization.e("anofollowers");g.user.isItMe(o.address)&&(a=g.app.localization.e("aynofollowers")),v.userslist(e,i,a,"Followers",t)}},following:function(e,t){var n=deep(g,"app.user.address.value");if(n){var o=deep(g,"sdk.users.storage."+n),i=_.map(deep(o,"subscribes")||[],function(e){return e.adddress}),a=g.app.localization.e("anofollowing");g.user.isItMe(o.address)&&(a=g.app.localization.e("aynofollowing")),v.userslist(e,i,a,"Following",t)}},fillUser:function(e,t){g.shell({name:"fillUser",el:e,data:{}},function(e){t&&t()})},report:function(e,n){a&&a.destroy();var t=c.findReport(e),o=function(e,t){_scrollTop(0),a=t,s&&s.apply(),n&&n()};g.shell({name:"report",el:r.report,data:{}},function(e){v[t.report]?(v[t.report](e.el.find(".reportCnt"),o),l&&r.contents.hcSticky("refresh")):g.nav.api.load({open:!0,id:t.report,el:e.el.find(".reportCnt"),animation:!1,primary:!0,essenseData:{sub:t.sub},clbk:function(e,t){o(0,t),l&&r.contents.hcSticky("refresh")}})})}},n=function(){};g.authclbk=function(){v.bgcaption()};var m=function(e){var t=parameters().id;isMobile()||t||(t="ustate"),v.contents(function(){t?u.openReport(t):u.closeReport(),e&&e()},t)},b=function(e){v.bgcaption(),m(e),g.app.user.validate()||(r.c.addClass("validate"),g.app.errors.connectionRs()&&(g.iclbks.mn=function(){delete g.iclbks.mn,b()})),isMobile()||(r.contents.hcSticky({stickTo:"#userpagestick",top:77,bottom:177}),l=!0)};return{primary:t,parametersHandler:function(){m()},getdata:function(t){!function(){if(p=[],!g.app.user.validate()){var e="Continue Registration";g.app.errors.connection()&&(e="Connection Lost"),p.push({name:e,id:"test",report:"fillUser",mobile:!0})}p.push({name:"Notifications",id:"notifications",report:"notifications",mobile:!0}),p.push({name:g.app.localization.e("rstate"),id:"ustate",report:"ustate",mobile:!0,add:function(){if(isMobile()&&deep(o,"reputation"))return o.reputation.toFixed(1)}}),p.push({name:g.app.localization.e("rwallet"),id:"wallet",report:"wallet",mobile:!0,add:function(){if(isMobile()&&i)return g.app.platform.mp.coin(i)}}),p.push({name:"Followers",id:"followers",report:"followers",mobile:!0,if:function(){return isMobile()},add:function(){var e=deep(g,"app.user.address.value");if(e){var t=deep(g,"sdk.users.storage."+e+".subscribers.length");if(isMobile()&&t)return t}}}),p.push({name:"Following",id:"following",report:"following",mobile:!0,if:function(){return isMobile()},add:function(){var e=deep(g,"app.user.address.value");if(e){var t=deep(g,"sdk.users.storage."+e+".subscribes.length");if(isMobile()&&t)return t}}}),g.app.user.validate()&&p.push({name:"Edit profile",id:"test",report:"test",mobile:!0}),p.push({name:g.app.localization.e("rsettings"),id:"usersettings",report:"usersettings",mobile:!0}),p.push({name:g.app.localization.e("raccounts"),id:"accounts",report:"accounts",mobile:!0})}();var n={};parameters();n.p2pkh=g.app.platform.sdk.address.pnet(),g.app.platform.sdk.ustate.me(function(e){console.log("_mestate",e),o=e,t(n)})},destroy:function(){delete g.iclbks.mn,l=!1,a&&a.destroy(),a=null,s&&s.destroy(),s=null,$("#menu").removeClass("abs"),r={}},init:function(e){n(),(r={}).c=e.el.find("#"+g.map.id),r.contents=r.c.find(".contents"),r.report=r.c.find(".report"),r.bgcaption=r.c.find(".bgCaptionWrapper"),$("#menu").addClass("abs"),new Caption({container:r.c,caption:r.c.find(".captionfwrapper"),offset:[0,0]}).init(),r.c.on("click",".signout",function(){u.signout()}),b(function(){e.clbk(null,e)})}}};return g.run=function(e){var t=g.addEssense(n,o,e);g.init(t,e)},g.stop=function(){_.each(n,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=userpage:(app.modules.userpage={},app.modules.userpage.module=userpage);
 /*_____*/ 
var imageGalleryEdit=function(){var P=new nModule,a={},n=function(e){var a,n,i=deep(e,"history"),t=null,r=0,l=!1,p=null,o=null,s=null,c={normal:{name:"Normal"},vintage:{name:"Vintage"},oldBoot:{name:"Old Boot"},clarity:{name:"Clarity"},sunrise:{name:"Sunrise"},crossProcess:{name:"Cross Process"},orangePeel:{name:"Orange Peel"},love:{name:"Love"},jarques:{name:"Jarques"},pinhole:{name:"Pinhole"}},d={},f={back:function(){--r<0&&(r=n.images.length-1),y()},next:function(){++r>=n.images.length&&(r=0),y()},initialValue:function(){n.initialValue&&(r=n.initialValue)},filters:function(){return(l=!l)?(a.c.addClass("filters"),h.filters()):a.c.removeClass("filters"),u.resize(),l},caman:function(e,i){var a="#galleryImage";i&&(a=i),o&&!i?e&&e(o):Caman(a,function(){i||(o=this),e&&e(this)})},crop:function(){return p?(p.destroy(),p=null,!1):(f.caman(function(){var e=a.imagesWrapper.find("#galleryImage"),i=e.parent();t=o,n.crop||(n.crop={}),p=new Cropper(e[0],{aspectRatio:n.crop.aspectRatio||null,autoCropArea:n.crop.autoCropArea||.9,checkOrientation:!1,crop:function(e){var i=o.width,a=o.height,n={x:e.detail.x/i,y:e.detail.y/a,w:e.detail.width/i,h:e.detail.height/a};d.crop=n},ready:function(){i.find(".cropper-container").addClass(n.crop.style||""),i.find(".cropper-crop-box").append('<div class="applyCrop center" action="apply">\t\t\t\t\t\t\t\t\t<span class="fa fa-check" aria-hidden="true"></span>\t\t\t\t\t\t\t\t</div>'),i.find(".applyCrop").on("click",function(){f.apply("crop"),h.savePanel()})}})}),!0)},camanFilter:function(e,i,a){e.revert(!1),"normal"!=i&&e.newLayer(function(){this.opacity(50),this.copyParent(),this.filter[i]()}),e.render(a)},previewFilter:function(e,i){var a=e.attr("filter"),n=e.attr("imageId");Caman("#"+n,function(){f.camanFilter(this,a,function(){e.animate({opacity:1})})}),e.on("click",function(){f.caman(function(){f.camanFilter(o,a,function(){t=o,d.filter=a,h.savePanel(),u.resize()})})})},applyFilters:function(t,e,r,l){"crop"!=e?"filter"==e&&f.caman(function(e){f.camanFilter(e,t,function(){l&&l()})},r):f.caman(function(e){var i=e.canvas.width,a=e.canvas.height,n={x:t.x*i,y:t.y*a,width:t.w*i,height:t.h*a};e.crop(n.width,n.height,n.x,n.y),e.resize({width:n.width,height:n.height}),e.render(function(){e.resetOriginalPixelData(),e.cropped=!1,e.cropCoordinates={x:0,y:0},e.originalHeight=n.height,e.originalWidth=n.width,e.preScaledHeight=n.height,e.preScaledWidth=n.width,e.resized=!1,r||u.resize(),l&&l()})},r)},apply:function(e,i){e&&d[e]&&(f.applyFilters(d[e],e,i),f[e](),a.c.find('[action="'+e+'"]').removeClass("active"))},close:function(){n.success?(topPreloader(20),n.success(n.images,function(){topPreloader(100),P.closeContainer()})):P.closeContainer()},exit:function(){n.apply&&(f.apply("crop"),f.save(!0)),f.close()},cancel:function(){d={},h.savePanel(),h.image({image:s})},save:function(e){f.checkUpdates()&&(s.original=o.toBase64(),d={},e||(h.savePanel(),h.image({image:s})))},checkUpdates:function(){return!!(d.filter&&"normal"!=d.filter||d.crop)}},u={resize:function(){u.bestFit(a.imagesWrapper.find(".image"),t)},bestFit:function(e,i){var a=e.closest(".imagesAbsWrapper"),n=e.find(".imgWrapper"),t=i.naturalWidth||i.width,r=i.naturalHeight||i.height,l=r/t;e.css("padding-top","0px");var o=e.width(),s=e.height(),c=a.width(),d=a.height();c<o&&(o=c),d<s&&(s=d),o<t&&(r=(t=o)*l),s<=r&&(t=(r=s)/l);var f=(s-r)/2;e.css("padding-top",f+"px"),i.canvas?(i.resize({width:t,height:r}),i.render()):(i.width=t,i.height=r,$(i).attr("data-camanwidth",t),$(i).attr("data-camanheight",r),$(i).css("opacity","1")),n.width(t),n.height(r),p&&p.resize({width:t,height:r})},nFormat:function(e){return e<10&&(e="0"+e),e}},m=function(){var e=$(this).attr("action");f[e]()},g=function(){var e=$(this).attr("action"),i=$(this);f[e]()?i.addClass("active"):i.removeClass("active")},h={savePanel:function(){(d.filter&&"normal"!=d.filter||d.crop)&&!n.apply?a.exitPanel.fadeOut(200,function(){a.savePanel.fadeIn(200)}):a.savePanel.fadeOut(200,function(){a.exitPanel.fadeIn(200)})},image:function(i){o=t=null,d={},h.savePanel(),p&&(p.destroy(),p=null,a.editPanel.find('.eitem[action="crop"]').removeClass("active")),a.imageNavigation.find(".number").html(u.nFormat(Number(r)+1)),$(window).off("resize",u.resize),i||(i={}),P.shell({name:"image",el:a.images,inner:html,display:"table",animation:!1,data:{data:n,image:i.image}},function(e){e.el.find("img").imagesLoaded(function(e){t=deep(e,"images.0.img"),s=i.image,u.resize(),$(window).on("resize",u.resize),l&&(l=!l,f.filters()),i.clbk&&i.clbk()})})},filters:function(i){i||(i={}),i.image||(i.image=n.images[r]),a.filters.html(""),resizeFit(i.image.original,80,80,function(e){P.shell({name:"filters",el:a.filters,data:{data:n,image:e,filters:c}},function(e){e.el.find(".preview").each(function(){f.previewFilter($(this),i.image)});var l=e.el.find(".filtersSwipe");swipedetect(l[0],function(e,i,a,n){var t=Number(l.css("margin-left").replace("px",""))+Number(1.7*i),r=-l.find(".filtersList").width()+l.closest(".filtersWrapperOvf").width();0<t&&(t=0),t<r&&(t=r),l.css("margin-left",t+"px")})})})}},v=function(){},y=function(){h.image({image:n.images[r],clbk:function(){n.apply&&(f.filters(),f.crop())}})},w=function(e){n.edit?P.nav.api.loadRelations({relations:[{src:"js/vendor/caman.full.min.js",f:"js",require:function(){Caman=require("../../js/vendor/caman.full.min.js").Caman}},{src:"js/vendor/cropper.js",f:"js",require:function(){Cropper=require("../../js/vendor/cropper.js")}},{src:"css/cropper.min.css",f:"css"}]},e):e&&e()};return{primary:i,getdata:function(e){e({})},destroy:function(){$(window).off("resize",u.resize),console.log("ASDSADDSA"),a={}},init:function(e){console.log("ASDSADDS122121A"),s=t=o=null,l=!1,d={},n=e.essenseData||{},v(),f.initialValue(),(a={}).c=e.el.find("#"+P.map.id),a.imagesWrapper=e.el.find(".imagesWrapper"),a.images=e.el.find(".images"),a.imageNavigation=e.el.find(".imageNavigation"),a.arrows=a.imageNavigation.find(".arrow"),a.editPanel=a.c.find(".editPanel"),a.savePanel=a.c.find(".panel .savePanel"),a.exitPanel=a.c.find(".panel .exitPanel"),a.filters=a.c.find(".filters"),w(function(){y(),a.arrows.on("click",m),a.editPanel.find(".eitem").on("click",g),a.savePanel.find(".sitem").on("click",g),a.exitPanel.find(".sitem").on("click",g),e.clbk(null,e)})},wnd:{close:function(){n.close&&n.close()},class:"allscreen black withoutButtons imageGalleryEdit"}}};return P.run=function(e){var i=P.addEssense(a,n,e);P.init(i,e)},P.stop=function(){_.each(a,function(e){e.destroy()})},P}();"undefined"!=typeof module?module.exports=imageGalleryEdit:(app.modules.imageGalleryEdit={},app.modules.imageGalleryEdit.module=imageGalleryEdit);
 /*_____*/ 
var notifications=function(){var f=new nModule,i={},o=function(t){var s,i,e,n=deep(t,"history"),o="",c=function(){var n=s.c.find(".notification:not(.seen)");n.length&&(i=slowMade(function(){if(f.app.platform.sdk.notifications.seenall(),0<n.length){n.addClass("seen")}},i,50))},a=function(){f.nav.api.go({href:"userpage?id=notifications&report=notifications",history:!0,open:!0}),f.closeContainer()},r=function(){c()},d={notifications:function(i,n){i||(i={});var t=i.notifications||f.app.platform.sdk.notifications.storage.notifications,o=!1;if(console.log("_notifications",t),i.el=s.new,i.el){f.app.platform.currentTime();i.seenFilter;var e=-t.length+(i.notifications||f.app.platform.sdk.notifications.storage.notifications).length;t=_.sortBy(t,function(n){return Number(-n.nblock)});var a=new Date,r=group(t,function(n){if(i.now)return"ntnow";var t=new Date(1e3*n.time);return t.addMinutes(60)>a?"ntlasthour":dateToStrSmall(t)==dateToStrSmall(a)?"nttoday":t.getFullYear().toString()+(t.getMonth()+1).toString()==a.getFullYear().toString()+(a.getMonth()+1).toString()?"ntmounth":"ntearlier"});if(i.now){var l=i.el.find('.group[index="ntnow"]');l.length&&(i.el=l.find(".groupContent")),o=!0}f.shell({name:"notifications",el:i.el,data:{notifications:t,ws:f.app.platform.ws,now:i.now,grou:r,rnow:o},inner:prepend},function(i){d.loadingAndEmpty(),e&&s.c.find(".more").html("("+e+")");var o=f.app.platform.ws;_.each(t,function(n){var t=null;n.mesType&&(t=o.messages[n.mesType]),n.msg&&!t&&(t=o.messages[n.msg]),t&&t.fastMessageEvents&&t.fastMessageEvents(n,{el:i.el.find('.notification[notification="'+n.txid+'"]')})}),f.app.nav.api.links(null,s.c,function(){f.closeContainer()}),c()})}},loadingAndEmpty:function(){if(f.app.errors.connection())return s.loader.addClass("hidden"),s.empty.addClass("hidden"),void s.error.removeClass("hidden");s.error.addClass("hidden"),f.app.platform.sdk.notifications.loading?s.loader.removeClass("hidden"):(s.loader.addClass("hidden"),s.c.find(".notification").length?s.empty.removeClass("hidden"):s.loader.addClass("hidden"))}},l=function(){};return{primary:n,getdata:function(n){n({})},destroy:function(){s={},o="",i&&clearTimeout(i),i=null,e.removeEventListener("scroll",r),delete f.app.platform.sdk.notifications.clbks.added["notifications"+o],delete f.iclbks.lenta},init:function(n){l(),(s={}).c=n.el.find("#"+f.map.id),s.new=s.c.find(".newWrapper"),s.loader=s.c.find(".loader"),s.empty=s.c.find(".empty"),s.error=s.c.find(".error"),"tooltip"==n.insert?(e=s.c.find(".nabsContentWrapper")[0],o="tt"):(o="",e=window),jinel=$(e),d.loadingAndEmpty(),function(){if(s.c.find(".showAll").on("click",a),e.addEventListener("scroll",r),s.c.find(".closecontainer").on("click",function(){f.closeContainer()}),f.iclbks.lenta=function(){d.loadingAndEmpty()},isMobile()){var i=s.c.find(".circularprogress"),o=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}});o.update(70),s.c.find(".circularprogressWrapper").html(o.el);var n=$(window),t=new SwipeParallax({el:s.c.find(".ntf"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(n){var t=Math.abs(n)/200;0<=n&&(o.options.text={value:""},o.update(100*t),i.height(220*t+"px"))},constraints:function(){if(0==n.scrollTop())return!0},restrict:!0,trueshold:200,clbk:function(){f.app.platform.sdk.notifications.getNotifications(function(){t.renew()})}}}}).init()}}(),n.insert,d.notifications({seenFilter:t.inTooltip}),f.app.platform.sdk.notifications.clbks.added["notifications"+o]=function(n,t){d.notifications({notifications:n,now:t})},n.clbk(null,n)},tooltip:{options:{theme:"lighttooltip notificationTolltip",position:"left",zIndex:50,distance:-47,functionPosition:function(n,t,i){return i.coord.top=0,i.coord.left=0,i},arrow:!1,trigger:"custom",triggerOpen:{click:!0},triggerClose:{}},event:"click"}}};return f.run=function(n){var t=f.addEssense(i,o,n);f.init(t,n)},f.stop=function(){_.each(i,function(n){n.destroy()})},f}();"undefined"!=typeof module?module.exports=notifications:(app.modules.notifications={},app.modules.notifications.module=notifications);
 /*_____*/ 
var discussions=function(){var y=new nModule,i={},t=function(s){var d,u,l,n,i=deep(s,"history"),t={},o={},e={},f=null,a=!1,c=null,r=null,p={preloader:function(s){d.c&&(s?d.c.addClass("loading"):d.c.removeClass("loading"))},inView:function(s,n,i){if(_.toArray(u).length&&d.c){var t=d.c.find(n||".discussion"),o="offset";"fixedin"==f.view&&(o="position");var e=inView(t,{inel:l,offset:0,mode:"part",f:o});if(0<e.length){var a={},c=_.map(e,function(s){var n=$(s).attr("chat");return a[n]=!0,u[n]});if(i){var r=[];_.each(u,function(s,n){a[n]||r.push(s)}),i(r)}s&&s(c)}}},chatp:function(s){u[s]&&(p.preloader(!0),retry(function(){if(o[s]||!t[s])return!0},function(){p.chat(u[s])}))},chat:function(n){r=!0,p.closeAll(function(){y.app.platform.sdk.chats.save();var s={open:!0,href:"chat",animation:!1,history:!0};"fixedin"==f.view?(s.history=!1,s.el=d.c.find(".chatWrapper"),s.essenseData={view:"fixedin",chat:n,destroyClbk:function(){r=!1,p.preloader(!0),d.c.removeClass("forChat"),s.el.html(""),h.discussions(null,function(){c=null,p.preloader(!1),l.scrollTop(0),setTimeout(function(){p.openInView()},100)})}},s.clbk=function(s,n){c=n,d.c.addClass("forChat"),p.preloader(!1)}):s.href="chat?chatid="+n.chat.id,y.nav.api.load(s)})},open:function(s,n){},remove:function(s){p.preloader(!0),p.close(s,function(){p.preloader(!1),y.app.platform.sdk.chats.remove(s),u=y.app.platform.sdk.discussions.fromChats(y.app.platform.sdk.chats.get("share"),f.author),d.c.find('.discussion[chat="'+s+'"]').remove(),h.empty()})},openInView:function(s){p.inView(function(s){_.map(s,function(s){return s.chat.id});_.each(s,function(s){p.open(s)})},".discussion:not(.dempty)",function(s){var n=_.map(s,function(s){return s.chat.id});p.closeMany(n)})},close:function(s,n){e[s]?retry(function(){if(!e[s])return!0},n):(e[s]=!0,retry(function(){if(o[s])return!0},function(){y.app.platform.rtc.destroy(s),delete e[s],delete o[s],delete t[s],n()}))},closeMany:function(s,n){lazyEach({array:s,action:function(s){var n=s.item;t[n]?p.close(n,s.success):s.success()},all:{success:function(){n&&n()}}})},closeAll:function(s){var n=_.map(t,function(s,n){return n});lazyEach({array:n,action:function(s){var n=s.item;p.close(n,s.success)},all:{success:function(){t={},o={},e={},s&&s()}}})}},m={inViewScroll:function(){n=slowMade(function(){r||(m.inView(),p.openInView())},n,200)},inView:function(){a||p.inView(function(s){a=!0,y.app.platform.sdk.discussions.info(s,function(s){h.fdiscussions(s,function(){a=!1}),u=y.app.platform.sdk.discussions.fromChats(y.app.platform.sdk.chats.get("share"),f.author)})},".discussion.dempty")},chat:function(){var s=$(this).closest(".discussion").attr("chat");p.chatp(s)},remove:function(){var s=$(this).closest(".discussion").attr("chat");p.remove(s)}},h={empty:function(){_.toArray(u).length?d.c.removeClass("sempty"):d.c.addClass("sempty")},message:function(s,n){y.shell({name:"message",inner:html,el:d.list.find('[chat="'+n+'"] .lastMessage'),data:{message:s}},function(s){})},discussion:function(s,n){var i=d.list.find('[chat="'+s.chat.id+'"]');s.share&&s.author?y.shell({name:"discussion",inner:html,el:i,data:{discussion:s}},function(s){i.removeClass("dempty"),s.el.find(".discussioncnt").on("click",m.chat),s.el.find(".remove").on("click",m.remove),n&&n()}):(i.remove(),n&&n())},fdiscussions:function(s,n){lazyEach({array:_.toArray(s),action:function(s){var n=s.item;h.discussion(n,s.success)},all:{success:function(){p.openInView(),n&&n()}}})},discussions:function(s,n,i){s||(s=u);var t=_.toArray(s);t=_.sortBy(t,function(s){return-s.chat.time}),y.shell({name:"discussions",inner:i||html,el:d.list,data:{discussions:t}},function(s){m.inView(),n&&n()})},discussionTemp:function(i,t,o){y.shell({name:"discussions",el:d.temp,data:{discussions:i}},function(s){var n=s.el.find(".discussion");y.app.platform.sdk.discussions.info(i,function(s){y.shell({name:"discussion",inner:html,el:n,data:{discussion:i[0],c:t}},function(s){n.removeClass("dempty"),n.on("click",function(){y.app.platform.sdk.chats.add(i[0].chat.id,"share")}),o&&o()})})})}},v=function(){};return{primary:i,getdata:function(s,n){f=n.settings.essenseData||{},a=!1;var i=y.app.platform.sdk.address.pnet().address+"addedtochat";localStorage[i]=!0,y.app.platform.sdk.chats.add("6768de97ad495c0110a9e09d43825ef24f1055449a5d368225ac102804397dc1_PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd","share");var t={};u=y.app.platform.sdk.discussions.fromChats(y.app.platform.sdk.chats.get("share"),f.author),t.discussions=u,s(t)},destroy:function(){l&&l.off("scroll",m.inViewScroll),delete y.app.platform.sdk.chats.clbks.discussions,p.closeAll(),c&&(c.destroy(),c=null),d={}},init:function(s){s,t={},opened={},r=!(o={}),v(),(d={}).c=s.el.find("#"+y.map.id),l="fixedin"==f.view?d.c.find(".discussionsWrapper"):$(window),d.list=d.c.find(".list"),d.temp=d.c.find(".gotoDisscussion"),l.on("scroll",m.inViewScroll),y.app.platform.sdk.chats.clbks.discussions=function(s,n,i){if("removeTemp"==n)return d.temp.html(""),void d.temp.fadeOut(1);var t=_.toArray(y.app.platform.sdk.discussions.fromChats([s]));"add"==n&&(u=y.app.platform.sdk.discussions.fromChats(y.app.platform.sdk.chats.get("share"),f.author),h.empty(),h.discussions(t,function(){p.chatp(t[0].chat.id)},prepend)),"addTemp"==n&&h.discussionTemp(t,i,function(){}),"addtwice"==n&&(h.discussions(),p.chatp(t[0].chat.id))},p.chatp("6768de97ad495c0110a9e09d43825ef24f1055449a5d368225ac102804397dc1_PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd"),s.clbk(null,s)}}};return y.run=function(s){var n=y.addEssense(i,t,s);y.init(n,s)},y.stop=function(){_.each(i,function(s){s.destroy()})},y}();"undefined"!=typeof module?module.exports=discussions:(app.modules.discussions={},app.modules.discussions.module=discussions);
 /*_____*/ 
var scheduler=function(){var f=new nModule,t={},n=function(e){var s,r,a=deep(e,"history"),t=[],n=null,i=function(a){return _.find(t,function(e){return e.id==a})},o=function(a){return findIndex(t,function(e){return e.id==a})},d={postInterval:function(){n=setInterval(function(){var e=d.taskForTime();l.time(),e.length&&lazyEach({array:e,sync:!0,action:function(e){var a=e.item;f.app.platform.sdk.node.transactions.get.unspent(function(){d.post(a,function(){e.success()})},null,!0)}})},6e4)},missed:function(e){dialog({html:"You have <b>"+e.length+"</b> missed posts. Do you want to share it?",btn1text:"Yes",btn2text:"No",success:function(){_.each(e,function(e){d.post(e)})},fail:function(){_.each(e,function(e){e.time=null,l.task(e,null,!0)})}})},taskForTime:function(){var a=new Date;return _.filter(t,function(e){if(e.time&&e.ready&&a>e.time&&!e.remove)return!0})},post:function(n,s){if(n.share){var e=n.share.validation();e?(sitemessage(e),d.failPost(n.id),s&&s(!1)):f.app.platform.sdk.pool.dumpKey(r,n.address,function(e){if(e){var a=bitcoin.ECPair.fromPrivateKey(Buffer.from(e,"hex")),t=bitcoin.payments.p2pkh({pubkey:a.publicKey});n.module.post(function(e,a){e?d.successPost(n.id):(sitemessage(a),d.failPost(n.id)),s&&s(e)},{address:t,keys:a})}else sitemessage("noprivateley")})}else sitemessage("error"),d.failPost(n.id),s&&s(!1)},add:function(){var e={time:null,id:makeid(),share:new Share,address:f.app.platform.sdk.address.pnet().address,ready:!1};e.share.on.change.scheduler=function(){u.save()},t.push(e),l.task(e),u.save()},remove:function(e){var a=o(e);t.splice(a,1),u.save(),s.c.find('.shareAppendWrapper[t="'+e+'"]').remove()},failPost:function(a){var e=i(a);e.time=null,l.task(e,function(){l.ready();var e=s.c.find('.shareAppendWrapper[t="'+a+'"] .result');e.html('<i class="fas fa-exclamation-circle"></i>'),e.addClass("bad")},!0)},successPost:function(e){i(e).remove=!0;var a=s.c.find('.shareAppendWrapper[t="'+e+'"] .result');a.html('<i class="far fa-check-circle"></i>'),a.addClass("good"),l.ready(),u.save()}},c=function(){var e=$(this).closest(".shareTimeWrapper").attr("task"),a=i(e),t=function(){d.remove(e)};a&&(a.share.validation()?t():dialog({html:"Do you really want to remove this task?",btn1text:"Yes",btn2text:"No",success:t}))},l={tasks:function(e){lazyEach({array:t,action:function(e){var a=e.item;l.task(a,e.success)},sync:!0,all:{success:e}})},task:function(t,n,e){e||s.tasks.append('<div class="shareAppendWrapper" t="'+t.id+'">'),_el=s.tasks.find('.shareAppendWrapper[t="'+t.id+'"]'),f.shell({name:"task",el:_el,data:{task:t}},function(e){e.el.find(".remove").on("click",c);var a=e.el.find('.shareTimeWrapper[task="'+t.id+'"] .shareContainer');f.nav.api.load({open:!0,id:"share",el:a,animation:!1,_id:t.id,essenseData:{daddress:t.address||f.app.platform.sdk.address.pnet().address,dtype:t.ready,share:t.share,exoprtByTime:!0,pack:r||{},time:t.time,notClear:!0,changeArrange:function(){u.save()},selectTime:function(e){t.time=e,l.ready(),u.save()},address:function(e){t.address=e,l.ready(),u.save()},type:function(e){"p"==e&&d.post(t,function(){}),"t"==e&&(t.ready=!0),"w"==e&&(t.ready=!1),l.time(),l.ready(),u.save()}},clbk:function(e,a){t.module=a,n&&n()}})})},time:function(){var e=new Date;s.c.find(".timeCellWrapper .time").html(e.getHours()+":"+e.getMinutes())},ready:function(){var a=new Date,e=_.filter(t,function(e){if(e.time&&e.ready&&a<e.time&&!e.remove)return!0});s.c.find(".activeTasks .count").html(e.length)}},u={save:function(){var e=_.filter(t,function(e){if(!e.remove)return!0}),a=_.map(e,function(e){var a=null;return e.time&&(a=dateToStr(e.time)),{time:a,id:e.id,share:e.share.export(!0),address:e.address,ready:e.ready}});localStorage.tasks=JSON.stringify(a)},load:function(){var e=JSON.parse(localStorage.tasks||"[]");t=_.map(e,function(e){var a=new Share;a.import(e.share),a.on.change.scheduler=function(){u.save()};var t=null;return e.time&&(t=strToDate(e.time)),{time:t,id:e.id,share:a,address:e.address,ready:e.ready||!1}})}};return{primary:a,getdata:function(e){u.load(),e({tasks:t})},destroy:function(){s={},n&&clearInterval(n),n=null},init:function(e){var a,t,n;u.load(),(s={}).c=e.el.find("#"+f.map.id),s.tasks=s.c.find(".shares"),s.add=s.c.find(".addshare"),s.add.on("click",d.add),d.postInterval(),a=f.app.platform.sdk.address.pnet().address,t=f.app.platform.sdk.pool.getPack(a),n=function(){l.tasks();var e=d.taskForTime();l.time(),l.ready(),e.length&&d.missed(e)},t?(r=t[0],f.app.platform.sdk.pool.info(r,function(){n()})):n(),e.clbk(null,e)}}};return f.run=function(e){var a=f.addEssense(t,n,e);f.init(a,e)},f.stop=function(){_.each(t,function(e){e.destroy()})},f}();"undefined"!=typeof module?module.exports=scheduler:(app.modules.scheduler={},app.modules.scheduler.module=scheduler);
 /*_____*/ 
var main=function(){var h=new nModule,t={},a=function(n){var t,a,o=deep(n,"history"),e=null,i=null,l=null,r=null,d="common",s=!1,c={addbutton:function(){h.nav.api.load({open:!0,id:"share",inWnd:!0,eid:"postin",clbk:function(n,e){h.app.platform.m.log("share_openbutton","button")},essenseData:{close:function(){l.make()},post:function(){l.make(),h.app.platform.m.log("share","button")},hello:!0,absolute:!0}})},addbuttonscroll:function(){400<$(window).scrollTop()?t.addbutton.addClass("scrollactive"):t.addbutton.removeClass("scrollactive")},panelTopPosition:function(){},panelPosition:function(){},currentMode:function(){"recommended"==d?h.nav.api.history.addParameters({r:"recommended"}):"sub"==d?h.nav.api.history.addParameters({r:"sub"}):h.nav.api.history.removeParameters(["r"]),m.lenta(),v(),m.smallpanel()}},p=function(){d=$(this).attr("lenta"),c.currentMode()},u=function(){c.panelPosition()},m={addpanel:function(){h.app.user.isState(function(n){n&&(n&&!isMobile()?t.addbutton.addClass("active"):t.addbutton.removeClass("active"))})},smallpanel:function(){t.smallpanel.find(".item").removeClass("active"),t.smallpanel.find('.item[lenta="'+d+'"]').addClass("active")},share:function(){isMobile()||h.nav.api.load({open:!0,id:"share",el:t.share,animation:!1,clbk:function(n,e){l=e,s&&t.panel.hcSticky("refresh")},essenseData:{post:function(){h.app.platform.m.log("share","normal")}}})},panel:function(){h.nav.api.load({open:!0,id:"panel",el:t.panel,animation:!1,clbk:function(n,e){a=e,c.panelPosition(),window.addEventListener("resize",u),window.addEventListener("scroll",c.panelTopPosition),t.panel.hcSticky({stickTo:"#main",top:76,bottom:177})}})},lenta:function(a,n){n||(n={}),m.addpanel(),h.nav.api.load({open:!0,id:"lenta",el:t.lenta,animation:!1,mid:"main",essenseData:{hr:"index?",goback:n.goback,renderclbk:function(){s&&t.panel.hcSticky("refresh")}},clbk:function(n,e){r||(r=h.app.platform.api.upbutton(t.up,{top:function(){return"65px"},rightEl:t.c.find(".lentacell")})),i=e,a&&a()}})}},f=function(){},v=function(){h.app.user.isState(function(n){n&&(isMobile()||("common"==d?(m.share(),t.c.find(".bgCaption").removeClass("hidden")):(t.share.html(""),t.c.find(".bgCaption").addClass("hidden"))))})},b=function(n,e){localStorage.lentakey=parameters().r||"index",m.lenta(n,e),v(),h.app.user.isState(function(n){n&&(isMobile()||m.panel(),m.addpanel())}),m.smallpanel()};return{primary:o,parametersHandler:function(n){var e=d;localStorage.lentakey=parameters().r||"index",e=parameters().r?parameters().r:"common",d!=e&&(d=e,i&&i.destroy(),m.lenta()),v(),n&&n()},authclbk:function(){void 0!==t&&t.c&&t.c.find(".bgCaption").removeClass("hidden")},getdata:function(n,e){s=!1;var a=parameters();if(d=a.r?a.r:"common",beginmaterial=a.s||a.i||a.v||null,e.state||!o||"undefined"==typeof _Electron&&!window.cordova&&("common"!=d||beginmaterial))if(e.state&&o&&!h.app.user.validate())h.nav.api.load({open:!0,href:"userpage?id=test",history:!0});else{n({})}else"undefined"!=typeof _Electron||window.cordova?h.nav.api.load({open:!0,href:"authorization",history:!0}):h.nav.api.load({open:!0,href:"video",history:!0})},destroy:function(){r&&r.destroy(),r=null,window.removeEventListener("scroll",c.panelTopPosition),window.removeEventListener("resize",u),window.removeEventListener("scroll",c.addbuttonscroll),e&&e.destroy(),i&&i.destroy(),l&&l.destroy(),a&&a.destroy(),i=e=a=null},init:function(n){i=e=null,f(),(t={}).c=n.el.find("#"+h.map.id),t.share=t.c.find(".share"),t.lenta=t.c.find(".lentaWrapper"),t.panel=t.c.find(".panel"),t.up=t.c.find(".upbuttonwrapper"),t.smallpanel=t.c.find(".smallpanell"),t.addbutton=t.c.find(".addbutton"),t.w=$(window),window.addEventListener("scroll",c.addbuttonscroll),t.smallpanel.find(".item").on("click",p),t.addbutton.on("click",c.addbutton),b(function(){n.clbk(null,n)},n)}}};return h.run=function(n){var e=h.addEssense(t,a,n);h.init(e,n)},h.stop=function(){var a=null;return _.each(t,function(n){var e=n.destroy();e&&(a=e)}),a},h.authclbk=function(){_.each(t,function(n){n.authclbk()})},h}();"undefined"!=typeof module?module.exports=main:(app.modules.main={},app.modules.main.module=main);
 /*_____*/ 
var socialshare=function(){var m=new nModule,a={},n=function(e){var n,i,a=deep(e,"history"),t="I want to share this from a decentralized blockchain platform Pocketnet with you. Hope you find it useful and if you sign up, both of us will get Pocketcoin cryptocurrency bonus!\r\n",c={},o=!1,s="",r=deep(window,"plugins.socialsharing"),l=function(){return console.log("calltoActionUserText",s),!n||o?"":s||t},d=function(){m.shell({name:"sharebuttons",el:i.c.find(".sharebuttons"),data:{socials:p()}},function(e){g()})},p=function(){return _.filter(f,function(e){if(!e.if||e.if())return!0})},f=[{n:"Email",i:'<i class="far fa-envelope"></i> Send by email',t:"email",c:"#f82a53"},{n:"SMS",i:"SMS",t:"sms",c:"#143e50",s:"shareViaSMS",if:function(){return deep(window,"plugins.socialsharing.canShareVia")}},{n:"Facebook",i:'<i class="fab fa-facebook-f"></i>',t:"facebook",c:"#3b5999",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}},{n:"Instagram",i:'<i class="fab fa-instagram"></i>',t:"facebook",c:"#fd1d1d",s:"shareViaInstagram",if:function(){return deep(window,"plugins.socialsharing.canShareVia")}},{n:"Twitter",i:'<i class="fab fa-twitter"></i>',t:"twitter",c:"#55acee",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}},{n:"Reddit",i:'<i class="fab fa-reddit-alien"></i>',t:"reddit",c:"#ff5700"},{n:"Pinterest",i:'<i class="fab fa-pinterest-p"></i>',t:"pinterest",c:"#bd081c"},{n:"LinkedIn",i:'<i class="fab fa-linkedin-in"></i>',t:"linkedin",c:"#0077B5"},{n:"Whatsapp",i:'<i class="fab fa-whatsapp"></i>',t:"whatsapp",c:"#075e54",s:"shareViaWhatsApp",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}}],u=function(){m.app.settings.set(m.map.id,"calltoActionNotInclude",o),m.app.settings.set(m.map.id,"calltoActionUserText",s)},h=function(){s=m.app.settings.get(m.map.id,"calltoActionUserText")||"",o=m.app.settings.get(m.map.id,"calltoActionNotInclude")||!1},g=function(){i.c.find(".socialsharebtn").each(function(){var i,e=$(this);if(e.hasClass("s_email"))e.on("click",function(){var e=l()+"\r\n"+c.title+"\r\n\r\n"+c.text+"\r\n\r\n\r\n"+c.url;deep(app,"platform.sdk.user.storage.me.name")&&(e+="\r\n\r\nBest,\r\n"+deep(app,"platform.sdk.user.storage.me.name"));var i="";i+="mailto:",i+="?subject="+c.title,i+="&body=",i+=encodeURIComponent(e),window.location.href=i,m.app.platform.m.log("sharing_by","email")});else{var a=c.text,n=c.title;a=trim(l()+" "+a);var t=e.data("type"),o=(i=t,_.find(f,function(e){return e.t==i}));if(o&&o.s&&window.cordova&&r){var s=o.s;e.on("click",function(){"shareViaFacebook"!=s&&"shareViaTwitter"!=s&&"shareViaWhatsApp"!=s||r[s](a,c.image,c.url),"shareViaInstagram"==s&&r[s](a,c.image),"shareViaSMS"==s&&r[s]({message:a+" "+c.url,subject:n,image:c.image})})}else e.ShareLink({title:n,text:a,image:c.image,url:c.url,class_prefix:"s_",width:640,height:480});e.on("click",function(){var e=$(this).data("type");m.app.platform.m.log("sharing_by",e)})}})};return{primary:a,getdata:function(e,i){if(n=i.state,c=i.settings.essenseData||{},h(),c.title||(c.title="Pocketnet"),c.text||(c.text="Great news. I gained my independence from social media monopolies, Come join me at pocketnet.app so we can share and chat independently on the blockchain. Join me here"),c.image||(c.image="https://pocketnet.app/img/logobigpadding.png"),!c.url)if("undefined"!=typeof _Electron||window.cordova){var a=(i=window.location.pathname.split("/"))[i.length-1];c.url="https://pocketnet.app/"+a+window.location.search}else c.url="https://pocketnet.app/"+m.app.nav.get.href();c.url=m.app.nav.api.history.addParametersToHref(c.url,{ref:m.app.platform.sdk.address.pnet().address}),e({socials:p(),url:c.url,rescue:c.rescue||!1,caption:c.caption,calltoActionUserText:s||t,calltoActionNotInclude:o})},destroy:function(){i={}},init:function(e){h(),(i={}).c=e.el.find("#"+m.map.id),i.url=i.c.find(".url"),i.c.find(".copycell").on("click",function(){copyText(i.url.find(".urlcell")),sitemessage(m.app.localization.e("urlsuccesscopied"))}),i.c.find(".changecallto").on("click",function(){o=!o,$(".additionalwrapper").toggleClass("checked"),o&&i.c.removeClass("textshowed"),u(),d()}),i.c.find(".morecell").on("click",function(){i.c.toggleClass("textshowed"),i.c.closest(".wnd").toggleClass("textshowedwnd")}),i.c.find(".calltoActionUserText").on("keyup",function(){(s=$(this).val())==t&&(s=""),u(),d()}),i.c.find(".calltoActionUserText").on("change",function(){s||i.c.find(".calltoActionUserText").val(t)}),d(),e.clbk(null,e)},wnd:{swipeClose:!0,swipeMintrueshold:30,header:"Social sharing",class:"sharingwindow"}}};return m.run=function(e){var i=m.addEssense(a,n,e);m.init(i,e)},m.stop=function(){_.each(a,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=socialshare:(app.modules.socialshare={},app.modules.socialshare.module=socialshare);
 /*_____*/ 
var filluser=function(){var x=new nModule,t={},a=function(e){var i,o,a,n,t=deep(e,"history"),r=null,l=function(n){x.app.ref?x.sdk.users.get(x.app.ref,function(){var e=deep(x,"sdk.users.storage."+x.app.ref+".name");n&&n(e)}):n&&n(null)},s=!1,c=!1,p=function(){var e=x.app.ref||"",n="Overall";return-1<e.indexOf("author")&&(n="Account"),(-1<e.indexOf("&s=")||-1<e.indexOf("&v="))&&(n="Post"),n},f={captcha:{id:"captcha",render:"captcha",nextindex:"email",prev:function(t){var e=x.sdk.address.pnet().address;x.app.settings.get(e,"request")||""?k.next():v.check(function(e){e?k.next():x.sdk.captcha.get(function(e,n){n?k.to("network"):e.done?(k.next(),v.request()):(f.captcha.current=e,t())},!0)},!0)},after:function(e,n){var t=e.find(".ucaptchainput"),a=e.find(".redo"),o=e.find(".addCaptcha"),r="";t.focus();var i=function(e){return!!/^[a-zA-Z0-9]{4,}$/.test(e)};t.on("keyup",function(){r=$(this).val(),i(r)?o.removeClass("disabled"):o.addClass("disabled")}),o.on("click",function(){var e=t.val();i(e)&&x.sdk.captcha.make(e,function(e,n){if("captchashots"==e)return sitemessage("Words doesn't match"),void k.redo();e?sitemessage("Words doesn't match"):n.done&&(k.next(),v.request())},!0)}),a.one("click",function(){x.app.platform.m.log("userwisard_captcha_redo"),k.redo()})}},email:{id:"email",nextindex:"money",prev:function(e){h.referral(),localStorage.uei?k.next():e()},render:"email",after:function(e,n,t){var a=function(e){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)},o=e.find(".uemailinput"),r=e.find(".skip"),i=e.find(".addEmail"),s="";o.focus(),o.on("keyup",function(){s=$(this).val(),a(s)?(i.removeClass("disabled"),r.addClass("hidden"),i.html("Add email and continue")):(i.addClass("disabled"),r.removeClass("hidden"),i.html("Add email"))}),i.on("click",function(){var e=o.val();a(e)&&(x.app.platform.m.log("userwisard_email_add"),k.next(),localStorage.uei=!0,function(e,a){topPreloader(20);var o={Email:e};o.Action||(o.Action="ADDTOMAILLIST"),o.TemplateID="1005",o.ref="",l(function(e){var n="";o.ref+=p(),e&&(o.ref+=", "+e,n+='<p><a href="https://pocketnet.app/author?address='+x.app.ref+'">Referrer: '+e+"</a></p>");var t=deep(document,"referrer");t&&(n+='<p><a href="'+t+'">From: '+t+"</a></p>"),o.body=encodeURIComponent(n),$.ajax({type:"POST",url:"https://pocketnet.app/Shop/AJAXMain.aspx",data:o,dataType:"json",success:function(){topPreloader(100),a&&a()}})})}(e,function(){}))}),r.one("click",function(){x.app.platform.m.log("userwisard_email_skip"),localStorage.uei=!0,k.next()})}},money:{id:"money",nextindex:"settings",prev:function(n){v.check(function(e){if(e)k.next();else{if(s)return void k.to("captcha");if(c)return void k.to("moneyfail");n()}})},ret:!1,render:"money",after:function(n,t,e){k.timer(n.find(".time"),e||59,function(){v.check(function(e){!e||"money"!=d&&"captcha"!=d?(x.app.platform.m.log("userwisard_modey_delay"),n.find(".subcaption").html(x.app.localization.e("wesentmoneydelay")),f.money.after(n,t,30)):(x.app.platform.m.log("userwisard_money_success"),k.next())},!0)})}},settings:{id:"settings",nextindex:"welcome",prev:function(e){e(),x.app.platform.m.log("userwisard_account")},render:"settings",after:function(e,n){},next:!0},welcome:{id:"welcome",prev:function(e){e()},render:"welcome",after:function(e){x.app.platform.m.log("userwisard_success"),setTimeout(function(){x.nav.api.go({href:"index?r=recommended",history:!0,open:!0})},1500),e.find(".welcome").on("click",function(){if("_this"==deep(a,"successHref")){var e=deep(n,"container.close");e&&e(),a.signInClbk&&a.signInClbk()}else x.nav.api.go({href:"index?r=recommended",history:!0,open:!0})})}},network:{id:"network",prev:function(e){x.app.platform.m.log("userwisard_network_fail"),e()},render:"network",after:function(e){x.app.errors.clbks.filluser=function(){app.errors.state.proxy||app.errors.state.proxymain||("network"!=d||x.app.platform.loadingWithErrors||k.to("captcha"),delete x.app.errors.clbks.filluser)}}},moneyfail:{id:"moneyfail",prev:function(e){e()},render:"moneyfail",after:function(n){var t=function(){x.app.platform.sdk.node.transactions.get.allBalance(function(e){n.find(".balance").html("Balance: "+x.app.platform.mp.coin(e)+" POC")})};t(),n.find(".check").on("click",function(){topPreloader(20),x.app.platform.sdk.node.transactions.get.allBalance(function(e){topPreloader(100),0<e&&("moneyfail"==d&&k.to("settings"),delete x.app.platform.sdk.node.transactions.clbks.moneyfail),t()}),x.app.platform.sdk.node.transactions.clbks.moneyfail=function(){x.app.platform.sdk.node.transactions.get.allBalance(function(e){0<e&&("moneyfail"==d&&k.to("settings"),delete x.app.platform.sdk.node.transactions.clbks.moneyfail)})}})}}},d=null,u=_.map(f,function(e,n){return n}),m=function(n){return _.findIndex(u,function(e){return e==n})},h={referral:function(){l(function(e){var n=p(),t=deep(document,"referrer");x.app.platform.m.log("registration_referal_name",e),x.app.platform.m.log("registration_referal_type",n),t&&x.app.platform.m.log("registration_referal_referrer",t)})}},v={request:function(o){x.sdk.users.requestFreeMoney(function(e,n){var t=x.sdk.address.pnet().address,a=x.app.settings.get(t,"request")||"";e||a?(x.app.settings.set(t,"request","true"),v.follow(),o&&o(!0)):("captcha"==n&&(s=!0,"money"!=d&&"captcha"!=d||k.to("captcha")),"error"==n&&(c=!0,"money"!=d&&"captcha"!=d||k.to("captcha")),o&&o(!1,"err"))})},check:function(n,e){x.app.platform.sdk.node.transactions.get.allBalance(function(e){n&&n(0<e)},e)},follow:function(){x.app.platform.sdk.node.transactions.clbks.filluser||(x.app.platform.sdk.node.transactions.clbks.filluser=function(){delete x.app.platform.sdk.node.transactions.clbks.filluser,v.check(function(e){e?"money"==d&&(x.app.platform.m.log("userwisard_money_success"),k.next()):v.follow()})})}},k={to:function(e,n){d=e,k.makeStep(n)},redo:function(e){k.makeStep(function(){})},next:function(e){(d=d?f[d].nextindex:f.captcha.id)&&k.makeStep(function(){})},makeStep:function(e){var t=f[d];t&&t.prev(function(){i.c&&(i.c.attr("step",t.id),y.panel(t,function(n){y.step(t,function(e){_scrollTop(e,r),n.find(".elpanel").addClass("active"),t.after(e,n)})}))})},timer:function(a,o,e){var r=new CircularProgress({radius:120,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 56px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#5D5D5D",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}});a.find(".circle").html(r.el);var n=function(e){var n=secInTime(e/1e3).split(":");a.find(".t .min").html(n[0]),a.find(".t .sec").html(n[1]),r.options.text={value:""};var t=100*(1-e/(1e3*o));t<0&&(t=0),r.update(t)};timer=new Timer({ontick:function(){n(timer.getDuration())},onend:function(){e&&e()}}),timer.start(o),n(timer.getDuration())}},g=function(){if(d){var e=f[d],n=i.c.find('.step[step="'+e.id+'"] .stepBody').closest(".step"),t=i.c.find(".stepsWrapperLine"),a=n.closest(".stepsWrapper").width();i.c.find(".step").width(a),t.css("margin-left","-"+m(d)*a+"px"),t.width(a*_.toArray(f).length)}},y={step:function(e,a){i.c.find(".step").removeClass("active");var n=i.c.find('.step[step="'+e.id+'"] .stepBody'),o=n.closest(".step"),r=i.c.find(".stepsWrapperLine");y[e.render](n,function(e){var n=o.closest(".stepsWrapper").width();i.c.find(".step").width(n),r.width(n*_.toArray(f).length);var t="-"+m(d)*n+"px";r.css("margin-left",t),o.closest(".step").addClass("active"),a&&a(e)})},panel:function(e,n){x.shell({name:"panel",el:i.panel,data:{step:e}},function(e){n&&n(e.el)})},captcha:function(e,n){x.shell({name:"captcha",el:e,data:{captcha:f.captcha.current}},function(e){n&&n(e.el)})},email:function(e,n){x.shell({name:"email",el:e,data:{}},function(e){n&&n(e.el)})},welcome:function(e,n){x.shell({name:"welcome",el:e,data:{}},function(e){n&&n(e.el)})},moneyfail:function(e,n){x.shell({name:"moneyfail",el:e,data:{}},function(e){n&&n(e.el)})},network:function(e,n){x.shell({name:"network",el:e,data:{}},function(e){n&&n(e.el)})},money:function(e,n){x.shell({name:"money",el:e,data:{}},function(e){n&&n(e.el)})},settings:function(t,a,e){x.nav.api.load({open:!0,id:"test",el:t,essenseData:{wizard:!0,panel:i.panel,success:function(){k.next()}},clbk:function(e,n){o=n,a&&a(t)}})}},w=function(){};return{primary:t,getdata:function(n,e){c=s=!1,a=e.settings.essenseData||{},d=null;var t={steps:f};x.app.user.validate()?x.app.nav.api.load({open:!0,href:"index",history:!0}):x.app.errors.connection()?x.app.nav.api.load({open:!0,href:"userpage?id=test",history:!0}):x.fastTemplate("panel",function(e){n(t)})},destroy:function(){window.removeEventListener("resize",g),o&&o.destroy(),o=null,i={},$("html").removeClass("fillinguser")},init:function(e){w(),(i={}).c=e.el.find("#"+x.map.id),i.panel=i.c.find(".panelWrapper"),window.addEventListener("resize",g),n=e,k.next(),(r=i.c.closest(".wndcontent")).length||(r=null),$("html").addClass("fillinguser"),e.clbk(null,e)}}};return x.run=function(e){var n=x.addEssense(t,a,e);x.init(n,e)},x.stop=function(){_.each(t,function(e){e.destroy()})},x}();"undefined"!=typeof module?module.exports=filluser:(app.modules.filluser={},app.modules.filluser.module=filluser);
 /*_____*/ 
var test = (function(){

	var self = new nModule();

	var mdl = self;

	var essenses = {};

	var Essense = function(p){

		var primary = deep(p, 'history');

		var el, lastTransaction, ed, ref, plissing; 

		var firstTime = false;

		var tempInfo = {
			language : /*self.app.localization.key ||*/ 'en'
		}

		var changedLoc = false;

		var actions = {		

			valid : function(v1, v2){
				if(!actions.equal((v1), (v2))){

					if(trim(v1.name) && v1.image) return true

				}
			},

			equal : function(v1, v2){

				var a = function(o){
					return 'name:' + (trim(o.name) || "") + 'image:' + (o.image || "") + 'about:' + (trim(o.about) || "") + 'site:' + (trim(o.site) || "")  + 'language:' + (o.language || "") + "addresses:" + JSON.stringify(o.addresses || [])
				}

				return a(v1) == a(v2)
			},
			cancel : function(){
				actions.userOptions()

				actions.upanel();

				renders.icon();

				renders.options();
			},
			save : function(clbk){

				self.sdk.users.checkFreeRef(self.app.platform.sdk.address.pnet().address, function(resref, err){				

					if(el.c.find('.userPanel').hasClass('loading')){
						return
					}

					if(actions.equal(tempInfo, self.app.platform.sdk.user.storage.me)){
						sitemessage(self.app.localization.e('uchanges'))

						return
					}

					if(!actions.valid(tempInfo, self.app.platform.sdk.user.storage.me)){
						sitemessage(self.app.localization.e('uchangesvalid'))

						if(!trim(tempInfo.name)){	
							var pn = el.c.find('[parameter="name"] input')

							pn.focus()

							_scrollTo(pn)
						}
						else{
							if(!tempInfo.image){	
								var pn = el.c.find('.fileUploader')

								_scrollTo(pn)
							}	

						}

							

						return
					}

					var userInfo = new UserInfo();

						userInfo.name.set(trim(tempInfo.name));
						userInfo.language.set(tempInfo.language);
						userInfo.about.set(trim(tempInfo.about));
						userInfo.site.set(trim(tempInfo.site));
						userInfo.image.set(tempInfo.image);
						userInfo.addresses.set(tempInfo.addresses);

						userInfo.ref.set(deep(ref, 'address') || '');

					var err  = userInfo.validation()

					if (err){

						el.c.find('.errorname').fadeIn();

						if(err == 'namelength'){
							
							el.c.find('.errorname span').html('The name length can be more than 20 symbols');
							
						}

						if(err == 'pocketnet'){
							
							el.c.find('.errorname span').html('To avoid user confusion using Pocketnet in name is reserved');
							
						}


						var pn = el.c.find('[parameter="name"] input')

							pn.focus()

							_scrollTo(pn)

						return false;
					}

					topPreloader(40)

					el.c.find('.userPanel').addClass('loading')

					el.upanel.addClass('loading')

					

					
					el.c.find('.errorname').fadeOut();

					userInfo.uploadImage(function(){


						self.sdk.node.transactions.create.commonFromUnspent(

							userInfo,

							function(tx, error){

								el.upanel.removeClass('loading')

								el.c.find('.userPanel').removeClass('loading')

								topPreloader(100)

								if(!tx){

									self.app.platform.errorHandler(error, true)	
								}
								else
								{

									successCheck()

									delete self.sdk.usersl.storage[self.app.platform.sdk.address.pnet().address];
									delete self.sdk.users.storage[self.app.platform.sdk.address.pnet().address];


									self.app.platform.sdk.user.storage.me = tx
									
									tempInfo = _.clone(self.app.platform.sdk.user.storage.me)
									
									actions.upanel()

									if (ref && firstTime){
										localStorage[self.app.platform.sdk.address.pnet().address + 'subscribeRef'] = ref.address										
									}

									if(ref && resref && firstTime){
										var refaddress = deep(ref, 'address');		

										self.sdk.users.requestFreeRef(refaddress, function(res, err){
											console.log(res, err)
										})
									}

									self.app.platform.sdk.users.getone(self.app.platform.sdk.address.pnet().address, function(){
										self.app.reloadModules(function(){

											if (primary){
	
												self.nav.api.go({
													href : 'index',
													history : true,
													open : true
												})	
	
											}
											
											else
											{	
												if (ed.success){
													ed.success()
												}
												else
												{
													if (clbk)
														clbk()
												}
											}
	
										})
									})

									

									
								}

							},

							/*{
								pseudo : true
							}*/
						
						)
					})

				})
				
		
			},
			upload	: function(file, clbk){

				topPreloader(20);

				var images = [{
					original : file.base64,
					index : 0
				}]

				self.nav.api.load({
					open : true,
					id : 'imageGalleryEdit',
					inWnd : true,

					essenseData : {
						edit : true,
						initialValue : 0,
						images : images,

						apply : true,

						crop : {
							aspectRatio : 1 / 1,
							style : 'round apply',
							autoCropArea : 0.9,
						},

						success : function(i, editclbk){

							images[0].original

							resize(images[0].original, 100, 100, function(resized){
								var r = resized.split(',');

								editclbk();

								if (r[1]){

									tempInfo.image = resized;

									renders.icon()

									actions.upanel()	
									
									if (clbk)
										clbk()

								}
								else
								{
									topPreloader(100);
								}

								
							})

						}
					}
				})


				
			},
			upanel : function(){

				if(!el.upanel) return

				if(_.toArray((self.app.platform.sdk.node.transactions.temp.userInfo || {})).length > 0){

					el.upanel.addClass('wait')

					el.c.find('.caption').remove()

				}
				else{
					el.upanel.removeClass('wait')

					if(actions.equal(tempInfo, self.app.platform.sdk.user.storage.me) || !actions.valid(tempInfo, self.app.platform.sdk.user.storage.me)){
						
						el.upanel.removeClass('changes')
					}
					else
					{
						el.upanel.addClass('changes')
					}
				}

				
				
			},

			clear : function(){
				actions.userOptions();
				renders.caption();
			},

			userOptions : function(){

				tempInfo = _.clone(self.app.platform.sdk.user.storage.me)

				_.each(userOptions, function(parameter, id){
					var value = self.app.platform.sdk.user.storage.me[parameter.id];

					if(id == 'addresses'){
						value = _.clone(self.app.platform.sdk.user.storage.me[parameter.id]);
					}
					
					parameter.value = value || parameter.defaultValue || ''
					tempInfo[parameter.id] = parameter.value

					parameter._onChange = function(value){

						if(id == 'addresses'){
							tempInfo[parameter.id] = _.clone(value);
						}
						else
						{
							tempInfo[parameter.id] = trim(value);
						}

						

						actions.upanel()

						if (id == 'language'){
							var a = self.app.localization.available[value];

							if (a && a.key != self.app.localization.key)
							{
								self.app.localization.lightSet(a.key);
							}
						}

						if (id == 'name'){

							var hash = tempInfo[parameter.id].toLowerCase().replace(/[^a-z]/g,'')

							if (hash.indexOf('pocketnet') > -1) {

								el.c.find('.errorname').fadeIn();
								el.c.find('.errorname span').html('To avoid user confusion using Pocketnet in name is reserved');	

								return
							}
							
							if (tempInfo[parameter.id].length > 20){
								el.c.find('.errorname').fadeIn();
								el.c.find('.errorname span').html('The name length can be more than 20 symbols');	
							}
							else
							{
								el.c.find('.errorname').fadeOut();

								self.app.platform.sdk.users.nameExist(tempInfo[parameter.id], function(exist){

									if(!exist || exist == self.app.platform.sdk.address.pnet().address){
										el.c.find('.errorname').fadeOut();
									}
									else
									{
										el.c.find('.errorname').fadeIn();
										el.c.find('.errorname span').html('This username is taken in Pocketnet');									
									}
								})	
							}
						}
					}

					//if(id == 'ref'){

						//self.app.platform.api.inputs.user(parameter)

					//}
				})
			},

			signout : function(){
				self.app.user.signout();

				self.app.reload({
					href : 'authorization'
				});
			},
		}

		var userOptions = {
			name : new Parameter({
				name : 'Nickname',
				id : 'name',
				type : "NICKNAME",
				onType : true,
				require : true
			}),

			language : new Parameter({
				name : self.app.localization.e('ulanguage'),
				id : 'language',
				type : "VALUES",
				defaultValue : /*self.app.localization.key || */'en',
				possibleValues : ['en'/*, 'ru'*/],
				possibleValuesLabels : ['English'/*, 'Русский'*/],
			}),

			about : new Parameter({
				name : self.app.localization.e('uabout'),
				id : 'about',
				type : "TEXT",
				onType : true,
				
				placeholder : 'Please write a few words about yourself to help people decide if they want to follow you'
			}),

			site : new Parameter({
				name : self.app.localization.e('uwebsite'),
				id : 'site',
				type : "STRINGANY",
				onType : true,
				value : ''
			}),

			addresses : new function(){

				var _self = this;

				_self.id = 'addresses';
				_self.name = self.app.localization.e('uaddresesd')
				_self.value = [];

				_self.defaultValue = [];

				_self.remove = function(currency, address){
					removeEqual(_self.value, {
						currency : currency,
						address : address
					})

					if (_self._onChange)
						_self._onChange(_self.value)

					_self.addedAddresses();
				}

				_self.add = function(v){


					_self.value.push(v)

					if (_self._onChange)
						_self._onChange(_self.value)

					_self.addedAddresses();

				}

				_self.addDialog = function(){

					var validate = function(cur, address){

						if(address.length > 0){
							return true
						}
						else
						{
							return false
						}

						
					}

					mdl.fastTemplate('addaddress', function(rendered){

						dialog({
							html : rendered,

							wrap : true,

							success : function(d){

								var currency = d.el.find('.currency').val();
								var address = d.el.find('.address').val();

								if(validate(currency, address)){


									_self.add({
										currency : currency,
										address : address
									})

									return true;

								}
							},

							clbk : function(_el){

								var currency = _el.find('.currency');
								var address = _el.find('.address');
								var b = _el.find('.btn1');


								var vl = function(){
									var c = currency.val();
									var a = address.val();

									if(validate(c, a)){
										b.removeClass('disabled')

										return true;
									}
									else
									{
										b.addClass('disabled')
										return false;
									}
								}

								address.focus()
								address.on('change', vl)
								address.on('keyup', vl)

								currency.on('change', vl)
								currency.on('keyup', vl)

								vl()
							},

							class : "one addaddressDialog"
						})

					}, {
					})
				}

				_self.removeEvent = function(){
					var currency = $(this).closest('.addedAddress').attr('currency')
					var address = $(this).closest('.addedAddress').attr('address')

					_self.remove(currency, address)
				}

				_self.addedAddresses = function(){

					/* 1F1tAaz5x1HUXrCNLbtMDqcw6o5GNn4xqX */

					var h = '';

					_.each(_self.value, function(v){
					
						if(!v || !v.currency) return

						h += '<div class="addedAddressWrapper">'
							h += '<div class="addedAddress table" currency="'+v.currency+'" address="'+v.address+'">'

							h += 	'<div class="currencyWrapper">'	
							h += 		v.currency.toUpperCase()
							h += 	'</div>'

							h += 	'<div class="addressWrapper">'	
							h += 		v.address
							h += 	'</div>'

							h += 	'<div class="panelWrapper">'	
							h += 		'<div class="item remove">'	
							h += 			'<i class="far fa-times-circle"></i>'	
							h += 		'</div>'
							h += 	'</div>'

							h += '</div>'
						h += '</div>'
					})
					
					_self.el.find('.addedAddressesWrapper').html(h)

					_self.el.find('.addedAddressesWrapper .remove').on('click', _self.removeEvent)
				}



				_self.init = function(_el){

					_self.defaultValue = [];

					_self.el = _el.find('.adressesInput')

					_self.addedAddresses();

					_self.el.find('.addaddress').on('click', _self.addDialog)
				}	

				_self.input = function(){
					var h = ''

					h += '<div class="adressesInput">'
					h += 	'<div class="addaddressWrapper">'
					h += 		'<div class="addaddress">'
					h += 			'<i class="fas fa-plus"></i>'
					h += 		'</div>'
					h += 	'</div>'
					h += 	'<div class="addedAddressesWrapper">'
					h += 	'</div>'
					h += '</div>'

					return h;
				}

				return _self
			},

			/*ref : new Parameter({
				name : "Referal",
				id : 'ref',
				type : "BOOLEAN",
				onType : true,
				value : ''
			}),*/
			
		}

		var privateInformation = {
			/*sex : new Parameter({
				name : "Sex",
				id : 'sex',
				type : "VALUES",
				defaultValue : 'notspecified',
				possibleValues : ['men', 'woman', 'notspecified'],
				possibleValuesLabels : ['Not Specified', 'Man', 'Woman'],
			})*/
		}

		var events = {
			signout : function(){
				actions.signout()
			},
			save : function(){
				actions.save()
			},
			cancel : function(){
				actions.cancel()
			},
			importAddress : function(){

				var address = self.app.platform.sdk.address.pnet()
				
				topPreloader(30);

				self.app.platform.sdk.node.account.import(address.address, function(){

					topPreloader(100);

					sitemessage("Address " + address.address + " was successfully imported")

				})
			}
		}

		var setNode = null;
		var setAddressType = null;

		var renders = {
			options : function(clbk){

				self.shell({

					name :  'options',
					el :   el.options,
					data : {
						tempInfo : tempInfo,
						userOptions : userOptions
					},

				}, function(_p){

					ParametersLive(_.toArray(userOptions), _p.el)

					userOptions.addresses.init(_p.el)

					if (clbk)
						clbk();

				})
			},
			icon : function(clbk){
				self.shell({

					name :  'icon',
					el :   el.icon,
					data : {
						tempInfo : tempInfo,
						ed : ed
					},

				}, function(_p){


					initUpload({
						el : _p.el.find('.pgroup'),
			
						ext : ['png', 'jpeg', 'jpg'],

						dropZone : el.c,

						multiple : false,

						action : function(file, clbk){

							actions.upload(file, function(){		
								if (plissing)
									plissing.destroy()

								console.log("el.c.find('.nickname input')", el.c.find('.nickname input'))
									_scrollTo(el.c.find('.nickname input').focus());
								

								if (clbk)
									clbk();

							})
							
						}
					})

					if (ed.wizard && !tempInfo.image)

						plissing = self.app.platform.api.plissing({
							el : _p.el.find('.iconWrapper'),
							text : "Upload image"
						})

					if (clbk)
						clbk();

				})
			},
			unspent : function(unspent, clbk){
				self.shell({

					name :  'unspent',
					el :   el.unspent,
					data : {
						unspent : unspent
					},

				}, function(_p){

					if (clbk)
						clbk();

				})
			},

			caption : function(unspent, clbk){

				return

				self.shell({

					name :  'caption',
					el :   el.caption,
					data : {
						p2pkh : self.app.platform.sdk.address.pnet(),
						tempInfo : tempInfo
					},

				}, function(_p){					

					if (clbk)
						clbk();

				})
			},

			address : function(){
				el.c.find('.adr').html(bitcoin.payments[self.app.platform.addressType]({ pubkey: self.app.user.key.value}))
			}
			
		}

		var state = {
			save : function(){

			},
			load : function(){
				
			}
		}

		var initEvents = function(){
			el.import.on('click', events.importAddress)
			el.showhidetestpanel.on('click', function(){
				$(this).closest('.testPanel').toggleClass('active')
			})

			el.upanel.find('.cancel').on('click', events.cancel)
			el.upanel.find('.save').on('click', events.save)

			ParametersLive([setNode, setAddressType], el.c)			

			el.signout.on('click', events.signout)

			el.c.find('.refRemove').on('click', function(){
				ref = null;

				delete localStorage['ref']

				el.c.find('.referalMaketWrapper').remove()
			})
		}

		var make = function(){

			renders.caption()

			renders.icon();

			renders.options();

			self.sdk.node.transactions.get.unspent(function(unspent){
				renders.unspent(unspent)
			})


			self.app.platform.ws.messages.transaction.clbks.utemp = function(data){
				if(data.temp){
					if(data.temp.type == 'userInfo'){
						actions.upanel()
					}
				}
			}
		}

		var prepare = function(){

			var pv = _.map(self.app.platform.nodes, function(n, i){
				return i.toString()
			})

			var pvl = _.map(self.app.platform.nodes, function(n, i){
				return n.full
			})

			setNode = new Parameter({
				type : "VALUES",
				name : "setNode",
				id : 'setNode',
				possibleValues : pv,
				possibleValuesLabels : pvl,
				defaultValue : "1",
			}),

			setNode.value = self.app.platform.nodeid

			setNode._onChange = function(value){
				self.app.platform.nodeid = value;

				self.app.platform.state.save()
			}

			setAddressType = new Parameter({
				type : "VALUES",
				name : "setAddressType",
				id : 'setAddressType',
				possibleValues : self.app.platform.addressTypes,
				possibleValuesLabels : ['P2PKH', 'P2SH'/*, 'P2WPKH'*/],

				defaultValue : "p2sh"
			}),

			setAddressType.value = self.app.platform.addressType
			

			setAddressType._onChange = function(value){

				self.app.platform.addressType = value;

				self.app.platform.state.save()

				self.user.address.set(self.app.platform.sdk.address.pnet().address)

				self.app.reload();

			}

			actions.userOptions()

		}

		var freeMoney = function(){			

			self.app.platform.sdk.users.checkFreeMoney(self.app.platform.sdk.address.pnet().address, function(res){
				
			})
		}

		var testletter = function(clbk){
			var _p = {
				Email : 'maxgrishkov@gmail.com'
			}

			_p.Action || (_p.Action = 'ADDTOMAILLIST');
			_p.TemplateID = '1005'

			_p.ref = ''

			var getrefname = function(clbk){
				if (self.app.ref){
					self.sdk.users.get(self.app.ref, function(){

						var name = deep(self, 'sdk.users.storage.' + self.app.ref + '.name');

						if (clbk)
							clbk(name)
					})
				}
				else{
					if (clbk)
						clbk(null)	
				}
			}

			var gettype = function(){
				var fref = self.app.ref || '';


				var type = 'Overall'

				if(fref.indexOf('author') > -1) type='Account'
				if(fref.indexOf('&s=') > -1 || fref.indexOf('&v=') > -1) type='Post'

				return type
			}

			getrefname(function(name){

				var body = ''

				_p.ref += gettype()

				if (name) {
					
					_p.ref += ', ' + name

					body += '<p><a href="https://pocketnet.app/author?address='+self.app.ref+'">Referrer: '+name+'</a></p>'
				}

				var r = deep(document, 'referrer')

				if (r) {
					body += '<p><a href="'+r+'">From: '+r+'</a></p>'
				}

				_p.body = encodeURIComponent(body)

				console.log(_p)

				return

				$.ajax({
					type: 'POST',
					url: 'https://pocketnet.app/Shop/AJAXMain.aspx',
					data: _p,
					dataType: 'json',
					success : function(){
	
						topPreloader(100)
	
						if (clbk)
							clbk();
	
					}
				});
			})

			
			
		}
		
		return {
			primary : primary,

			getdata : function(clbk, p){

				//testletter()

				ref = null
				changedLoc = true;

				ed = p.settings.essenseData;

				self.app.platform.sdk.user.get(function(){

					if(_.isEmpty(self.app.platform.sdk.user.storage.me)){
						firstTime = true

						var _r = self.app.ref;

						if (_r && _r != self.app.platform.sdk.address.pnet())

						ref = _r;
					}

					prepare();

					var data = {};

						data.p2pkh = self.app.platform.sdk.address.pnet()

						data.setNode = setNode;
						data.setAddressType = setAddressType;
						data.userOptions = userOptions;
						data.tempInfo = tempInfo;
						data.firstTime = firstTime;
						data.ref = ref;

					if(ref){
						self.sdk.users.get(ref, function(){

							var address = ref;

							ref = self.sdk.users.storage[address] || null;

							if(ref) ref.address = address;
							
							data.ref = ref;

							clbk(data);

						})
					}
					else
					{
						clbk(data);
					}

					

				})

			},

			destroy : function(){
				el = {};



				if(self.app.platform.sdk.user.storage.me && !actions.equal(tempInfo, self.app.platform.sdk.user.storage.me)){
					
					return function(clbk){


						var locF = function(){

							delete self.app.platform.ws.messages.transaction.clbks.utemp
							
							clbk()

						}

						dialog({
							html : self.app.localization.e('usavechanges'),
							btn1text : self.app.localization.e('dyes'),
							btn2text : self.app.localization.e('dno'),
							success : function(){
								actions.save(locF)
							},

							fail : function(){

								tempInfo = _.clone(self.app.platform.sdk.user.storage.me)
								
								locF()
							}
						})

					}

				}

				return null;
			},
			
			init : function(p){

			
				state.load();

				el = {};
				el.c = p.el.find('#' + self.map.id);
				el.transaction = p.el.find('.transactionInfo');
				el.unspent = p.el.find('.unspentlist');
				el.showhidetestpanel = p.el.find('.showhidetestpanel')
				el.import = p.el.find('.import');
				el.caption = el.c.find('.bgCaption');
				el.icon = el.c.find('.pgroupIconWrapper');

				el.usericon = el.c.find('.usericon');
				el.options = el.c.find('.optionsParameters');
				el.upanel = ed.panel || el.c.find('.upanel');

				el.signout = el.c.find('.signout')

				initEvents();

				actions.upanel();

				make();

				p.clbk(null, p);
			}
		}
	};



	self.run = function(p){

		var essense = self.addEssense(essenses, Essense, p);

		self.init(essense, p);

	};

	self.stop = function(){

		var s = null

		_.each(essenses, function(essense){

			var d = essense.destroy();

			if (d){
				s = d;
			}

		})

		if(!s) return;

		return {
			action : s
		};

	}

	return self;
})();


if(typeof module != "undefined")
{
	module.exports = test;
}
else{

	app.modules.test = {};
	app.modules.test.module = test;

}
 /*_____*/ 
var article=function(){var g=new nModule,t={},n=function(e){var o,c,r,t,a,n=deep(e,"history"),i=/[,.!?;:()<> \n\r]/g,p={message:g.app.localization.e("emptymessage")},d={newart:function(){return g.app.platform.sdk.articles.empty()},complete:function(){r.save&&r.save(c),s.close(),r.complete&&r.complete(c)},change:function(e){c.content=e,c.time=Math.floor((new Date).getTime()/1e3),r.save&&r.save(c)},changecaption:function(e){c.caption.value=e,c.time=Math.floor((new Date).getTime()/1e3),r.save&&r.save(c)},trx:function(i,s){o.c.addClass("loading"),r.share&&(i.aliasid=r.share.aliasid),g.sdk.node.transactions.create.commonFromUnspent(i,function(e,a){if(topPreloader(100),o.c.removeClass("loading"),e)try{var t=new pShare;t._import(e,!0),t.temp=!0,t.address=e.address,i.aliasid&&(t.edit="true"),g.app.platform.sdk.node.shares.add(t),console.log("alias",t),c.txid=t.txid,c.ptime=Math.floor((new Date).getTime()/1e3),g.app.platform.sdk.user.survey(),d.complete()}catch(e){console.log(e)}else if(s)s(!1,p[a]);else{var n=g.app.platform.errorHandler(a,!0);n&&sitemessage(n)}},e)},fromShare:function(e){var a=g.app.platform.sdk.articles.empty();return a.caption.value=e.caption.v,a.content=[{value:e.message.v}],a},add:function(){var e=new Share,a=g.app.platform.sdk.articles.echo(c);e.message.set(a),e.caption.set(c.caption.value),e.images.set(g.app.platform.sdk.articles.getImages(a)),e.tags.set(d.tagsFromText(a)),e.settings.v="a",e.settings.videos=g.app.platform.sdk.articles.getVideos(a);var t=e.validation();if(t)p[t]&&sitemessage(p[t]);else{var n="Do you really want to publish this article?";r.share&&(n="Do you really want to change and publish this article?"),dialog({html:n,btn1text:g.app.localization.e("dyes"),btn2text:g.app.localization.e("dno"),class:"zindex",success:function(){a=filterXSS(a,{stripIgnoreTag:!0,whiteList:{a:["href","title","target"],br:["style"],b:["style"],span:["style"],figure:["style"],figcaption:["style","class"],i:["style"],img:["src","width","height"],div:["class","data-plyr-provider","data-plyr-embed-id"],p:[],ul:[],ol:[],li:[],h2:[],h1:[],h3:[],h4:[],h5:[],em:[],u:[],blockquote:[],strong:[],picture:["img-type"],source:["srcset","type"]}}),e.message.set(a),d.trx(e)}})}},tagsFromText:function(e){var a=e.split(i),t=_.filter(a,function(e){if("#"==e[0])return!!(e=e.replace(/#/g,""))});return _.each(t,function(e,a){t[a]=e.replace(/\#/g,"")}),t}},s={authorclose:function(){g.nav.api.load({open:!0,href:"author?address="+g.app.user.address.value.toString("hex"),history:!0}),g.closeContainer(),r.closeContainer&&r.closeContainer()},changecaption:function(){var e=$(this).val();d.changecaption(e)},change:function(){a=slowMade(function(){var e=g.app.platform.sdk.articles.lightVideo(t.serialize());d.change(e)},a,300)},close:function(){r.close&&r.close(),g.closeContainer()},add:function(){d.add()},goto:function(){c.txid&&(g.closeContainer(),r.closeContainer&&r.closeContainer(),g.nav.api.load({open:!0,href:"index?s="+c.txid,history:!0}))}},f=function(e,a){o.caption.val(e.caption.value)},u=function(){};return{primary:n,getdata:function(e,a){r=a.settings.essenseData||{},c=r.art||d.newart(parameters().aid),r.share&&(c=d.fromShare(r.share)),console.log(c),e({art:c,ed:r})},destroy:function(){g.app.nav.api.history.removeParameters(["aid"]),o={}},init:function(e){var a;u(),(o={}).c=e.el.find("#"+g.map.id),o.caption=o.c.find(".caption"),o.content=o.c.find(".content"),o.back=o.c.find(".back"),o.add=o.c.find(".add"),o.goto=o.c.find(".goto"),o.back.on("click",s.close),o.caption.on("keyup",s.changecaption),o.add.on("click",s.add),o.goto.on("click",s.goto),o.c.find(".uic").on("click",s.authorclose),o.c.find(".username").on("click",s.authorclose),t=new MediumEditor(".edt",{delay:500,targetBlank:!0,toolbar:{buttons:["bold","italic","underline","anchor","quote"],diffLeft:25,diffTop:10},anchor:{placeholderText:"Type a link",customClassOption:"btn",customClassOptionText:"Create Button"},paste:{cleanPastedHTML:!0,cleanAttrs:["style","dir"],cleanTags:["label","meta"]},anchorPreview:{hideDelay:300},placeholder:{text:"Text",hideOnClick:!1}}),$(function(){$(".edt").mediumInsert({editor:t,addons:{images:{label:'<span class="fas fa-camera"></span>',deleteScript:function(e,a){g.sdk.imagesH.delete(e)},fileDeleteOptions:{},preview:!0,captions:!0,captionPlaceholder:"Type caption for image (optional)",autoGrid:3,formData:{},upload:function(e,n){resize(e,1080,1080,function(e){var a=e.split(",");a[1]&&g.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:a[1]},success:function(e){var a=deep(e,"data.link");if(a){var t=deep(e,"data.deletehash");t&&g.sdk.imagesH.add(a,t)}else a="https://pocketnet.app/img/imagenotuploaded.jpg";n&&n(a)},fail:function(){l="https://pocketnet.app/img/imagenotuploaded.jpg",n&&n(l)}})})},fileUploadOptions:{acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i},styles:{wide:{label:'<span class="fa fa-align-justify"></span>',added:function(e){},removed:function(e){}},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'},grid:{label:'<span class="fa fa-th"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(e){var a=$.Event("keydown");a.which=8,$(document).trigger(a)}}},messages:{acceptFileTypesError:"This file is not in a supported format: ",maxFileSizeError:"This file is too big: "},uploadCompleted:function(e,a){s.change()},uploadFailed:function(e,a){}},embeds:{label:'<span class="fas fa-play"></span>',placeholder:"Paste a YouTube, Vimeo link and press Enter",styles:{wide:{label:'<span class="fa fa-align-justify"></span>',added:function(e){},removed:function(e){}},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(e){var a=$.Event("keydown");a.which=8,$(document).trigger(a)}}}}}}),t.subscribe("editableKeyup",function(){s.change()}),t.subscribe("editablePaste",function(){s.change()}),t.subscribe("editableBlur",function(){s.change()}),f(c),Plyr.setup(".js-player",function(e){}),a&&a()}),e.clbk(null,e)},wnd:{class:"allscreen a100 article articlebtn"}}};return g.run=function(e){var a=g.addEssense(t,n,e);g.init(a,e)},g.stop=function(){_.each(t,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=article:(app.modules.article={},app.modules.article.module=article);
 /*_____*/ 
var connection=function(){var y=new nModule,a={},n=function(e){var p,o=deep(e,"history"),a=function(e,a){var o=y.app.platform.apiproxy;y.app.platform.apiproxy=e,y.app.platform.sdk.proxy.info(function(e,o){a&&a(!o)}),y.app.platform.nodeid=o},n=function(e,a){var o=y.app.platform.nodeid;y.app.platform.nodeid=e,y.app.platform.sdk.node.get.time(function(e,o){a&&a(!o)}),y.app.platform.nodeid=o},i=function(e,o){a(e,function(e){e?o&&o(!0):(dialog({html:"Unable connect to proxy",class:"one zindex"}),o&&o(!1))})},t=function(e,o){n(e,function(e){e?o&&o(!0):(dialog({html:"Unable connect to node",class:"one zindex"}),o&&o(!1))})},d={preloader:function(e){e?p.c.addClass("loading"):p.c.removeClass("loading")},addproxy:function(s,l){var r=!1,p="create",e="Add Proxy",o="Add";s&&(r=!0,p="update",e="Edit Proxy",o="Save"),s||(s={});var d={host:new Parameter({type:"STRING",name:"Node Host",id:"host",defaultValue:s.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:"RPC Port",id:"port",defaultValue:s.port||"8888",placeholder:"8888",require:!0}),ws:new Parameter({type:"STRING",name:"WS Port",id:"ws",defaultValue:s.ws||"8088",placeholder:"8088",require:!0})},a={close:{class:"close",html:'<i class="fas fa-times"></i> Close',fn:function(e,o){o.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+o,fn:function(a,n){var t={},o=!0;if(_.each(d,function(e){t[e.id]=e.value||s[e.id],e.value||(o=!1)}),o){t.user=!0,t.id=y.app.platform.sdk.proxy.makeid(t);var e=y.app.platform.sdk.proxy.all();_.find(e,function(e){return e.id==t.id})?sitemessage("You alredy have this proxy in list."):(a.find(".addproxy").addClass("loading"),i(t,function(e){if(a.find(".addproxy").removeClass("loading"),e){var o=y.app.platform.sdk.proxy[p](t,s.id);r||(y.app.platform.apiproxy=t,o=!0),l&&l(t,o),n.close()}}))}else sitemessage("Please fill all fields")}}};r&&(a.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> Delete',fn:function(e,o){dialog({class:"zindex",html:"Do you really want to delete this proxy from list?",success:function(){var e=y.app.platform.sdk.proxy.remove(s.id);l&&l(null,e),o.close()}})}}),y.shell({destroy:function(){},insert:"wnd",name:"addproxy",data:{parameters:d},wnd:{header:e,buttons:a,noInnerScroll:!0,class:"addproxywnd"}},function(e){ParametersLive(_.toArray(d),e.el),e.el.find(".host input").focus()})},proxieslist:function(e,t){var s=function(e){e.close(),d.connectproxy()},o={close:{class:"close",html:'<i class="fas fa-times"></i> Close',fn:function(e,o){console.log("close"),o.close()}},success:{class:"success",html:'<i class="fas fa-plus"></i> Add Proxy',fn:function(a,n){console.log("ADDDD"),d.addproxy(null,function(e,o){o?s(n):u.proxieslist(a,n)})}}},a={destroy:function(){},name:"proxieslist",data:{proxies:y.app.platform.sdk.proxy.all(),proxy:y.app.platform.apiproxy,ele:d.ele()},wnd:{header:"Proxies list",noInnerScroll:!0,class:"proxieslistwnd",buttons:o}};e?a.el=e:a.insert="wnd",y.shell(a,function(n){n.el.find(".proxy").length?n.el.find(".proxieslist").removeClass("empty"):n.el.find(".proxieslist").addClass("empty"),n.el.find(".name").on("click",function(){var e=$(this).closest(".proxy").hasClass("active"),o=$(this).closest(".proxy").attr("pid");if(e);else if("none"==o)dialog({html:"Do you really want to stop use Proxy. It is usafe (Http connection)",class:"zindex",success:function(){d.using(!0),u.active(),(n.container||t).close()}});else{var a=y.app.platform.sdk.proxy.find(o);n.el.find(".proxieslist").addClass("loading"),i(a,function(e){n.el.find(".proxieslist").removeClass("loading"),e&&y.app.platform.sdk.proxy.changeWithDialog(a,function(){(n.container||t).close(),u.proxy(),u.active()})})}}),n.el.find(".edit").on("click",function(){var e=$(this).closest(".proxy").attr("pid"),o=y.app.platform.sdk.proxy.find(e);o&&d.addproxy(o,function(e,o){o?s(n.container||t):d.proxieslist(a.el)})})})},addnode:function(s,e){var l=!1,o="create",a="Add Node",n="Add";s&&(l=!0,o="update",a="Edit Node",n="Save"),s||(s={});var r={saveto:new Parameter({type:"VALUES",name:"Save",id:"saveto",defaultValue:"proxy",possibleValues:["proxy","locally"],possibleValuesLabels:["On Proxy","Locally"],require:!0}),host:new Parameter({type:"STRING",name:"Node Host",id:"host",defaultValue:s.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:"RPC Port",id:"port",defaultValue:s.port||"38081",placeholder:"38081",require:!0}),ws:new Parameter({type:"STRING",name:"WS Port",id:"ws",defaultValue:s.ws||"8087",placeholder:"8087",require:!0}),nodename:new Parameter({type:"STRING",name:"Name Of Node",id:"nodename",defaultValue:(s.nodename||(y.app.platform.api.clearname(deep(app,"platform.sdk.user.storage.me.name"))||"New")+" node").replace(/\+/g," "),placeholder:"Please enter Node Name",require:!0}),rpcuser:new Parameter({type:"STRING",name:"RPC login",id:"rpcuser",placeholder:"Login for PRC authorization",defaultValue:s.rpcuser||"",require:!0}),rpcpwd:new Parameter({type:"STRING",name:"RPC password",id:"rpcpwd",defaultValue:s.rpcpwd||"",placeholder:"Password for PRC authorization",require:!0})};!y.app.platform.dontuseapiproxy&&y.app.platform.apiproxy||(r.saveto=new Parameter({type:"VALUES",name:"Save",id:"saveto",defaultValue:"locally",possibleValues:["locally"],possibleValuesLabels:["Locally"],require:!0})),console.log("ap",r);var t={close:{class:"close",html:'<i class="fas fa-times"></i> Close',fn:function(e,o){o.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+n,fn:function(e,a){var n=_.clone(s);if(s.host=r.host.value,s.port=r.port.value,s.ws=r.ws.value,s.nodename=r.nodename.value,s.rpcuser="",s.rpcpwd="","locally"==r.saveto.value?(s.rpcuser=r.rpcuser.value||"",s.rpcpwd=r.rpcpwd.value||"",s.locally=!0):(delete s.rpcuser,delete s.rpcpwd),s.host&&s.port&&s.ws&&s.nodename){var t=_.clone(s);delete t.addedby,delete t.date,t.locally||delete t.locally,y.app.platform.sdk.node.sys[o+r.saveto.value](t,function(e,o){e?(s=_.clone(n),sitemessage(e)):(l?(p.list.html(""),u.nodes(y.app.platform.nodes)):(y.app.platform.nodes||(y.app.platform.nodes=[]),y.app.platform.nodes.push(o),u.nodes([o])),y.app.platform.nodeid&&y.app.platform.nodeid.host!=t.host?a.close():d.connectnode(t,function(){a.close()}),u.active())})}else sitemessage("Please fill all fields")}}};l&&(r.host.disabled=!0,r.saveto.hidden=!0,s.locally?r.saveto.value="locally":r.saveto.value="proxy",t.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> Delete',fn:function(e,a){dialog({class:"zindex",html:"Do you really want to delete this node from list?",success:function(){var e="revoke";e=s.locally?"revokelocally":"revokeproxy",y.app.platform.sdk.node.sys[e]({host:s.host},function(e,o){e?sitemessage(e):(p.list.find('.node[host="'+s.host+'"]').closest(".nodewrapepr").remove(),u.empty(),s.host==y.app.platform.nodeid.host?d.connectnode(null,function(){a.close()}):a.close())})}})}}),y.shell({destroy:function(){},insert:"wnd",name:"addnode",data:{parameters:r},wnd:{header:a,buttons:t,noInnerScroll:!0,class:"addnodewnd"}},function(e){ParametersLive(_.toArray(r),e.el);var o=function(){e.el.find(".addnode").attr("saveto",r.saveto.value)};o(),r.saveto._onChange=function(){o()}})},connectproxy:function(e){y.app.platform.nodeid=null,y.app.platform.nodes=null,y.app.errors.clear(),y.app.platform.state.save(),y.app.platform.restart(function(){app.reload(function(){}),e&&e()})},connectnode:function(o,a){d.preloader(!0),t(o,function(e){e?(y.app.platform.nodeid=o,y.app.platform.state.save(),u.active(),y.app.errors.clear(),y.app.platform.restart(function(){d.preloader(!1),app.reload(function(){}),a&&a()})):d.preloader(!1)})},ele:function(){return"undefined"!=typeof _Electron},using:function(e){y.app.platform.dontuseapiproxy=e,y.app.platform.sdk.proxy.save(),u.proxy(),d.connectproxy()}},s=function(){y.app.platform.dontuseapiproxy?d.using(!y.app.platform.dontuseapiproxy):dialog({html:"Do you really want to stop use Proxy. It is usafe (Http connection)",class:"zindex",success:function(){d.using(!y.app.platform.dontuseapiproxy)}})},l=function(){d.proxieslist()},r=function(){d.addnode()},c=function(){var o=$(this).closest(".node").attr("host"),a=$(this).closest(".node").attr("locally");a="true"==a;var e=_.find(y.app.platform.nodes,function(e){return e.host==o&&e.locally==a});e&&d.addnode(e)},f=function(){var e=$(this).closest(".node");if(!e.hasClass("active")){var o=e.attr("host"),a=e.attr("locally");a="true"==a;var n=_.find(y.app.platform.nodes,function(e){return e.host==o&&e.locally==a});d.connectnode(n)}},u={nodes:function(e,o){y.shell({inner:append,name:"nodes",data:{nodes:e},el:p.list},function(){u.empty(),u.active(),o&&o()})},empty:function(){p.list.find(".node").length?p.nodes.removeClass("empty"):p.nodes.addClass("empty")},active:function(){p.list.find(".node").removeClass("active"),y.app.platform.nodeid&&p.list.find('.node[host="'+y.app.platform.nodeid.host+'"][locally="'+(y.app.platform.nodeid.locally||"false")+'"]').addClass("active")},proxy:function(){y.app.platform.dontuseapiproxy?(p.cc.removeClass("useproxy"),p.cc.addClass("shownodes"),p.currentproxy.html("Don't use proxy")):(p.cc.addClass("useproxy"),y.app.platform.apiproxy?(p.cc.addClass("shownodes"),p.currentproxy.html("https://"+app.platform.apiproxy.host+":"+app.platform.apiproxy.port+"; wss:"+app.platform.apiproxy.ws)):(p.cc.removeClass("shownodes"),p.currentproxy.html("Not selected")))}},m=function(){};return{primary:o,getdata:function(e){var o={ele:d.ele()};window.cordova,e(o)},destroy:function(){p={}},init:function(e){m(),(p={}).c=e.el.find("#"+y.map.id),p.list=p.c.find(".list"),p.add=p.c.find(".addnewNode"),p.nodes=p.c.find(".nodespart"),p.cc=p.c.find(".connection"),p.currentproxy=p.c.find(".current"),p.add.on("click",r),p.c.on("click",".edit",c),p.c.on("click",".connectnode",f),p.c.find(".openproxielist").on("click",l),p.c.find(".usingproxy").on("click",s),u.proxy(),p.nodes.addClass("loading"),y.app.platform.sdk.system.get.nodes(!0,function(){p.nodes.removeClass("loading"),u.nodes(y.app.platform.nodes)}),e.clbk(null,e)}}};return y.run=function(e){var o=y.addEssense(a,n,e);y.init(o,e)},y.stop=function(){_.each(a,function(e){e.destroy()})},y}();"undefined"!=typeof module?module.exports=connection:(app.modules.connection={},app.modules.connection.module=connection);
 /*_____*/ 
var mchat=function(){var w=new nModule,i={},n=function(e){var d,t=deep(e,"history"),n=makeid(),m={},l=null,f=null,a=null,p=null,u={},h={},g={preloader:function(e){e?d.c.addClass("loading"):d.c.removeClass("loading")},close:function(){w.removeEssense(i,n),m.closeClbk&&m.closeClbk()},sendClbk:function(e,t,n){var a=d.messages.find("#"+e.EncryptedMessageID);t?(e.EncryptedMessageID=t,e.result="success",e.Message=n.note||"",e.Attachment=n.attachment||"",e.AttachmentName=n.attachmentName||"",e.AttachmentPreview=n.attachmentPreview||"",a.attr("id",e.EncryptedMessageID)):e.result="fail",a.removeClass("sending"),a.addClass(e.result)},mobileBuildHeight:function(){if("buildin"==m.view&&isMobile()){var e=d.c.find(".chatwindow").height(),t=$(window).height(),n=d.c.find(".chatmessages").height();e<=t-175&&n<e?d.c.find(".chatwindow").height(t-175):d.c.find(".chatwindow").css("height","auto")}},spacer:function(){if(g.mobileBuildHeight(),isTablet()){var e=0;0<d.messages.find(".chatmessage").length&&(d.c.find(".spacer").height(0),(e=d.c.find(".chatwindow").height()-d.c.find(".chatmessages").height()-10)<0&&(e=0),d.spacer.height(e+"px"))}},send:function(e){e&&p.rtc.send(e)},sendAttachment:function(e,n){w.app.platform.sdk.chats.send({attachment:e.attachment,attachmentName:e.attachmentName,attachmentPreview:e.attachmentPreview,temp:n},p.ThreadID,function(e,t){g.sendClbk(n,e,t)})},addTempMessage:function(e){var t=new Date;w.app.platform.timeDifference&&(t=t.addSeconds(w.app.platform.timeDifference/1e3));var n={Created:dateToStrUtcS(t),ThreadID:p.ThreadID,EncryptedMessageID:makeid(!0),temp:!0,UserID:w.app.user.data.id,decrypted:{Message:e.note,AttachmentName:e.attachmentName,AttachmentPreview:e.attachmentPreview}};return p.messages.push(n),o.messages(null,[n],!0),n},clearTempMessages:function(){d.messages.find(".temp").remove()},scrollToPx:function(e,t){if(!g.checkState())return!1;if(null!==t){var n=null,a=null,s="position";if("buildin"==m.view?(n=$(window),a=$("html"),s="offset"):(n=d.c.find(".chatwindow"),a=d.c.find(".chatmessages")),"toLast"==e||"toLast"==t){var i=d.messages.find(".chatmessage:nth-last-child(1)");if(i[s]()){var c=70;isMobile()&&(c=115),t=i[s]().top+i.height()+c-n.height(),n.scrollTop(t,200)}}else{var o=a.height();n.scrollTop(o-t,200)}}},scrollPx:function(e){var t=null,n=null,a=null;if(n="buildin"==m.view?(t=$(window),$("html")):(t=d.c.find(".chatwindow"),d.c.find(".chatmessages")),"toLast"==e)a="toLast";else{var s=d.messages.find(".chatmessage:nth-last-child(1)"),i="position";if("buildin"==m.view&&(i="offset"),inView(s,{inel:t,offset:0}).length){var c=n.height(),o=t.scrollTop();a=s[i]().top+s.height()+70,a=o+t.height()>a?c-o:"toLast"}}return a},saveAttachment:function(e){topPreloader(30);var t=c.findEl(e);t&&t.addClass("saveAttachment"),w.app.platform.sdk.chats.getAttachment(e,function(e){topPreloader(100),t&&t.removeClass("saveAttachment"),e?e.ChatMessageAttach&&saveAs({download:e.decrypted.AttachmentName,file:e.ChatMessageAttach,noA:!0}):console.log("ERROR")})},openGallery:function(e){var t={idName:"EncryptedMessageID",initialValue:e.EncryptedMessageID,getImages:function(){return _.filter(p.messages,function(e){var t=deep(e,"decrypted.AttachmentName");if(t&&(-1<t.indexOf(".jpg")||-1<t.indexOf(".png")||-1<t.indexOf(".jpeg")))return!0})},getImage:function(e,n){e.ChatMessageAttach?n&&n({src:e.ChatMessageAttach,name:e.decrypted.AttachmentName}):w.app.platform.sdk.chats.getAttachment(e,function(e){var t={src:e.ChatMessageAttach,name:e.decrypted.AttachmentName};n&&n(t)})}};o.gallery(t)},getPreview:function(e){w.app.platform.sdk.chats.getPreview(e,function(e){_.each(e,function(e){var t=c.findEl(e);o.messages(null,[e],!0,t)})})},read:function(){w.app.platform.focus&&w.app.platform.sdk.chats.read(p.messages,function(e){g.countUnread(),_.each(e,function(e){c.findEl(e).addClass("read")})})},countUnread:function(){w.app.user.data.id},checkState:function(){if(!d.c.hasClass("minimized"))return!0}},v={minimize:function(){d.c.addClass("minimized"),m.minimizeClbk&&m.minimizeClbk(),l.clear(),f.clear(),d.type.blur()},expand:function(){d.c.removeClass("minimized"),m.expandClbk&&m.expandClbk(),isTablet()||d.type.focus(),g.spacer(),setTimeout(function(){g.scrollToPx("toLast","toLast")},100)},out:function(){w.app.modules.chats.module.api.add(p.ThreadID)},close:function(){g.close()},type:function(e,t){var n,a;if(a=isMobile()?(n=this).getText():(t=e,(n=$(this)).val()),13==t.which||13==t.keyCode)return a&&(isMobile()?n.setText(""):n.val(""),g.send(a)),!1},resizeWindow:function(){l&&l.setOffset([$("#menu .menuWrapper").height(),0]),f&&f.setOffset([50,100])},getAttachment:function(){var e=$(this).closest(".chatmessage"),t=e.attr("id");if(!e.hasClass("sending")){var n=c.findMessage(t);if(n.decrypted&&n.decrypted.AttachmentName){var a=n.decrypted.AttachmentName.toLowerCase();-1<a.indexOf(".jpg")||-1<a.indexOf(".png")||-1<a.indexOf(".jpeg")?g.openGallery(n):g.saveAttachment(n)}}},messagesInView:function(){a=slowMade(function(){if(!g.checkState())return!1;var e,t=d.messages.find(".chatmessage"),n=d.messages.find(".chatmessage:nth-last-child(1)");"buildin"==m.view&&(e=$(window)),"fixedin"==m.view&&(e=d.c.find(".chatwindow"));var a=inView(t,{inel:e}),s=inView(n,{inel:e});if(0<a.length)_.map(a,function(e){var t=$(e).attr("id");return c.findMessage(t)});s.length},a,100)}},c={findMessage:function(t){return _.find(p.messages,function(e){return e.EncryptedMessageID==t})},findEl:function(e){return d.c.find("#"+(e.tm+e.f))}},o={gallery:function(e){e||(e={}),w.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:e})},safemessages:function(e,t){var s=_.map(h,function(e,t){return{m:e,t:t}});s=_.sortBy(s,function(e){return Number(e.t)});var i=[];_.each(s,function(t,n){var a={newmessages:[],oldmessage:t};_.each(e,function(e){(Number(e.tm)<Number(t.t)||n==s.length-1)&&(!n||Number(s[n-1].t)>Number(e.tm))&&a.newmessages.push(e)}),a.newmessages.length&&(a.newmessages.push(a.oldmessage),a.newmessages=_.sortBy(a.newmessages,function(e){return Number(t.t)}),i.push(a))}),i.length?lazyEach({array:i,action:function(e){var t=e.item,n=c.findEl(t.oldmessage);o.messages(e.success,t.newmessages,null,n)},all:{success:t}}):o.messages(t,e)},messages:function(t,e,n,a){var s="toLast";e&&(s="fixed");var i=g.scrollPx(s);e||(e=[]),e=_.filter(e,function(e){var t=e.tm+e.f;if(!u[t])return u[t]=!0,h[e.tm]=e,!0});var c=_.sortBy(e,function(e){return Number(e.tm)});n||g.clearTempMessages();var o=append,r=d.messages;a&&(o=replaceWith,r=a),w.shell({name:"messages",el:r,data:{chat:p,messages:c},inner:o},function(e){m.messagesClbk&&m.messagesClbk(),d.messages.find(".attachment").off("click"),d.messages.find(".attachment").on("click",v.getAttachment),v.messagesInView(),0<d.messages.find(".chatmessage").length?d.c.find(".other").fadeOut(1):d.c.find(".other").fadeIn(1),n&&(i="toLast"),g.spacer(),setTimeout(function(){g.scrollToPx(s,i)},20),l&&l.action(),f&&f.action(),g.countUnread(),t&&t()})}},s=function(){};return{primary:t,getdata:function(t,e){deep(e,"settings.essenseData");var n={};(p=deep(e,"settings.essenseData.chat"))&&w.app.platform.sdk.chats.info([p],function(e){n.chat=p,w.app.platform.sdk.messenger.getChat(p),n.canEnc=!0,t(n)})},destroy:function(){d.type&&d.type.blur(),$("html").off("mousemove",v.messagesInView),window.removeEventListener("scroll",v.messagesInView),window.removeEventListener("resize",v.resizeWindow),w.app.platform.ws,a&&clearTimeout(a),d={},l&&l.destroy(),f&&f.destroy(),l=f=null,w.app.platform.rtc.destroy(p.chat.id),p=null,0,m.destroyClbk&&m.destroyClbk()},init:function(e){u={},h={},(m=e.essenseData||{}).view||(m.view="buildin"),s(),(d={}).c=e.el.find("#"+w.map.id),d.messages=d.c.find(".chatmessages"),d.type=d.c.find(".type"),d.attachement=d.c.find(".attachement"),d.countUnread=d.c.find(".countUnread"),d.spacer=d.c.find(".spacer"),d.c.addClass(m.view),function(){if("buildin"==m.view){isMobile()||(l=new Caption({container:d.c.find(".chatWrapper"),caption:d.c.find(".captionfwrapper"),offset:[$("#menu .menuWrapper").height(),0]}).init());var e=0;isMobile()&&(e=50),f=new Caption({container:d.c.find(".chatWrapper"),caption:d.c.find(".bcaptionfwrapper"),offset:[e,2*e],pos:"bottom"}).init(),d.c.find(".out").on("click",v.out),window.addEventListener("scroll",v.messagesInView),window.addEventListener("resize",v.resizeWindow),$("html").on("mousemove",v.messagesInView)}"fixedin"==m.view&&(d.c.find(".close").on("click",v.close),d.c.find(".chatwindow").on("scroll",v.messagesInView),$("html").on("mousemove",v.messagesInView)),d.c.find(".minimize").on("click",v.minimize),d.c.find(".expand").on("click",v.expand),d.countUnread.on("click",function(){v.expand()}),isMobile(),d.type.on("keyup",v.type),initUpload({el:d.attachement,ext:["png","jpeg","jpg","pdf"],multiple:!0,maxFileSize:5,dropZone:d.c.find(".chatWrapper"),beforeUpload:function(e){var a=deep(e,"file.name");if("png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext)resize(e.base64,200,200,function(t){var n=g.addTempMessage({attachmentName:a,attachmentPreview:t});resize(e.base64,1600,1600,function(e){g.sendAttachment({attachment:e,attachmentName:a,attachmentPreview:t},n)})});else{var t=g.addTempMessage({attachmentName:a});g.sendAttachment({attachment:e.base64,attachmentName:a},t)}}})}(),function(){if(p.rtc.clbks.receive.message.messenger=function(e){w.app.platform.sdk.messenger.load.messages(e,function(){o.messages(null,[e])})},p.rtc.clbks.receive.messages.messenger=function(e){w.app.platform.sdk.messenger.load.messages(e,function(){o.safemessages(e)})},p.rtc.clbks.send.message.messenger=function(e){w.app.platform.sdk.messenger.load.messages(e,function(){o.messages(null,[e],!0)})},p){var e=_.toArray(p.rtc.storage._db||{});w.app.platform.sdk.messenger.load.messages(e,function(){o.messages(null,e,!0)}),p.rtc.connect(function(){console.log(p)})}}(),w.app.platform.ws,e.clbk(null,e)},id:n,api:v}};return w.run=function(e){var t=w.addEssense(i,n,e);w.init(t,e)},w.stop=function(){_.each(i,function(e){e.destroy()})},w}();"undefined"!=typeof module?module.exports=mchat:(app.modules.mchat={},app.modules.mchat.module=mchat);
 /*_____*/ 
var chat=function(){var b=new nModule,r={},n=function(e){var m,i,t=deep(e,"history"),n=makeid(),d={},l=null,f=null,a=null,u=null,p=null,h={},g={},v={preloader:function(e){e?m.c.addClass("loading"):m.c.removeClass("loading")},close:function(){b.removeEssense(r,n),d.closeClbk&&d.closeClbk()},sendClbk:function(e,t,n){var a=m.messages.find("#"+e.EncryptedMessageID);t?(e.EncryptedMessageID=t,e.result="success",e.Message=n.note||"",e.Attachment=n.attachment||"",e.AttachmentName=n.attachmentName||"",e.AttachmentPreview=n.attachmentPreview||"",a.attr("id",e.EncryptedMessageID)):e.result="fail",a.removeClass("sending"),a.addClass(e.result)},mobileBuildHeight:function(){if("buildin"==d.view&&isMobile()){var e=m.c.find(".chatwindow").height(),t=$(window).height(),n=m.c.find(".chatmessages").height();e<=t-175&&n<e?m.c.find(".chatwindow").height(t-175):m.c.find(".chatwindow").css("height","auto")}},spacer:function(){if(v.mobileBuildHeight(),isTablet()){var e=0;0<m.messages.find(".chatmessage").length&&(m.c.find(".spacer").height(0),(e=m.c.find(".chatwindow").height()-m.c.find(".chatmessages").height()-10)<0&&(e=0),m.spacer.height(e+"px"))}},send:function(e){e&&u.rtc.send(e)},sendAttachment:function(e,n){b.app.platform.sdk.chats.send({attachment:e.attachment,attachmentName:e.attachmentName,attachmentPreview:e.attachmentPreview,temp:n},u.ThreadID,function(e,t){v.sendClbk(n,e,t)})},addTempMessage:function(e){var t=new Date;b.app.platform.timeDifference&&(t=t.addSeconds(b.app.platform.timeDifference/1e3));var n={Created:dateToStrUtcS(t),ThreadID:u.ThreadID,EncryptedMessageID:makeid(!0),temp:!0,UserID:b.app.user.data.id,decrypted:{Message:e.note,AttachmentName:e.attachmentName,AttachmentPreview:e.attachmentPreview}};return u.messages.push(n),o.messages(null,[n],!0),n},clearTempMessages:function(){m.messages.find(".temp").remove()},scrollToPx:function(e,t){if(!v.checkState())return!1;if(null!==t){var n=null,a=null,s="position";if("buildin"==d.view?(n=$(window),a=$("html"),s="offset"):(n=m.c.find(".chatwindow"),a=m.c.find(".chatmessages")),"toLast"==e||"toLast"==t){var i=m.messages.find(".chatmessage:nth-last-child(1)");if(i[s]()){var c=70;isMobile()&&(c=115),t=i[s]().top+i.height()+c-n.height(),n.scrollTop(t,200)}}else{var o=a.height();n.scrollTop(o-t,200)}}},scrollPx:function(e){if(m.c){var t=null,n=null,a=null;if(n="buildin"==d.view?(t=$(window),$("html")):(t=m.c.find(".chatwindow"),m.c.find(".chatmessages")),"toLast"==e)a="toLast";else{var s=m.messages.find(".chatmessage:nth-last-child(1)"),i="position";"buildin"==d.view&&(i="offset");inView(s,{inel:t,offset:-20,mode:"partall"});if(s&&s[i]()){var c=n.height(),o=t.scrollTop();a=c-s.height()-150,a=o+t.height()>a?"toLast":null}}return a}},saveAttachment:function(e){topPreloader(30);var t=c.findEl(e);t&&t.addClass("saveAttachment"),b.app.platform.sdk.chats.getAttachment(e,function(e){topPreloader(100),t&&t.removeClass("saveAttachment"),e?e.ChatMessageAttach&&saveAs({download:e.decrypted.AttachmentName,file:e.ChatMessageAttach,noA:!0}):console.log("ERROR")})},openGallery:function(e){var t={idName:"EncryptedMessageID",initialValue:e.EncryptedMessageID,getImages:function(){return _.filter(u.messages,function(e){var t=deep(e,"decrypted.AttachmentName");if(t&&(-1<t.indexOf(".jpg")||-1<t.indexOf(".png")||-1<t.indexOf(".jpeg")))return!0})},getImage:function(e,n){e.ChatMessageAttach?n&&n({src:e.ChatMessageAttach,name:e.decrypted.AttachmentName}):b.app.platform.sdk.chats.getAttachment(e,function(e){var t={src:e.ChatMessageAttach,name:e.decrypted.AttachmentName};n&&n(t)})}};o.gallery(t)},getPreview:function(e){b.app.platform.sdk.chats.getPreview(e,function(e){_.each(e,function(e){var t=c.findEl(e);o.messages(null,[e],!0,t)})})},read:function(){},countUnread:function(){m.countUnread&&m.countUnread.html("")},checkState:function(){if(m.c&&!m.c.hasClass("minimized"))return!0}},w={minimize:function(){m.c.addClass("minimized"),d.minimizeClbk&&d.minimizeClbk(),l.clear(),f.clear(),m.type.blur()},expand:function(){m.c.removeClass("minimized"),d.expandClbk&&d.expandClbk(),isTablet()||m.type.focus(),v.spacer(),setTimeout(function(){v.scrollToPx("toLast","toLast")},100)},out:function(){b.app.modules.chats.module.api.add(u.ThreadID)},close:function(){v.close()},type:function(e,t){var n=this.getText();if(13==t.which||13==t.keyCode)return n&&(this.setText(""),v.send(n),$(this).val("")),!1},resizeWindow:function(){l&&l.setOffset([0,0]),f&&f.setOffset([50,100])},getAttachment:function(){var e=$(this).closest(".chatmessage"),t=e.attr("id");if(!e.hasClass("sending")){var n=c.findMessage(t);if(n.decrypted&&n.decrypted.AttachmentName){var a=n.decrypted.AttachmentName.toLowerCase();-1<a.indexOf(".jpg")||-1<a.indexOf(".png")||-1<a.indexOf(".jpeg")?v.openGallery(n):v.saveAttachment(n)}}},messagesInView:function(){a=slowMade(function(){if(!v.checkState())return!1;var e,t=m.messages.find(".chatmessage"),n=m.messages.find(".chatmessage:nth-last-child(1)");"buildin"==d.view&&(e=$(window)),"fixedin"==d.view&&(e=m.c.find(".chatwindow"));var a=inView(t,{inel:e}),s=inView(n,{inel:e});if(0<a.length)_.map(a,function(e){var t=$(e).attr("id");return c.findMessage(t)});0<s.length&&v.read()},a,100)}},c={findMessage:function(t){return _.find(u.messages,function(e){return e.EncryptedMessageID==t})},findEl:function(e){return m.c.find("#"+(e.tm+e.f))}},o={gallery:function(e){e||(e={}),b.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:e})},safemessages:function(e,t){var s=_.map(g,function(e,t){return{m:e,t:t}});s=_.sortBy(s,function(e){return Number(e.t)});var i=[];_.each(s,function(t,n){var a={newmessages:[],oldmessage:t};_.each(e,function(e){(Number(e.tm)<Number(t.t)||n==s.length-1)&&(!n||Number(s[n-1].t)>Number(e.tm))&&a.newmessages.push(e)}),a.newmessages.length&&(a.newmessages.push(a.oldmessage.m),a.newmessages=_.sortBy(a.newmessages,function(e){return Number(t.t)}),i.push(a))}),i.length?lazyEach({array:i,action:function(e){var t=e.item,n=c.findEl(t.oldmessage);o.messages(e.success,t.newmessages,null,n)},all:{success:t}}):o.messages(t,e)},messages:function(t,a,n,e){if(m.c){a=_.filter(a,function(e,t){var n=e.tm;if(17==e.tm.length&&(e.tm=n+"0"),!(p&&p.tm>e.tm))return!(a.length-50>t)});var s="toLast";a&&(s="fixed");var i=v.scrollPx(s);a||(a=[]),a=_.filter(a,function(e){var t=e.tm+e.f;return!!e.tm&&(h[t]?void 0:(h[t]=!0,g[e.tm]=e,!0))});var c=_.sortBy(a,function(e){var t=e.tm;return 17==e.tm.length&&(e.tm=t+"0"),Number(e.tm)});n||v.clearTempMessages();var o=append,r=m.messages;e&&(o=replaceWith,r=e),a.length?(p=c[c.length-1],b.shell({name:"messages",el:r,data:{chat:u,messages:c},inner:o},function(e){d.messagesClbk&&d.messagesClbk(),m.messages.find(".attachment").off("click"),m.messages.find(".attachment").on("click",w.getAttachment),w.messagesInView(),0<m.messages.find(".chatmessage").length?m.c.find(".other").fadeOut(1):m.c.find(".other").fadeIn(1),n&&(i="toLast"),v.spacer(),setTimeout(function(){v.scrollToPx(s,i)},20),l&&l.action(),f&&f.action(),v.countUnread(),t&&t()})):t&&t()}}},s=function(){};return{primary:t,getdata:function(t,e){var n={},a=deep(e,"settings.essenseData.chat");if(!a){var s=parameters().chatid;a=b.app.platform.sdk.discussions.fromChatId(s)}deep(e,"settings.essenseData");a&&(u=a.chat,b.app.platform.sdk.chats.info([a.chat],function(e){n.chat=a,b.app.platform.sdk.tempmessenger.getChat(a.chat),n.canEnc=!0,b.app.platform.sdk.ustate.me(function(e){i=e,n.mestate=i,t(n)})}))},destroy:function(){console.log("exel",m),m.type&&m.type.blur(),$("html").off("mousemove",w.messagesInView),window.removeEventListener("scroll",w.messagesInView),window.removeEventListener("resize",w.resizeWindow),function(){b.app.platform.ws;$(window).off("focus",v.read),$(window).off("mousemove",v.read),delete u.rtc.clbks.receive.message.messenger,delete u.rtc.clbks.receive.messages.messenger,delete u.rtc.clbks.send.message.messenger}(),a&&clearTimeout(a),m={},l&&l.destroy(),f&&f.destroy(),l=f=null,u&&(u.rtc.leave(),u=null),clearInterval(null),0,$("#tawkchat-container").fadeIn(),d.destroyClbk&&d.destroyClbk()},init:function(e){console.log("INICHAT"),h={},g={},(d=e.essenseData||{}).view||(d.view="buildin"),s(),(m={}).c=e.el.find("#"+b.map.id),m.messages=m.c.find(".chatmessages"),m.type=m.c.find(".type"),m.attachement=m.c.find(".attachement"),m.countUnread=m.c.find(".countUnread"),m.spacer=m.c.find(".spacer"),m.c.addClass(d.view),function(){if("buildin"==d.view){isMobile()||(l=new Caption({container:m.c.find(".chatWrapper"),caption:m.c.find(".captionfwrapper"),offset:[0,0]}).init());var e=0;isMobile()&&(e=50),f=new Caption({container:m.c.find(".chatWrapper"),caption:m.c.find(".bcaptionfwrapper"),offset:[e,2*e],pos:"bottom"}).init(),m.c.find(".out").on("click",w.out),window.addEventListener("scroll",w.messagesInView),window.addEventListener("resize",w.resizeWindow),$("html").on("mousemove",w.messagesInView)}"fixedin"==d.view&&(m.c.find(".close").on("click",w.close),m.c.find(".chatwindow").on("scroll",w.messagesInView),$("html").on("mousemove",w.messagesInView)),m.c.find(".minimize").on("click",w.minimize),m.c.find(".expand").on("click",w.expand),m.countUnread.on("click",function(){w.expand()}),m.type.emojioneArea({pickerPosition:"top",search:!1,tones:!1,attributes:{spellcheck:!0,autocomplete:"on"},events:{keyup:w.type,onLoad:function(e,t){}}}),initUpload({el:m.attachement,ext:["png","jpeg","jpg","pdf"],multiple:!0,maxFileSize:5,dropZone:m.c.find(".chatWrapper"),beforeUpload:function(e){var a=deep(e,"file.name");if("png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext)resize(e.base64,200,200,function(t){var n=v.addTempMessage({attachmentName:a,attachmentPreview:t});resize(e.base64,1600,1600,function(e){v.sendAttachment({attachment:e,attachmentName:a,attachmentPreview:t},n)})});else{var t=v.addTempMessage({attachmentName:a});v.sendAttachment({attachment:e.base64,attachmentName:a},t)}}})}(),function(){if(u.rtc.clbks.receive.message.messenger=function(e){!b.app.platform.focus&&b.app.platform.titleManager&&b.app.platform.titleManager.add("You have new messages"),p=e,b.app.platform.sdk.messenger.load.messages(e,function(){o.messages(null,[e])})},u.rtc.clbks.receive.messages.messenger=function(e){0,b.app.platform.sdk.messenger.load.messages(e,function(){o.messages(null,e,!0)})},u.rtc.clbks.send.message.messenger=function(e){b.app.platform.sdk.messenger.load.messages(e,function(){p=e,o.messages(null,[e],!0)})},u){var e=_.toArray(u.rtc.storage._db||{});b.app.platform.sdk.messenger.load.messages(e,function(){o.messages(null,e,!0)}),u.rtc.connect(function(){})}}(),function(){b.app.platform.ws;$(window).on("focus",v.read),$(window).on("mousemove",v.read)}(),v.countUnread(),e.clbk(null,e)},id:n,api:w}};return b.run=function(e){var t=b.addEssense(r,n,e);b.init(t,e)},b.stop=function(){_.each(r,function(e){e.destroy()})},b}();"undefined"!=typeof module?module.exports=chat:(app.modules.chat={},app.modules.chat.module=chat);
 /*_____*/ 
var menu=function(){var u=new nModule,a={},t=function(){var c,n=null,t=null,e=null,r=null,a=null,i=new Parameter({type:"VALUES",name:"Localization",id:"localization",defaultValue:app.localization.current().name,possibleValues:app.localization.availableMap("name"),format:{right:!0},_onChange:function(e){var n=app.localization.findByName(e);n&&n.key!=app.localization.key&&app.localization.set(n.key)}}),l={autoUpdate:function(){u.app.user.isState(function(e){})},elswidth:function(){c.c.find(".autowidth.active").each(function(){l.setWidth($(this))})},setWidth:function(e){if(!isMobile()&&e.offset()){var n=e.offset().left,a=e.width(),t=n-(c.c.width()-n-a);e.width(a+t)}},ah:function(e,n){0<n?e.addClass("amountHave"):e.removeClass("amountHave"),e.find(".amount").html(n)},sitenameToNav:function(){o.navinit.el&&(e=slowMade(function(){var e=u.app.nav.current.href;if(("index"==e||"author"==e)&&45<$(window).scrollTop()){c.nav.addClass("active"),c.c.addClass("menupanelactive"),c.nav.find(".pcenterLabel").removeClass("active");var n=parameters(u.app.nav.current.completeHref,!0).r||"empty";"index"==e&&c.nav.find('.pcenterLabel[r="'+n+'"]').addClass("active")}else c.c.removeClass("menupanelactive"),c.nav.removeClass("active");l.elswidth()},e,10))}},o={navinit:{init:function(e){isTablet()||($(window).on("scroll",l.sitenameToNav),u.app.nav.clbks.history.menu=function(e){l.sitenameToNav()})},destroy:function(){$(window).off("scroll",l.sitenameToNav),delete u.app.nav.clbks.history.menu}},sitename:{click:function(){u.app.user.isState(function(e){if("index"!=u.app.nav.get.pathname()){var n=localStorage.lentakey||"index";parameters().r==n&&(n="index"),"index"!=n&&(n="index?r="+n),e||(n="index"),u.nav.api.go({href:n,history:!0,open:!0,handler:!0})}})}},activate:{click:function(){dialog({header:u.app.localization.e("id167"),html:u.app.localization.e("id168"),class:"one",btn1text:u.app.localization.e("id169"),success:function(){u.app.platform.sdk.user.activateWithDialogs(function(e){})}})}},notifications:{init:function(n){var a=function(){return _.filter(u.app.platform.sdk.notifications.storage.notifications,function(e){if(!e.seen)return!0})},t=null;"undefined"!=typeof cordova&&(t=deep(cordova,"plugins.notification.badge")),u.app.platform.sdk.notifications.init(function(){var e=a().length;l.ah(n,e),t&&t.set(e),u.app.platform.api.electron.notifications(e,"notifications"),isMobile()||u.nav.api.load({open:!0,id:"notifications",el:n,inTooltip:!0})}),u.app.platform.sdk.notifications.clbks.added.menu=u.app.platform.sdk.notifications.clbks.seen.menu=function(){var e=a().length;t&&t.set(e),l.ah(n,e),u.app.platform.api.electron.notifications(e,"notifications")}},click:function(e){isMobile()&&u.nav.api.go({href:"userpage?id=notifications&report=notifications",history:!0,open:!0})}},messenger:{init:function(e){var n=u.app.platform.clientrtc.rtchttp,a=function(){var a=0;return _.each(n.storage.chat,function(e,n){a+=e.messages.unreaded}),a};u.app.platform.clientrtc.rtchttp.info.allchats(function(){l.ah(e,a())}),u.app.platform.sdk.messenger.clbks.menu=function(){l.ah(e,a())}},click:function(e){isMobile()?u.nav.api.load({href:"messenger",history:!0,open:!0}):u.nav.api.go({href:"userpage?id=messenger&report=messenger",history:!0,open:!0})}},savecross:{init:function(a){var e=deep(u.app,"platform.sdk.user.storage.me.rc")||0;l.ah(a,e),u.app.platform.ws.messages.event.clbks.menusave=function(e){if("userInfo"==e.mesType){var n=deep(u.app,"platform.sdk.user.storage.me.rc")||0;l.ah(a,n)}}},click:function(){u.app.platform.m.log("sharing_opened_menu","0"),u.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{rescue:!0}})}},search:{click:function(){c.c.toggleClass("searchactive"),c.c.hasClass("searchactive")?(searchBackAction=null,c.postssearch.find("input").focus(),c.postssearch.addClass("active"),n&&(clearTimeout(n),n=null)):(c.postssearch.removeClass("active"),c.postssearch.find("input").val(""),r&&r.clear()),l.elswidth()}},searchinit:{init:function(i){var o=function(e){"s"!=u.app.nav.current.href||e?(i.find("input").val(""),c.c.removeClass("searchactive"),s()):searchBackAction&&(searchBackAction(),searchBackAction=null)},s=function(){n&&(clearTimeout(n),n=null)};a=new search(c.postssearch,{placeholder:"SEARCH ON POCKETNET",clbk:function(e){e.find("input").on("blur",function(){n=slowMade(function(){o()},n,200)})},last:{get:function(){return[]},tpl:function(e,n){}},events:{fastsearch:function(n,a){u.app.platform.sdk.search.get(n,"fs",null,null,null,function(e){p.results(e||{},n,function(e){a(e,function(e,t){bgImages(e),e.find(".result").on("click",function(){var e=$(this).attr("result");i.find("input").val(e);var n="s?ss="+e.replace("#","tag:");r&&(n="?report=shares&ss="+e.replace("#","tag:"),r.clear(!0));var a={href:n,history:!0,open:!0};r&&(a.handler=!0),u.nav.api.go(a),t.closeResults(),s()}),e.find(".user").on("click",function(){var e=$(this).attr("address");u.nav.api.go({href:"author?address="+e,history:!0,open:!0}),t.closeResults(),o(),s()})})})})},search:function(e,n,a,t){var i="s?ss="+e.replace("#","tag:");r&&(i="?report=shares&ss="+e.replace("#","tag:"),r.clear(!0));var o={href:i,history:!0,open:!0};r&&(o.handler=!0),console.log("authorForSearch",r,o),u.nav.api.go(o),t.closeResults(),s(),n&&n(!0)},clear:function(e){e||(i.find("input").blur(),setTimeout(function(){o(!0),s()},100))}}})}},newaccount:{click:function(){u.nav.api.go({href:"registration",history:!0,open:!0})}},state:{init:function(e){var n=function(){_.isEmpty(u.app.errors.state)?e.addClass("hidden"):e.removeClass("hidden")};n(),u.app.errors.clbks.menu=function(){n()},e.tooltipster({theme:"tooltipster-light",maxWidth:300,zIndex:200})}},wallets:{click:function(){u.nav.api.go({open:!0,href:"userpage?id=wallet",history:!0})},init:function(i){var o=i.find(".number"),s=!0,c=0,e=function(){u.app.platform.sdk.node.transactions.get.allBalance(function(e){var t,n,a=(e+=u.app.platform.sdk.node.transactions.tempBalance())-c;s&&(a=0,c=e),s=!1,t=c,n=a,i.removeClass("hidden"),0==n?(o.text(u.app.platform.mp.coin(t)),l.elswidth()):o.animateNumber({number:n,numberStep:function(e,n){l.elswidth(),i.addClass("good");var a=Number(t+e).toFixed(8);$(n.elem).text(u.app.platform.mp.coin(a))}},rand(400,1200),function(){i.removeClass("good")}),c=e,u.app.platform.sdk.wallet.drawSpendLine(i.find(".numberWrp"))})},n=function(){e()};(u.app.platform.sdk.node.transactions.clbks.menu=n)()}},signout:{click:function(){u.app.user.signout(),u.app.reload({href:"authorization"})}},signin:{init:function(e){},click:function(){u.nav.api.go({href:"authorization",history:!0,open:!0})}},signup:{init:function(e){},click:function(){u.nav.api.go({href:"registration",history:!0,open:!0})}}},p={results:function(e,n,a){u.shell({name:"results",data:{results:e,value:n}},function(e){a&&a(e.rendered)})}},s=function(){a.placeholder("SEARCH ON POCKETNET"),r=null};return{getdata:function(e,n){console.log("MENU0",n);var a={};i.value=app.localization.current().name,a.loc=i,a._SEO=_SEO,n.state?(console.log("GETONE"),u.app.platform.sdk.users.getone(u.app.platform.sdk.address.pnet().address,function(){console.log("GETONE2"),e(a)})):e(a)},destroy:function(){s(),a=null,$(window).off("resize",l.elswidth),delete u.app.platform.sdk.node.transactions.clbks.menu,delete u.app.platform.ws.messages.event.clbks.menusave,delete u.app.platform.sdk.notifications.clbks.seen.menu,delete u.app.platform.sdk.notifications.clbks.added.menu,delete u.app.platform.sdk.messenger.clbks.menu,delete u.app.errors.clbks.menu,t&&clearInterval(t),_.each(o,function(e){delete e.el,e.destroy&&e.destroy()}),c={}},closesearch:function(){c.c.removeClass("searchactive")},showsearch:function(e,n){c.c.addClass("searchactive"),c.postssearch.find("input").val(e.replace("tag:","#")),searchBackAction=n||null,l.elswidth()},initauthorsearch:function(e){var n;e.data&&(n=e,a.placeholder("SEARCH ON "+n.data.name.toUpperCase()),r=n)},destroyauthorsearch:function(){s()},init:function(e){(c={}).c=e.el.find("#"+u.map.id),c.a=e.el.find(".additionalbar"),c.cart=c.c.find(".cart"),c.likes=c.c.find(".favorites"),c.messagesCount=c.c.find(".dialogs .count"),c.notificationsCount=c.c.find(".notifications .count"),c.walletsAmount=c.c.find(".wallets .amount"),c.notactive=c.c.find(".notactive"),c.currency=c.c.find(".currencyWrapper"),c.postssearch=c.c.find(".postssearch"),c.nav=c.c.find(".menutoppanel"),function(){if(c.c.find("[events]").each(function(){var a=$(this),e=a.attr("events");o[e]&&(o[e].el=a,_.each(o[e],function(e,n){"init"==n?e(a):a.on(n,e)}))}),$(window).on("resize",l.elswidth),ParametersLive([i],c.c),t=setInterval(l.autoUpdate,100),"undefined"!=typeof _Electron){var n=require("electron").remote,a=function(){n.getCurrentWindow().isFullScreen()?c.c.addClass("fullscreen"):c.c.removeClass("fullscreen")};c.c.find(".closeApp").on("click",function(){n.getCurrentWindow().close()}),c.c.find(".miniizeApp").on("click",function(){n.getCurrentWindow().minimize()}),c.c.find(".toggleMinMax").on("click",function(){var e=n.getCurrentWindow();e.setFullScreen(!e.isFullScreen()),a()}),a()}}(),u.app.user.isState(function(e){parameters().ss&&(isMobile()||"s"==u.app.nav.get.pathname())&&(c.c.addClass("searchactive"),c.c.find(".postssearch").addClass("active"),l.elswidth(),c.postssearch.find("input").val(parameters().ss.replace("tag:","#")))}),e.clbk(null,e)}}};return u.run=function(e){var n=u.addEssense(a,t,e);u.init(n,e)},u.stop=function(){_.each(a,function(e){e.destroy()})},u.initauthorsearch=function(n){_.each(a,function(e){e.initauthorsearch(n)})},u.destroyauthorsearch=function(){_.each(a,function(e){e.destroyauthorsearch()})},u.closesearch=function(){_.each(a,function(e){e.closesearch()})},u.showsearch=function(n){_.each(a,function(e){e.showsearch(n)})},u}();"undefined"!=typeof module?module.exports=menu:(app.modules.menu={},app.modules.menu.module=menu);
 /*_____*/ 
var author=function(){var g=new nModule,a={},t=function(e){var r,s,l,t,n=deep(e,"history"),a=null,o=null,c=!1,i=null,p={showmoreabout:function(){var e=filterXSS(clearScripts(findAndReplaceLink(deep(r,"data.about"),!0)));l.c.find(".aboutwrapper").html(e),l.c.find(".showmoreabout").remove()},showHideUp:function(){200<l.w.scrollTop()?l.up.addClass("active"):l.up.removeClass("active")},panelTopPosition:function(){if(!isMobile()){var e=$(window).scrollTop();l.caption.height()+20<e?l.fxd.addClass("dfxd"):l.fxd.removeClass("dfxd"),p.panelPosition()}},panelPosition:function(){if(!isMobile()){var e=l.fxd,n=l.panel.closest(".mwork"),a=$(window).width(),t=(a-1280)/2;t<0&&(t=0);var s=a-(n.offset().left+n.width())+0,o=a-s-350+0+0;e.css("right",s+"px"),e.css("left",o+"px")}},destroy:function(){_.each(u,function(e){e.active=!1,e.module&&e.module.destroy()})}},d={showHideUp:function(){o=slowMade(function(){p.showHideUp()},o,30)},up:function(){_scrollTop(0)},unsubscribe:function(){dialog({html:"Do you really want to unfollow user?",btn1text:"Unfollow",btn2text:"Cancel",class:"zindex",success:function(){g.app.platform.api.actions.unsubscribe(r.address,function(e,n){e||g.app.platform.errorHandler(n,!0)})}})},subscribe:function(){g.app.platform.api.actions.subscribe(r.address,function(e,n){e||g.app.platform.errorHandler(n,!0)})},subscribePrivate:function(){p.subscribePrivate(function(e,n){e?l.subscribe.addClass("subscribed"):g.app.platform.errorHandler(n,!0)})}},u={shares:{name:g.app.localization.e("uposts"),mobile:'<i class="fas fa-align-justify"></i>',id:"shares",render:"lenta",history:!0,count:function(){return 0}},post:{if:function(){return!1},id:"post",render:"post",count:function(){return 0}},followers:{name:g.app.localization.e("followers"),mobile:'<i class="fas fa-users"></i>',id:"followers",render:"followers",history:!0,count:function(){return deep(r,"data.subscribers.length")||0}},following:{name:g.app.localization.e("following"),id:"following",mobile:'<i class="fas fa-user-plus"></i>',render:"following",history:!0,count:function(){return deep(r,"data.subscribes.length")||0}},share:{name:'SHARE <i class="fas fa-share-alt"></i>',mobile:'<i class="fas fa-share-alt"></i>',id:"share",if:function(){return!0},events:{click:function(){g.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0})}}},settings:{name:g.app.localization.e("settings")+' <i class="fas fa-cog"></i>',mobile:'<i class="fas fa-cog"></i>',id:"settings",href:"userpage?id=ustate",class:"tosettings",if:function(){if(g.user.isItMe(r.address)&&!isMobile())return!0}},more:{name:'<i class="fas fa-ellipsis-h"></i>',mobile:'<i class="fas fa-ellipsis-h"></i>',id:"more",class:"more",if:function(){if(!g.user.isItMe(r.address)&&s)return!0},events:{click:function(){f.metmenu($(this))}}},info:{name:'Info <i class="fas fa-info-circle"></i>',mobile:'<i class="fas fa-info-circle"></i>',id:"info",class:"info",render:"info",history:!0,if:function(){if(isMobile())return!0}}},f={contents:function(e,n){var a=parameters().mt,t={name:"contents",el:l.contents,data:{contents:e,author:r,selected:a}};g.shell(t,function(e){e.el.find(".hasmore .captiontable").on("click",function(){$(this).closest(".hasmore").toggleClass("showedmore")}),n&&n()})},metmenu:function(a){var t={};g.fastTemplate("metmenu",function(e,n){g.app.platform.api.tooltip(a,function(){return t.author=r,n(t)},function(e){e.find(".donate").on("click",function(){p.donate(id),a.tooltipster("hide")}),e.find(".block").on("click",function(){g.app.platform.api.actions.blocking(r.address,function(e,n){e||g.app.platform.errorHandler(n,!0)}),a.tooltipster("hide")}),e.find(".unblock").on("click",function(){g.app.platform.api.actions.unblocking(r.address,function(e,n){e||g.app.platform.errorHandler(n,!0)}),a.tooltipster("hide")})})},t)},panel:function(){var e={};g.user.isItMe(r.address)||(e.author=r.address),g.nav.api.load({open:!0,id:"panel",el:l.panel,animation:!1,essenseData:{discussions:e},clbk:function(e,n){a=n,p.panelPosition(),window.addEventListener("resize",d.panelPosition),window.addEventListener("scroll",p.panelTopPosition)}})},report:function(e,n,a){if(p.destroy(),!e.active&&e.history){var t=["mt"];("shares"!=e.id||n)&&t.push("ss"),a||g.app.nav.api.history.addRemoveParameters(t,{report:e.id})}e.active=!0,f[e.render]&&(f[e.render](l.lenta,e),f.menulight(),g.app.platform.sdk.contents.get(r.address,function(e){f.contents(e)}))},menulight:function(){l.menu.find(".usermenuitem").removeClass("active");var e=_.find(u,function(e){return e.active});e&&l.menu.find(".usermenuitem .c"+e.class).addClass("active")},menu:function(e){g.shell({name:"menu",el:l.menu,data:{reports:u}},function(t){t.el.find(".usermenuitem").swipe({tap:function(){var e=$(this).attr("menuitem");u[e]&&f.report(u[e])}}),_.each(u,function(e,n){if(e.events){var a=t.el.find('[menuitem="'+n+'"]');_.each(e.events,function(e,n){"click"==n&&isMobile()?a.swipe({tap:e}):a.on(n,e)})}}),e&&e()})},userslist:function(e,n,a,t,s){g.nav.api.load({open:!0,id:"userslist",el:e,animation:!1,essenseData:{addresses:n,empty:a,caption:t},clbk:function(e,n){s&&s(e,n)}})},info:function(e){g.shell({name:"info",el:e,data:{author:r},animation:"fadeIn"},function(e){e.el.find(".showmoreabout").on("click",p.showmoreabout)})},followers:function(e,a){var n=_.map(deep(r,"data.subscribers")||[],function(e){return e}),t=g.app.localization.e("anofollowers");g.user.isItMe(r.address)&&(t=g.app.localization.e("aynofollowers")),f.userslist(e,n,t,"Followers",function(e,n){a.module=n})},following:function(e,a){var n=_.map(deep(r,"data.subscribes")||[],function(e){return e.adddress}),t=g.app.localization.e("anofollowing");g.user.isItMe(r.address)&&(t=g.app.localization.e("aynofollowing")),f.userslist(e,n,t,"Following",function(e,n){a.module=n})},post:function(o,e){var i=parameters().mt;g.app.platform.sdk.contents.get(r.address,function(e){var n=g.app.platform.sdk.contents.getsorteditems(e),a=_.map(n,function(e){return e.txid}),t=_.indexOf(a,i),s={currentindex:t+1,allength:a.length,leftid:null,rightid:null};0<t&&(s.leftid=a[t-1]),t<a.length-1&&(s.rightid=a[t+1]),g.shell({name:"post",el:o,data:s},function(a){var e="author?address="+r.address,n=app.platform.api.name(r.address);n&&(e=n.toLowerCase()+"?"),g.app.platform.papi.post(i,a.el.find(".postcnt"),function(e,n){external=n,c&&l.c.find(".contentswrapper").hcSticky("refresh"),a.el.find(".postauarrows").addClass("active")},{hr:e})})})},lenta:function(a,t){var s=function(){var e={name:"lenta",el:a,data:{}};g.shell(e,function(e){if(g.nav.api.load({open:!0,id:"lenta",el:a.find(".authorlentawrapper"),animation:!1,mid:r.address,essenseData:o,clbk:function(e,n){t.module=n,c&&l.c.find(".contentswrapper").hcSticky("refresh")}}),!isMobile()&&r.data&&r.data.name){var n=e.el.find(".authorlentawrappermain");e.el.find(".authorsearchicon .icon").on("click",function(){n.toggleClass("searchactive"),n.hasClass("searchactive")?n.find(".search input").focus():(n.find(".search input").val(""),b())}),new search(e.el.find(".authorsearch"),{placeholder:"SEARCH ON "+r.data.name.toUpperCase(),clbk:function(e){},last:{get:function(){return[]},tpl:function(e,n){}},events:{search:function(e,n,a,t){var s="?report=shares&ss="+e.replace("#","tag:");b(!0);var o={href:s,history:!0,open:!0,handler:!0};g.nav.api.go(o),n&&n(!0)},clear:function(e){}}}),parameters().ss&&(n.addClass("searchactive"),n.find(".search input").val(parameters().ss))}})},e="author?address="+r.address,n=app.platform.api.name(r.address);n&&(e=n.toLowerCase()+"?");var o={author:r.address,byauthor:!0,hr:e,renderclbk:function(){c&&l.c.find(".contentswrapper").hcSticky("refresh")}};"b"==parameters().r?(e=n.toLowerCase()+"?r=b&mt="+parameters().mt,o.beginmaterial=parameters().mt,o.contents=!0,g.app.platform.sdk.contents.get(r.address,function(e){var n=g.app.platform.sdk.contents.getsorteditems(e);o.txids=_.map(n,function(e){return e.txid}),s()})):(parameters().ss&&(o.search=!0,o.searchValue=parameters().ss,o.loader=function(t){v("posts",deep(h,"data.length")||0,10,function(e){var n,a;n=e,a=g.app.platform.sdk.node.shares.transform(n),t&&t(a,null,{count:10})})}),s())}},m=function(){},h=null,b=function(e){parameters().ss&&(g.app.platform.sdk.search.clear(),i=h=null,e||f.report(u.shares,!0))},v=function(e,n,a,t){var s=0,o=10;if(h&&(s=h.data.length,o=h.count),console.log(n,a,deep(h,"data.length")),!(n+a<=s)){if(n<s){var i=s-n;n=s,a-=i}o<n+a&&(a=o-n),a<=0||w[e](function(e){t&&t(e)},n,a)}},w={posts:function(a,e,n){g.app.platform.sdk.search.get(parameters().ss,"posts",e,n,i||null,function(e,n){console.log("RESULT",e,h),i=n,h||(h=e),a(h.data)},r.address)}};return{primary:n,parametersHandler:function(){var e=parameters().report||"shares";f.report(u[e],null,!0),f.menu()},getdata:function(n,e){r={},g.app.platform.sdk.search.clear();var a=e.settings.essenseData||{},t=parameters();s=e.state,t.address||(t.address=a.address),c=!1,h=i=null,g.sdk.users.addressByName(t.address,function(e){e&&(r.address=e,g.sdk.users.get(r.address,function(){g.sdk.ustate.get(r.address,function(){if(g.app.platform.sdk.address.pnet()&&r.address==g.app.platform.sdk.address.pnet().address){if(u.shares.name=g.app.localization.e("myuposts"),!g.app.user.validate())return void g.nav.api.go({href:"userpage?id=test",history:!0,open:!0})}else u.shares.name=g.app.localization.e("uposts");r.data=g.sdk.users.storage[r.address],r.state=g.sdk.ustate.storage[r.address],n({author:r})})}))})},destroy:function(){t&&t.destroy(),t=null,a&&a.destroy(),window.removeEventListener("resize",d.panelPosition),window.removeEventListener("scroll",p.panelTopPosition),window.removeEventListener("scroll",d.showHideUp),delete g.app.platform.ws.messages.event.clbks.author,delete g.app.platform.clbks.api.actions.subscribe.author,delete g.app.platform.clbks.api.actions.unsubscribe.author,p.destroy();var e=deep(g,"app.modules.menu.module.destroyauthorsearch");e&&isMobile()&&e(),l={}},init:function(e){var n,a;setTimeout(function(){var e=deep(g,"app.modules.menu.module.initauthorsearch");e&&isMobile()&&(r.clear=b,e(r))},300),m(),(l={}).c=e.el.find("#"+g.map.id),l.lenta=l.c.find(".lentaWrapper"),l.menu=l.c.find(".usermenu"),l.panel=l.c.find(".panel"),l.caption=l.c.find(".bgCaption"),l.fxd=l.c.find(".fxd"),l.subscribe=l.c.find(".subscribebuttonstop"),l.up=l.c.find(".upbuttonwrapper"),l.w=$(window),l.contents=l.c.find(".contentswrapper"),l.info=l.c.find(".authorinfoWrapper"),n=!0,a=parameters().report||"shares",u[a].active=!0,f.report(u[a],null,n),f.menu(),g.app.user.isState(function(e){if(e){var n=g.app.platform.sdk.users.storage[g.app.platform.sdk.address.pnet().address];n&&n.relation(r.address,"blocking")&&l.caption.addClass("blocking")}}),t=g.app.platform.api.upbutton(l.up,{top:function(){return"65px"},class:"light",rightEl:l.c.find(".leftpanelcell")}),g.app.platform.sdk.contents.get(r.address,function(e){f.contents(e)}),isMobile()||f.info(l.info),l.up.on("click",d.up),l.subscribe.find(".subscribe").on("click",d.subscribe),l.subscribe.find(".unsubscribe").on("click",d.unsubscribe),l.subscribe.find(".subscribeprivate").on("click",d.subscribePrivate),l.caption.find(".unblocking").on("click",function(){dialog({html:"Do you really want to unblock user?",btn1text:"Unblock",btn2text:"Cancel",class:"zindex",success:function(){g.app.platform.api.actions.unblocking(r.address,function(e,n){e||g.app.platform.errorHandler(n,!0)})}})}),g.app.platform.ws.messages.event.clbks.author=function(e){"subscribe"!=e.mesType&&"unsubscribe"!=e.mesType||(l.c.find('.toReport[report="followers"] .count').html(u.followers.count()),l.c.find('.toReport[report="following"] .count').html(u.following.count()))},g.app.platform.clbks.api.actions.subscribe.author=function(e){e==r.address&&(l.subscribe.addClass("following"),l.c.find('.toReport[report="followers"] .count').html(u.followers.count()),l.c.find('.toReport[report="following"] .count').html(u.following.count()))},g.app.platform.clbks.api.actions.unsubscribe.author=function(e){e==r.address&&(l.subscribe.removeClass("following"),l.c.find('.toReport[report="followers"] .count').html(u.followers.count()),l.c.find('.toReport[report="following"] .count').html(u.following.count()))},g.app.platform.clbks.api.actions.blocking.author=function(e){e==r.address&&l.caption.addClass("blocking")},g.app.platform.clbks.api.actions.unblocking.author=function(e){e==r.address&&l.caption.removeClass("blocking")},g.user.isItMe(r.address)&&g.app.nav.api.backChainClear(),e.clbk(null,e)}}};return g.run=function(e){var n=g.addEssense(a,t,e);g.init(n,e)},g.stop=function(){_.each(a,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=author:(app.modules.author={},app.modules.author.module=author);
 /*_____*/ 
var post=function(){var D=new nModule,t={},n=function(s){var a,r,d,i,t=deep(s,"history")||deep(s,"primary"),o="",p=null,l=0,c={repost:function(e){var s="index";isMobile()&&(s="share"),D.closeContainer(),D.nav.api.load({open:!0,href:s+"?repost="+e,history:!0,handler:!0,essenseData:{},clbk:function(e){}})},next:function(){a.wnd.off("scroll");var s=a.c.find(".nextpost");s.html('<div class="loader"><div class="preloader5"><span></span><span></span><span></span></div></div>'),d.next(r.txid,function(e){e?D.nav.api.load({open:!0,href:"post?s="+e,eid:"nextpost"+e,el:s,clbk:function(){},essenseData:{share:e,hr:d.hr,like:d.like,next:d.next,removemargin:!0}}):s.html('<div class="ended">End of posts</div>')})},sharesocial:function(e){var s="https://pocketnet.app/"+(d.hr||"index?")+"s="+r.txid+"&mpost=true&ref="+D.app.platform.sdk.address.pnet().address;parameters().address&&(s+="&address="+(parameters().address||""));var t=r.message,n=trimHtml(t,130).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"..."),a=r.images[0];if(!a&&r.url){var i=videoImage(r.url);i&&(a=i)}var o="Post";"a"==r.settings.v&&(o="Article"),D.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{url:s,caption:"Share this "+o,image:a,title:r.caption||deep(app,"platform.sdk.usersl.storage."+r.address+".name"),text:n}})},donate:function(e){var s=deep(app,"platform.sdk.usersl.storage."+r.address)||{address:r.address,addresses:[]},t="send?address="+r.address+"&amount=1&message="+hexEncode(D.app.localization.e("postlabel")+" &mdash; "+(r.caption||r.message).substr(0,20)+"...")+"&label="+(s.name||s.address)+"&setammount=true";D.fastTemplate("donation",function(e){dialog({html:e,class:"one donation",btn1text:D.app.localization.e("dcancel"),clbk:function(e,s){e.find(".pnetdnt").on("click",function(){D.nav.api.load({open:!0,href:t,history:!0}),D.closeContainer(),s.destroy()}),e.find(".copy").on("click",function(){var e=$(this).closest(".address").find(".addr");copyText(e),sitemessage(D.app.localization.e("successfullycopiedaddress"))})}})},{userinfo:s})},position:function(){if(!isMobile()&&!t&&!d.removemargin){var e=($(window).height()-a.wr.height())/2;0<e?a.wr.css("margin-top",e+"px"):a.wr.css("margin-top","0px")}},initVideo:function(t){if(!D.app.platform.sdk.usersettings.meta.embedvideo||D.app.platform.sdk.usersettings.meta.embedvideo.value){var e=a.c.find(".js-player, [data-plyr-provider][data-plyr-embed-id]");if(e.length){var n={resetOnEnd:!0,muted:!1};$.each(e,function(e,s){PlyrEx(s,n,function(e){e.on("ready",function(){t&&t()})})})}}},likeWithR:function(e,s){},like:function(e,t){var s=r.upvote(e);if(!s)return D.app.platform.errorHandler("4",!0),void(t&&t(!1));D.sdk.node.transactions.create.commonFromUnspent(s,function(e,s){topPreloader(100),e?t&&t(!0):(r.myVal=null,D.app.platform.errorHandler(s,!0),t&&t(!1))})},complain:function(e){D.nav.api.load({open:!0,id:"complain",inWnd:!0,essenseData:{item:"post",obj:r,success:function(){}},clbk:function(){}})},unsubscribe:function(t){D.app.platform.api.actions.unsubscribe(r.address,function(e,s){e||D.app.platform.errorHandler(s,!0),t&&t(e,s)})},subscribe:function(t){D.app.platform.api.actions.subscribe(r.address,function(e,s){e||D.app.platform.errorHandler(s,!0),t&&t(e,s)})},openGalleryRec:function(t,e){var n=[],a=function(e,t){_.each(e.images,function(e){n.push(e)}),e.repost?D.app.platform.sdk.node.shares.getbyid(e.repost,function(e){var s=e[0];s?a(s,t):t&&t()}):t&&t()};a(r,function(){var e=_.map(n,function(e){return{src:e}}),s=findIndex(e,function(e){if(e.src==t)return!0});D.app.nav.api.load({open:!0,href:"imagegallery?i="+r.txid+"&num="+(s||0),inWnd:!0,history:"true",essenseData:{initialValue:t,idName:"src",images:e}})})},openGallery:function(s){var e=_.map(r.images,function(e){return{src:e}}),t=findIndex(e,function(e){if(e.src==s)return!0});D.app.nav.api.load({open:!0,href:"imagegallery?i="+r.txid+"&num="+(t||0),inWnd:!0,history:"true",essenseData:{initialValue:s,idName:"src",images:e}})}},n=function(){c.repost(r.txid)},u=function(){var e=$(this),s=r.txid;D.app.platform.api.metmenu(e,s,c)},f=function(){a.wnd.scrollTop()+a.wnd.height()>a.wnd.find(">div#post").height()-400&&c.next()},m=function(e){c.unsubscribe(function(){tx&&a.share.find(".shareTable").removeClass("subscribed")})},h=function(e){c.subscribe(function(e){e&&a.share.find(".shareTable").addClass("subscribed")})},v=function(){D.app.platform.sdk.node.transactions.get.tx(r.txid)},g=function(){var n=$(this).attr("value");D.app.user.isState(function(e){if(e){var t=$(this).closest(".stars");if(t.attr("value"))return;t.attr("value",n),t.addClass("liked"),c.like(n,function(e){if(e){r.scnt||(r.scnt=0),r.score||(r.score=0),r.scnt++,r.score=Number(r.score||0)+Number(n);var s=Number(r.score)/Number(r.scnt);t.find(".tstarsov").css("width",s/5*100+"%"),t.closest(".itemwr").find(".count span.v").html(s.toFixed(1)),w.stars(),d.like&&d.like(r)}else t.removeAttr("value"),t.removeClass("liked")})}else D.nav.api.load({open:!0,href:"authorization",history:!0})})},b=function(){dialog({html:"Do yor really want to complain on this post?",btn1text:"Yes",btn2text:"No",success:function(){a.share.addClass("complained"),topPreloader(30),c.complain(function(e){topPreloader(100),e||s.removeClass("hidden")})}})},k=function(){var e=$(this).attr("i");c.openGalleryRec(e)},x=function(){D.app.platform.m.log("sharing_opened_post",r.txid),c.sharesocial()},y=function(){c.donate()},w={comments:function(n){D.fastTemplate("commentspreview",function(e){var s=a.c.find(".commentsWrapper"),t="https://pocketnet.app/"+(d.hr||"index?")+"s="+r.txid+"&mpost=true&ref="+D.app.platform.sdk.address.pnet().address;parameters().address&&(t+="&address="+(parameters().address||"")),D.nav.api.load({open:!0,id:"comments",el:s,eid:r.txid+"post",essenseData:{hr:t,totop:a.c,caption:e,send:function(){var e=a.c.find(".commentsAction .count span");e.html(Number(e.html()||"0")+1)},txid:r.txid,showall:!0,reply:d.reply,fromtop:!0,additionalActions:function(){D.closeContainer()}},clbk:function(e,s){c.position(),i=s,n&&n()}})},{share:r})},empty:function(){D.shell({name:"empty",el:a.share},function(e){c.position()})},images:function(e){var s=a.c.find(".image"),t=a.c.find(".images");!t.hasClass("active")&&s.length&&t.length?s.imagesLoaded({background:!0},function(i){"a"!=r.settings.v&&_.each(i.images,function(e,s){var t=e.img,n=$(i.elements[s]).closest(".imagesWrapper"),a=n.width();n.height(),t.width,t.height;t.width<n.width()?(n.find(".image").width(t.width),n.find(".image").height(t.height)):n.height(a*(t.height/t.width))}),t.addClass("active"),s.addClass("active"),e&&e()}):e&&e()},share:function(s){D.shell({turi:"lenta",name:"share",el:a.share,additionalActions:function(){D.closeContainer()},data:{share:r,all:!0,mestate:{},repost:d.repost}},function(e){a.stars=a.share.find(".forstars"),c.position(),a.wr.addClass("active"),w.stars(function(){w.url(function(){w.repost(),c.position(),w.urlContent(function(){c.position(),c.initVideo(),w.images(function(){d.repost||(c.position(),a.share.find(".stars i").on("click",g),a.share.find(".complain").on("click",b),a.share.on("click",".image",k),a.share.on("click",".forrepost",n),a.share.find(".txid").on("click",v),a.share.find(".donate").on("click",y),a.share.find(".sharesocial").on("click",x),a.share.find(".asubscribe").on("click",h),a.share.find(".aunsubscribe").on("click",m),a.share.find(".metmenu").on("click",u)),s&&s()})})})})})},stars:function(s){D.shell({turi:"lenta",name:"stars",el:a.stars,data:{share:r}},function(e){fastars(e.el.find(".stars")),s&&s()})},repost:function(e){r.repost&&D.shell({turi:"lenta",name:"repost",el:a.c.find(".repostWrapper"),data:{repost:r.repost,level:l,share:r}},function(e){c.position(),e.el&&e.el.length&&D.app.platform.papi.post(r.repost,e.el.find(".repostShare"),function(e){p=e,c.position()},{repost:!0,eid:o+r.txid,level:l})})},url:function(s){var e=r.url,t=D.app.platform.sdk.remote.storage[e];D.shell({turi:"share",name:"url",el:a.c.find(".url"),data:{url:e,og:t,share:r},additionalActions:function(){D.closeContainer()}},function(t){var n=t.el.find("img");t.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,s){e.isLoaded?($(n[s]).addClass("active"),500<e.img.naturalWidth&&t.el.addClass("bigimageinlink")):$(n[s]).closest(".image").css("display","none")}),s&&s()})})},urlContent:function(s){var e=r.url;if(e){var t=D.app.platform.parseUrl(e),n=D.app.platform.sdk.remote.storage[e];e&&!n?"youtube"==t.type||"vimeo"==t.type||"bitchute"==t.type?s&&s():D.app.platform.sdk.remote.get(e,function(e){e?w.url(s):s&&s()}):s&&s()}else s&&s()}},C=function(){};return{primary:t,getdata:function(n,a){p=null,o=a.settings.eid||"";var s=deep(a,"settings.essenseData.share");d=deep(a,"settings.essenseData")||{},r=null,l=(d.level||-1)+1,D.app.platform.sdk.node.shares.getbyid([s],function(){if(!(r=D.app.platform.sdk.node.shares.storage.trx[s])){var e=_.find(D.sdk.node.transactions.temp.share,function(e){return e.txid==s});e&&((r=new pShare)._import(e,!0),r.temp=!0,r.address=D.app.platform.sdk.address.pnet().address)}r&&D.app.platform.sdk.node.shares.users([r],function(e,s){var t={ed:deep(a,"settings.essenseData")||{}};n(t)})})},destroy:function(e){a={},d.close&&d.close(),i&&i.destroy(),delete D.app.platform.ws.messages.event.clbks.post,delete D.app.platform.ws.messages.transaction.clbks.temppost,p&&(p.destroy(),p=null)},clearparameters:["s","commentid","parentid"],init:function(e){C(),(a={}).c=e.el.find("#"+D.map.id),a.share=a.c.find(".share"),a.wr=a.c.find(".postWrapper"),a.wnd=a.c.closest(".wndcontent"),r?w.share(function(){w.comments(function(){a.wnd&&a.wnd.length&&d.next&&!isMobile()&&(a.wnd.on("scroll",f),f())})}):w.empty(),e.clbk(null,e),D.app.platform.ws.messages.transaction.clbks.temppost=function(e){e.temp&&r.txid==e.temp.txid&&(r.temp=!1,r.scnt="0",r.score="0",r.myVal=0,w.share())},D.app.platform.ws.messages.event.clbks.post=function(e){"upvoteShare"==e.mesType&&e.share&&r.txid==e.share.txid&&w.stars(function(){})},D.app.platform.clbks.api.actions.subscribe.post=function(e){e==r.address&&a.c.find('.shareTable[address="'+e+'"]').addClass("subscribed")},D.app.platform.clbks.api.actions.unsubscribe.post=function(e){e==r.address&&a.c.find(".shareTable").removeClass("subscribed")}},wnd:{class:"withoutButtons postwindow",swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30,close:function(){}}}};return D.run=function(e){var s=D.addEssense(t,n,e);D.init(s,e)},D.stop=function(){_.each(t,function(e){e.destroy()})},D}();"undefined"!=typeof module?module.exports=post:(app.modules.post={},app.modules.post.module=post);
 /*_____*/ 
var faq=function(){var u=new nModule,o={},a=function(e){var a,t=deep(e,"history"),o=[{name:"Technical",id:"technical",group:[{id:"downloadclient",q:"Where do I download the client?",a:'<div><a href="https://github.com/pocketnetteam/pocketnet.gui/releases/latest">https://github.com/pocketnetteam/pocketnet.gui/releases/latest</a></div><div>Click on PocketnetSetup.exe</div>'},{id:"downloadclient",q:"Where do I download the node?",a:'<div><a href="https://github.com/pocketnetteam/pocketnet.core/releases/latest">https://github.com/pocketnetteam/pocketnet.core/releases/latest</a></div><div>With any questions email core@pocketnet.app</div>'}]},{name:"Pocketnet",id:"roadmap",group:[{id:"walletaddresses",q:"I see a PN address and a wallet address... are both these addresses on the PN blockchain?",a:"<div>PN address is the one used for posting content and using social network in general. It also keeps coins that you win for your highly rated posts.</div><div>Wallet addresses are to keep the rest of coins.</div>"},{id:"linktoprofile",q:'Can I link to my profile? or my "page"? So that i can post it into my community to bring members over.',a:"<div>In the browser, go to your profile by clicking on avatar in the upper right and just copy the browser address, everyone who will sign up from that link will follow you automatically and you will actually get rewards.</div>\t\t\t\t\t\t\t<div>On the desktop,  from a desktop application go to your profile,  once there, there will be three icons to the right of your avatar first there will be a wallet with number of coins, then a bell with notifications and a third is a green cross icon click on that green cross  and click copy,  send that link around everyone who subscribes will follow you and you will get rewards.</div>"},{id:"starsystem",q:"The star system. is there a limit on how many stars a person has to give people?",a:"<div>There are some limits. But as your reputation grows you can upvote more and more. This is done, so bots don&rsquo;t break down our blockchain. Initially you get 100 ratings every 24 hours. As your reputation grows (that happens by posting and getting rated), then you do 200 ratings a day.</div>"},{id:"updateprofiletime",q:"How long until I&rsquo;m able to update my profile? ",a:"<div>You are able to update your profile once every hour.</div>"},{id:"linuxdesktop",q:"Is there a Linux Desktop?",a:"<div>Yes! It is in the works 2-3 weeks as the beta test progresses.</div>"},{id:"savevideo",q:"Where do you save the video content?",a:"<div>We are working on video storage, in the meantime you can share from Bitchute, Youtube, Vimeo and other video sources.</div>"},{id:"mobileapp",q:"Is there a mobile app?",a:"<div>Mobile app is not ready yet. We plan it for July 2019. But we strongly encourage everyone to also download the desktop app, since, unlike Android or iPhone app, it cannot be taken away from you by Google or Apple.</div>"},{id:"postinglimit",q:"Can you tell me what is the limit for posting each day or hour?",a:"<div>We do have some limitations, but after testing it we have increased our limits. At the outset you can make 15 posts and issue 100 ratings every 24 hours. Once your reputation grows above 50, you will be able to make up to 30 posts and 200 ratings every 24 hours.</div>"},{id:"reputation",q:"What is reputation and how is it calculated?",a:"<div>Your reputation is the sum of your ratings calculated in the following way. Note, that users with reputation below 50 do not affect anyone's reputation or coin winnings. They can rate the content, but it does not affect reputation.</div>\t\t\t\t\t\t<div>5=2<br>4=1<br>3=0<br>2=-1<br>1=-2</div><div>So, if you have two 5 start ratings and one 1 star rating, the total will be 2+2-2=2</div>"},{id:"deletepostoruser",q:"Is there a way to delete or edit a post?",a:"<div>Not at this point, as it is baked into blockchain. However, we are working on a feature to create an overwrite transaction as well &#10075;hide&#10076; transaction, which would effectively translate to edit or delete.</div>"},{id:"usersearch",q:"Is there a way to search for a user?",a:"<div>Click the search magnifying glass on the top and search by username or by keywords.</div>"},{id:"follow",q:"How do you follow someone?",a:"<div>Next to post author (on top of post) there is a Follow link, you can find his posts in Top posts (red flame on top of the page). You will also soon see Subscriptions feed, which is going to be different from the main feed. The main feed will be everything that anyone posts chronologically, but Subscriptions feed will only contain posts from people you follow. So, you will go into general feed in search of good content, though you may not like everything. Then select those you want to keep. Kind of like fishing :)</div>"},{id:"otherbrowsers",q:"Can it be used on Brave or Duck Duck go browsers?",a:"<div>Pocketnet should work on those browsers. It is fully functional on Chrome and Firefox. But we strongly encourage everyone to download the desktop app (grab PocketnetSetup.exe here: https://github.com/pocketnetteam/pocketnet.gui/releases/tag/v0.0.33-beta). It cannot be blocked ever (even if pocketnet.app is down or blocked for some reason). This is a serious consideration in totalitarian and quasi-totalitarian countries which, if you think about it, is beginning to include more and more of the globe.</div>"},{id:"replypost",q:"Can we reply to our own/and other&rsquo;s posts?",a:"<div>Yes, commenting is live below each post..</div>"},{id:"addtags",q:"How to add a tag to a post?",a:"<div>Just type in the field tag and press enter. No need to specify #, it will be added automatically.</div>"},{id:"usepublicaddress",q:"How can I use the public address?",a:"<div>Your public address is what Pocketnet uses to verify your identity. Essentially, your private key is a really large number (that can be represented with a 12 word sequence or a QR code). This number gets multiplied by another that everyone knows (called a base point) and we get a public key. When you enter your private key, we can multiply it by the base point to get your public key and we can match it against public address. If they match, we know it is you. It is impossible to go back i.e. to divide public key by the base point to get your private key. The way multiplication in cryptography works is it is only one way and cannot be reversed, so your key is safe. Pocketnet uses the same exact cryptography as Bitcoin.</div>"},{id:"desktopmac",q:"Will there be a downloadable executable for Mac?",a:"<div>Yes - we are working of Mac platform. Target is for mid-April.</div>"}]},{name:"Pocketcoin",id:"pocketcoin",group:[{id:"pocketcoin",q:"What can I do with Pocketcoin?",a:"<div>Currently you can win it or send as a gift. However, if and when Pocketnet takes off, Pocketcoin will be the main method of buying advertising on the platform. Advertisers will be able to easily find content authors with the right audience and then offer them advertising opportunities. This will be a trustless endeavor (i.e. neither side can cheat), because of something called multi-signature contracts. Multisig contract requires a digital signature of both parties to be valid. When advertiser offers an ad to the content creator, he creates the first of two required signatures. He signs the actual ad and the amount bid. Content creator reviews this partially signed multisig and if it is accepted, then he appends the second signature. When a blockchain sees both signatures, content creator is automatically paid and an ad is automatically shown on creator’s channel. These transactions will only be done through Pocketcoin. Thus, if Pocketcoin becomes big, it will be an immensely valuable token.</div>"},{id:"pocketcoinstock",q:"Is Pocketcoin like a share of stock in Pocketnet?",a:"<div>Definitely no. Pocketnet is not even a corporation and does not have any ownership. It is an open source code that anyone can copy and run. Pocketcoin is a token that facilitates value exchange, specifically advertising transactions. In addition, Pocketnet will include a marketplace where goods and services will be sold directly for Pocketcoin</div>"},{id:"pocketcoinbuy",q:"Can I buy additional Pocketcoin?",a:"<div>Yes, we will create a way to buy Pocketcoin for Bitcoin and a few other cryptocurrencies on pocketnet.app. All proceeds of sales will be used to advertise Pocketnet to the world. So, by buying a Pocketcoin you are positioning yourself for success of Pocketnet, but just as importantly you are helping Pocketnet achieve this success. All major social networks had billion dollar advertising budgets. Pocketnet was funded by its founders and developers worked only for Pocketcoin. We need you to help us spread the word. To go the extra mile consider buying some Pocketcoin to help us advertise the site. To buy Pocketcoin you will need to first buy Bitcoin or some other cryptocurrency, which is exceedingly easy now.</div>"},{id:"pocketcoinbuyfiat",q:"Can I buy Pocketcoin for US Dollars or other fiat currency?",a:"<div>No.</div>"}]},{name:"Privacy",id:"privacy",group:[{id:"anonymous",q:"Are people who do not enter their real names anonymous?",a:"<div>Yes - no names, phones, email is NOT connected to your account in any way, it is just optionally entered to receive newsletter updates.</div>"},{id:"viewoutside",q:"Can someone view a profile (someone&rsquo;s posts) outside the garden? Is it a walled garden?",a:"<div>Since the whole blockchain and all the posts are in opensource anyone can have access to your posts and profile. They just know that it is linked to your public address. In practice, you can have multiple accounts. You can use some with your real name and others anonymously. Anonymity is a great tool to protect free speech from abuse of power.</div>"},{id:"walletid",q:"Is my public key like a wallet ID that I enter on my profile and people can send points to?",a:"<div>Exactly. And it is safe to reveal. But not a secret phrase - keep it safe!</div>"},{id:"runnode",q:"Can I run a node on my headless server?",a:"<div>We will put the node&rsquo;s sources into GitHub. Instructions for running a node will be made available in early April.</div>"},{id:"signback",q:"How can I sign back in?",a:"<div>You can use your private 12-word key or a QR code to sign in.</div>"}]},{name:"Curation of content",id:"curation",group:[{id:"content",q:"Is any content allowed on Pocketnet? If some content is not allowed, can the platform still be called free speech?",a:"<div>This is a very important question and we will be releasing many videos and articles about it, as well as looking for your input. To begin with, not all types of content are allowed. However, and this is crucial, the enforcement is transparent and up to the community in the way we will explain below. Enforcement is done by the community and is in the open with no hidden shadow bans or selective banning practiced by the Silicon Valley.</div>"},{id:"specific",q:"Specifics of curation on Pocketnet.",a:"<div>When your reputation gets to 100 and you press on dots in the upper right of any post, you will see an option to Complain. If enough Complaints come in, the post will not be shown anymore. When someone has more than 2 posts that are voted off the platform in 24 hours, they cannot post for another 48 hours after the second post. Complain is completed when number of complaints is at least ⅓ of the number of 4 and 5 star ratings, subject to a minimum of 10 complaints (which will be adjusted over time in consultation with the community).</div><div>We are extremely and passionately pro-speech. However, we do not want to turn Pocketnet into a marginal forum where lunatics reign. What would cause you to Complain?</div><div>Do NOT complain about stuff that you simply don’t like or that offends you. That is not a high enough bar. Do not follow people who offend you, soon we will have a feature for not seeing their posts, but do not complain about them. Complain only about things that threaten long term viability of Pocketnet as a mass communication platform that intends to reach to all levels of society in many countries.</div><div>We strongly recommend that you complain about porn of any kind. There are plenty of porn sites on the web, we do not want to mix our free speech endeavor with that. We strongly encourage the community to vote off porn. Secondly, any type of a direct threat should be voted off and clear examples of racism should too. If we allow MSM to tie us to racism or violence directly, Pocketnet will cease to exist before we can even get it out there. Just because MSM media cries wolf about fake racism, doesn’t mean we should prove them right by tolerating it in our platform. It will detract from what we are trying to achieve, which is to challenge new totalitarianism created by the unholy alliance of media, finance and corrupt government officials.</div> "},{id:"racism",q:"Important Note on Racism.",a:"<div>Free thought and free speech is under attack on mainstream social platforms and in the media. We need to speak the truth and this platform is non-corporate and decentralized for that very reason. But we ask everyone make your point without attacking people&rsquo;s nationality or race. You can make your point based on evidence. We cannot afford to turn Pocketnet into a marginal platform. Speak the truth, but please avoid racism and attacks against specific nationalities on the whole. We know that Silicon Valley and MSM has turned the issue of racism into their playing card and they constantly cry wolf. Even more the reason for us to be measured and evidence based and not let them smear us with that. If we are not, we are not allowing most of the population to weigh the evidence of MSM corruption presented on Pocketnet. Please keep that in mind, so that free speech can thrive and we can beat the facebokks of the world.</div><div>Ultimately, it is the community that will determine the direction of the platform. Having a bunch of snowflakes that complain about stuff that offends them is equally as bad as when people want to voice direct violent threats. However, the first indication is that early users of the platform are generally intelligent and evidence based, so the future looks incredibly bright. Pocketnet team has noticed after a few days of the beta test, that we stopped reading even alternative news, because there was so much interesting content on Pocketnet. Keep it up!</div><div>Please get involved in the discussion on these topics. This is a community platform. We are always eager to improve transparency of the platform and you should let us know how we can improve our content curation and policing. Use group chat or email support(at)pocketnet*dot*app or make full posts on this topic.</div>"}]},{name:"Specifics of curation on Pocketnet.",id:"specificscuration",group:[{id:"trolls",q:"Is any content allowed on Pocketnet? If some content is not allowed, can the platform still be called free speech?",a:"<div>Sometimes we can have a user who comes in with a specific purpose to attack Pocketnet by posting a series of vile images. To protect against that we have a following mechanism. If someone’s reputation reaches -50 (negative 50), their account is automatically blocked. Getting a reputation of -50 is equivalent to having 25 one star ratings and no four or five star ratings. This is nearly impossible to achieve without having lots of bad posts.</div>"},{id:"flagging",q:"Flagging a specific post",a:"<div>When your reputation gets to 50 and you press on dots in the upper right of any post, you will see an option to Complain. If enough Complaints come in, the post will not be shown anymore. Complain is completed when number of complaints is at least ⅓ of the number of 4 and 5 star ratings, subject to a minimum of 10 complaints (which will be adjusted over time in consultation with the community).</div><div>We are extremely and passionately pro-speech. However, we do not want to turn Pocketnet into a marginal forum where lunatics reign. What would cause you to Complain?</div><div>Do NOT complain about stuff that you simply don’t like or that offends you. That is not a high enough bar. Do not follow people who offend you, soon we will have a feature for not seeing their posts, but do not complain about them. Complain only about things that threaten long term viability of Pocketnet as a mass communication platform that intends to reach to all levels of society in many countries.</div><div>We strongly recommend that you complain about porn of any kind. There are plenty of porn sites on the web, we do not want to mix our free speech endeavor with that. We strongly encourage the community to vote off porn. Secondly, any type of a direct threat should be voted off and clear examples of racism should too. If we allow MSM to tie us to racism or violence directly, Pocketnet will cease to exist before we can even get it out there. Just because MSM media cries wolf about fake racism, doesn’t mean we should prove them right by tolerating it in our platform. It will detract from what we are trying to achieve, which is to challenge new totalitarianism created by the unholy alliance of media, finance and corrupt government officials.</div>"}]},{name:"How is Pocketnet different from...",id:"differents",group:[{id:"differents1",q:"Twitter, Facebook, Reddit & other centralized platforms?",a:"<div>There is no central authority or corporation. Platform is run by equal nodes on a blockchain. All revenue is split between node operators and content creators. Node operators stake Pocketcoin in order to mint blocks with rewards and transactions fees. Half of rewards in each block go to content creators based on ratings their content gathers from users.</div>"},{id:"differents2",q:"Decentralized platforms like Minds.com and Sola?",a:"<div>Both of those platforms, while great, are not self-contained. Both are highly dependent on the Ethereum platform, because their tokens are based on ERC-20 Ethereum standard. That means that operations with tokens carry Ether gas fees. Also, those entities have corporations behind them and a corporation will always be a point of centralization due to its economic logic of growing profits. In addition, corporations are exceedingly easy to censor.</div>"},{id:"differents3",q:"From Steemit?",a:"<div>Steemit has its own blockchain, but is a corporate entity with all of the centralization that comes from that.</div>"},{id:"differents4",q:"Decentralized platforms like Mastodon and others?",a:"<div>While Mastodon is a fully decentralized platform, it requires a great deal of technical knowledge to use. This presents a great hindrance to potential widespread acceptance. Pocketnet features a web and desktop applications and users can log in from any device, pull in their personal settings from the blockchain and start using the platform immediately without any technial knowledge.</div>"}]},{name:"Pocketnet ecosystem",id:"ecosystem",group:[{id:"ecosystem1",q:"How is Pocketnet develpment funded?",a:"<div>Pocketnet is open sourced and is currently run by the group of volunteers with some serious programming and math skills. After launch Pocketnet will attract top programming talent based on its promise of creating a decentralized fair social network. Programmers and marketers working on Pocketcoin receive 5% of emission. The awards to developers and marketers will be assigned by nodes voting in a transparent manner.</div>"},{id:"ecosystem2",q:"What is Pocketcoin?",a:"<div>Pocketcoin is a network token. It is used exclusively to buy advertising from Pocketnet contributors and to pay transaction fees for such payments. Pocketcoin emission depends on the number of users of Pocketnet and has inherent algorithmic factors tying its long term value to Annual Revenue Per User (ARPU). ARPU is a term in digital advertising which signifies the total amount of revenue platform receives for one active user per year. In Pocketent all of the revenue is split between content creators and nodes.</div>"},{id:"ecosystem3",q:"How are content creators and node operators rewarded?",a:"<div>Pocketnet features unique Direct Marketplace where content creators can sell advertising to ad buyers. Content creators set their price and can accept mass-produced ads or can offer highly valued custom placements (creators pitching the product in their own way). Direct Marketplace is essentially an exchange for advertising that allows ad buyers target specific audiences without any intermediaries. All ad buys and ads themselves are linked on the blockchain, therefore ad buying is completely trustless.</div>"},{id:"ecosystem4",q:"What if users post illegal content, pornography and SPAM?",a:"<div>Pocketnet is not a darknet platform or some sort of pornhub. While it is decentralized and censorship resistant, it is policed by the users. Any illegal content is flagged and removed from the platform using the Wikipedia model. This means that users with highest reputation can police the platform. However, there are safeguards in place (within the open source code) from same or very similar group(s) of people repeatedly voting content off the platform. Also, users are explicitly encouraged to flag illegal content OR content that threatens mass adoption of Pocketnet, not simply the content they find offensive. To make sure that Pocketnet is a free speech platform, we encourage you to start participate, grow your reputation and police the platform properly without the censorship currently prevalent in centralized social media.</div>"},{id:"ecosystem5",q:"Who runs the Pocketnet?",a:"<div>There is no corporate entity or single individual who owns or controls the Pocketnet.</div><div>The Designer of the Pocketnet, Daniel Sachkov changed his main focus in the Summer of 2019 he is now doing research on further decentralization of blockchain technology that will benefit everyone. He handed control of the Project in accordance with the idea of a full decentralized social media architecture and design over to the community and the Nodes who run the Network.</div><div>A team of capable, changing developers and community volunteers is working on the realisation of his Vision ever since. </div>"}]}],i={},n=function(e){_scrollToTop(a.c.find('.faqcnt .question[question="'+e+'"]'),null,null,-110)},s=function(e){_scrollToTop(a.c.find('.faqcnt .group[group="'+e+'"]'),null,null,-110)},r=function(e){console.log(i,e);var t=i[e],o="https://pocketnet.app/help?page=faq&id="+e+"&ref="+u.app.platform.sdk.address.pnet().address,a=t.q;u.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{url:o,caption:"Share FAQ answer in social",title:a}})},l=function(){var e=$(window).height()/4,t=inView(a.c.find(".faqcnt .group"),{offsetTop:e,offsetBottom:e,mode:"line"}),o=null;0<t.length&&(o=$(t[0]).attr("group"),a.contens.removeClass("active"),a.c.find('.contens .item[group="'+o+'"]').addClass("active"))},c=function(){var e=$(this).attr("group");s(e)},d=function(){var e=$(this).closest(".question").attr("question");r(e)},h=function(){};return{primary:t,getdata:function(e){i={},_.each(o,function(e){_.each(e.group,function(e){i[e.id]=e})}),e({groups:o})},destroy:function(){console.log("DESTROY"),window.removeEventListener("scroll",l),a={}},init:function(e){h(),(a={}).c=e.el.find("#"+u.map.id),a.contens=a.c.find(".contens .item"),a.contens.on("click",c),a.c.find(".share").on("click",d),a.c.find(".question .questionName").on("click",function(){$(this).closest(".question").toggleClass("opened")}),window.addEventListener("scroll",l),a.c.find(".contens").hcSticky({stickTo:"#faq",top:65});var t=parameters().id;t&&n(t),e.clbk(null,e)}}};return u.run=function(e){var t=u.addEssense(o,a,e);u.init(t,e)},u.stop=function(){_.each(o,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=faq:(app.modules.faq={},app.modules.faq.module=faq);
 /*_____*/ 
var share=function(){var v=new nModule,t={},n=function(e){var o,s,a,i=/[,.!?;:() \n\r]/g,t=deep(e,"history"),r=null,l=!1,c=null,m=!1,n="Hello Pocketeers!",p={tooltips:function(){p.tooltip||a&&a.destroy()},tooltip:function(){if(m&&r.message.v)return r.tags.length?void 0:(a=v.app.platform.api.plissing({el:o.tagSearch,text:"Add Tags For Your Post"}),!0)},unfocus:function(){o.c&&o.c.addClass("unfocus").removeClass("focus")},waitActions:function(){v.app.platform.sdk.user.waitActions(function(e){o.c&&(e&&"inf"!=e?o.c.addClass("waitActions"):o.c.removeClass("waitActions"))})},autoFilled:function(){p.filled("i",0!=r.images.v.length),p.filled("u",r.url.v),p.filled("t",0!=r.tags.v.length),p.filled("cm",r.message.v||r.caption.v)},filled:function(e,a){var t=o.c.find('.draggablepart[part="'+e+'"]');a?t.addClass("filled"):t.removeClass("filled")},checkUrlForImage:function(a){if(a=a.split("?")[0].toLowerCase(),_.find([".jpg",".gif",".png",".jpeg"],function(e){if(-1<a.indexOf(e))return!0}))return!0},embeding20:function(e){var a=r.export(!0);v.nav.api.load({open:!0,id:"embeding20",inWnd:!0,essenseData:{storage:a,value:e,on:{added:function(e){"url"==type&&e&&p.checkUrlForImage(e)&&(type="images",e=e),r[type].set(e),u[type]&&u[type]()}}}})},embeding:function(n,e){var a=r.export(!0);"article"==n?v.nav.api.load({open:!0,id:"articles",inWnd:!0,history:!0,essenseData:{storage:a,value:e,on:{added:function(e){}}},clbk:function(e){c=e}}):(l=!0,v.nav.api.load({open:!0,id:"embeding",inWnd:!0,essenseData:{type:n,storage:a,value:e,on:{added:function(e){var t=!0;"url"==n&&e&&p.checkUrlForImage(e)&&(n="images",e=e),_.isArray(e)||(e=[e]),_.each(e,function(e,a){t=r[n].set(e),s.share||f.save()}),!t&&d[n]&&sitemessage(d[n]),u[n]&&u[n]()}}},clbk:function(e,a){c=a,console.log("external",c)}}))},addTag:function(e){r.tags.set(e)?(o.error.html(""),s.share||f.save()):o.error.html("You can enter less that 30 tags")},editImage:function(e){var a=_.map(r.images.v,function(e,a){return{original:e,index:a}}),n=_.filter(a,function(e){if(-1<e.original.indexOf("data:image"))return!0});l=!0,v.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:e,images:n,close:function(){setTimeout(function(){l=!1},200)},success:function(e,a){_.each(r.images.v,function(e,a){var t=_.find(n,function(e){if(e.index==a)return!0});t&&(r.images.v[a]=t.original)}),s.share||f.save(),u.images(a)}}})},removeImage:function(t){var e=r.images.v.splice(t,1)[0];o.c.find(".imageContainer").each(function(){var e=$(this),a=e.attr("value");t<a&&e.attr("value",a-1),a==t&&e.remove()}),o.c.find(".imagesEmbWr").isotope();var a=o.eMessage[0].emojioneArea.getText();a=a.split(e).join(""),o.eMessage[0].emojioneArea.setText(a),s.share||f.save()},removelink:function(){var e=r.url.v;r.url.set();var a=o.eMessage[0].emojioneArea.getText();a=a.split(e).join(""),o.eMessage[0].emojioneArea.setText(a),s.share||f.save()},removeTag:function(e){r.tags.remove(e);var a=o.eMessage[0].emojioneArea.getText();a=a.split("#"+e).join(e),o.eMessage[0].emojioneArea.setText(a),s.share||f.save()},applyText:function(e){r.message.set(e)},caption:function(e){r.caption.set(e)},linksFromText:function(e){if(!r.url.v){var a=e.match(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%|_\+.~#/?&//=]*)?/gi);a&&0<a.length&&_.each(a,function(e){if(p.checkUrlForImage(e))-1==r.images.v.indexOf(e)&&(r.images.set(e),u.images());else{if(r.url.v)return;r.url.set(e),u.url()}})}},tagsFromText:function(e){var a=e.split(i),t=_.filter(a,function(e){if("#"==e[0])return!!(e=e.replace(/#/g,""))&&!r.tags.have(e)});t.length&&(_.each(t,function(e){e=e.replace(/\#/g,""),r.tags.set(e)}),u.tags())},post:function(i,e){if(o.postWrapper.removeClass("showError"),s.hash==r.shash())return o.postWrapper.addClass("showError"),void o.error.html("There aren't changes in Post");o.c.addClass("loading"),topPreloader(50),r.uploadImages(v.app,function(){v.sdk.node.transactions.create.commonFromUnspent(r,function(e,a){if(topPreloader(100),o.c.removeClass("loading"),e){try{var t=new pShare;t._import(e,!0),t.temp=!0,t.address=e.address,r.aliasid&&(t.edit="true"),r.time&&(t.time=r.time),v.app.platform.sdk.node.shares.add(t),s.notClear||(r.clear(),v.app.nav.api.history.removeParameters(["repost"]),s.share||f.save(),h())}catch(e){console.log(e)}v.app.platform.sdk.user.get(function(e){e.postcnt++}),m=!1,s.post?s.post():isMobile()?v.app.nav.api.load({open:!0,href:"index",history:!0}):_scrollTop(0),i&&i(!0),p.unfocus(),successCheck()}else if(i)i(!1,d[a]);else{o.postWrapper.addClass("showError");var n=v.app.platform.errorHandler(a,!0);n&&o.error.html(n)}},e)})},error:function(e){var a=r.validation();return a&&!e?(o.postWrapper&&o.postWrapper.addClass("showError"),o.error.html(d[a]),"message"==a&&o.c.find(".emojionearea-editor").focus(),"tags"==a&&o.c.find(".tgs input").focus(),!0):(o.postWrapper&&o.postWrapper.removeClass("showError"),o.error.html(""),!1)},eTextChange:function(e){var a=e.getText();p.tagsFromText(a),p.applyText(a),p.linksFromText(a),u.caption(),s.share||f.save()}},d={message:v.app.localization.e("emptymessage"),tags:v.app.localization.e("emptytags"),images:v.app.localization.e("maximages"),url:"Please add a few words to tell Pocketpeople about your link. What is it about? Why is it important? What is your opinion?",error_video:"Your link to video is invalid. Please load valid video URL."},g={unfocus:function(e){o.c.hasClass("focus")&&!l&&0===o.c.has(e.target).length&&p.unfocus()},selectTime:function(){var e=new Date,a={day:null,hour:(e=e.addMinutes(10)).getHours(),minutes:e.getMinutes()};s.time&&(a.day=s.time.yyyymmdd(),a.hour=s.time.getHours(),a.minutes=s.time.getMinutes()),v.fastTemplate("sharedate",function(e){dialog({html:e,btn1text:v.app.localization.e("daccept"),class:"one sharedate",clbk:function(e){},wrap:!0,success:function(e){var a=e.el.find(".day").val(),t=e.el.find(".hours").val(),n=e.el.find(".minutes").val(),i=strToDateSmall(a);return i=(i=i.addHours(t)).addMinutes(n),new Date<i?(s.time=i,o.selectTime.find(".selectedTime").html(convertDate(dateToStr(i))),s.selectTime&&s.selectTime(i),!0):(sitemessage(v.app.localization.e("pastdate")),!1)}})},{date:a})},changePostTime:function(){var e=$(this),a=$(this).val();if("p"!=a){if("t"==a)p.error()?e.val("w"):s.time&&s.time<new Date&&(s.time=null,o.selectTime.find(".selectedTime").html(v.app.localization.e("timenotselected")),s.selectTime&&s.selectTime(null));a=$(this).val(),s.type&&s.type(a)}else dialog({html:v.app.localization.e("sharenow"),btn1text:v.app.localization.e("dyes"),btn2text:v.app.localization.e("dno"),success:function(){s.type&&s.type(a)},fail:function(){e.val("w")}})},changeAddress:function(){var e=$(this).val(),a=o.c.find(".usericon"),t=deep(app,"platform.sdk.users.storage."+e+".image")||"";t?(a.html(""),a.attr("image",t),bgImages(o.c.find(".icon"))):(a.html('<svg width="30" height="30" data-jdenticon-value="'+e+'"></svg>'),a.attr("image",""),a.css("background","#F9F6F6"),a.css("background-image",""),a.css("background-size",""),a.css("background-position",""),a.css("background-repeat",""),o.c.find("[data-jdenticon-value]").each(function(){var e=$(this),a=e.data("jdenticon-value");e.html(jdenticon.toSvg(a,e.width()))})),s.address&&s.address(e)},change:function(){p.error(!0),p.autoFilled()},post:function(){p.error()||p.post()},embeding:function(){var e=$(this).attr("embeding");"embeding20"==e?p.embeding20():p.embeding(e)},addTag:function(e){p.addTag(e),u.tags()},caption:function(){var e=$(this).val();p.caption(e)},eTextChange:function(e,a){p.eTextChange(this)},textChange:function(){var e=$(this).val();p.tagsFromText(e),p.applyText(e),p.linksFromText(e),u.caption()},eText:function(e,a){var t=String.fromCharCode(a.keyCode||a.which),n=this.getText();i.test(t)&&(p.tagsFromText(n),p.linksFromText(n)),p.applyText(n),u.caption(),s.share||f.save()},text:function(e){var a=String.fromCharCode(e.keyCode||e.which),t=$(this).val();i.test(a)&&(p.tagsFromText(t),p.linksFromText(t)),p.applyText(t),u.caption()},removeTag:function(){var e=$(this).closest(".tag").attr("tag");p.removeTag(e),$(this).closest(".tag").remove()},removelink:function(){p.removelink(),u.url()}},u={postline:function(a){v.shell({name:"postline",el:o.postline,data:{share:r,essenseData:s}},function(e){o.panel=o.c.find(".panel .item"),o.postWrapper=o.c.find(".postWrapper"),o.changePostTime=o.c.find(".postTime"),o.selectTime=o.c.find(".selectedTimeWrapper"),o.post=o.c.find(".post"),o.changePostTime.on("change",g.changePostTime),o.selectTime.on("click",g.selectTime),o.panel.on("click",g.embeding),o.post.on("click",g.post),e.el.find(".cancelediting").on("click",function(){v.closeContainer(),s.close&&s.close()}),a&&a()})},tgs:function(a){v.shell({name:"tgs",el:o.tgsWrapperMain,data:{share:r}},function(e){o.tags=o.c.find(".tagsCont"),o.tagSearch=o.c.find(".searchWrapper"),search(o.tagSearch,{placeholder:v.app.localization.e("addtags"),clbk:function(e){},time:0,events:{fastsearch:function(e,a,t){if(console.log("fastsearch",e,t),t){var n=String.fromCharCode(t.keyCode||t.which);if(/[,.!?;:() ]/.test(n))return g.addTag(e.replace(/#/g,"").replace(/ /g,"")),o.tagSearch.find("input").val("").focus(),void a(null)}v.app.platform.sdk.tags.search(e,function(e){u.tagsResults(e,function(e){a(e,function(e,a){e.find(".result").on("click",function(){var e=$(this).attr("result");a.closeResults(),a.clear(),g.addTag(e)}),e.find(".empty").on("click",function(){var e=trim(o.tagSearch.find("input").val());e&&(a.closeResults(),a.clear(),g.addTag(e))})})})})},search:function(e,a,t){e=(e=e.replace(/#/g," ")).split(" "),1==(e=_.filter(e,function(e){return e})).length&&(e=e[0]),g.addTag(e),t.clear(),a&&a()}},last:{get:function(){return[v.app.localization.e("tnews"),v.app.localization.e("timages"),v.app.localization.e("tvideos"),v.app.localization.e("tmarket"),v.app.localization.e("tsport")]},tpl:function(e,a){u.tagsResults(e,function(e){a(e,function(e,a){e.find(".result").on("click",function(){var e=$(this).attr("result");a.closeResults(),a.clear(),g.addTag(e)})})})}}}),a&&a()})},tags:function(a){o.tags&&(o.tags.find(".tag").remove(),v.shell({name:"tags",inner:append,el:o.tags,data:{tags:r.tags.get(),share:r}},function(e){e.el&&e.el.find(".remove").on("click",g.removeTag),a&&a()}))},tagsResults:function(e,a){v.shell({name:"tagsResult",data:{results:e}},function(e){a&&a(e.rendered)})},all:function(){o.eMessage[0].emojioneArea.setText(r.message.v),o.cpt.find("input").val(r.caption.v||""),o.cpt.val(),u.tgs(u.tags),u.url(),u.caption(),u.images(),u.repost(),u.postline()},caption:function(){r.caption.v?o.cpt.hasClass("active")||o.cpt.addClass("active"):o.cpt.removeClass("active")},url:function(e){var a=r.url.v,i=v.app.platform.parseUrl(a),s=v.app.platform.sdk.remote.storage[a];v.shell({name:"url",inner:html,el:o.urlWrapper,data:{url:r.url.v,og:s,remove:!0,share:r}},function(t){if(r.url.v&&!s)"youtube"==i.type||"vimeo"==i.type||"bitchute"==i.type?(console.log("INITPLAYER"),Plyr.setup(".js-player",function(e){e.muted=!1})):v.app.platform.sdk.remote.get(i.url,function(e){e&&u.url()});else if(s){var n=t.el.find("img");t.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,a){e.isLoaded?($(n[a]).addClass("active"),500<e.img.naturalWidth&&t.el.addClass("bigimageinlink")):$(n[a]).closest(".image").css("display","none")})}),t.el.find(".removeImage").on("click",function(){l=!0,r.settings.image="r",u.url(),f.save(),setTimeout(function(){l=!1},200)})}t.el.find(".removelink").on("click",g.removelink),e&&e()})},images:function(t){v.shell({name:"images",turi:"embeding",inner:html,el:o.images,data:{images:_.map(r.images.v||[],function(e,a){return{src:e,id:a}})}},function(e){e.el.find(".remove").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");p.removeImage(e)}),e.el.find(".edit").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");p.editImage(e)}),e.el.find(".image").on("click",function(){var e=$(this).attr("i");if(e){var a=_.map(r.images,function(e){return{src:e}});v.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:{initialValue:e,idName:"src",images:a}})}}),e.el.find(".image").imagesLoaded({background:!0},function(e){if(isMobile())t&&t(),o.images.addClass("active");else{var a=o.images.find(".imagesEmbWr");a.isotope({layoutMode:"packery",itemSelector:".imageContainer",packery:{gutter:20},initLayout:!1}),a.on("arrangeComplete",function(){t&&t(),o.images.addClass("active")}),a.isotope()}})})},repost:function(a){var t=r.repost.v;v.app.platform.sdk.node.shares.getbyid([t],function(){var e=v.app.platform.sdk.node.shares.storage.trx[t];v.shell({name:"repost",inner:html,el:o.repostWrapper,data:{repost:e,share:r,level:0}},function(e){t&&(v.app.platform.papi.post(t,e.el.find(".repostShare"),function(){},{repost:!0,eid:"share"}),e.el.find(".repostCaption").on("click",function(){r.repost.set(),f.save(),v.app.nav.api.history.removeParameters(["repost"]),u.repost(function(){u.tgs(u.tags),u.postline()})})),a&&a()})})}},f={save:function(){if(r){var e=r.export(!0);e.message==n&&(e.message="");v.app.settings.set(v.map.id,"currentShare",e)}else v.app.settings.set(v.map.id,"currentShare","")},load:function(){var e=v.app.settings.get(v.map.id,"currentShare");return e&&r.import(e),e}},h=function(){u.all()};return{primary:t,post:p.post,make:function(){f.load(),h()},auto:function(){parameters().marticles&&!v.app.nav.wnds.articles&&p.embeding("article",null)},getdata:function(t,e){m=!1,c=null,r=deep(e,"settings.essenseData.share")||new Share,s=deep(e,"settings.essenseData")||{},v.app.platform.sdk.user.get(function(e){s.share||(f.load(),0===e.postcnt&&!r.message.v&&s.hello&&(r.message.v=n,m=!0)),parameters().repost&&r.repost.set(parameters().repost),console.log("currentShare",r);var a={essenseData:s,share:r,postcnt:e.postcnt};t(a)})},destroy:function(){c&&c.module.closeContainer(),c=null,$("html").off("click",g.unfocus),delete v.app.platform.ws.messages.transaction.clbks.share,o.c&&o.c.find(".emojionearea-editor").off("pasteImage"),o={},Sortable&&Sortable.destroy&&Sortable.destroy()},init:function(e){(o={}).c=e.el.find("#"+v.map.id),o.tgsWrapperMain=o.c.find(".tgsWrapperMain"),o.message=o.c.find(".message"),o.eMessage=o.c.find("#emjcontainer"),o.error=o.c.find(".error"),o.urlWrapper=o.c.find(".urlWrapper"),o.caption=o.c.find(".captionshare"),o.cpt=o.c.find(".cpt"),o.images=o.c.find(".imagesWrapper"),o.changeAddress=o.c.find(".changeAddress"),o.repostWrapper=o.c.find(".repostWrapper"),o.postline=o.c.find(".postlineWrapper"),function(){o.changeAddress.on("change",g.changeAddress),o.eMessage.emojioneArea({pickerPosition:"bottom",search:!1,tones:!1,autocomplete:!1,attributes:{spellcheck:!0},filters:{smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning smiley smile grin laughing sweat_smile joy rofl relaxed blush innocent slight_smile upside_down wink relieved crazy_face star_struck heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes yum stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth hugging nerd sunglasses cowboy smirk unamused disappointed pensive worried face_with_raised_eyebrow face_with_monocle confused slight_frown frowning2 persevere confounded tired_face weary triumph angry rage face_with_symbols_over_mouth no_mouth neutral_face expressionless hushed frowning anguished open_mouth astonished dizzy_face exploding_head flushed scream fearful cold_sweat cry disappointed_relieved drooling_face sob sweat sleepy sleeping rolling_eyes thinking shushing_face face_with_hand_over_mouth lying_face grimacing zipper_mouth face_vomiting nauseated_face sneezing_face mask thermometer_face head_bandage smiling_imp imp japanese_ogre japanese_goblin poop ghost skull skull_crossbones alien space_invader robot jack_o_lantern clown smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat open_hands raised_hands palms_up_together clap pray handshake thumbsup thumbsdown punch fist left_facing_fist right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ring lipstick kiss lips tongue ear nose footprints eye eyes speaking_head bust_in_silhouette busts_in_silhouette baby boy girl man woman blond-haired_woman blond_haired_man older_man older_woman man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer police_officer woman_construction_worker construction_worker woman_guard guard woman_detective detective woman_health_worker man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing man_bowing woman_tipping_hand man_tipping_hand woman_gesturing_no man_gesturing_no woman_gesturing_ok man_gesturing_ok woman_raising_hand man_raising_hand woman_facepalming man_facepalming woman_shrugging man_shrugging woman_pouting man_pouting woman_frowning man_frowning woman_getting_haircut man_getting_haircut woman_getting_face_massage man_getting_face_massage man_in_business_suit_levitating dancer man_dancing women_with_bunny_ears_partying men_with_bunny_ears_partying woman_walking man_walking woman_running man_running couple bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf woman_genie man_genie woman_zombie man_zombie womans_clothes shirt jeans necktie dress bikini kimono high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat mortar_board crown helmet_with_cross school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses closed_umbrella umbrella2 brain billed_cap scarf gloves coat socks "}},events:{change:g.eTextChange,click:g.eTextChange,keyup:g.eText,onLoad:function(e,a){parameters().newshare&&o.c.find(".emojionearea-editor").focus(),o.c.find(".emojionearea-editor").pastableContenteditable(),o.c.find(".emojionearea-editor").on("pasteImage",function(e,a){topPreloader(100),r.images.set(a.dataURL)?u.images&&u.images():sitemessage(d.images)}).on("pasteImageStart",function(){topPreloader(30)}).on("pasteImageError",function(e,a){topPreloader(100)}).on("pasteText",function(e,a){p.eTextChange(o.eMessage[0].emojioneArea)})}}}),o.caption.on("keyup",g.caption),r.on.change.edit=g.change,isMobile()||o.c.find(".tooltip").tooltipster({theme:"tooltipster-light",maxWidth:600,zIndex:20});var e={animation:150,swapThreshold:.5,draggable:".draggablepart",onUpdate:function(e){var a=[],t=$(n).find(".draggablepart");$.each(t,function(){a.push($(this).attr("part"))}),r.settings.a=a,s.share||f.save(),s.changeArrange&&s.changeArrange()},forceFallback:!0,handle:".marker"},n=document.getElementById("sortableBody");n&&!isMobile()&&Sortable.create(n,e),p.autoFilled(),v.app.platform.ws.messages.transaction.clbks.share=p.waitActions,o.c.on("click",function(){o.c.addClass("focus").removeClass("unfocus")}),$("html").on("click",g.unfocus)}(),h(),e.clbk(null,e),p.waitActions()},wnd:{close:function(){s.close&&s.close()},class:"smallWnd withoutButtons wndsharepost"},id:e._id}};return v.run=function(e){var a=v.addEssense(t,n,e);v.init(a,e)},v.stop=function(){_.each(t,function(e){e.destroy()})},v}();"undefined"!=typeof module?module.exports=share:(app.modules.share={},app.modules.share.module=share);
 /*_____*/ 
var wallet=function(){var b=new nModule,t={},n=function(e){var i,a=deep(e,"history"),s={},l={pnetwallet:{label:b.app.localization.e("tacaddress"),alabel:b.app.localization.e("tacaddress"),id:"pnetwallet",addresses:function(){return[b.app.platform.sdk.address.pnet().address]}},wallet:{label:b.app.localization.e("twallet"),id:"wallet",addresses:function(){return b.app.platform.sdk.addresses.storage.addresses||[]},caption:b.app.localization.e("twalletaddresses")},total:{label:b.app.localization.e("tTotal"),id:"total",addresses:function(){return[b.app.platform.sdk.address.pnet().address].concat(b.app.platform.sdk.addresses.storage.addresses||[])}}},c={parameters:{source:new Parameter({name:"Source",type:"VALUES",id:"source",defaultValue:"pnetwallet",possibleValuesLabels:[b.app.localization.e("twallet"),b.app.localization.e("tacaddress"),b.app.localization.e("tTotal")],possibleValues:["wallet","pnetwallet","total"],placeholder:b.app.localization.e("wsselect")}),reciever:new Parameter({name:b.app.localization.e("wsreciever"),type:"VALUESCUSTOM",id:"reciever",possibleValuesLabels:[],possibleValues:[],placeholder:b.app.localization.e("wsenter"),onType:!0}),amount:new Parameter({name:b.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:b.app.localization.e("wsamountof"),format:{Precision:6}}),message:new Parameter({name:"Message",id:"message",type:"stringany",placeholder:"Your message",format:{Length:80}}),fees:new Parameter({name:b.app.localization.e("wsincludefees"),type:"VALUES",id:"fees",defaultValue:"include",possibleValuesLabels:[b.app.localization.e("wsrecieverpay"),b.app.localization.e("wssenderpay")],possibleValues:["include","exclude"]})}},n={wallet:b.app.localization.e("twallet"),pnetwallet:b.app.localization.e("tacaddress")},r={active:!1,parameters:{deposit:new Parameter({name:b.app.localization.e("wrecieveon"),type:"VALUES",id:"deposit",defaultValue:"wallet",possibleValuesLabels:[b.app.localization.e("twallet"),b.app.localization.e("tacaddress")],possibleValues:["wallet","pnetwallet"],placeholder:b.app.localization.e("wdselectfrom")}),depositamount:new Parameter({name:b.app.localization.e("wdamount"),id:"depositamount",type:"NUMBER",placeholder:b.app.localization.e("wdenteramount"),onType:!0,format:{Precision:6}}),message:new Parameter({name:b.app.localization.e("wdmessage"),id:"message",type:"TEXT",placeholder:b.app.localization.e("wdmessageplaceholder"),onType:!0}),label:new Parameter({name:b.app.localization.e("wdlabel"),id:"label",type:"STRING",onType:!0})}},o={active:!1,parameters:{reciever:new Parameter({name:b.app.localization.e("wrecieveon"),type:"VALUES",id:"reciever",defaultValue:"pnetwallet",possibleValuesLabels:[b.app.localization.e("tacaddress")],possibleValues:["pnetwallet"],placeholder:b.app.localization.e("wdselectfrom")}),amount:new Parameter({name:"Pocetcoin Amount",id:"amount",type:"NUMBER",placeholder:b.app.localization.e("wsamountof"),format:{Precision:6}}),currency:new Parameter({name:"Currency",id:"currency",type:"VALUES",defaultValue:"btc",possibleValuesLabels:["BTC","LTC"],possibleValues:["btc","ltc"],placeholder:"Select currency"}),currencyAmount:new Parameter({name:"Currency Amount",id:"currencyAmount",type:"NUMBER",placeholder:b.app.localization.e("wsamountof"),format:{Precision:6}})},segments:[{id:"AWAITINGFUNDS",time:180,exclude:"all",label:function(e,a,t){if(e==this.id)return'<div class="todeal">'+t.currency.toUpperCase()+": "+a.Address+' <i class="fas fa-chevron-circle-right"></i> </div>'},currentLabel:function(e){return"Awaitng Funds. Address will be valid for <b>"+e.MinutesLeft+" minutes</b>"}},{id:"EXPIREDAWAITINGFUNDS",class:"bad",finish:!0,exclude:"all",label:function(e,a){return"Time to this deal has been expired."},currentLabel:function(e){return'Time to this deal has been expired. <div class="reactivate">Reactivate</div>'}},{id:"CONFIRMATIONS0",time:10,currentLabel:function(e){return"Waiting blockchain confirmations (0/4)"}},{id:"CONFIRMATIONS1",time:10,currentLabel:function(e){return"Waiting blockchain confirmations (1/4)"}},{id:"CONFIRMATIONS2",time:10,currentLabel:function(e){return"Waiting blockchain confirmations (2/4)"}},{id:"CONFIRMATIONS3",time:10,currentLabel:function(e){return"Waiting blockchain confirmations (3/4)"}},{id:"POCSENT",time:4,currentLabel:function(e){return"Send Pocketcoins to You"}},{id:"POCDELEVERED",finish:!0,currentLabel:function(e){return"Pocketcoins delivered"}}]},d=[],p=[],u=0,m={showCrInStep:function(a,e,t,n){h.step(function(e){h.crowdfunding(function(e){a&&m[a](e,n),h.stepC(e,t)},e)},e,{class:"crowdfunding",view:a})},olddeal:function(e,a){h.crDeal(a,b.app.platform.sdk.exchanges.info[a.info.address],e.find(".actionbody"))},newdeal:function(n){var e={currency:o.parameters.currency.value,address:o.parameters.reciever.value,amount:o.parameters.amount.value,currencyAmount:o.parameters.currencyAmount.value};m.pocAddress(e,function(e,a,t){e?sitemessage("Something went wrong. Please reload page and try again (error: 0003)"):h.crDeal(a,t,n.find(".actionbody"))})},showListcount:function(t){b.app.platform.sdk.exchanges.statuses(function(e,a){e?sitemessage("Something went wrong. Please reload page and try again (error: 0004)"):h.showListcount(a,t.find(".actionbody"))})},status:function(){},pocAddress:function(e,n){e||(e={}),e.reciever&&"pnetwallet"!=e.reciever||(e.address=b.app.platform.sdk.address.pnet().address),"wallet"==e.reciever&&(e.address=b.app.platform.sdk.addresses.storage.addresses[0]),e.currency&&e.address?b.app.platform.sdk.exchanges.address(e,function(e,a,t){e?n&&n("fail",null):n&&n(null,a,t)}):n&&n("no data",null)},sendAddresses:function(){var e=c.parameters.source.value;return l[e].addresses()},canChangeSend:function(){if(c.parameters.reciever.value){var t=null;if(_.find(n,function(e,a){return t=a,c.parameters.reciever.value==e||c.parameters.reciever.value==a}))return t}return null},sendParameters:function(){var t=c.parameters.source.value;(c.parameters.reciever.possibleValues=[],c.parameters.reciever.possibleValuesLabels=[],_.each(n,function(e,a){a!=t&&"total"!=t&&(c.parameters.reciever.possibleValues.push(a),c.parameters.reciever.possibleValuesLabels.push(e))}),"total"==t)&&(_.find(n,function(e,a){return c.parameters.reciever.value==e||c.parameters.reciever.value==a})&&(c.parameters.reciever.value=""));c.parameters.reciever.value!=t&&c.parameters.reciever.value!=n[t]||(c.parameters.reciever.value=c.parameters.reciever.possibleValuesLabels[0]),c.parameters.reciever.possibleValues.length?c.parameters.reciever.placeholder=b.app.localization.e("wrenteraddressselect"):c.parameters.reciever.placeholder=b.app.localization.e("wrenteraddress");var e=m.sendAddresses();b.app.platform.sdk.node.transactions.get.balance(function(e){c.parameters.amount.value>e&&(c.parameters.amount.value=e)},e,null,!0)},addaddress:function(){var e=b.app.platform.sdk.addresses.storage.addresses.length;b.app.platform.sdk.addresses.addWalletAddress(e),b.app.platform.sdk.addresses.save(),topPreloader(0),g(function(){topPreloader(100)})},linkValidation:function(){return 0<r.parameters.depositamount.value&&trim(r.parameters.message.value)&&trim(r.parameters.label.value)},linkValidationQr:function(){return 0<r.parameters.depositamount.value},showDepositInStep:function(a,e,t){h.step(function(e){h.deposit(function(e){m[a](e),h.stepB(e,t)},e)},e,{class:"deposit"})},showQrResult:function(e){r.address&&m.linkValidationQr()&&h.qrResultForDeposit(r.address,e.find(".actionbody"))},showLinkResult:function(e){r.address&&m.linkValidation()&&h.linkResultForDeposit(r.address,e.find(".actionbody"))},showLinkMaker:function(e){r.address&&h.linkMakerForDeposit(r.address,e.find(".actionbody"))},showQrMaker:function(e){r.address&&h.qrMakerForDeposit(r.address,e.find(".actionbody"))},showDeposit:function(a){r.address="";var e=r.parameters.deposit.value,t="";if(r.active=!0,"pnetwallet"==e)return t=b.app.platform.sdk.address.pnet().address,r.address=t,void h.addressForDeposit(t,a.find(".actionbody"));"wallet"!=e||b.app.platform.sdk.addresses.addNewWalletAddress(function(e){b.app.platform.sdk.addresses.save(),t=e,r.address=t,h.addresses(),h.addressForDeposit(t,a.find(".actionbody"))})},showSendInStep:function(a,e,t){h.step(function(e){h.send(function(e){m[a](e),h.stepB(e,t)},e)},e,{class:"send"})},calculateFee:function(a){b.app.platform.sdk.node.fee.estimate(function(e){h.sendFees(a.find(".actionbody"),e)})},validSend:function(){var e=c.parameters.amount.value,a=c.parameters.reciever.value;return!!(0<e&&a)},prepareTransaction:function(l,d){var a=function(r,o,i){b.app.platform.sdk.wallet.txbase(r,_.clone(o),0,i,function(e,a,t){if(e)sitemessage(e);else{var n=b.app.platform.sdk.node.transactions.create.wallet(a,t),s=Math.min(n.virtualSize()*l,.0999);d&&d(r,o,s,i)}})},t=c.parameters.amount.value,n=c.parameters.fees.value,e=c.parameters.message.value,s=m.sendAddresses(),r=[],o=c.parameters.reciever.value;if("pnetwallet"==o||o==b.app.localization.e("tacaddress"))return r.push({address:b.app.platform.sdk.address.pnet().address,amount:t}),void a(s,r,n);"wallet"!=o&&o!=b.app.localization.e("twallet")?(r.push({address:o,amount:t}),b.sdk.wallet.embed(r,e),a(s,r,n)):b.app.platform.sdk.addresses.addNewWalletAddress(function(e){r.push({address:e,amount:t}),b.app.platform.sdk.addresses.save(),a(s,r,n)})}},f=function(){m.addaddress()},v=function(){$(this).closest(".actionbody").html("")},h={clearMain:function(e){b.shell({animation:{id:"fadeInByElement",selector:".fadeInByElement",timeouts:150},clear:!0,el:i.c.find(".animationWrapper")},e)},clearStep:function(e){b.shell({animation:{id:"fadeInByElement",selector:".fadeInByElementStep",timeouts:150},clear:!0,el:i.step},e)},mainWithClear:function(e){d=[],p=[],h.clearStep(function(){h.main(function(){g()})})},main:function(e){b.shell({name:"main",el:i.main,data:{},animation:"fadeIn"},function(){i.total=i.c.find(".total .tttl"),i.totaler=i.c.find(".total .tttlforerror"),i.addresses=i.c.find(".addresses"),i.send=i.c.find(".send"),i.deposit=i.c.find(".deposit"),i.crowdfunding=i.c.find(".crowdfunding"),b.iclbks.main=function(){console.log("ACLK",b.app.errors.connection()),b.app.errors.connection()?i.totaler.addClass("active"):i.totaler.removeClass("active")},e&&e()})},stepC:function(e,a){e.find("._stepback").html('<div class="backWrapper"><div class="back"><i class="fas fa-arrow-left"></i></div></div>'),e.find("._stepclose").html('<div class="closeAdditional"><span><i class="fas fa-undo"></i> '+b.app.localization.e("wreturntoeallet")+"</span></div>"),e.find("._subcaptionlevel span").html(a||"")},stepB:function(e,a){e.find("._stepback").html('<div class="backWrapper"><div class="back"><i class="fas fa-arrow-left"></i></div></div>'),e.find("._stepclose").html('<div class="closeAdditional"><span><i class="fas fa-undo"></i> '+b.app.localization.e("wreturntoeallet")+"</span></div>"),e.find("._subcaptionlevel span").html(a||"")},step:function(t,e,n){n||(n={}),u==e?t&&t(i.c.find(".step")):(d[u=e]=t,p[e]=n,h.clearMain(function(){_scrollToTop(i.step,0,200,-70),setTimeout(function(){b.shell({name:"step",el:i.step,data:{},animation:"fadeIn"},function(e){var a=e.el.find(".step");n.class&&a.addClass(n.class),n.view?a.attr("view",n.view):a.removeAttr("view"),t&&t(a)})},200)}))},showListcount:function(e,a){var t=b.app.platform.sdk.exchanges.get();b.shell({name:"listcr",el:a,data:{list:t,c:o}},function(s){var r=function(e,a){b.app.platform.sdk.exchanges.remove(e.currency,e.info.address),a.remove(),(t=b.app.platform.sdk.exchanges.get()).length||h.step(d[u-1],u-1,p[u-1])};s.el.find(".removecr").on("click",function(){var t=$(this).closest(".item"),e=t.attr("item"),n=b.app.platform.sdk.exchanges.find(e);b.app.platform.sdk.exchanges.status(n.currency,n.info.address,function(e,a){e?sitemessage("Something went wrong. Please reload page and try again (error: 0006)"):"AWAITINGFUNDS"==a.Status||"EXPIREDAWAITINGFUNDS"==a.Status?r(n,t):dialog({html:"Do you really want to delete information about this deal? Deal can't be stop",success:function(){r(n,t)}})})}),s.el.find(".updatecr").on("click",function(){var t=$(this).closest(".item"),e=t.attr("item"),n=b.app.platform.sdk.exchanges.find(e);n?b.app.platform.sdk.exchanges.status({address:n.info.address,currency:n.currency},function(e,a){e?sitemessage("Something went wrong. Please reload page and try again (error: 0002)"):h.crStatus(n,a,t.find(".status"))}):sitemessage("Something went wrong. Please reload page and try again (error: 0001)")}),s.el.on("click",".todeal",function(){var e=$(this).closest(".item").attr("item"),a=b.app.platform.sdk.exchanges.find(e);m.showCrInStep("olddeal",u+1,"Deal",a)}),lazyEach({array:t,action:function(e){var a=e.item,t=s.el.find('[item="'+a.info.address+'"] .status'),n=b.app.platform.sdk.exchanges.info[a.info.address];h.crStatus(a,n,t)}})})},listcount:function(e){var a="",t=b.app.platform.sdk.exchanges.get(),n=e.find(".listcountWrapper");0<t.length?(a="("+t.length+")",e.find(".listcount").html(a),n.fadeIn()):n.fadeOut()},crdealstatusstep:function(e,a,t){b.shell({name:"crdealstatusstep",el:t,data:{addressobject:e,info:a}},function(e){})},crDeal:function(n,s,e){b.shell({name:"crdeal",el:e,data:{addressobject:n}},function(t){h.crStatus(n,s,t.el.find(".status")),h.crdealstatusstep(n,s,t.el.find(".crdealstatusstep")),t.el.on("click",".copyaddress1",function(){copyText(t.el.find(".forcopyaddress1")),sitemessage(b.app.localization.e("waddresswascop"))}),t.el.on("click",".copyaddress2",function(){copyText(t.el.find(".forcopyaddress2")),sitemessage(b.app.localization.e("waddresswascop"))}),t.el.on("click",".reactivate",function(){b.app.platform.sdk.exchanges.reactivate({address:n.info.address,currency:n.currency},function(e,a){e?sitemessage("Something went wrong. Please reload page and try again (error: 0002)"):(s=a,h.crStatus(n,s,t.el.find(".status")),h.crdealstatusstep(n,s,t.el.find(".crdealstatusstep")))})})})},applyStatus:function(n,s){_.find(o.segments,function(e){var a=s.find('.segment[segment="'+e.id+'"]');if(e.id==n.Status){var t=100*Math.min((Number(e.time)-Number(n.MinutesLeft))/Number(e.time),.99);return a.find(".line").css("width",t+"%"),a.addClass("active"),e.class&&a.addClass(e.class),e.finish&&(a.addClass("ended"),a.find(".line").css("width","100%")),(e.finish||"all"==e.exclude)&&s.find(".current").html(e.currentLabel(n)),!0}a.addClass("ended"),a.find(".line").css("width","100%")})},crStatus:function(e,a,t,n){b.shell({name:"pocstatus",el:t,data:{addressobject:e,info:a,segments:o.segments}},function(e){h.applyStatus(a,t),n&&n()})},crowdRate:function(e,a,t){e.find(".rate .value").html("<b>1 POC = "+a[t].toFixed(6)+" "+t.toUpperCase()+"</b>")},crowdCurrencyLabel:function(e,a){e.find(".currencyAmountLabel").html(a.toUpperCase()+" Amount</b>")},crowdfunding:function(e,a){2==u&&(d[1]=function(e){m.showCrInStep("",1,"")},p[1]={class:"crowdfunding"}),o.parameters.currency||(o.parameters.currency.value="btc"),b.app.platform.sdk.exchanges.rates(function(n){b.app.platform.sdk.node.transactions.get.balance(function(t){t=Math.min(t/3,1e3),b.shell({name:"crowdfunding",el:a||i.crowdfunding,data:{d:o,amount:t}},function(a){ParametersLive(_.toArray(o.parameters),a.el),a.el.on("click",".closeAdditional",v),h.crowdRate(a.el,n,o.parameters.currency.value),h.crowdCurrencyLabel(a.el,o.parameters.currency.value),h.listcount(a.el),o.parameters.amount._onChange=function(e){o.parameters.amount.value<0&&(o.parameters.amount.value=0),o.parameters.amount.value>t&&(o.parameters.amount.value=t),o.parameters.currencyAmount.value=o.parameters.amount.value*n[o.parameters.currency.value],o.parameters.amount.el.closest(".inputWrapper").html(o.parameters.amount.input()),o.parameters.currencyAmount.el.closest(".inputWrapper").html(o.parameters.currencyAmount.input()),ParametersLive([o.parameters.amount,o.parameters.currencyAmount],a.el)},o.parameters.currency._onChange=function(e){b.app.platform.sdk.exchanges.rates(function(e){n=e,h.crowdRate(a.el,n,o.parameters.currency.value),h.crowdCurrencyLabel(a.el,o.parameters.currency.value)})},o.parameters.currencyAmount._onChange=function(e){o.parameters.currencyAmount.value<0&&(o.parameters.currencyAmount.value=0),o.parameters.currencyAmount.value/n[o.parameters.currency.value]>t&&(o.parameters.currencyAmount.value=Number((t*n[o.parameters.currency.value]).toFixed(6))),o.parameters.amount.value=o.parameters.currencyAmount.value/n[o.parameters.currency.value],o.parameters.amount.el.closest(".inputWrapper").html(o.parameters.amount.input()),o.parameters.currencyAmount.el.closest(".inputWrapper").html(o.parameters.currencyAmount.input()),ParametersLive([o.parameters.amount,o.parameters.currencyAmount],a.el)},a.el.find(".listcountWrapper").on("click",function(){m.showCrInStep("showListcount",2,"List of deals")}),a.el.find(".newdeal").on("click",function(){0<o.parameters.amount.value?(m.showCrInStep("newdeal",2,"Deal"),a.el.find(".required").addClass("hidden")):a.el.find(".required").removeClass("hidden")}),e&&e(a.el)})},"PFF7PevK753eYTwWBScdEAbWQrgu36AdUA",!0,!0)})},qrResultForDeposit:function(e,a,t){b.shell({name:"depositqrresult",el:a,data:{address:e,d:r}},function(e){})},linkResultForDeposit:function(e,a,t){b.shell({name:"depositlinkresult",el:a,data:{address:e,d:r}},function(e){e.el.find(".copylink").on("click",function(){copyText(e.el.find(".linkInTextArea")),sitemessage(b.app.localization.e("waddresswascop"))})})},linkMakerForDeposit:function(e,a,t){b.shell({name:"depositlinkmaker",el:a,data:{address:e,d:r}},function(e){var a=e.el.find(".getlink"),t=[r.parameters.depositamount,r.parameters.message,r.parameters.label];ParametersLive(t,e.el),_.each(t,function(e){e._onChange=function(){m.linkValidation()?a.removeClass("disabled"):a.addClass("disabled")}}),m.linkValidation()&&a.removeClass("disabled"),a.on("click",function(){m.linkValidation()&&m.showDepositInStep("showLinkResult",3,b.app.localization.e("linkCreated"))})})},qrMakerForDeposit:function(e,a,t){b.shell({name:"depositqrmaker",el:a,data:{address:e,d:r}},function(e){var a=e.el.find(".getlink"),t=[r.parameters.depositamount,r.parameters.message,r.parameters.label];ParametersLive(t,e.el),_.each(t,function(e){e._onChange=function(){m.linkValidationQr()?a.removeClass("disabled"):a.addClass("disabled")}}),m.linkValidationQr()&&a.removeClass("disabled"),a.on("click",function(){m.linkValidationQr()&&m.showDepositInStep("showQrResult",3,b.app.localization.e("wqrcodecreated"))})})},addressForDeposit:function(e,a,t){b.shell({name:"depositaddress",el:a,data:{address:e,d:r}},function(e){e.el.find(".getlink").on("click",function(){m.showDepositInStep("showLinkMaker",2,b.app.localization.e("wlinkcreating"))}),e.el.find(".qrcode").on("click",function(){m.showDepositInStep("showQrMaker",2,b.app.localization.e("wqrcodecreating"))}),e.el.find(".copyaddress").on("click",function(){copyText(e.el.find(".adr")),sitemessage(b.app.localization.e("waddresswascop"))})})},deposit:function(e,a){b.shell({name:"deposit",el:a||i.deposit,data:{d:r}},function(t){ParametersLive([r.parameters.deposit],t.el),r.parameters.deposit._onChange=function(e){b.app.settings.set(b.map.uri,"deposit",e);var a=r.parameters.deposit.labelByValue(e);t.el.find(".type").html(a),m.showDepositInStep("showDeposit",1,b.app.localization.e("wdoptions"))},t.el.find(".recieveaddress").on("click",function(){m.showDepositInStep("showDeposit",1,b.app.localization.e("wdoptions"))}),t.el.on("click",".closeAdditional",v),e&&e(t.el)})},sendFees:function(s,e,a){if(m.validSend()){var r=e.feerate||1e-6;m.prepareTransaction(r,function(e,a,t,n){b.shell({name:"sendfees",el:s,data:{fees:t,d:c}},function(e){ParametersLive([c.parameters.fees],e.el),c.parameters.fees._onChange=function(e){b.app.settings.set(b.map.uri,"feesMode",e)},e.el.find(".sendtransaction").on("click",function(){m.prepareTransaction(r,function(e,a,t,n){b.app.platform.sdk.wallet.txbase(e,_.clone(a),t,n,function(e,n,a){if(e)sitemessage(e);else{var t=b.app.platform.sdk.node.transactions.create.wallet(n,a);_.each(n,function(e){e.cantspend=!0}),b.app.platform.sdk.node.transactions.send(t,function(e,a){if(a)b.app.platform.sdk.node.transactions.releaseCS(n),sitemessage(a);else{var t=_.map(n,function(e){return e.txid});b.app.platform.sdk.node.transactions.clearUnspents(t),u=0,h.mainWithClear(),sitemessage(b.app.localization.e("wssuccessfully"))}})}})})})})})}},send:function(a,e){m.sendParameters(),b.shell({name:"send",el:e||i.send,data:{d:c}},function(t){ParametersLive(_.toArray(c.parameters),t.el);var e=t.el.find(".change"),n=function(){m.canChangeSend()?e.removeClass("hidden"):e.addClass("hidden")};c.parameters.amount._onChange=function(e){var a=m.sendAddresses();b.app.platform.sdk.node.transactions.get.balance(function(e){c.parameters.amount.value<0&&(c.parameters.amount.value=0),c.parameters.amount.value>e&&(c.parameters.amount.value=e),c.parameters.amount.el.closest(".inputWrapper").html(c.parameters.amount.input()),ParametersLive([c.parameters.amount],t.el),1==u&&m.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees"))},a,null,!0)},c.parameters.source._onChange=function(e){m.sendParameters(),c.parameters.reciever.el.closest(".inputWrapper").html(c.parameters.reciever.input()),c.parameters.amount.el.closest(".inputWrapper").html(c.parameters.amount.input()),ParametersLive([c.parameters.reciever,c.parameters.amount],t.el),n(),1==u&&m.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees"))},c.parameters.reciever._onChange=function(e){if(n(),!m.canChangeSend()&&e){var a=!0;try{bitcoin.address.fromBase58Check(e)}catch(e){a=!1}if(!a)return void t.el.find(".notvalidaddress").html(b.app.localization.e("wsaddressnotv"));t.el.find(".notvalidaddress").html(""),e[0]}else t.el.find(".notvalidaddress").html("")},e.on("click",function(){var e=m.canChangeSend();e&&(c.parameters.source.value=e,c.parameters.source._onChange(),c.parameters.source.el.closest(".inputWrapper").html(c.parameters.source.input()),ParametersLive([c.parameters.source],t.el))}),t.el.find(".calculateFee").on("click",function(){m.validSend()?(m.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees")),t.el.find(".required").addClass("hidden")):t.el.find(".required").removeClass("hidden")}),n(),a&&a(t.el)})},addresses:function(s){var r=l.total.addresses(),o={};b.app.platform.sdk.node.transactions.get.unspents(function(n){b.app.platform.sdk.node.transactions.get.balance(function(e){_.each(n,function(e,a){o[a]=_.reduce(e,function(e,a){return e+Number(a.amount)},0)});var a=[l.pnetwallet,l.wallet],t=_.map(a,function(e){var a=_.map(e.addresses(),function(e){return{balance:o[e],address:e}});return{caption:e.caption,details:a,label:e.alabel}},r);b.shell({name:"addresses",el:i.addresses,data:{addressesGroup:t,total:e}},function(e){e.el.find(".addaddress").on("click",f),s&&s()})},r)},r)},updateTotal:function(e,a){h.datasets(e,s[e.id].data.datasets),s[e.id].update(),i.total.find('.totalItem[item="'+e.id+'"] .balanceWrapper').html(b.app.platform.mp.coinwithsmall(e.balance)),a&&a()},datasets:function(e,a){var t=[],n=_.map(e.move,function(e){return t.push(e.color),Number(e.summary||0)}),s=[],r=[],o=[],i=[],l="#F1F1F1";_.each(e.move,function(e){_.each(e.items,function(e){s.push(Number(e.value)),r.push(e.color),o.push(l),i.push(8)})});var d=[{data:n,backgroundColor:t,borderColor:[l,l],borderWidth:[8,8]},{data:s,backgroundColor:r,borderColor:o,borderWidth:i}];return _.each(a,function(e,a){e.data=d[a].data}),d},total:function(t,n){t.update?h.updateTotal(t,n):b.shell({name:"total",el:i.total,inner:append,data:{item:t}},function(e){var a=e.el.find("#chart"+t.id)[0].getContext("2d");s[t.id]=new Chart(a,{type:"doughnut",data:{datasets:h.datasets(t)},options:{rotation:.5*Math.PI,cutoutPercentage:85}}),n&&n()})}},t=function(){},w=function(e,d){lazyEach({array:_.toArray(l),sync:!0,action:function(i){var l=i.item,e=l.addresses();b.app.platform.sdk.node.transactions.get.balance(function(o){b.app.platform.sdk.node.transactions.get.canSpend(e,function(e,a){var t="#414244",n=100,s=b.app.platform.sdk.node.transactions.tempBalance();a&&("pnetwallet"!=l.id&&"total"!=l.id||(a=s+a),n=100*e/a,t="#0F8623");var r={positive:{summary:n,color:t}};e<a&&(r.neutral={summary:100-n,color:"#414244"}),"pnetwallet"!=l.id&&"total"!=l.id||(o=s+o),h.total({label:l.label,id:l.id,balance:o,move:r,update:d},i.success)})},e)},all:{success:function(){e&&e()}}})},g=function(e){i.total.html(""),w(function(){lazyActions([h.send,h.deposit,h.addresses],e),b.app.platform.sdk.node.transactions.clbks.circles=function(){w(null,!0)},b.app.platform.sdk.node.transactions.clbks.walletaddresses=function(){h.addresses()}}),b.app.platform.sdk.node.transactions.get.allBalance(null,!0)};return{primary:a,getdata:function(e){var a={};a.p2pkh=b.app.platform.sdk.address.pnet(),r.parameters.deposit.value=b.app.settings.get(b.map.uri,"deposit")||r.parameters.deposit.defaultValue,c.parameters.source.value=b.app.settings.get(b.map.uri,"source")||c.parameters.source.defaultValue,c.parameters.reciever.value="",c.parameters.fees.value=b.app.settings.get(b.map.uri,"feesMode")||c.parameters.fees.defaultValue,r.active=!1,u=0,d=[],p=[],e(a)},destroy:function(){delete b.app.platform.sdk.node.transactions.clbks.circles,delete b.app.platform.sdk.node.transactions.clbks.walletaddresses,delete b.iclbks.main,i={}},init:function(a){s={},t(),(i={}).c=a.el.find("#"+b.map.id),i.step=i.c.find(".actionstep"),i.main=i.c.find(".mainstep"),function(){if(i.c.on("click","._stepclose",function(){u=0,h.mainWithClear()}),i.c.on("click","._stepback",function(){1<u?h.step(d[u-1],u-1,p[u-1]):(u=0,h.mainWithClear())}),isMobile()){var t=i.c.find(".circularprogress"),n=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}});n.update(70),i.c.find(".circularprogressWrapper").html(n.el);var e=$(window),a=new SwipeParallax({el:i.c.find(".ntf"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(e){var a=Math.abs(e)/200;0<=e&&(n.options.text={value:""},n.update(100*a),t.height(220*a+"px"))},constraints:function(){if(0==e.scrollTop())return!0},restrict:!0,trueshold:200,clbk:function(){b.app.platform.sdk.notifications.getNotifications(),b.app.platform.sdk.node.transactions.get.allBalanceUpdate(function(){g(),a.renew()})}}}}).init()}}(),h.main(function(){g(function(){var e=parameters();e.action&&("send"==e.action&&(c.parameters.amount.value=Number(e.amount.replace(/,/g,"")),c.parameters.reciever.value=e.address,c.parameters.amount._onChange(),m.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees"))),"recieve"==e.action&&m.showDepositInStep("showDeposit",1,b.app.localization.e("wdoptions"))),a.clbk(null,a)})})}}};return b.run=function(e){var a=b.addEssense(t,n,e);b.init(a,e)},b.stop=function(){_.each(t,function(e){e.destroy()})},b}();"undefined"!=typeof module?module.exports=wallet:(app.modules.wallet={},app.modules.wallet.module=wallet);
 /*_____*/ 
var comments=function(){var L=new nModule,i={},t=function(e){var d,c,p,s,i,t,a,o,n=deep(e,"history"),f={},r=!1,u=!1,l=!1,m={content:"Message is empty",messagelength:"Comments have 1000 character limit per comment",images:L.app.localization.e("maximages")},g={},h={},v=null,w=/[,.!?;:() \n\r]/g,k=function(e,n,i,t){if(n&&n.txid==c){var a=d.c.find("#"+n.id),s=a.find(">div.commentPaddingWrapper>div.commentWrapper>div.commentBody>div.cbodyWrapper");t==L.app.platform.sdk.address.pnet().address&&(a.addClass("rated"),0<i?s.find(".scoreUp").addClass("ratedScore"):s.find(".scoreDown").addClass("ratedScore")),n.scoreUp&&s.find(".scoreUp .commentScore").html(compressedNumber(n.scoreUp,1)),n.scoreDown&&s.find(".scoreDown .commentScore").html(compressedNumber(n.scoreDown,1))}},y=function(e,n,i,t,a,s,o,r){if(i==c&&(d.c.find(".sending").removeClass("sending"),!e)){S.save(),d.c.find(".emojionearea-editor").blur(),d.c.find(".att").html("");var l={comments:[n]};if(u&&(p.lastComment=L.app.platform.sdk.comments.toLastComment(n)),delete f[o],"0"==o&&(l.class="firstcomment"),"0"==o)h[o]&&h[o].setText(""),d.c.find(".post .newcommentimages").html("");else{var m=d.c.find("#"+o);s?(m.find(".edit").html(""),n.timeUpd=n.timeUpd.addMinutes(1),n.parentid||(l.class="firstcomment"),delete h[o],delete g[o],m.removeClass("editing"),l.inner=replaceWith,l.el=m):(m.find(".answer").html(""),m.find(".repliescount").html(Number(m.find(".repliescount").html()||"0")+1),m.find(".replies").removeClass("hidden"),l.el=d.c.find("#"+o+" .answers"),delete h[o])}l.newcomments="newcomments",W.list(l,function(){r&&C.tocomment(n.id)}),!s&&p.send&&p.send(n),s||(p.comments&&p.comments++,C.showhideLabel())}},C={sharesocial:function(e){var n,i=findAndReplaceLink(filterXSS(e.message,{whiteList:[],stripIgnoreTag:!0}),!0),t=emojione.toImage(i);n=nl2br(trimrn(t));var a=p.hr+"&commentid="+e.id;e.parentid&&"0"!=e.parentid&&(a=a+"&parentid="+e.parentid),L.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{url:a,caption:"Share this Comment",image:deep(app,"platform.sdk.usersl.storage."+e.address+".image"),title:deep(app,"platform.sdk.usersl.storage."+e.address+".name"),text:n}})},editImage:function(i,e,t){var a=f[i],s=_.map(a.images.v,function(e,n){return{original:e,index:n}});focusfixed=!0,L.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:e,images:s,close:function(){},success:function(e,n){_.each(a.images.v,function(e,n){var i=_.find(s,function(e){if(e.index==n)return!0});i&&(a.images.v[n]=i.original)}),W.images(i,t,n)}}})},removeImage:function(e,i,n){f[e].images.v.splice(i,1)[0];n.el.find(".imageContainer").each(function(){var e=$(this),n=e.attr("value");i<n&&e.attr("value",n-1),n==i&&e.remove()}),n.el.find(".imagesEmbWr").isotope()},embedimages:function(t,n){t||(t="0"),C.process(t),h[t]&&(h[t].___inited=!0);var e=f[t].export(!0);L.nav.api.load({open:!0,id:"embeding",inWnd:!0,essenseData:{type:"images",storage:e,on:{added:function(e){var i=!0;_.isArray(e)||(e=[e]),_.each(e,function(e,n){i=f[t].images.set(e)}),!i&&m[type]&&sitemessage(m[type]),W.images(t,n)}}},clbk:function(e,n){v=n}})},removeForm:function(e){delete h[e],d.c.find("#"+e+" .answer").html(""),d.c.find("#"+e+" .edit").html("")},post:function(e,n,i,t){e||(e="0");var a=f[e];if(a){var s=a.validation();if(s)d.c.find(".sending").removeClass("sending"),sitemessage(m[s]);else{if(a.loading)return;a.loading=!0,a.uploadImages(L.app,function(){C.send(a,function(e,n){a.loading=!1,e||successCheck()},n,i,t,e)})}}else d.c.find(".sending").removeClass("sending"),sitemessage(m.content)},send:function(e,i,n,t,a,s){L.app.platform.sdk.comments.send(c,e,n,t,function(e,n){d.c&&d.c.find(".sending").removeClass("sending"),e?(L.app.platform.errorHandler(e,!0),i&&i(e,null)):i&&i(null,n)},a,s)},links:function(e,n){e||(e="0");var i=f[e];if(i&&!i.url.v){var t=null,a=n.match(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi);a&&0<a.length&&(t=a[0]),t&&i.url.set(t)}},process:function(e){e||(e="0"),f[e]||(f[e]=new Comment(c))},message:function(e,n){e||(e="0"),f[e]&&f[e].message.set(n),S.save()},emessage:function(e,n){var i=n.getText();C.links(e,i),C.message(e,i),h[e]&&(h[e].___inited=!0)},fastreply:function(n){n&&C.replies(n.parentid||n.answerid,!0,function(){if(n.noaction){C.tocomment(n.answerid);var e=d.c.find("#"+n.answerid);e.addClass("newcommentsn"),setTimeout(function(){e.removeClass("newcommentsn")},2500)}else C.reply(n.parentid||n.answerid,n.answerid)})},reply:function(o,r){var e=d.c.find("#"+o).find(".answer");W.post(function(e,n){var i="0";r!=o&&(i=o);var t=L.app.platform.sdk.comments.address(c,r,i)||deep(p,"lastComment.address"),a=deep(L.app,"platform.sdk.usersl.storage."+t+".name")||t,s="@"+a+",  ";t!=L.app.platform.sdk.address.pnet().address&&a||(s=""),e.setText(s),h[o]=e,n.focus(),n.closest(".answer").addClass("active"),s.length&&ecaretPosition(n,0,s.length)},{placeholder:"Send Reply",el:e,answer:"answer",pid:o,aid:r,id:o})},hideallReplies:function(){_.each(deep(L,"app.platform.sdk.comments.storage."+c+".0"),function(e,n){C.replies(n,!1)}),p.lastComment&&C.replies(p.lastComment.id,!1)},replies:function(n,e,i){if("0"!=n){var t={};t.el=d.c.find("#"+n+" .answers");var a=d.c.find("#"+n);void 0===e&&(a.hasClass("showedreplies")?e=!1:(e=!0,a.find(".repliesloaderWrapper").removeClass("hidden"))),e?j.level(n,function(e){a.find(".repliesloaderWrapper").addClass("hidden"),t.comments=L.app.platform.sdk.comments.storage[c][n],a.addClass("showedreplies"),W.list(t,function(){s||W.caption(),i&&i()})}):(_.each(L.app.platform.sdk.comments.storage[c][n],function(e){delete g[e.id]}),a.removeClass("showedreplies"),C.removeForm(n),t.el.html(""))}else i&&i()},getid:function(e){if(e.attr("answer")){(n=e.closest(".comment")).attr("id");return e.closest(".firstcomment").attr("id")}if(e.attr("edit")){var n;(n=e.closest(".comment")).attr("aid"),n.attr("pid");return n.attr("id")}return"0"},tocomment:function(e){_scrollTo(d.c.find("#"+e),i)},closeEdit:function(e){var n=d.c.find("#"+e);n.removeClass("editing"),n.find(".commentBody").removeClass("editing"),C.removeForm(e)},delete:function(e,i){var n=e.delete();L.app.platform.sdk.comments.delete(c,n,function(e,n){e?(L.app.platform.errorHandler(e,!0),i&&i(e,null)):i&&i(null,n)})},update:function(e){var n={},i=null;i=e?d.c.find("#"+e+" .answers"):(n.class="firstcomment",d.c.find(".list")),j.level(e,function(e){i.html(""),n.comments=e,W.list(n)})},hiddenCounts:function(e){0<e?d.showall.find(".ccounts").html("("+e+")"):d.showall.find(".ccounts").html()},showall:function(){l=!0,d.c.addClass("showedall"),C.showhideLabel(),u&&(d.c.removeClass("listpreview"),d.c.find(".loaderWrapper").removeClass("hidden"),j.level(null,function(e,n){if(n)return L.app.platform.errorHandler(n,!0),d.c.addClass("listpreview"),d.c.find(".loaderWrapper").addClass("hidden"),l=!1,d.c.removeClass("showedall"),void C.showhideLabel();u=!1,W.caption(),g={};var i={};i.comments=L.app.platform.sdk.comments.storage[c][0],i.class="firstcomment",i.inner=html,W.list(i,function(){d.c.find(".loaderWrapper").addClass("hidden")})}))},showhideLabel:function(){if(d.showall)if(l)d.showall.addClass("hidden");else{var e=deep(L.app.platform,"sdk.node.shares.storage.trx."+c+".comments")||0,n=deep(L.app.platform,"sdk.node.shares.storage.trx."+c+".lastComment.children")||0;u?1<e-n?(d.showall.removeClass("hidden"),C.hiddenCounts(e-n-1)):d.showall.addClass("hidden"):5<e?(d.showall.removeClass("hidden"),C.hiddenCounts(e-5)):d.showall.addClass("hidden")}},openGallery:function(e,n,i){var t=_.map(e.images,function(e){return{src:e}}),a=findIndex(t,function(e){if(e.src==n)return!0});L.app.nav.api.load({open:!0,href:"imagegallery?s="+c+"&num="+(a||0)+"&com="+e.id,inWnd:!0,history:!0,essenseData:{initialValue:n,idName:"src",images:t,gid:c+e.id},clbk:function(){i&&i()}})},upvoteComment:function(e,n){var i=deep(L.app.platform.sdk,"comments.storage.all."+n);if(i&&i.address!=L.app.platform.sdk.address.pnet().address){var t=i.upvote(e);L.app.platform.sdk.comments.upvote(t,function(e,n){e&&L.app.platform.errorHandler(e,!0)})}}},b={upvoteComment:function(){if(!$(this).closest(".comment").hasClass("rated")){var e=0;e="scoreUp"==$(this).attr("score")?1:-1;var n=$(this).closest(".comment").attr("id"),i=$(this).closest(".comment").attr("pid");C.upvoteComment(e,n,i)}},openGallery:function(){var e=$(this),n=e.closest(".comment"),i=n.attr("id"),t=n.attr("pid"),a=L.app.platform.sdk.comments.find(c,i,t);u&&p.lastComment&&(a=L.app.platform.sdk.comments.ini([p.lastComment])[0]),C.openGallery(a,e.attr("i"))},replyandreplies:function(){var e=$(this).closest(".firstcomment").attr("id");C.replies(e,!0);var n=$(this).closest(".comment"),i=(e=$(this).closest(".firstcomment").attr("id"),n.attr("id"));C.reply(e,i)},replies:function(){var e=$(this).closest(".firstcomment").attr("id");C.replies(e)},emessage:function(e,n){var i=C.getid(e.closest(".postbody"));C.emessage(i,this)},message:function(){var e=$(this).val(),n=C.getid(editor.closest(".postbody"));C.links(n,e),C.message(n,e)},reply:function(){var e=$(this).closest(".comment"),n=$(this).closest(".firstcomment").attr("id"),i=e.attr("id");C.reply(n,i)},tocomment:function(){var e=$(this).attr("comment");C.tocomment(e)},metmenu:function(){var i=$(this),e=i.closest(".comment"),t=i.closest(".commentBody"),n=e.attr("id"),a=e.attr("pid"),s=L.app.platform.sdk.comments.find(c,n,a);console.log("id, pid, txid, comment",n,a,c,s);var o={address:L.app.user.address.value,caddress:L.app.platform.sdk.comments.address(c,n,a)};u&&p.lastComment&&!a&&(s=L.app.platform.sdk.comments.ini([p.lastComment])[0],o.caddress=s.address),L.fastTemplate("metmenu",function(e,n){L.app.platform.api.tooltip(i,function(){return n(o)},function(e){e.find(".edit").on("click",function(){W.edit(t,s),i.tooltipster("hide")}),e.find(".remove").on("click",function(){dialog({html:"Do you really want to delete your comment?",success:function(){C.delete(s,function(e){if(!e){var n=d.c.find("#"+s.id);n.addClass("deleted"),d.c.find("#"+s.id+" >div.commentPaddingWrapper .commentmessage div").html("<div>Comment has been removed</div>"),n.find(".panel").remove(),n.find(".commentimages").remove(),n.find(".reply").remove()}})},btn1text:"Yes",btn2text:"No, cancel"}),i.tooltipster("hide")}),e.find(".socialshare").on("click",function(){console.log("sharesocial",s),C.sharesocial(s),i.tooltipster("hide")})},{theme:"zindex lighttooltip"})},o)}},x=function(a,i,t){var e=i.el.find(".leaveComment"),s=i.el.find(".postbody");C.process(a.id||"0"),e.emojioneArea({pickerPosition:"top",search:!1,tones:!1,autocomplete:!1,attributes:{spellcheck:!0},filters:{smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning smiley smile grin laughing sweat_smile joy rofl relaxed blush innocent slight_smile upside_down wink relieved crazy_face star_struck heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes yum stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth hugging nerd sunglasses cowboy smirk unamused disappointed pensive worried face_with_raised_eyebrow face_with_monocle confused slight_frown frowning2 persevere confounded tired_face weary triumph angry rage face_with_symbols_over_mouth no_mouth neutral_face expressionless hushed frowning anguished open_mouth astonished dizzy_face exploding_head flushed scream fearful cold_sweat cry disappointed_relieved drooling_face sob sweat sleepy sleeping rolling_eyes thinking shushing_face face_with_hand_over_mouth lying_face grimacing zipper_mouth face_vomiting nauseated_face sneezing_face mask thermometer_face head_bandage smiling_imp imp japanese_ogre japanese_goblin poop ghost skull skull_crossbones alien space_invader robot jack_o_lantern clown smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat open_hands raised_hands palms_up_together clap pray handshake thumbsup thumbsdown punch fist left_facing_fist right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ring lipstick kiss lips tongue ear nose footprints eye eyes speaking_head bust_in_silhouette busts_in_silhouette baby boy girl man woman blond-haired_woman blond_haired_man older_man older_woman man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer police_officer woman_construction_worker construction_worker woman_guard guard woman_detective detective woman_health_worker man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing man_bowing woman_tipping_hand man_tipping_hand woman_gesturing_no man_gesturing_no woman_gesturing_ok man_gesturing_ok woman_raising_hand man_raising_hand woman_facepalming man_facepalming woman_shrugging man_shrugging woman_pouting man_pouting woman_frowning man_frowning woman_getting_haircut man_getting_haircut woman_getting_face_massage man_getting_face_massage man_in_business_suit_levitating dancer man_dancing women_with_bunny_ears_partying men_with_bunny_ears_partying woman_walking man_walking woman_running man_running couple bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf woman_genie man_genie woman_zombie man_zombie womans_clothes shirt jeans necktie dress bikini kimono high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat mortar_board crown helmet_with_cross school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses closed_umbrella umbrella2 brain billed_cap scarf gloves coat socks "}},events:{change:b.emessage,click:b.emessage,keydown:function(e,n){if(n.ctrlKey&&13==n.keyCode){if(s.hasClass("sending"))return;return s.addClass("sending"),C.post(a.id||"0",a.pid,a.aid,a.editid),n.preventDefault(),!1}},keyup:function(e,n){var i=String.fromCharCode(n.keyCode||n.which),t=this.getText();w.test(i)&&C.links(t),n.ctrlKey&&13==n.keyCode||(C.message(a.id||"0",t),W.limits(s,t))},onLoad:function(e,n){((p.init||a.init)&&(i.el.find(".emojionearea-editor").focus(),i.el.addClass("active"),p.init=!1),a.value&&this.setText(a.value),a.images)&&(a.editid&&a.images.length&&(f[a.editid].images.v=_.clone(a.images),W.images(a.editid,a)));t&&t(this,i.el.find(".emojionearea-editor"))}}}),i.el.find(".emojionearea-editor").on("focus",function(){C.process(a.id||"0"),i.el.addClass("active")}),i.el.find(".emojionearea-editor").on("blur",function(){setTimeout(function(){i.el.removeClass("active")},150)}),i.el.find(".postaction").on("click",function(){s.hasClass("sending")||(s.addClass("sending"),C.post(a.id||"0",a.pid,a.aid,a.editid))}),a.id&&i.el.find(".closeEdit").on("click",function(){C.closeEdit(a.id)}),i.el.find(".closeAnswer").on("click",function(){C.removeForm(a.id||"0")})},W={images:function(n,t,a){var s=f[n];L.shell({name:"images",turi:"embeding",inner:html,el:t.el.find(".newcommentimages"),data:{images:_.map(s.images.v||[],function(e,n){return{src:e,id:n}})}},function(i){i.el.find(".remove").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");C.removeImage(n,e,t)}),i.el.find(".edit").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");C.editImage(n,e,t)}),i.el.find(".image").on("click",function(){var e=$(this).attr("i");if(e){var n=_.map(s.images,function(e){return{src:e}});L.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:{initialValue:e,idName:"src",images:n}})}}),i.el.find(".image").imagesLoaded({background:!0},function(e){if(isMobile())a&&a(),t.el.find(".newcommentimages").addClass("active");else{var n=i.el.find(".imagesEmbWr");n.isotope({layoutMode:"packery",itemSelector:".imageContainer",packery:{gutter:10},initLayout:!1}),n.on("arrangeComplete",function(){a&&a(),t.el.find(".newcommentimages").addClass("active")}),n.isotope()}})})},limits:function(e,n){var i=1e3-encodeURIComponent(n).length;i<500?0<i?e.find(".limits").addClass("active").html(i+" "+pluralform(i,["Character","Characters"])+" Available"):e.find(".limits").addClass("active").html("You have reached comment length limit"):e.find(".limits").removeClass("active")},cpreview:function(e){e||(e=p.caption),d.caption&&(d.caption.find(".captionPreview").html(e),bgImages(d.caption.find(".captionPreview")))},caption:function(n){p.caption&&L.shell({name:"caption",el:d.caption,data:{ed:p}},function(e){W.cpreview(),s=new Caption({container:d.c,caption:d.c.find(".captionfwrapper"),offset:[t,-100],removeSpacer:!0,iniHeight:!0,_in:i}).init(),e.el.find(".close .cact").on("click",function(){p.close&&p.close()}),e.el.find(".top .cact").on("click",function(){_scrollToTop(d.c.find(".list"),i,void 0,-150)}),e.el.find(".bottom .cact").on("click",function(){_scrollToBottom(d.c.find(".list"),i,void 0,-150)}),n&&n()})},edit:function(e,n){e.addClass("editing");var i={value:n.message,images:n.images,init:!0,edit:"edit",el:e.find(">div.edit"),pid:n.parentid,aid:n.answerid,id:n.id,editid:n.id};console.log("P, p",i,n),W.post(function(e,n){},i)},post:function(a,s){L.app.user.isState(function(e){if(e){s||(s={}),s.el||(s.el=d.post);var t=r&&!s.answer&&!s.editid;L.shell({name:"post",el:s.el,data:{placeholder:s.placeholder||"",answer:s.answer||"",edit:s.edit||"",preview:t,mestate:o}},function(n){var i=function(i){if(r){r=!1,s.init=!0,d.c.removeClass("preview");x(s,n,function(e,n){a(e,n),i&&i(e,n)})}};if(n.el.find(".embedimages").off("click").on("click",function(){var e=C.getid(n.el.find(".postbody"));C.embedimages(e,s),s.answer||s.editid||i()}),t)return n.el.find("textarea").on("click",function(){$(this).blur(),i()}),void n.el.find(".embedEmojiPrivew").on("click",function(){i(function(e,n){e.showPicker()})});x(s,n,a)})}})},commentimages:function(e,n){if(d.c){var i=d.c.find("#"+e.id),t=i.find(".commentimages .image"),l=i.find(".commentimages");if(!l.hasClass("active")&&t.length&&l.length){var m=i.height();t.imagesLoaded({background:!0},function(r){_.each(r.images,function(e,n){var i=e.img,t=$(r.elements[n]).closest(".imagesWrapper"),a="",s=t.width();t.height();if(i.width>i.height&&!isMobile()){a="w2";var o=s*(i.width/i.height);o>l.width()&&(o=l.width(),m=o*(i.height/i.width),t.height(m)),t.width(o)}(i.height>i.width||isMobile())&&(a="h2",t.height(s*(i.height/i.width))),a&&t.addClass(a)});l.isotope({layoutMode:"packery",itemSelector:".imagesWrapper",packery:{gutter:10},initLayout:!1}),l.on("arrangeComplete",function(){l.addClass("active"),t.addClass("active"),n&&n()}),l.isotope()})}else n&&n()}},list:function(n,i){n||(n={}),n.comments=_.filter(n.comments||[],function(e){if(!g[e.id])return g[e.id]=!0});var e=append;p.fromtop&&!n.el?(n.comments=_.sortBy(n.comments,function(e){return-e.time}),e=prepend):n.comments=_.sortBy(n.comments,function(e){return e.time}),n.el||(n.el=d.list),L.shell({name:"list",el:n.el||d.list,inner:n.inner||e,data:{comments:n.comments||[],_class:n.class||"",newcomments:n.newcomments||"",replaceName:function(e,n){return'<span class="tocomment" comment="'+n.comment+'">'+e+"</span>"},replaceNameNoComment:function(e,n){return'<span class="tocommentno">'+e+"</span>"},mestate:o},additionalActions:function(){p.additionalActions()}},function(e){d.list.find(".reply").off("click").on("click",b.replyandreplies),d.list.find(".replies").off("click").on("click",b.replies),d.list.find(".panel").off("click").on("click",b.metmenu),d.list.find(".tocomment").off("click").on("click",b.tocomment),d.list.find(".imageCommentOpen").off("click").on("click",b.openGallery),setTimeout(function(){d.list&&d.list.find(".newcomments").removeClass("newcomments")},600),bgImages(d.list),lazyEach({array:n.comments,action:function(e){W.commentimages(e.item,e.success)}}),i&&i()})}},j={preview:function(e){var n=[];p.lastComment&&(n=L.app.platform.sdk.comments.ini([p.lastComment])),L.sdk.comments.users(n,function(){e&&e(n)})},level:function(e,i){L.app.platform.sdk.comments.get(c,e||"",function(e,n){i&&i(e,n)})}},S={save:function(){},load:function(){var e=L.app.settings.get(L.map.id,c);e&&f[0].import(e)}};return{primary:n,getdata:function(n,e){if(a=e.settings.eid,g={},f={},p=e.settings.essenseData||{},r=p.preview||!1,u=r,l=!1,c=p.txid||null,f[0]=new Comment(c),c){var i={};i.ed=p,L.app.platform.sdk.ustate.me(function(e){o=e,n(i)})}},destroy:function(){delete L.app.platform.sdk.comments.sendclbks[a],delete L.app.platform.ws.messages.comment.clbks[a],delete L.app.platform.sdk.comments.upvoteClbks[a],delete L.app.platform.ws.messages.cScore.clbks[a],v&&v.destroy(),s&&s.destroy(),d={}},init:function(e){var n;(d={}).c=e.el.find("#"+L.map.id),d.post=d.c.find(".post"),d.list=d.c.find(".list"),d.caption=d.c.find(".captionCnt"),d.showall=d.c.find(".showall"),i=d.c.closest(".wndcontent"),t=i.length?0:(i=null,65),r?function(){d.c.find(".loaderWrapper").addClass("hidden"),d.c.addClass("preview"),d.c.addClass("listpreview");var n={};W.post(function(e){h[0]=e}),j.preview(function(e){n.comments=e,n.class="firstcomment",C.showhideLabel(),W.list(n,function(){})})}():(n={},j.level(null,function(e){n.comments=L.app.platform.sdk.comments.storage[c][0],n.class="firstcomment",C.showhideLabel(),W.caption(),W.list(n,function(){d.c.find(".loaderWrapper").addClass("hidden"),W.post(function(e){if(h[0]=e,p.reply)C.fastreply(p.reply);else{var n=parameters(),i={};n.commentid&&(i.answerid=n.commentid,i.parentid=n.parentid||"",i.noaction=!0,C.fastreply(i))}})})}),p.showall&&C.showall()),d.c.find(".showall").on("click",function(){C.showall()}),L.app.platform.sdk.comments.sendclbks[a]=y,L.app.platform.sdk.comments.upvoteClbks[a]=k,L.app.platform.ws.messages.comment.clbks[a]=function(e){if(e.posttxid==c){var n={};if(n.comments=[e.comment],e.parentid){var i=d.c.find("#"+e.parentid);if(n.el=i.find(".answers"),i.find(".repliescount").html(Number(i.find(".repliescount").html()||"0")+1),i.find(".replies").removeClass("hidden"),!i.hasClass("showedreplies"))return}else n.el=d.c.find(".list"),n.class="firstcomment";W.list(n)}},L.app.platform.ws.messages.cScore.clbks[a]=function(e){e.comment.txid==c&&k(null,e.comment,e.upvoteVal||e.value,e.addrFrom)},d.c.on("click",".upvoteComment",b.upvoteComment),e.clbk(null,e)},freeze:function(){s&&s.destroy()},hideall:function(e){l=!1,void 0!==e&&(u=e||!1),u?(d.c.addClass("listpreview"),s&&s.destroy(),s=null):d.c.removeClass("listpreview"),d.c.removeClass("showedall"),C.hideallReplies(),C.showhideLabel()},changein:function(e,n){e?(i=e,t=n,s&&(s.addscroll=!0,s.setOffset([t,0]),s.setIn(i))):(i=d.c.closest(".wndcontent"),t=i.length?0:(i=null,65),s&&(s.addscroll=!!i,s.setOffset([t,0]),s.setIn(i)))}}};return L.run=function(e){var n=L.addEssense(i,t,e);L.init(n,e)},L.stop=function(){_.each(i,function(e){e.destroy()})},L}();"undefined"!=typeof module?module.exports=comments:(app.modules.comments={},app.modules.comments.module=comments);
 /*_____*/ 
var lenta=function(){var le=new nModule,n={},a=function(e){var c,d,p,r,s,t,n,a=deep(e,"history"),i=e.mid,o=!1,l=!1,f=[],u={},m=!1,v={},g={},b=!1,k=!1,x={},w=[],y=!1,C=0,E=null,T=0,S={},A={},V=!1,W=0,I=null,P=!1,M={repost:function(e){var t="index";isMobile()&&(t="share"),le.nav.api.load({open:!0,href:t+"?repost="+e,history:!0,handler:!0,essenseData:{}})},loadprev:function(e){c.c.find(".shares").html('<div class="bspacer"></div>'),c.c.removeClass("showprev"),c.c.removeClass("loading"),c.c.removeClass("sharesEnded"),c.c.removeClass("sharesZero"),M.clear(),re(e)},clear:function(){_.each(v,function(e,t){delete le.app.platform.sdk.node.shares.storage.trx[t]}),_.each(x,function(e){e.p.destroy()}),_.each(u,function(e){e&&e.destroy()}),_.each(A,function(e){e&&e.destroy()}),A={},f=[],v={},g={},S={},k=b=V=!(u={}),x={},C=W=0,I=E=t=null,k=P=y=!(w=[]),loaded=!1,o=!1,T=0},next:function(t,n){var e=nextElH(w,function(e){if(e.txid==t)return!0});e?n&&n(e.txid):k?n&&n(null):M.loadmore(function(e){n&&n(deep(e,"0.txid")||null)})},loadmore:function(n){ie.shares(function(e,t){if(t)return o=!1,le.app.errors.connection()&&c.c.addClass("networkError"),void(le.app.errors.connectionRs()&&(le.iclbks.lenta=M.loadmore));c.c.removeClass("networkError"),e&&se.shares(e,function(){se.sharesInview(e,function(){})},{index:w.length}),n&&n(e)})},removeAdditionalByScroll:function(){if(E){var e=$(window).scrollTop();150<Math.abs(e-C)&&M.additional(E,!1)}},additional:function(e,t){t?(e.addClass("showAdditional"),e.find(".subscribeWrapper").fadeIn(),C=$(window).scrollTop(),E=e,window.addEventListener("scroll",M.removeAdditionalByScroll)):(e.removeClass("showAdditional"),e.find(".subscribeWrapper").fadeOut(),window.removeEventListener("scroll",M.removeAdditionalByScroll))},applyheight:function(e,t,n){var a=d.scrollTop(),s=a+Number(t-e);a==s||e<t||d.scrollTop(s)},applyheightEl:function(e,t,n){if(c&&c.shares&&e&&t.length){var a=t[0].offsetHeight;return t.length&&d.scrollTop()>t.offset().top&&M.applyheight(e,a,n),a}},stateAction:function(t,n){le.app.user.isState(function(e){e?n():le.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{loginText:le.app.localization.e("llogin"),successHref:t,signInClbk:function(){n&&n()}}})})},initVideo:function(e,t){if(!le.app.platform.sdk.usersettings.meta.embedvideo||le.app.platform.sdk.usersettings.meta.embedvideo.value){var n=e.find(".js-player"),a=e.find(".videoWrapper");if(n.length){var s={muted:!0,resetOnEnd:!0,controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],speed:{selected:1,options:[1]}};"a"==t.settings.v&&(s.muted=!1,s.autoplay=!1),isMobile()&&(s.controls=["play","progress","current-time","fullscreen"]),PlyrEx(n[0],s,function(e){x[t.txid]||(x[t.txid]={}),x[t.txid].p=e,x[t.txid].initing=!0,x[t.txid].el=a,x[t.txid].id=a.attr("pid"),e.on("ready",function(){x[t.txid]&&(n.find("iframe").attr("disable-x-frame-options","disable-x-frame-options"),x[t.txid].inited=!0)})})}}},openPost:function(e,t){if(isMobile()){var n=le.app.platform.sdk.node.shares.storage.trx[e];delete u[e],se.share(n,null,!0)}else le.nav.api.load({open:!0,href:"post?s="+e,inWnd:!0,history:!0,clbk:function(){p.renderclbk&&p.renderclbk(),t&&t()},essenseData:{share:e,hr:p.hr,like:function(e){se.stars(e)},next:M.next,close:function(){p.renderclbk&&p.renderclbk()}}})},sharesocial:function(e,t){var n=le.app.platform.sdk.node.shares.storage.trx[e];if(n){var a="https://pocketnet.app/"+(p.hr||"index?")+"s="+e+"&mpost=true&ref="+le.app.platform.sdk.address.pnet().address;parameters().address&&(a+="&address="+(parameters().address||""));var s=n.message,i=trimHtml(s,130).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"..."),o=n.images[0];if(!o&&n.url){var r=videoImage(n.url);r&&(o=r)}var l="Post";"a"==n.settings.v&&(l="Article"),le.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{url:a,caption:"Share this "+l,image:o||deep(app,"platform.sdk.usersl.storage."+n.address+".image"),title:n.caption||deep(app,"platform.sdk.usersl.storage."+n.address+".name"),text:i}})}},donate:function(e,t){var n=le.app.platform.sdk.node.shares.storage.trx[e];if(n){var a=deep(app,"platform.sdk.usersl.storage."+n.address)||{address:n.address,addresses:[]},s="send?address="+n.address+"&amount=1&message="+hexEncode(le.app.localization.e("postlabel")+" &mdash; "+(n.caption||n.message).substr(0,20)+"...")+"&label="+(a.name||a.address)+"&setammount=true";le.fastTemplate("donation",function(e){dialog({html:e,class:"one donation",btn1text:le.app.localization.e("dcancel"),clbk:function(e,t){e.find(".pnetdnt").on("click",function(){le.nav.api.load({open:!0,href:s,history:!0}),t.destroy()}),e.find(".copy").on("click",function(){var e=$(this).closest(".address").find(".addr");copyText(e),sitemessage(le.app.localization.e("successfullycopiedaddress"))})}})},{userinfo:a})}},videoPosition:function(e){var t=e.find(".work");if(e.hasClass("fullScreenVideo")){var n=($(window).height()-(e.find(".videoWrapper").height()+100))/2;0<n?t.css("margin-top",n+"px"):t.css("margin-top","0px")}else t.css("margin-top","0px")},fullScreenVideoMobile:function(e){x[e]&&(x[e].p.fullscreen.enter(),x[e].p.playing||x[e].p.play(),x[e].p.muted=!1)},fullScreenVideo:function(e,t){if(x[e]){var n=c.c.find("#"+e);n.addClass("fullScreenVideo"),M.videoPosition(n),le.app.nav.api.history.addParameters({v:e});var a=x[e];a.p.playing||a.p.play(),a.p.muted=!1,l=!le.app.actions.offScroll(),u[e]&&u[e].changein(c.c.find("#"+e),0),se.comments(e,!1,!0),V=!0,t&&t()}},exitFullScreenVideo:function(e){var t=c.c.find("#"+e);t.removeClass("fullScreenVideo"),M.videoPosition(t),x[e].p.muted=!0,le.app.nav.api.history.removeParameters(["v"]),le.app.actions.onScroll(),V=!1,u[e]&&(u[e].changein(null),u[e].hideall(!0))},like:function(n,e,a){if(n.address!=le.app.platform.sdk.address.pnet().address){var s=n.upvote(e);if(!s)return le.app.platform.errorHandler("4",!0),void(a&&a(!1));le.sdk.node.transactions.create.commonFromUnspent(s,function(e,t){topPreloader(100),e?a&&a(!0):(s.myVal=null,n.myVal=0,le.app.platform.errorHandler(t,!0),a&&a(!1))})}},block:function(e,t){},complain:function(e,n){var t=e.complain();le.sdk.node.transactions.create.commonFromUnspent(t,function(e,t){topPreloader(100),e?n&&n(!0):(c.postWrapper.addClass("showError"),le.app.platform.errorHandler(t,!0),n&&n())})},openGalleryRec:function(n,a,s){var i=[],o=function(e,n){_.each(e.images,function(e){i.push(e)}),e.repost?le.app.platform.sdk.node.shares.getbyid(e.repost,function(e){var t=e[0];t?o(t,n):n&&n()}):n&&n()};o(n,function(){var e=_.map(i,function(e){return{src:e}}),t=findIndex(e,function(e){if(e.src==a)return!0});(1<e.length||n.url&&e.length&&parseVideo(n.url).type||!isMobile())&&le.app.nav.api.load({open:!0,href:"imagegallery?i="+n.txid+"&num="+(t||0),inWnd:!0,history:!0,essenseData:{initialValue:a,idName:"src",images:e,gid:n.txid},clbk:function(){s&&s()}})})},openGallery:function(e,t,n){var a=_.map(e.images,function(e){return{src:e}}),s=findIndex(a,function(e){if(e.src==t)return!0});(1<a.length||e.url&&a.length&&parseVideo(e.url).type||!isMobile())&&le.app.nav.api.load({open:!0,href:"imagegallery?i="+e.txid+"&num="+(s||0),inWnd:!0,history:!0,essenseData:{initialValue:t,idName:"src",images:a,gid:e.txid},clbk:function(){n&&n()}})},videosInview:function(e,i,o){var r=_.filter(e,function(e){if(e.inited&&!e.playing&&!e.stopped&&e.el)return!0});r.length&&(t=slowMade(function(){r=_.filter(r,function(e){return e.el});_.map(r,function(e){return e.el[0]});var e=inView(c.c.find(".videoWrapper"),{offset:$(window).height()/10,mode:"all"}),t=null;if(0<e.length){var n=$(e[0]);t=n.attr("pid");var a=_.find(r,function(e){return e.id==t});if(!t||!a)return;a&&setTimeout(function(){inView(n,{offset:-100,mode:"all"}).length&&i(a,n)},320)}var s=_.filter(r,function(e){return e.id!=t});s.length&&o(s)},t,30))},scrollToPost:function(e){_scrollTo($("#"+e))},sharesInview:function(o,r,l){d.scrollTop();o.length&&!y&&(n=slowMade(function(){var e=c.c.find(".share"),t=d,n=$(window).height()/4,a=inView(e,{inel:t,offsetTop:n,offsetBottom:n});if(0<a.length){var s={},i=_.map(a,function(e){var t=$(e).attr("id");return _.find(o,function(e){return e.txid==t})});i=_.filter(i,function(e){if(e&&!e.temp)return!0}),!0,r(i,a,function(){if(!1,l){var e=_.filter(o,function(e){if(!s[e.txid])return!0});l(e)}})}},n,30))},complain:function(e){le.nav.api.load({open:!0,id:"complain",inWnd:!0,essenseData:{item:"post",obj:le.app.platform.sdk.node.shares.storage.trx[e],success:function(){}},clbk:function(){}})}},L=function(){var e=$(this).closest(".share").attr("id");M.repost(e)},H=function(){$(this).closest(".authorgroup").find(".share").removeClass("hidden"),$(this).remove(),se.sharesInview(w,function(){})},D=function(){var e=$(this),t=$(this).closest(".share").attr("id");le.app.platform.api.metmenu(e,t,M)},z=function(){var e=c.c.find(".fullScreenVideo");0<e.length&&M.videoPosition(e)},N=function(){$(window).scrollTop()+$(window).height()>c.c.height()-400&&!b&&!k&&"recommended"!=r&&M.loadmore()},F=function(e){M.sharesInview(w,function(e,t,n){var a=_.filter(e,function(e){return!v[e.txid]});p.contents&&0<a.length&&(p.beginmaterial=e[0].txid,ie.shares(function(e){se.sharesInview(e,function(){})})),n&&n()},function(e){})},B=function(e){M.videosInview(x,function(e,t,n){le.app.platform.sdk.usersettings.meta.videoautoplay&&!le.app.platform.sdk.usersettings.meta.videoautoplay.value||t.closest(".share").hasClass("showAdditional")||e.p.play()},function(e){_.each(e,function(e){e.p.muted=!0,e.p.playing&&e.p.stop()})})},U=function(){var e=$(this).closest(".share").attr("id");se.comments(e,!0)},O=function(){var e=$(this).closest(".share").attr("id");le.app.platform.sdk.node.transactions.get.tx(e)},G=function(){if(p.authAction)p.authAction("like");else{var n=$(this).closest(".stars");if(!n.attr("value")){var e=$(this).closest(".share").attr("id"),a=$(this).attr("value"),s=le.app.platform.sdk.node.shares.storage.trx[e];n.attr("value",a),n.addClass("liked"),M.stateAction("_this",function(){M.like(s,a,function(e){if(e){s.scnt||(s.scnt=0),s.score||(s.score=0),s.scnt++,s.score=Number(s.score||0)+Number(a);var t=Number(s.score)/Number(s.scnt);n.find(".tstarsov").css("width",t/5*100+"%"),n.closest(".itemwr").find(".count span.v").html(t.toFixed(1)),se.stars(s)}else n.removeAttr("value"),n.removeClass("liked")})})}}},R=function(){var e=$(this).closest(".share").attr("id");M.complain(e)},j=function(){var e=$(this).closest(".share");M.additional(e,!e.hasClass("showAdditional"))},q=function(){var t=$(this).closest(".shareinlenta").attr("id"),e=$(this).attr("i"),n=le.app.platform.sdk.node.shares.storage.trx[t];if(!n){var a=_.find(le.sdk.node.transactions.temp.share,function(e){return e.txid==t});(n=new pShare)._import(a),n.temp=!0,n.address=le.app.platform.sdk.address.pnet().address}M.openGalleryRec(n,e)},Z=function(){var e=$(this).closest(".shareTable").attr("address");$(this).closest(".share");le.app.platform.api.actions.subscribe(e,function(e,t){e||le.app.platform.errorHandler(t,!0)})},J=function(){var e=$(this).closest(".shareTable").attr("address"),n=$(this).closest(".share");dialog({html:"Do you really want to unfollow user?",btn1text:"Unfollow",btn2text:"Cancel",class:"zindex",success:function(){le.app.platform.api.actions.unsubscribe(e,function(e,t){e?n.find(".shareTable").removeClass("subscribed"):le.app.platform.errorHandler(t,!0)})}})},K=function(){var e=$(this).closest(".share").attr("id");M.exitFullScreenVideo(e)},Q=function(){var e=$(this).closest(".share").attr("id");M.fullScreenVideo(e)},X=function(e){if(!deep(e,"target.href"))if(p.authAction)p.authAction("like");else{var t=$(this).closest(".shareinlenta").attr("id");M.openPost(t)}},Y=function(){var e=$(this).closest(".shareinlenta").attr("id");le.app.platform.m.log("sharing_opened_button",e),M.sharesocial(e)},ee=function(){if(p.authAction)p.authAction("donate");else{var e=$(this).closest(".share").attr("id");M.donate(e)}},te=function(){if(p.authAction)p.authAction("discussion");else{var e=$(this).closest(".share").attr("id"),t=le.app.platform.sdk.node.shares.getWithTemp(e);isMobile()?le.nav.api.load({open:!0,id:"discussions",history:!0,clbk:function(){le.app.platform.sdk.chats.add(e+"_"+t.address,"share")}}):le.app.platform.sdk.chats.add(e+"_"+t.address,"share")}},ne=function(){M.loadmore()},ae=function(){M.loadprev()},se={comments:function(n,a,s,i){if(!p.nocomments&&!u[n]&&c.c){var o=c.c.find("#"+n+" .commentsWrapper"),r=deep(le.app.platform,"sdk.node.shares.storage.trx."+n);setTimeout(function(){le.fastTemplate("commentspreview",function(e){if(c.c){var t="https://pocketnet.app/"+(p.hr||"index?")+"s="+n+"&mpost=true&ref="+le.app.platform.sdk.address.pnet().address;parameters().address&&(t+="&address="+(parameters().address||"")),le.nav.api.load({open:!0,id:"comments",el:o,eid:n+"lenta",essenseData:{close:function(){u[n]&&u[n].hideall(!0),_scrollToTop(o,0,0,-65)},totop:c.c.find("#"+n),caption:e,send:function(){var e=c.c.find("#"+n+" .commentsAction .count span");e.html(Number(e.html()||"0")+1)},txid:n,init:a,showall:s,preview:i,lastComment:r.lastComment,count:r.comments,hr:t,renderClbk:function(){p.renderclbk&&p.renderclbk()}},clbk:function(e,t){c.c&&((e=c.c.find("#"+n)).hasClass("fullScreenVideo")&&t.changein(e,0),t&&(u[n]=t),p.renderclbk&&p.renderclbk())}})}},{share:r})},30)}},roomsinfo:function(e){_.each(e,function(e){var t,n=deep(le.app.platform,"rtc.storage.info."+e+".d.users_count"),a=e.split("_")[0];void 0!==n&&c.c&&c.c.find("#"+a+" .discussion .count").html((t=n)?"<b>"+t+"</b>":"")})},shareSpacers:function(e){_.each(e,function(e){se.shareSpacer(e)})},shareSpacer:function(e){if(v[e.txid]&&!g[e.txid]){var t=c.shares.find("#"+e.txid),n=t.find(".work").outerHeight();x[e.txid]&&x[e.txid].inited&&(x[e.txid].p.destroy(),x[e.txid].el=null,x[e.txid].inited=!1),v[e.txid]=!1,c.shares.css("height",c.shares.outerHeight()),t.html('<div class="shareSpacer added"></div>'),t.find(".shareSpacer").outerHeight(n),S[e.txid]=M.applyheightEl(S[e.txid],t,"space")}},share:function(t,n,e){var a=c.shares.find("#"+t.txid);S[t.txid]=0,a[0]&&(S[t.txid]=a[0].offsetHeight);a.find(".added");g[t.txid]=!0,le.shell({name:"share",el:a,data:{share:t,ed:p,mestate:s,all:e||!1}},function(e){a.find(".work");v[t.txid]=!0,S[t.txid]=M.applyheightEl(S[t.txid],a,"share"),se.stars(t),t.temp||se.comments(t.txid,!1,!1,!0),se.repost(e.el,t.repost,t.txid),se.url(e.el.find(".url"),t.url,t,function(){se.urlContent(t,function(){p.searchValue&&e.el.find(".canmark").mark(p.searchValue),M.initVideo(e.el,t),g[t.txid]=!1,n&&n()})}),se.images(t,function(){})})},stars:function(e,t){if(c.shares){var n=c.shares.find("#"+e.txid);n.length&&le.shell({name:"stars",el:n.find(".forstars"),data:{share:e}},function(e){fastars(e.el.find(".stars")),t&&t()})}},sharesInview:function(e,t){e=_.filter(e,function(e){return!$("#"+e.txid).hasClass("hidden")});var n=_.sortBy(e,function(e){return-e.time});lazyEach({array:n,action:function(e){var t=e.item;v[t.txid]?e.success():(v[t.txid]=!0,se.share(t,e.success))},sync:isMobile(),all:{success:function(){t()}}})},shares:function(t,n,e){e||(e={}),e.inner||(e.inner=append);var a="groupshares";(p.author||r||p.txids||p.search)&&(a="shares"),"recommended"==r&&(t=_.sortBy(t,function(e){return-e.time})),e.ignoresw||(t=_.filter(t,function(t){return!_.find(w,function(e){return e.txid==t.txid})})),le.shell({name:a,inner:e.inner,el:e.el||c.shares,data:{shares:t||[],index:e.index||0},animation:!1},function(e){e.inner==append?w=w.concat(t):e.inner!=replaceWith&&(w=t.concat(w)),w=_.uniq(w,function(e){return e.txid}),p.renderclbk&&p.renderclbk(),n&&n()})},videoPreview:function(e,t){var n=c.c.find("#"+e.txid);if("a"==e.settings.v){var a=n.find("[data-plyr-provider][data-plyr-embed-id]"),s=[];$.each(a,function(){var e=$(this),t={type:e.attr("provider"),id:e.attr("eid")};s.push(videoImage(t))})}else t&&t()},images:function(n,a){var s=n;if(c.c){var i=c.c.find("#"+n.txid),o=i.find(".image"),l=i.find(".images");!l.hasClass("active")&&o.length&&l.length?o.imagesLoaded({background:!0},function(r){"a"!=n.settings.v&&_.each(r.images,function(e,t){var n=e.img,a=$(r.elements[t]).closest(".imagesWrapper"),s="",i=a.width();a.height();if(n.width>n.height&&!isMobile()){s="w2";var o=i*(n.width/n.height);o>l.width()&&(o=l.width(),h=o*(n.height/n.width),a.height(h)),a.width(o)}(n.height>n.width||isMobile())&&(s="h2",a.height(i*(n.height/n.width))),s&&a.addClass(s)}),S[s.txid]=M.applyheightEl(S[s.txid],i);var e=function(){l.addClass("active"),o.addClass("active"),S[s.txid]=M.applyheightEl(S[s.txid],i),p.renderclbk&&p.renderclbk(),a&&a()};if("a"!=n.settings.v&&1<r.images.length){var t=20;isMobile&&(t=5),l.isotope({layoutMode:"packery",itemSelector:".imagesWrapper",packery:{gutter:t},initLayout:!1}),l.on("arrangeComplete",function(){e()}),l.isotope()}else e()}):a&&a()}},repost:function(e,t,n,a){t&&le.shell({name:"repost",el:e.find(".repostWrapper"),data:{repost:t,share:deep(le.app.platform,"sdk.node.shares.storage.trx."+n),level:1}},function(e){e.el&&e.el.length&&le.app.platform.papi.post(t,e.el.find(".repostShare"),function(e){A[n]=e},{repost:!0,eid:n,level:1})})},url:function(e,t,s,i){if(p.nourlload)i&&i();else{var n=le.app.platform.sdk.remote.storage[t],o=e.closest(".share");le.shell({turi:"share",name:"url",el:e,data:{url:t,og:n,share:s}},function(n){le.app.nav.api.links(null,n.el,function(e){e.stopPropagation()}),S[s.txid]=M.applyheightEl(S[s.txid],o,"url");var a=n.el.find("img");p.renderclbk&&p.renderclbk(),n.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,t){e.isLoaded?($(a[t]).addClass("active"),500<e.img.naturalWidth&&n.el.addClass("bigimageinlink")):$(a[t]).closest(".image").css("display","none")}),S[s.txid]=M.applyheightEl(S[s.txid],o,"url"),p.renderclbk&&p.renderclbk()}),i&&i()})}},urlContent:function(t,n){if(c.c){var a=t.url;if(a){var s=c.c.find("#"+t.txid+" .url"),e=le.app.platform.parseUrl(a),i=le.app.platform.sdk.remote.storage[a];a&&!i?"youtube"==e.type||"vimeo"==e.type||"bitchute"==e.type?n&&n():le.app.platform.sdk.remote.get(a,function(e){e?se.url(s,a,t,n):n&&n()}):n&&n()}else n&&n()}},urlsContent:function(e){_.each(e,function(e){se.urlContent(e)})},urls:function(e,t){lazyEach({array:e,sync:!0,action:function(e){se.url(e.item.el,e.item.url,e.item.share,e.success)},all:{success:function(){t&&t()}}})},spacers:function(e,t){var n=_.map(e,function(e){return{txid:e,author:p.author}});this.shares(n,t,{noview:!0})}},ie={recomended:function(t,n){c.loader.fadeIn(),c.c.addClass("loading"),f=[],p.author||I?t&&t(f):le.app.platform.sdk.node.shares.recomended({},function(e){f=_.filter(e,function(t){if(!_.find(n,function(e){if(e.txid==t)return!0}))return!0}),le.app.platform.sdk.node.shares.users(e,function(){t&&t(f)})})},txids:function(e,t){P?t([]):le.app.platform.sdk.node.shares.getbyid(e,function(e){P=!0,t(e)})},begin:function(t){!I||P||r&&"sub"!=r?t([]):le.app.platform.sdk.node.shares.getbyid(I,function(e){P=!0,t(e)})},sstuff:function(n,a,s,i){var o=p.author;le.app.platform.sdk.node.shares.users(n,function(e,t){W+=n.length,b=!1,c.c&&(a||t||(!n||!n.length||n.length<s.count||"recommended"==r)&&(I||W?(n.length<s.count||"recommended"==r)&&(r||o||p.search)&&setTimeout(function(){c.c&&c.c.addClass("sharesEnded")},1e3):c.c.addClass("sharesZero"),n.length<s.count&&(r||o||p.search)&&(k=!0)),c.loader.fadeOut(),i&&i(n,a||t))})},shares:function(s,i){b||k&&(!p.contents||p.txids.length==_.toArray(v).length)||(c.loader.fadeIn(),c.c.addClass("loading"),b=!0,p.loader?p.loader(function(e,t,n){ie.sstuff(e,t,n,s)}):ie.begin(function(a){var e=p.author,t="common",n=I;r&&("recommended"==r?t="recommended":"b"==r?(t="getbyidsp",n=p.beginmaterial):(t="common",e="1")),p.txids&&"b"!=r&&(t="txids"),le.app.platform.sdk.node.shares[t]({author:e,begin:n||"",txids:p.txids},function(t,e,n){_.each(a,function(e){e&&t.unshift(e)}),p.filter&&(t=_.filter(t,p.filter)),ie.sstuff(t,e,n,s),"b"==r&&(I="")},i)}))}},oe=function(){},re=function(a,s){var e="clear",n=o=!0;p.goback&&(e="cache"),p.contents&&(c.c.find(".shares").html(""),se.spacers(p.txids,function(){M.scrollToPost(p.beginmaterial)}),n=!1),ie.shares(function(e,t){if(t)return o=!1,le.app.errors.connection()&&c.c.addClass("networkError"),void(le.iclbks.lenta=function(){re(null,s)});c.c.removeClass("networkError"),e?(I&&!r&&c.c.addClass("showprev"),n&&c.c.find(".shares").html(""),se.shares(e,function(){se.sharesInview(e,function(){o=!1,F();var e=parameters();if(e.s&&M.openPost(e.s,function(){M.scrollToPost(e.p)}),e.i){var t=deep(le.app.platform,"sdk.node.shares.storage.trx."+e.i),n=null;t&&(e.num&&(n=deep(t,"images."+e.num)),M.openGalleryRec(t,n))}e.v&&(M.scrollToPost(e.v),M.fullScreenVideo(e.v,function(){})),a&&a(),p.goback&&s.clbk&&(p.goback=!1,s.clbk(null,s))})})):o=!1},e)};return{id:i,primary:a,getdata:function(n,t){l=!1,T=0,u={},p=t.settings.essenseData||{},M.clear();var e=parameters();I=e.s||e.i||e.v||null,r=!!e.r&&e.r,p.txids&&"b"!=r&&(r=!1),m=!p.txids||!1,t.state||r||p.author||p.txids?le.app.platform.sdk.ustate.me(function(e){s=e||{};var t={beginmaterial:I,author:p.author,recommended:r};le.loadTemplate({name:"share"},function(){le.loadTemplate({turi:"share",name:"url"},function(){le.loadTemplate({name:"stars"},function(){n(t)})})})}):I?ie.begin(function(e){le.app.platform.sdk.node.shares.users(e,function(){t.settings.el.closest("#main").addClass("onepost"),le.nav.api.load({open:!0,href:"post",primary:!0,el:t.settings.el,essenseData:{share:I},clbk:function(){}})})}):"undefined"!=typeof _Electron||window.cordova?le.nav.api.load({open:!0,href:"authorization",history:!0}):le.nav.api.load({open:!0,href:"video",history:!0})},destroy:function(){_.each(v,function(e,t){delete le.app.platform.sdk.node.shares.storage.trx[t]}),_.each(x,function(e){e.p.destroy()}),l&&le.app.actions.onScroll(),_.each(u,function(e){e.destroy()}),u={},delete le.iclbks.lenta,delete le.app.platform.ws.messages.comment.clbks.lenta,delete le.app.platform.sdk.node.shares.clbks.added.lenta,delete le.app.platform.ws.messages.transaction.clbks.temp,delete le.app.platform.ws.messages.event.clbks.lenta,delete le.app.platform.ws.messages["new block"].clbks.newsharesLenta,delete le.app.platform.clbks.api.actions.subscribe.lenta,delete le.app.platform.clbks.api.actions.unsubscribe.lenta,delete le.app.platform.clbks.api.actions.blocking.lenta,delete le.app.platform.clbks.api.actions.unblocking.lenta,delete le.app.platform.clbks._focus.lenta,le.app.platform.sdk.chats.removeTemp(),window.removeEventListener("scroll",B),window.removeEventListener("scroll",F),window.removeEventListener("scroll",N),window.removeEventListener("resize",z),c={}},init:function(e){d=$(window),oe(),(c={}).c=e.el.find("#"+le.map.id),c.shares=c.c.find(".shares"),c.loader=c.c.find(".loader"),c.lentacnt=c.c.find(".lentacell .cnt"),function(){if(isMobile()&&m){var n=c.c.find(".circularprogress"),a=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}});a.update(70),c.c.find(".circularprogressWrapper").html(a.el);var s=c.c.find(".loadprev"),e=new SwipeParallax({el:c.c.find(".shares"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(e){var t=Math.abs(e)/200;0<=e&&(a.options.text={value:""},a.update(100*t),n.height(220*t+"px"),s.css("opacity",1-4*t))},constraints:function(){if(0==d.scrollTop()&&!V)return!0},restrict:!0,trueshold:200,clbk:function(){le.app.platform.sdk.notifications.getNotifications(),M.loadprev(function(){e.renew()})}}}}).init()}window.addEventListener("scroll",F),window.addEventListener("scroll",B),window.addEventListener("resize",z),p.notscrollloading||window.addEventListener("scroll",N),c.c.on("click",".stars i",G),c.c.on("click",".complain",R),c.c.on("click",".imageOpen",q),c.c.on("click",".txid",O),isMobile()||(c.c.on("click",".sharecaption",X),c.c.on("click",".message",X)),c.c.on("click",".showMore",X),c.c.on("click",".forrepost",L),c.c.on("click",".videoTips",Q),c.c.on("click",".videoOpen",Q),c.c.on("click",".exitFull",K),c.c.on("click",".additional",j),c.c.on("click",".asubscribe",Z),c.c.on("click",".aunsubscribe",J),c.c.on("click",".donate",ee),c.c.on("click",".sharesocial",Y),c.c.on("click",".discussion",te),c.c.on("click",".metmenu",D),c.c.find(".loadmore button").on("click",ne),c.c.find(".loadprev button").on("click",ae),c.c.on("click",".showmorebyauthor",H),c.c.on("click",".commentsAction",U),p.txids||(le.app.platform.sdk.node.shares.clbks.added.lenta=function(e){e.txidEdit?(delete u[e.txidEdit],delete v[e.txidEdit],delete g[e.txidEdit],replaceEqual(w,{txid:e.txidEdit},e)&&se.shares([e],function(){se.sharesInview([e],function(){})},{inner:replaceWith,el:c.shares.find("#"+e.txidEdit),ignoresw:!0})):se.shares([e],function(){se.sharesInview([e],function(){})},{inner:prepend})},le.app.platform.ws.messages.transaction.clbks.temp=function(t){if(t.temp){var e=_.find(w,function(e){if(e.txid==t.temp.txid)return!0});e&&(e.temp=!1,e.scnt="0",e.score="0",e.myVal=0,e.time=new Date,v[e.txid]=!1,se.sharesInview([e],function(){}))}},le.app.platform.ws.messages.event.clbks.lenta=function(t){if("upvoteShare"==t.mesType&&t.share){var e=_.find(w,function(e){if(e.txid==t.share.txid)return!0});e&&se.stars(e,function(){})}});var t=function(e){if(!I&&"recommended"!=r&&!p.author&&!p.search){var t=_.toArray(le.sdk.node.transactions.temp.share||{}),n=0;t.length&&!r&&(n-=t.length),0<(e||0)+n&&(T=T+(e||0)+n,c.c.addClass("showprev"),c.c.find(".countnew").html("("+T+")"))}};le.app.platform.clbks._focus.lenta=function(e){window.cordova&&!p.txids&&!o&&120<e&&(M.loadprev(),_scrollTop(0))},le.app.platform.ws.messages.newblocks.clbks.newsharesLenta=function(e){o||I||p.author||p.txids||t("sub"==r?e.cntsubscr:e.cntposts)},le.app.platform.ws.messages["new block"].clbks.newsharesLenta=function(e){o||I||p.author||p.txids||t("sub"==r?e.sharesSubscr:e.shares)},le.app.platform.ws.messages.comment.clbks.lenta=function(e){if(v[e.posttxid]){var t=c.c.find("#"+e.posttxid+" .commentsAction .count span");t.html(Number(t.html()||"0")+1)}},le.app.platform.clbks.api.actions.subscribe.lenta=function(e){c.c.find('.shareTable[address="'+e+'"]').addClass("subscribed")},le.app.platform.clbks.api.actions.unsubscribe.lenta=function(e){c.c.find('.shareTable[address="'+e+'"]').removeClass("subscribed")},le.app.platform.clbks.api.actions.blocking.lenta=function(e){c.c.find('.shareTable[address="'+e+'"]').closest(".share").addClass("blocking")},le.app.platform.clbks.api.actions.unblocking.lenta=function(e){c.c.find('.shareTable[address="'+e+'"]').closest(".share").removeClass("blocking")}}(),re(null,e),p.goback||e.clbk(null,e)}}};return le.run=function(e){var t=le.addEssense(n,a,e);le.init(t,e)},le.stop=function(){_.each(n,function(e){e.destroy()})},le}();"undefined"!=typeof module?module.exports=lenta:(app.modules.lenta={},app.modules.lenta.module=lenta);