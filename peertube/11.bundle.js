(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{158:function(e,t,s){"use strict";s.d(t,"d",(function(){return b})),s.d(t,"j",(function(){return a})),s.d(t,"i",(function(){return h})),s.d(t,"h",(function(){return p})),s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return m})),s.d(t,"k",(function(){return g})),s.d(t,"l",(function(){return v})),s.d(t,"f",(function(){return u})),s.d(t,"c",(function(){return d})),s.d(t,"e",(function(){return o})),s.d(t,"g",(function(){return l}));const n=["linkify","autolink","emphasis","link","newline","list"],i=n.concat(["html_inline","html_block"]);function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}function o(){return!!/iPad|iPhone|iPod/.test(navigator.platform)||!!(navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform))}function l(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}n.concat(["image"]),i.concat(["image"]).concat(["block","inline","heading","paragraph"]);const r=[{max:1024,type:"B"},{max:1048576,type:"KB"},{max:1073741824,type:"MB"},{max:10995116e5,type:"GB"}];function d(e){const t=r.find((t=>e<t.max))||r[r.length-1];return[Math.floor(e/(t.max/1024)).toString(),t.type]}function u(){return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}function c(e={}){const{baseUrl:t}=e,s=t||window.location.origin+window.location.pathname.replace("/embed/","/watch/"),n=function(e){const t=new URLSearchParams(window.location.search);return t.delete("videoId"),t.delete("resume"),t}(window);if(null!=e.startTime){const t=Math.floor(e.startTime);n.set("start",p(t))}if(e.stopTime){const t=Math.floor(e.stopTime);n.set("stop",p(t))}return e.subtitle&&n.set("subtitle",e.subtitle),!0===e.loop&&n.set("loop","1"),!0===e.autoplay&&n.set("autoplay","1"),!0===e.muted&&n.set("muted","1"),!1===e.title&&n.set("title","0"),!1===e.warningTitle&&n.set("warningTitle","0"),!1===e.controls&&n.set("controls","0"),!1===e.peertubeLink&&n.set("peertubeLink","0"),function(e,t){let s=!1;return t.forEach((()=>s=!0)),s?e+"?"+t.toString():e}(s,n)}function h(e){if(!e)return 0;if("number"==typeof e)return e;const t=e.match(/^((\d+)[h:])?((\d+)[m:])?((\d+)s?)?$/);return t?3600*parseInt(t[2]||"0",10)+60*parseInt(t[4]||"0",10)+parseInt(t[6]||"0",10):0}function p(e,t=!1,s){let n="";if(0===e&&!t)return"0s";const i=s||"h",a=s||"m",o=t?"":"s",l=Math.floor(e/3600);l>=1?n=l+i:t&&(n="0"+i),e%=3600;const r=Math.floor(e/60);return r>=1&&r<10&&t?n+="0"+r+a:r>=1?n+=r+a:t&&(n+="00"+a),(e%=60)>=1&&e<10&&t?n+="0"+e+o:e>=1?n+=e+o:t&&(n+="00"),n}function m(e,t){return'<iframe width="560" height="315" sandbox="allow-same-origin allow-scripts allow-popups" title="'+function(e){if(!e)return"";const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(e).replace(/[&<>"'`=/]/g,(e=>t[e]))}(t)+'" src="'+e+'" frameborder="0" allowfullscreen></iframe>'}function g(e){let t=e[0];for(let s=1;s<e.length;s++){const n=e[s];t.resolution.id<n.resolution.id&&(t=n)}return t}function v(e){let t=e[0];for(let s=1;s<e.length;s++){const n=e[s];t.resolution.id>n.resolution.id&&(t=n)}return t}function b(){return{iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"stun:stun.framasoft.org"}]}}},168:function(e,t,s){"use strict";function n(){const e=v("volume");if(null!=e){const t=parseFloat(e);if(isNaN(t))return;return t}}function i(){const e=v("webtorrent_enabled");return null==e||"true"===e}function a(){const e=v("mute");if(null!=e)return"true"===e}function o(){const e=v("theater-enabled");return null!=e&&"true"===e}function l(e){return b("volume",e.toString())}function r(e){return b("mute",e.toString())}function d(e){return b("theater-enabled",e.toString())}function u(e){return b("average-bandwidth",e.toString())}function c(){const e=v("average-bandwidth");if(null!=e){const t=parseInt(e,10);if(isNaN(t))return;return t}}function h(e){return b("last-subtitle",e)}function p(){return v("last-subtitle")}function m(e,t){return b("video-watch-history",JSON.stringify(Object.assign(Object.assign({},function(e){let t;try{t=JSON.parse(v("video-watch-history"))}catch(e){console.error("Cannot parse video watch history from local storage: ",e)}return t=t||{},t}()),{[e]:{duration:t,date:`${(new Date).toISOString()}`}})))}s.d(t,"f",(function(){return n})),s.d(t,"d",(function(){return i})),s.d(t,"c",(function(){return a})),s.d(t,"e",(function(){return o})),s.d(t,"l",(function(){return l})),s.d(t,"i",(function(){return r})),s.d(t,"j",(function(){return d})),s.d(t,"g",(function(){return u})),s.d(t,"a",(function(){return c})),s.d(t,"h",(function(){return h})),s.d(t,"b",(function(){return p})),s.d(t,"k",(function(){return m}));const g="peertube-videojs-";function v(e){try{return localStorage.getItem(g+e)}catch(e){return}}function b(e,t){try{localStorage.setItem(g+e,t)}catch(e){}}},235:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));var n=s(0),i=s(30),a=s(157);function o(t,o){let r=l(t);const d=/bytes=(\d+)-(\d+)/;return function u(c,h,p,m=1){return Object(n.a)(this,void 0,void 0,(function*(){o&&(yield Object(i.d)(1e3));const g=Object(a.basename)(c.url),v=(yield r)[g];if(!v&&m>3)throw new Error(`Unknown segment name ${g} in segment validator`);if(!v)return console.log("Refetching sha segments for %s.",g),yield Object(i.d)(1e3),r=l(t),void(yield u(c,h,p,m+1));let b,y="";if("string"==typeof v)b=v;else{const e=d.exec(c.range);y=e[1]+"-"+e[2],b=v[y]}if(void 0===b)throw new Error(`Unknown segment name ${g}/${y} in segment validator`);const C=yield function(t){return Object(n.a)(this,void 0,void 0,(function*(){if(t)return window.crypto.subtle?window.crypto.subtle.digest("SHA-256",t).then((e=>function(e){if(!e)return"";let t="";const s="0123456789abcdef";return new Uint8Array(e).forEach((e=>t+=s[e>>4]+s[15&e])),t}(e))):(new((yield s.e(8).then(s.t.bind(null,341,7))).sha256)).update(e.from(t)).digest("hex")}))}(c.data);if(C!==b)throw new Error(`Hashes does not correspond for segment ${g}/${y}(expected: ${b} instead of ${C})`)}))}}function l(e){return fetch(e).then((e=>e.json())).catch((e=>(console.error("Cannot get sha256 segments",e),{})))}}).call(this,s(149).Buffer)},346:function(e,t,s){"use strict";s.r(t),s.d(t,"PeertubePlayerManager",(function(){return q})),s.d(t,"videojs",(function(){return a.a}));var n=s(0),i=(s(231),s(232),s(233),s(234),s(8)),a=s.n(i);const o=a.a.getComponent("Component");a.a.registerComponent("EndCard",class extends o{constructor(e,t){super(e,t),this.dashOffsetTotal=586,this.dashOffsetStart=293,this.interval=50,this.upNextEvents=new a.a.EventTarget,this.ticks=0,this.totalTicks=this.options_.timeout/this.interval,e.on("ended",(t=>{this.options_.condition()&&(e.addClass("vjs-upnext--showing"),this.showCard((t=>{e.removeClass("vjs-upnext--showing"),this.container.style.display="none",t||this.options_.next()})))})),e.on("playing",(()=>{this.upNextEvents.trigger("playing")}))}createEl(){const e=super.createEl("div",{className:"vjs-upnext-content",innerHTML:(t=this.options_,`\n    <div class="vjs-upnext-top">\n      <span class="vjs-upnext-headtext">${t.headText}</span>\n      <div class="vjs-upnext-title"></div>\n    </div>\n    <div class="vjs-upnext-autoplay-icon">\n      <svg height="100%" version="1.1" viewbox="0 0 98 98" width="100%">\n        <circle class="vjs-upnext-svg-autoplay-circle" cx="49" cy="49" fill="#000" fill-opacity="0.8" r="48"></circle>\n        <circle class="vjs-upnext-svg-autoplay-ring" cx="-49" cy="49" fill-opacity="0" r="46.5" stroke="#FFFFFF" stroke-width="4" transform="rotate(-90)"></circle>\n        <polygon class="vjs-upnext-svg-autoplay-triangle" fill="#fff" points="32,27 72,49 32,71"></polygon></svg>\n    </div>\n    <span class="vjs-upnext-bottom">\n      <span class="vjs-upnext-cancel">\n        <button class="vjs-upnext-cancel-button" tabindex="0" aria-label="Cancel autoplay">${t.cancelText}</button>\n      </span>\n      <span class="vjs-upnext-suspended">${t.suspendedText}</span>\n    </span>\n  `)});var t;return this.container=e,e.style.display="none",this.autoplayRing=e.getElementsByClassName("vjs-upnext-svg-autoplay-ring")[0],this.title=e.getElementsByClassName("vjs-upnext-title")[0],this.cancelButton=e.getElementsByClassName("vjs-upnext-cancel-button")[0],this.suspendedMessage=e.getElementsByClassName("vjs-upnext-suspended")[0],this.nextButton=e.getElementsByClassName("vjs-upnext-autoplay-icon")[0],this.cancelButton.onclick=()=>{this.upNextEvents.trigger("cancel")},this.nextButton.onclick=()=>{this.upNextEvents.trigger("next")},e}showCard(e){let t;this.autoplayRing.setAttribute("stroke-dasharray",""+this.dashOffsetStart),this.autoplayRing.setAttribute("stroke-dashoffset",""+-this.dashOffsetStart),this.title.innerHTML=this.options_.getTitle(),this.upNextEvents.one("cancel",(()=>{clearTimeout(t),e(!0)})),this.upNextEvents.one("playing",(()=>{clearTimeout(t),e(!0)})),this.upNextEvents.one("next",(()=>{clearTimeout(t),e(!1)}));const s=e=>{const t=Math.max(-this.dashOffsetTotal,-this.dashOffsetStart-e*this.dashOffsetTotal/2/100);this.autoplayRing.setAttribute("stroke-dashoffset",""+t)},n=()=>{s(100*this.ticks++/this.totalTicks)},i=()=>{this.options_.suspended()?(this.suspendedMessage.innerText=this.options_.suspendedText,s(0),this.ticks=0,t=setTimeout(i.bind(this),300)):this.ticks>=this.totalTicks?(clearTimeout(t),e(!1)):(this.suspendedMessage.innerText="",n(),t=setTimeout(i.bind(this),this.interval))};this.container.style.display="block",t=setTimeout(i.bind(this),this.interval)}});const l=a.a.getPlugin("plugin");a.a.registerPlugin("upnext",class extends l{constructor(e,t={}){const s={next:t.next,getTitle:t.getTitle,timeout:t.timeout||5e3,cancelText:t.cancelText||"Cancel",headText:t.headText||"Up Next",suspendedText:t.suspendedText||"Autoplay is suspended",condition:t.condition,suspended:t.suspended};super(e),this.player.ready((()=>{e.addClass("vjs-upnext")})),e.addChild("EndCard",s)}});const r=a.a.getComponent("Component");a.a.registerComponent("PauseBezel",class extends r{constructor(e,t){super(e,t),e.on("pause",(t=>{e.seeking()||e.ended()||(this.container.innerHTML='\n  <div class="vjs-bezels-pause">\n    <div class="vjs-bezel" role="status" aria-label="Pause">\n      <div class="vjs-bezel-icon">\n        <svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%">\n          <use class="vjs-svg-shadow" xlink:href="#vjs-id-1"></use>\n          <path class="vjs-svg-fill" d="M 12,26 16,26 16,10 12,10 z M 21,26 25,26 25,10 21,10 z" id="vjs-id-1"></path>\n        </svg>\n      </div>\n    </div>\n  </div>\n  ',this.showBezel())})),e.on("play",(t=>{e.seeking()||(this.container.innerHTML='\n  <div class="vjs-bezels-play">\n    <div class="vjs-bezel" role="status" aria-label="Play">\n      <div class="vjs-bezel-icon">\n        <svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%">\n          <use class="vjs-svg-shadow" xlink:href="#vjs-id-2"></use>\n          <path class="vjs-svg-fill" d="M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z" id="ytp-id-2"></path>\n        </svg>\n      </div>\n    </div>\n  </div>\n  ',this.showBezel())}))}createEl(){return this.container=super.createEl("div",{className:"vjs-bezels-content"}),this.container.style.display="none",this.container}showBezel(){this.container.style.display="inherit",setTimeout((()=>{this.container.style.display="none"}),500)}});const d=a.a.getPlugin("plugin");a.a.registerPlugin("bezels",class extends d{constructor(e,t){super(e),this.player.ready((()=>{e.addClass("vjs-bezels")})),e.addChild("PauseBezel",t)}});var u=s(158);const c=a.a.getComponent("MenuItem"),h=a.a.getComponent("Component");class p extends c{constructor(e,t){super(e,t),this.settingsButton=t.menuButton,this.dialog=this.settingsButton.dialog,this.mainMenu=this.settingsButton.menu,this.panel=this.dialog.getChild("settingsPanel"),this.panelChild=this.panel.getChild("settingsPanelChild"),this.panelChildEl=this.panelChild.el(),this.size=null,this.menuToLoad="mainmenu";const s=Object(u.j)(t.entry),n=a.a.getComponent(s);if(!n)throw new Error(`Component ${s} does not exist`);const i=Object.assign({},t,{entry:t.menuButton,menuButton:this});this.subMenu=new n(this.player(),i);const o=this.subMenu.buildCSSClass().split(" ")[0];this.settingsSubMenuEl_.className+=" "+o,this.eventHandlers(),e.ready((()=>{setTimeout((()=>{this.player_&&(this.build(),e.on("ratechange",this.submenuClickHandler),"CaptionsButton"===s&&e.on("captionsChanged",(()=>{setTimeout((()=>{this.settingsSubMenuEl_.innerHTML="",this.settingsSubMenuEl_.appendChild(this.subMenu.menu.el()),this.update(),this.bindClickEvents()}),0)})),this.reset())}),0)}))}eventHandlers(){this.submenuClickHandler=this.onSubmenuClick.bind(this),this.transitionEndHandler=this.onTransitionEnd.bind(this)}onSubmenuClick(e){let t=null;t="tap"===e.type?e.target:e.currentTarget,t&&t.classList.contains("vjs-back-button")?this.loadMainMenu():(setTimeout((()=>this.update(e)),0),this.subMenu.menu.removeClass("vjs-hidden"))}createEl(){const e=a.a.dom.createEl("li",{className:"vjs-menu-item"});return this.settingsSubMenuTitleEl_=a.a.dom.createEl("div",{className:"vjs-settings-sub-menu-title"}),e.appendChild(this.settingsSubMenuTitleEl_),this.settingsSubMenuValueEl_=a.a.dom.createEl("div",{className:"vjs-settings-sub-menu-value"}),e.appendChild(this.settingsSubMenuValueEl_),this.settingsSubMenuEl_=a.a.dom.createEl("div",{className:"vjs-settings-sub-menu"}),e}handleClick(e){this.menuToLoad="submenu",a.a.dom.removeClass(this.el(),"open"),super.handleClick(e),this.mainMenu.el().style.opacity="0",a.a.dom.hasClass(this.settingsSubMenuEl_,"vjs-hidden")?(a.a.dom.removeClass(this.settingsSubMenuEl_,"vjs-hidden"),setTimeout((()=>{this.settingsSubMenuEl_.style.opacity="1",this.settingsSubMenuEl_.style.marginRight="0px"}),0),this.settingsButton.setDialogSize(this.size)):a.a.dom.addClass(this.settingsSubMenuEl_,"vjs-hidden")}createBackButton(){const e=this.subMenu.menu.addChild("MenuItem",{},0);e.addClass("vjs-back-button"),e.el().innerHTML=this.player().localize(this.subMenu.controlText())}PrefixedEvent(e,t,s,n="addEvent"){const i=["webkit","moz","MS","o",""];for(let a=0;a<i.length;a++)i[a]||(t=t.toLowerCase()),"addEvent"===n?e.addEventListener(i[a]+t,s,!1):"removeEvent"===n&&e.removeEventListener(i[a]+t,s,!1)}onTransitionEnd(e){"margin-right"===e.propertyName&&"mainmenu"===this.menuToLoad&&(a.a.dom.addClass(this.settingsSubMenuEl_,"vjs-hidden"),this.settingsSubMenuEl_.style.opacity="0")}reset(){a.a.dom.addClass(this.settingsSubMenuEl_,"vjs-hidden"),this.settingsSubMenuEl_.style.opacity="0",this.setMargin()}loadMainMenu(){const e=this.mainMenu.el();this.menuToLoad="mainmenu",this.mainMenu.show(),e.style.opacity="0";const t=this.mainMenu;this.settingsButton.setDialogSize([t.width,t.height]),setTimeout((()=>{this.setMargin(),e.style.opacity="1"}),0)}build(){this.subMenu.on("updateLabel",(()=>{this.update()})),this.subMenu.on("menuChanged",(()=>{this.bindClickEvents(),this.setSize(),this.update()})),this.settingsSubMenuTitleEl_.innerHTML=this.player().localize(this.subMenu.controlText()),this.settingsSubMenuEl_.appendChild(this.subMenu.menu.el()),this.panelChildEl.appendChild(this.settingsSubMenuEl_),this.update(),this.createBackButton(),this.setSize(),this.bindClickEvents(),this.PrefixedEvent(this.settingsSubMenuEl_,"TransitionEnd",this.transitionEndHandler,"addEvent")}update(e){let t=null;const s=this.subMenu.name();if(e&&"tap"===e.type?t=e.target:e&&(t=e.currentTarget),"PlaybackRateMenuButton"===s){const e=this.subMenu.labelEl_.innerHTML;setTimeout((()=>this.settingsSubMenuValueEl_.innerHTML=e),250)}else for(const e of this.subMenu.menu.children_)if(e instanceof h&&e.hasClass("vjs-selected")){const t=e;if("function"==typeof t.getLabel){this.settingsSubMenuValueEl_.innerHTML=t.getLabel();break}this.settingsSubMenuValueEl_.innerHTML=t.options_.label}t&&!t.classList.contains("vjs-back-button")&&this.settingsButton.hideDialog()}bindClickEvents(){for(const e of this.subMenu.menu.children())e instanceof h&&e.on(["tap","click"],this.submenuClickHandler)}setSize(){this.dialog.removeClass("vjs-hidden"),a.a.dom.removeClass(this.settingsSubMenuEl_,"vjs-hidden"),this.size=this.settingsButton.getComponentSize(this.settingsSubMenuEl_),this.setMargin(),this.dialog.addClass("vjs-hidden"),a.a.dom.addClass(this.settingsSubMenuEl_,"vjs-hidden")}setMargin(){if(!this.size)return;const[e]=this.size;this.settingsSubMenuEl_.style.marginRight=`-${e}px`}hideSubMenu(){this.el()&&a.a.dom.hasClass(this.el(),"open")&&(a.a.dom.addClass(this.settingsSubMenuEl_,"vjs-hidden"),a.a.dom.removeClass(this.el(),"open"))}}p.prototype.contentElType="button",a.a.registerComponent("SettingsMenuItem",p);const m=a.a.getComponent("Button"),g=a.a.getComponent("Menu"),v=a.a.getComponent("Component");v.registerComponent("SettingsButton",class extends m{constructor(e,t){super(e,t),this.settingsButtonOptions=t,this.controlText("Settings"),this.dialog=this.player().addChild("settingsDialog"),this.dialogEl=this.dialog.el(),this.menu=null,this.panel=this.dialog.addChild("settingsPanel"),this.panelChild=this.panel.addChild("settingsPanelChild"),this.addClass("vjs-settings"),this.el().setAttribute("aria-label","Settings Button"),this.addSettingsItemHandler=this.onAddSettingsItem.bind(this),this.disposeSettingsItemHandler=this.onDisposeSettingsItem.bind(this),this.playerClickHandler=this.onPlayerClick.bind(this),this.userInactiveHandler=this.onUserInactive.bind(this),this.buildMenu(),this.bindEvents(),this.player().one("play",(()=>this.hideDialog()))}onPlayerClick(e){const t=e.target;t.classList.contains("vjs-settings")||t.parentElement.classList.contains("vjs-settings")||this.dialog.hasClass("vjs-hidden")||this.hideDialog()}onDisposeSettingsItem(e,t){if(void 0===t){const e=this.menu.children();for(;e.length>0;)e[0].dispose(),this.menu.removeChild(e[0]);this.addClass("vjs-hidden")}else{const e=this.menu.getChild(t);e&&(e.dispose(),this.menu.removeChild(e))}this.hideDialog(),0===this.settingsButtonOptions.entries.length&&this.addClass("vjs-hidden")}onAddSettingsItem(e,t){const[s,n]=t;this.addMenuItem(s,n),this.removeClass("vjs-hidden")}onUserInactive(){this.dialog.hasClass("vjs-hidden")||this.hideDialog()}bindEvents(){this.player().on("click",this.playerClickHandler),this.player().on("addsettingsitem",this.addSettingsItemHandler),this.player().on("disposesettingsitem",this.disposeSettingsItemHandler),this.player().on("userinactive",this.userInactiveHandler)}buildCSSClass(){return`vjs-icon-settings ${super.buildCSSClass()}`}handleClick(){this.dialog.hasClass("vjs-hidden")?this.showDialog():this.hideDialog()}showDialog(){this.player().peertube().onMenuOpen(),this.menu.el().style.opacity="1",this.dialog.show(),this.setDialogSize(this.getComponentSize(this.menu))}hideDialog(){this.player_.peertube().onMenuClosed(),this.dialog.hide(),this.setDialogSize(this.getComponentSize(this.menu)),this.menu.el().style.opacity="1",this.resetChildren()}getComponentSize(e){let t=null,s=null;if(e instanceof v){const n=e.el();t=n.offsetWidth,s=n.offsetHeight,e.width=t,e.height=s}else t=e.offsetWidth,s=e.offsetHeight;return[t,s]}setDialogSize([e,t]){if("number"!=typeof t)return;const s=this.settingsButtonOptions.setup.maxHeightOffset,n=this.player().el().offsetHeight-s,i=this.panel.el();t>n?(e+=17,i.style.maxHeight=`${t=n}px`):""!==i.style.maxHeight&&(i.style.maxHeight=""),this.dialogEl.style.width=`${e}px`,this.dialogEl.style.height=`${t}px`}buildMenu(){this.menu=new g(this.player()),this.menu.addClass("vjs-main-menu");const e=this.settingsButtonOptions.entries;if(0===e.length)return this.addClass("vjs-hidden"),void this.panelChild.addChild(this.menu);for(const t of e)this.addMenuItem(t,this.settingsButtonOptions);this.panelChild.addChild(this.menu)}addMenuItem(e,t){t.name=Object(u.j)(e);const s=Object.assign({},t,{entry:e,menuButton:this}),n=new p(this.player(),s);this.menu.addChild(n),n.on("click",a.a.bind(this,this.hideChildren)),n.on("click",(function(){a.a.dom.hasClass(this.el_,"open")?a.a.dom.removeClass(this.el_,"open"):a.a.dom.addClass(this.el_,"open")}))}resetChildren(){for(const e of this.menu.children())e.reset()}hideChildren(){for(const e of this.menu.children())e.hideSubMenu()}});var b=s(168);const y=a.a.getPlugin("plugin");a.a.registerPlugin("peertube",class extends y{constructor(e,t){super(e),this.CONSTANTS={USER_WATCHING_VIDEO_INTERVAL:5e3},this.menuOpened=!1,this.mouseInControlBar=!1,this.videoViewUrl=t.videoViewUrl,this.videoDuration=t.videoDuration,this.videoCaptions=t.videoCaptions,this.isLive=t.isLive,this.savedInactivityTimeout=e.options_.inactivityTimeout,t.autoplay&&this.player.addClass("vjs-has-autoplay"),this.player.on("autoplay-failure",(()=>{this.player.removeClass("vjs-has-autoplay")})),this.player.ready((()=>{const e=this.player.options_;"webtorrent"===t.mode&&(this.player.webtorrent().on("resolutionChange",((e,t)=>this.handleResolutionChange(t))),this.player.webtorrent().on("autoResolutionChange",((e,t)=>this.trigger("autoResolutionChange",t)))),"p2p-media-loader"===t.mode&&this.player.p2pMediaLoader().on("resolutionChange",((e,t)=>this.handleResolutionChange(t))),this.player.tech(!0).on("loadedqualitydata",(()=>{setTimeout((()=>{this.lastResolutionChange&&this.handleResolutionChange(this.lastResolutionChange)}),0)}));const s=Object(b.f)();void 0!==s&&this.player.volume(s);const n=void 0!==e.muted?e.muted:Object(b.c)();if(void 0!==n&&this.player.muted(n),this.defaultSubtitle=t.subtitle||Object(b.b)(),this.player.on("volumechange",(()=>{Object(b.l)(this.player.volume()),Object(b.i)(this.player.muted())})),t.stopTime){const e=Object(u.i)(t.stopTime),s=this;this.player.on("timeupdate",(function t(){s.player.currentTime()>e&&(s.player.pause(),s.player.trigger("stopped"),s.player.off("timeupdate",t))}))}this.player.textTracks().on("change",(()=>{const e=this.player.textTracks().tracks_.find((e=>"captions"===e.kind&&"showing"===e.mode));e?Object(b.h)(e.language):Object(b.h)("off")})),this.player.on("sourcechange",(()=>this.initCaptions())),this.player.duration(t.videoDuration),this.initializePlayer(),this.runViewAdd(),this.runUserWatchVideo(t.userWatching,t.videoUUID)}))}dispose(){this.videoViewInterval&&clearInterval(this.videoViewInterval),this.userWatchingVideoInterval&&clearInterval(this.userWatchingVideoInterval)}onMenuOpen(){this.menuOpened=!1,this.alterInactivity()}onMenuClosed(){this.menuOpened=!0,this.alterInactivity()}initializePlayer(){Object(u.f)()&&this.player.addClass("vjs-is-mobile"),this.initSmoothProgressBar(),this.initCaptions(),this.listenControlBarMouse()}runViewAdd(){this.clearVideoViewInterval();let e=30;!this.isLive&&this.videoDuration<e&&(e=3*this.videoDuration/4);let t=0;this.videoViewInterval=setInterval((()=>{this.player&&!this.player.paused()&&(t+=1,t>e&&(this.isLive?t=0:this.clearVideoViewInterval(),this.addViewToVideo().catch((e=>console.error(e)))))}),1e3)}runUserWatchVideo(e,t){let s=0;this.userWatchingVideoInterval=setInterval((()=>{const n=Math.floor(this.player.currentTime());n-s>=1&&(s=n,e?this.notifyUserIsWatching(n,e.url,e.authorizationHeader).catch((e=>console.error("Cannot notify user is watching.",e))):Object(b.k)(t,n))}),this.CONSTANTS.USER_WATCHING_VIDEO_INTERVAL)}clearVideoViewInterval(){void 0!==this.videoViewInterval&&(clearInterval(this.videoViewInterval),this.videoViewInterval=void 0)}addViewToVideo(){return this.videoViewUrl?fetch(this.videoViewUrl,{method:"POST"}):Promise.resolve(void 0)}notifyUserIsWatching(e,t,s){const n=new URLSearchParams;n.append("currentTime",e.toString());const i=new Headers({Authorization:s});return fetch(t,{method:"PUT",body:n,headers:i})}handleResolutionChange(e){this.lastResolutionChange=e;const t=this.player.qualityLevels();for(let s=0;s<t.length;s++)if(t[s].height===e.resolutionId){e.id=t[s].id;break}this.trigger("resolutionChange",e)}listenControlBarMouse(){this.player.controlBar.on("mouseenter",(()=>{this.mouseInControlBar=!0,this.alterInactivity()})),this.player.controlBar.on("mouseleave",(()=>{this.mouseInControlBar=!1,this.alterInactivity()}))}alterInactivity(){this.menuOpened?this.player.options_.inactivityTimeout=this.savedInactivityTimeout:this.mouseInControlBar||this.isTouchEnabled()||(this.player.options_.inactivityTimeout=1)}isTouchEnabled(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}initCaptions(){for(const e of this.videoCaptions)this.player.addRemoteTextTrack({kind:"captions",label:e.label,language:e.language,id:e.language,src:e.src,default:this.defaultSubtitle===e.language},!1);this.player.trigger("captionsChanged")}initSmoothProgressBar(){const e=a.a.getComponent("SeekBar");e.prototype.getPercent=function(){const e=this.player_.currentTime()/this.player_.duration();return e>=1?1:e},e.prototype.handleMouseMove=function(e){let t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.player_.currentTime(t),this.update()}}});const C=a.a.getComponent("Button");class f extends C{constructor(e,t){super(e,t),this.nextPreviousVideoButtonOptions=t,this.update()}createEl(){const e=this.options_.type,t=a.a.dom.createEl("button",{className:"vjs-"+e+"-video"}),s=a.a.dom.createEl("span",{className:"icon icon-"+e});return t.appendChild(s),t.title=this.player_.localize("next"===e?"Next video":"Previous video"),t}handleClick(){this.nextPreviousVideoButtonOptions.handler()}update(){this.nextPreviousVideoButtonOptions.isDisabled()?this.addClass("vjs-disabled"):this.removeClass("vjs-disabled")}}a.a.registerComponent("NextVideoButton",f),a.a.registerComponent("PreviousVideoButton",f);const T=a.a.getComponent("Button");a.a.registerComponent("P2PInfoButton",class extends T{createEl(){const e=a.a.dom.createEl("div",{className:"vjs-peertube"}),t=a.a.dom.createEl("div",{className:"vjs-peertube-hidden"});e.appendChild(t);const s=a.a.dom.createEl("span",{className:"icon icon-download"});t.appendChild(s);const n=a.a.dom.createEl("span",{className:"download-speed-text"}),i=a.a.dom.createEl("span",{className:"download-speed-number"}),o=a.a.dom.createEl("span");n.appendChild(i),n.appendChild(o),t.appendChild(n);const l=a.a.dom.createEl("span",{className:"icon icon-upload"});t.appendChild(l);const r=a.a.dom.createEl("span",{className:"upload-speed-text"}),d=a.a.dom.createEl("span",{className:"upload-speed-number"}),c=a.a.dom.createEl("span");r.appendChild(d),r.appendChild(c),t.appendChild(r);const h=a.a.dom.createEl("span",{className:"peers-text"}),p=a.a.dom.createEl("span",{className:"peers-number"});t.appendChild(p),t.appendChild(h);const m=a.a.dom.createEl("div",{className:"vjs-peertube-hidden"}),g=a.a.dom.createEl("span",{className:"http-fallback",textContent:"HTTP"});return m.appendChild(g),e.appendChild(m),this.player_.on("p2pInfo",((e,s)=>{if(!s)return m.className="vjs-peertube-displayed",void(t.className="vjs-peertube-hidden");const n=s.p2p,a=s.http,l=Object(u.c)(n.downloadSpeed+a.downloadSpeed),r=Object(u.c)(n.uploadSpeed+a.uploadSpeed),g=Object(u.c)(n.downloaded+a.downloaded),v=Object(u.c)(n.uploaded+a.uploaded),b=n.numPeers;if(t.title=this.player().localize("Total downloaded: ")+g.join(" ")+"\n","p2p-media-loader"===s.source){const e=Object(u.c)(a.downloaded).join(" "),s=Object(u.c)(n.downloaded).join(" ");t.title+=" * "+this.player().localize("From servers: ")+e+"\n * "+this.player().localize("From peers: ")+s+"\n"}t.title+=this.player().localize("Total uploaded: ")+v.join(" "),i.textContent=l[0],o.textContent=" "+l[1],d.textContent=r[0],c.textContent=" "+r[1],p.textContent=b.toString(),h.textContent=" "+(b>1?this.player().localize("peers"):this.player_.localize("peer")),m.className="vjs-peertube-hidden",t.className="vjs-peertube-displayed"})),e}});const E=a.a.getComponent("Button");a.a.registerComponent("PeerTubeLinkButton",class extends E{constructor(e,t){super(e,t)}createEl(){return this.buildElement()}updateHref(){this.el().setAttribute("href",Object(u.a)({startTime:this.player().currentTime()}))}handleClick(){this.player().pause()}buildElement(){const e=a.a.dom.createEl("a",{href:Object(u.a)(),innerHTML:"PeerTube",title:this.player().localize("Video page (new window)"),className:"vjs-peertube-link",target:"_blank"});return e.addEventListener("mouseenter",(()=>this.updateHref())),e}});const j=a.a.getComponent("Component");j.registerComponent("PeerTubeLoadProgressBar",class extends j{constructor(e,t){super(e,t),this.on(e,"progress",this.update)}createEl(){return super.createEl("div",{className:"vjs-load-progress",innerHTML:`<span class="vjs-control-text"><span>${this.localize("Loaded")}</span>: 0%</span>`})}dispose(){super.dispose()}update(){const e=this.player().webtorrent().getTorrent();e&&(this.el().style.width=100*e.progress+"%")}});const M=a.a.getComponent("MenuItem");class x extends M{constructor(e,t){t.selectable=!0,super(e,t),this.autoResolutionPossible=!0,this.currentResolutionLabel="",this.resolutionId=t.id,this.label=t.label,this.labels=t.labels,this.callback=t.callback,e.peertube().on("resolutionChange",((e,t)=>this.updateSelection(t))),-1===this.resolutionId&&e.peertube().on("autoResolutionChange",((e,t)=>this.updateAutoResolution(t)))}handleClick(e){!1===this.autoResolutionPossible&&-1===this.resolutionId||(super.handleClick(e),this.callback(this.resolutionId,"video"))}updateSelection(e){-1===this.resolutionId&&(this.currentResolutionLabel=this.labels[e.id]),this.selected(!0!==e.auto?this.resolutionId===e.id:-1===this.resolutionId)}updateAutoResolution(e){!1===e.possible?this.addClass("disabled"):this.removeClass("disabled"),this.autoResolutionPossible=e.possible}getLabel(){return-1===this.resolutionId?this.label+" <small>"+this.currentResolutionLabel+"</small>":this.label}}a.a.registerComponent("ResolutionMenuItem",x);const w=a.a.getComponent("Menu"),S=a.a.getComponent("MenuButton");a.a.registerComponent("ResolutionMenuButton",class extends S{constructor(e,t){super(e,t),this.controlText("Quality"),e.tech(!0).on("loadedqualitydata",((e,t)=>this.buildQualities(t))),e.peertube().on("resolutionChange",(()=>setTimeout((()=>this.trigger("updateLabel")),0)))}createEl(){const e=super.createEl();return this.labelEl_=a.a.dom.createEl("div",{className:"vjs-resolution-value"}),e.appendChild(this.labelEl_),e}updateARIAAttributes(){this.el().setAttribute("aria-label","Quality")}createMenu(){return new w(this.player_)}buildCSSClass(){return super.buildCSSClass()+" vjs-resolution-button"}buildWrapperCSSClass(){return"vjs-resolution-control "+super.buildWrapperCSSClass()}addClickListener(e){e.on("click",(()=>{const t=this.menu.children();for(const s of t)e!==s&&s.selected(!1)}))}buildQualities(e){const t={};e.qualityData.video.sort(((e,t)=>e.id>t.id?-1:e.id===t.id?0:1));for(const s of e.qualityData.video){if(-1===s.id)continue;const n="0p"===s.label?this.player().localize("Audio-only"):s.label;this.menu.addChild(new x(this.player_,{id:s.id,label:n,selected:s.selected,callback:e.qualitySwitchCallback})),t[s.id]=s.label}this.menu.addChild(new x(this.player_,{id:-1,label:this.player_.localize("Auto"),labels:t,callback:e.qualitySwitchCallback,selected:!0}));for(const e of this.menu.children())this.addClickListener(e);this.trigger("menuChanged")}});const k=a.a.getComponent("Component");k.registerComponent("SettingsDialog",class extends k{constructor(e){super(e),this.hide()}createEl(){const e=this.id();return super.createEl("div",{className:"vjs-settings-dialog vjs-modal-overlay",innerHTML:"",tabIndex:-1},{role:"dialog","aria-labelledby":"TTsettingsDialogLabel-"+e,"aria-describedby":"TTsettingsDialogDescription-"+e})}});const P=a.a.getComponent("Component");P.registerComponent("SettingsPanel",class extends P{constructor(e,t){super(e,t)}createEl(){return super.createEl("div",{className:"vjs-settings-panel",innerHTML:"",tabIndex:-1})}});const I=a.a.getComponent("Component");I.registerComponent("SettingsPanelChild",class extends I{constructor(e,t){super(e,t)}createEl(){return super.createEl("div",{className:"vjs-settings-panel-child",innerHTML:"",tabIndex:-1})}});const O=a.a.getComponent("Button");class B extends O{constructor(e,t){super(e,t);const s=Object(b.e)();!0===s&&(this.player().addClass(B.THEATER_MODE_CLASS),this.handleTheaterChange()),this.controlText("Theater mode"),this.player().theaterEnabled=s}buildCSSClass(){return`vjs-theater-control ${super.buildCSSClass()}`}handleTheaterChange(){const e=this.isTheaterEnabled();this.controlText(e?"Normal mode":"Theater mode"),Object(b.j)(e),this.player_.trigger("theaterChange",e)}handleClick(){this.player_.toggleClass(B.THEATER_MODE_CLASS),this.handleTheaterChange()}isTheaterEnabled(){return this.player_.hasClass(B.THEATER_MODE_CLASS)}}B.THEATER_MODE_CLASS="vjs-theater-enabled",a.a.registerComponent("TheaterButton",B);const L=a.a.getComponent("ClickableComponent");class N extends L{constructor(e,t){super(e,t)}createEl(){this.wrapper=super.createEl("div",{className:"vjs-playlist-button",innerHTML:"",tabIndex:-1});const e=super.createEl("div",{className:"vjs-playlist-icon",innerHTML:"",tabIndex:-1});return this.playlistInfoElement=super.createEl("div",{className:"vjs-playlist-info",innerHTML:"",tabIndex:-1}),this.wrapper.appendChild(e),this.wrapper.appendChild(this.playlistInfoElement),this.update(),this.wrapper}update(){const e=this.options_;this.playlistInfoElement.innerHTML=e.getCurrentPosition()+"/"+e.playlist.videosLength,this.wrapper.title=this.player().localize("Playlist: {1}",[e.playlist.displayName])}handleClick(){this.getPlaylistMenu().open()}getPlaylistMenu(){return this.options_.playlistMenu}}a.a.registerComponent("PlaylistButton",N);const _=a.a.getComponent("Component");class V extends _{constructor(e,t){super(e,t),this.emitTapEvents(),this.element=t.element,this.on(["click","tap"],(()=>this.switchPlaylistItem())),this.on("keydown",(e=>this.handleKeyDown(e)))}createEl(){const e=this.options_,t=super.createEl("li",{className:"vjs-playlist-menu-item",innerHTML:""});e.element.video||t.classList.add("vjs-disabled");const s=super.createEl("div",{className:"item-position-block"}),n=super.createEl("div",{className:"item-position",innerHTML:e.element.position});return s.appendChild(n),t.appendChild(s),e.element.video?this.buildAvailableVideo(t,s,e):this.buildUnavailableVideo(t),t}setSelected(e){e?this.addClass("vjs-selected"):this.removeClass("vjs-selected")}getElement(){return this.element}buildAvailableVideo(e,t,s){const n=s.element,i=super.createEl("div",{className:"item-player"});t.appendChild(i);const a=super.createEl("img",{src:window.location.origin+n.video.thumbnailPath}),o=super.createEl("div",{className:"info-block"}),l=super.createEl("div",{innerHTML:n.video.name,className:"title"}),r=super.createEl("div",{innerHTML:n.video.channel.displayName,className:"channel"});if(o.appendChild(l),o.appendChild(r),n.startTimestamp||n.stopTimestamp){let e="";n.startTimestamp&&(e+=Object(u.h)(n.startTimestamp)),n.stopTimestamp&&(e+=" - "+Object(u.h)(n.stopTimestamp));const t=super.createEl("div",{innerHTML:e,className:"timestamps"});o.append(t)}e.append(a),e.append(o)}buildUnavailableVideo(e){const t=super.createEl("div",{className:"item-unavailable",innerHTML:this.player().localize("Unavailable video")});e.appendChild(t)}handleKeyDown(e){"Space"!==e.code&&"Enter"!==e.code||this.switchPlaylistItem()}switchPlaylistItem(){this.options_.onClicked()}}_.registerComponent("PlaylistMenuItem",V);const H=a.a.getComponent("Component");class z extends H{constructor(e,t){super(e,t);const s=this;function n(){s.close()}this.el().addEventListener("mouseenter",(()=>{this.player().off("userinactive",n)})),this.el().addEventListener("mouseleave",(()=>{this.player().one("userinactive",n)})),this.player().on("click",(e=>{let t=e.target;do{if(t.classList.contains("vjs-playlist-menu")||t.classList.contains("vjs-playlist-button"))return;t=t.parentElement}while(t);this.close()}))}createEl(){this.menuItems=[];const e=this.getOptions(),t=super.createEl("div",{className:"vjs-playlist-menu",innerHTML:"",tabIndex:-1}),s=super.createEl("div",{className:"header"}),n=super.createEl("div"),i=super.createEl("div",{innerHTML:e.playlist.displayName,className:"title"}),a=e.playlist.videoChannel,o=super.createEl("div",{innerHTML:a?this.player().localize("By {1}",[a.displayName]):"",className:"channel"});n.appendChild(i),n.appendChild(o);const l=super.createEl("div",{className:"cross"});l.addEventListener("click",(()=>this.close())),s.appendChild(n),s.appendChild(l);const r=super.createEl("ol");for(const t of e.elements){const e=new V(this.player(),{element:t,onClicked:()=>this.onItemClicked(t)});r.appendChild(e.el()),this.menuItems.push(e)}return t.appendChild(s),t.appendChild(r),t}update(){const e=this.getOptions();this.updateSelected(e.getCurrentPosition())}open(){this.player().addClass("playlist-menu-displayed")}close(){this.player().removeClass("playlist-menu-displayed")}updateSelected(e){for(const t of this.menuItems)t.setSelected(t.getElement().position===e)}getOptions(){return this.options_}onItemClicked(e){this.getOptions().onItemClicked(e)}}H.registerComponent("PlaylistMenu",z);const D=a.a.getPlugin("plugin");a.a.registerPlugin("playlist",class extends D{constructor(e,t){super(e,t),this.options=t,this.player.ready((()=>{e.addClass("vjs-playlist")})),this.playlistMenu=new z(e,t),this.playlistButton=new N(e,Object.assign({},t,{playlistMenu:this.playlistMenu})),e.addChild(this.playlistMenu,t),e.addChild(this.playlistButton,t)}updateSelected(){this.playlistMenu.updateSelected(this.options.getCurrentPosition())}});var R=s(3),U=s(157);class A{constructor(e=[]){this.baseUrls=e}removeBySegmentUrl(e){console.log("Removing redundancy of segment URL %s.",e);const t=Object(U.dirname)(e);this.baseUrls=this.baseUrls.filter((e=>e!==t&&e!==t+"/"))}buildUrl(e){const t=this.baseUrls.length+1,s=this.getRandomInt(t);if(s===t-1)return e;const n=this.baseUrls[s],i=n.endsWith("/")?"":"/";return n+i+Object(U.basename)(e)}countBaseUrls(){return this.baseUrls.length}getRandomInt(e){return Math.floor(Math.random()*Math.floor(e))}}function F(e){return function(t){return e.buildUrl(t.url)}}var W=s(235),$=s(51);s(30),a.a.getComponent("PlaybackRateMenuButton").prototype.controlText_="Speed";const K=a.a.getComponent("CaptionsButton");K.prototype.controlText_="Subtitles/CC",K.prototype.label_=" ";class q{static initState(){q.alreadyPlayed=!1}static initialize(e,t,i){return Object(n.a)(this,void 0,void 0,(function*(){let n;this.onPlayerChange=i,this.playerElementClassName=t.common.playerElement.className,"webtorrent"===e&&(yield Promise.all([s.e(0),s.e(1),s.e(2)]).then(s.bind(null,347))),"p2p-media-loader"===e&&([n]=yield Promise.all([Promise.all([s.e(0),s.e(3),s.e(10)]).then(s.t.bind(null,331,7)),Promise.all([s.e(0),s.e(3),s.e(12),s.e(9)]).then(s.bind(null,348))]));const o=this.getVideojsOptions(e,t,n);yield $.a.loadLocaleInVideoJS(t.common.serverUrl,t.common.language,a.a);const l=this;return new Promise((s=>{a()(t.common.playerElement,o,(function(){const n=this;let i=!1;return n.tech(!0).one("error",(()=>{i||l.maybeFallbackToWebTorrent(e,n,t),i=!0})),n.one("error",(()=>{i||l.maybeFallbackToWebTorrent(e,n,t),i=!0})),n.one("play",(()=>{q.alreadyPlayed=!0})),l.addContextMenu(e,n,t.common.embedUrl,t.common.embedTitle),n.bezels(),s(n)}))}))}))}static maybeFallbackToWebTorrent(e,t,i){return Object(n.a)(this,void 0,void 0,(function*(){if("webtorrent"===e)return;console.log("Fallback to webtorrent.");const n=document.createElement("video");n.className=this.playerElementClassName;let o=i.common.playerElement.parentNode;o||(o=document.getElementById(i.common.playerElement.id).parentNode),o.parentNode.insertBefore(n,o),i.common.playerElement=n,i.common.onPlayerElementChange(n),t.dispose(),yield Promise.all([s.e(0),s.e(1),s.e(2)]).then(s.bind(null,347));const l="webtorrent",r=this.getVideojsOptions(l,i),d=this;a()(n,r,(function(){d.addContextMenu(l,this,i.common.embedUrl,i.common.embedTitle),q.onPlayerChange(this)}))}))}static getVideojsOptions(e,t,s){const n=t.common,i="p2p-media-loader"===e;let a=this.getAutoPlayValue(n.autoplay),o={preloadTextTracks:!1};const l={peertube:{mode:e,autoplay:a,videoViewUrl:n.videoViewUrl,videoDuration:n.videoDuration,userWatching:n.userWatching,subtitle:n.subtitle,videoCaptions:n.videoCaptions,stopTime:n.stopTime,isLive:n.isLive,videoUUID:n.videoUUID}};if(n.playlist&&(l.playlist=n.playlist),!0===n.enableHotkeys&&q.addHotkeysOptions(l),i){const{hlsjs:e}=q.addP2PMediaLoaderOptions(l,t,s);Object.assign(o,e.html5)}"webtorrent"===e&&(q.addWebTorrentOptions(l,t),a=!1);const r={html5:o,textTrackSettings:!1,controls:void 0===n.controls||n.controls,loop:void 0!==n.loop&&n.loop,muted:void 0!==n.muted?n.muted:void 0,autoplay:this.getAutoPlayValue(a),poster:n.poster,inactivityTimeout:n.inactivityTimeout,playbackRates:[.5,.75,1,1.25,1.5,1.75,2],plugins:l,controlBar:{children:this.getControlBarChildren(e,{captions:n.captions,peertubeLink:n.peertubeLink,theaterButton:n.theaterButton,nextVideo:n.nextVideo,hasNextVideo:n.hasNextVideo,previousVideo:n.previousVideo,hasPreviousVideo:n.hasPreviousVideo})}};return n.language&&!Object(R.d)(n.language)&&Object.assign(r,{language:n.language}),r}static addP2PMediaLoaderOptions(e,t,s){const n=t.p2pMediaLoader,i=t.common,a=n.trackerAnnounce.filter((e=>e.startsWith("ws"))),o=new A(t.p2pMediaLoader.redundancyBaseUrls),l={redundancyUrlManager:o,type:"application/x-mpegURL",startTime:i.startTime,src:n.playlistUrl};let r=!1;navigator&&navigator.connection&&"cellular"===navigator.connection.type&&(console.log("We are on a cellular connection: disabling seeding."),r=!0);const d={loader:{trackerAnnounce:a,segmentValidator:Object(W.a)(t.p2pMediaLoader.segmentsSha256Url,t.common.isLive),rtcConfig:Object(u.d)(),requiredSegmentsPriority:1,segmentUrlBuilder:F(o),useP2P:Object(b.d)(),consumeOnly:r},segments:{swarmId:n.playlistUrl}},c={p2pMediaLoader:l,hlsjs:{levelLabelHandler:e=>{const t=Math.min(e.height||0,e.width||0),s=n.videoFiles.find((e=>e.resolution.id===t));if(!s)return e.height;let i=s.resolution.label;return s.fps>=50&&(i+=s.fps),i},html5:{hlsjsConfig:{capLevelToPlayerSize:!0,autoStartLoad:!1,liveSyncDurationCount:5,loader:new s.Engine(d).createLoaderClass()}}}};return Object.assign(e,c),c}static addWebTorrentOptions(e,t){const s=t.common,n=t.webtorrent,i="play"===this.getAutoPlayValue(s.autoplay);Object.assign(e,{webtorrent:{autoplay:i,videoDuration:s.videoDuration,playerElement:s.playerElement,videoFiles:n.videoFiles,startTime:s.startTime}})}static getControlBarChildren(e,t){const s=[],n="webtorrent"===e?"peerTubeLoadProgressBar":"loadProgressBar";s.push("playbackRateMenuButton"),!0===t.captions&&s.push("captionsButton"),s.push("resolutionMenuButton");const i={};return t.previousVideo&&Object.assign(i,{previousVideoButton:{type:"previous",handler:t.previousVideo,isDisabled:()=>!!t.hasPreviousVideo&&!t.hasPreviousVideo()}}),Object.assign(i,{playToggle:{}}),t.nextVideo&&Object.assign(i,{nextVideoButton:{type:"next",handler:t.nextVideo,isDisabled:()=>!!t.hasNextVideo&&!t.hasNextVideo()}}),Object.assign(i,{currentTimeDisplay:{},timeDivider:{},durationDisplay:{},liveDisplay:{},flexibleWidthSpacer:{},progressControl:{children:{seekBar:{children:{[n]:{},mouseTimeDisplay:{},playProgressBar:{}}}}},p2PInfoButton:{},muteToggle:{},volumeControl:{},settingsButton:{setup:{maxHeightOffset:40},entries:s}}),!0===t.peertubeLink&&Object.assign(i,{peerTubeLinkButton:{}}),!0===t.theaterButton&&Object.assign(i,{theaterButton:{}}),Object.assign(i,{fullscreenToggle:{}}),i}static addContextMenu(e,t,s,n){}static addHotkeysOptions(e){const t=(e,t)=>!(e.ctrlKey||e.altKey||e.metaKey||e.shiftKey||e.key!==t);Object.assign(e,{hotkeys:{skipInitialFocus:!0,enableInactiveFocus:!1,captureDocumentHotkeys:!0,documentHotkeysFocusElementFilter:e=>{const t=e.tagName.toLowerCase();return"content"===e.id||"body"===t||"video"===t},enableVolumeScroll:!1,enableModifiersForNumbers:!1,rewindKey:function(e){return t(e,"ArrowLeft")},forwardKey:function(e){return t(e,"ArrowRight")},fullscreenKey:function(e){return t(e,"f")||!e.altKey&&e.ctrlKey&&"Enter"===e.key},customKeys:{increasePlaybackRateKey:{key:function(e){return t(e,">")},handler:function(e){const t=Math.min(e.playbackRate()+.1,5);e.playbackRate(parseFloat(t.toFixed(2)))}},decreasePlaybackRateKey:{key:function(e){return t(e,"<")},handler:function(e){const t=Math.max(e.playbackRate()-.1,.1);e.playbackRate(parseFloat(t.toFixed(2)))}},frameByFrame:{key:function(e){return t(e,".")},handler:function(e){e.pause(),e.currentTime(e.currentTime()+1/30)}}}}})}static getAutoPlayValue(e){return!0!==e?e:Object(u.e)()||Object(u.g)()?!!q.alreadyPlayed&&"play":"play"}}q.alreadyPlayed=!1}}]);