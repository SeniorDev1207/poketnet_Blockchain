{"version":3,"sources":["webpack:///../shared/core-utils/renderer/html.ts","webpack:///../shared/core-utils/renderer/index.ts","webpack:///../shared/core-utils/renderer/markdown.ts","webpack:///./src/assets/player/bezels/bezels-plugin.ts","webpack:///./src/assets/player/bezels/pause-bezel.ts","webpack:///./src/assets/player/p2p-media-loader/redundancy-url-manager.ts","webpack:///./src/assets/player/p2p-media-loader/segment-url-builder.ts","webpack:///./src/assets/player/p2p-media-loader/segment-validator.ts","webpack:///./src/assets/player/peertube-player-local-storage.ts","webpack:///./src/assets/player/peertube-player-manager.ts","webpack:///./src/assets/player/peertube-plugin.ts","webpack:///./src/assets/player/playlist/playlist-button.ts","webpack:///./src/assets/player/playlist/playlist-menu-item.ts","webpack:///./src/assets/player/playlist/playlist-menu.ts","webpack:///./src/assets/player/playlist/playlist-plugin.ts","webpack:///./src/assets/player/upnext/end-card.ts","webpack:///./src/assets/player/upnext/upnext-plugin.ts","webpack:///./src/assets/player/utils.ts","webpack:///./src/assets/player/videojs-components/next-previous-video-button.ts","webpack:///./src/assets/player/videojs-components/p2p-info-button.ts","webpack:///./src/assets/player/videojs-components/peertube-link-button.ts","webpack:///./src/assets/player/videojs-components/peertube-load-progress-bar.ts","webpack:///./src/assets/player/videojs-components/resolution-menu-button.ts","webpack:///./src/assets/player/videojs-components/resolution-menu-item.ts","webpack:///./src/assets/player/videojs-components/settings-dialog.ts","webpack:///./src/assets/player/videojs-components/settings-menu-button.ts","webpack:///./src/assets/player/videojs-components/settings-menu-item.ts","webpack:///./src/assets/player/videojs-components/settings-panel-child.ts","webpack:///./src/assets/player/videojs-components/settings-panel.ts","webpack:///./src/assets/player/videojs-components/theater-button.ts"],"names":[],"mappings":"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","file":"4.chunk.js","sourcesContent":["export const SANITIZE_OPTIONS = {\n  allowedTags: [ 'a', 'p', 'span', 'br', 'strong', 'em', 'ul', 'ol', 'li' ],\n  allowedSchemes: [ 'http', 'https' ],\n  allowedAttributes: {\n    a: [ 'href', 'class', 'target', 'rel' ]\n  },\n  transformTags: {\n    a: (tagName: string, attribs: any) => {\n      let rel = 'noopener noreferrer'\n      if (attribs.rel === 'me') rel += ' me'\n\n      return {\n        tagName,\n        attribs: Object.assign(attribs, {\n          target: '_blank',\n          rel\n        })\n      }\n    }\n  }\n}\n\n// Thanks: https://stackoverflow.com/a/12034334\nexport function escapeHTML (stringParam: string) {\n  if (!stringParam) return ''\n\n  const entityMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    '\\'': '&#39;',\n    '/': '&#x2F;',\n    '`': '&#x60;',\n    '=': '&#x3D;'\n  }\n\n  return String(stringParam).replace(/[&<>\"'`=/]/g, s => entityMap[s])\n}\n","export * from './markdown'\nexport * from './html'\n","export const TEXT_RULES = [\n  'linkify',\n  'autolink',\n  'emphasis',\n  'link',\n  'newline',\n  'list'\n]\n\nexport const TEXT_WITH_HTML_RULES = TEXT_RULES.concat([\n  'html_inline',\n  'html_block'\n])\n\nexport const ENHANCED_RULES = TEXT_RULES.concat([ 'image' ])\nexport const ENHANCED_WITH_HTML_RULES = TEXT_WITH_HTML_RULES.concat([ 'image' ])\n\nexport const COMPLETE_RULES = ENHANCED_WITH_HTML_RULES.concat([\n  'block',\n  'inline',\n  'heading',\n  'paragraph'\n])\n","import videojs from 'video.js'\nimport './pause-bezel'\n\nconst Plugin = videojs.getPlugin('plugin')\n\nclass BezelsPlugin extends Plugin {\n\n  constructor (player: videojs.Player, options?: videojs.ComponentOptions) {\n    super(player)\n\n    this.player.ready(() => {\n      player.addClass('vjs-bezels')\n    })\n\n    player.addChild('PauseBezel', options)\n  }\n}\n\nvideojs.registerPlugin('bezels', BezelsPlugin)\n\nexport { BezelsPlugin }\n","import videojs from 'video.js'\n\nfunction getPauseBezel () {\n  return `\n  <div class=\"vjs-bezels-pause\">\n    <div class=\"vjs-bezel\" role=\"status\" aria-label=\"Pause\">\n      <div class=\"vjs-bezel-icon\">\n        <svg height=\"100%\" version=\"1.1\" viewBox=\"0 0 36 36\" width=\"100%\">\n          <use class=\"vjs-svg-shadow\" xlink:href=\"#vjs-id-1\"></use>\n          <path class=\"vjs-svg-fill\" d=\"M 12,26 16,26 16,10 12,10 z M 21,26 25,26 25,10 21,10 z\" id=\"vjs-id-1\"></path>\n        </svg>\n      </div>\n    </div>\n  </div>\n  `\n}\n\nfunction getPlayBezel () {\n  return `\n  <div class=\"vjs-bezels-play\">\n    <div class=\"vjs-bezel\" role=\"status\" aria-label=\"Play\">\n      <div class=\"vjs-bezel-icon\">\n        <svg height=\"100%\" version=\"1.1\" viewBox=\"0 0 36 36\" width=\"100%\">\n          <use class=\"vjs-svg-shadow\" xlink:href=\"#vjs-id-2\"></use>\n          <path class=\"vjs-svg-fill\" d=\"M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z\" id=\"ytp-id-2\"></path>\n        </svg>\n      </div>\n    </div>\n  </div>\n  `\n}\n\nconst Component = videojs.getComponent('Component')\nclass PauseBezel extends Component {\n  container: HTMLDivElement\n\n  constructor (player: videojs.Player, options?: videojs.ComponentOptions) {\n    super(player, options)\n\n    player.on('pause', (_: any) => {\n      if (player.seeking() || player.ended()) return\n      this.container.innerHTML = getPauseBezel()\n      this.showBezel()\n    })\n\n    player.on('play', (_: any) => {\n      if (player.seeking()) return\n      this.container.innerHTML = getPlayBezel()\n      this.showBezel()\n    })\n  }\n\n  createEl () {\n    this.container = super.createEl('div', {\n      className: 'vjs-bezels-content'\n    }) as HTMLDivElement\n\n    this.container.style.display = 'none'\n\n    return this.container\n  }\n\n  showBezel () {\n    this.container.style.display = 'inherit'\n\n    setTimeout(() => {\n      this.container.style.display = 'none'\n    }, 500) // matching the animation duration\n  }\n}\n\nvideojs.registerComponent('PauseBezel', PauseBezel)\n","import { basename, dirname } from 'path'\n\nclass RedundancyUrlManager {\n\n  constructor (private baseUrls: string[] = []) {\n    // empty\n  }\n\n  removeBySegmentUrl (segmentUrl: string) {\n    console.log('Removing redundancy of segment URL %s.', segmentUrl)\n\n    const baseUrl = dirname(segmentUrl)\n\n    this.baseUrls = this.baseUrls.filter(u => u !== baseUrl && u !== baseUrl + '/')\n  }\n\n  buildUrl (url: string) {\n    const max = this.baseUrls.length + 1\n    const i = this.getRandomInt(max)\n\n    if (i === max - 1) return url\n\n    const newBaseUrl = this.baseUrls[i]\n    const slashPart = newBaseUrl.endsWith('/') ? '' : '/'\n\n    return newBaseUrl + slashPart + basename(url)\n  }\n\n  countBaseUrls () {\n    return this.baseUrls.length\n  }\n\n  private getRandomInt (max: number) {\n    return Math.floor(Math.random() * Math.floor(max))\n  }\n}\n\n// ---------------------------------------------------------------------------\n\nexport {\n  RedundancyUrlManager\n}\n","import { Segment } from 'p2p-media-loader-core'\nimport { RedundancyUrlManager } from './redundancy-url-manager'\n\nfunction segmentUrlBuilderFactory (redundancyUrlManager: RedundancyUrlManager) {\n  return function segmentBuilder (segment: Segment) {\n    return redundancyUrlManager.buildUrl(segment.url)\n  }\n}\n\n// ---------------------------------------------------------------------------\n\nexport {\n  segmentUrlBuilderFactory\n}\n","import { wait } from '@root-helpers/utils'\nimport { Segment } from 'p2p-media-loader-core'\nimport { basename } from 'path'\n\ntype SegmentsJSON = { [filename: string]: string | { [byterange: string]: string } }\n\nconst maxRetries = 3\n\nfunction segmentValidatorFactory (segmentsSha256Url: string, isLive: boolean) {\n  let segmentsJSON = fetchSha256Segments(segmentsSha256Url)\n  const regex = /bytes=(\\d+)-(\\d+)/\n\n  return async function segmentValidator (segment: Segment, _method: string, _peerId: string, retry = 1) {\n    // Wait for hash generation from the server\n    if (isLive) await wait(1000)\n\n    const filename = basename(segment.url)\n\n    const segmentValue = (await segmentsJSON)[filename]\n\n    if (!segmentValue && retry > maxRetries) {\n      throw new Error(`Unknown segment name ${filename} in segment validator`)\n    }\n\n    if (!segmentValue) {\n      console.log('Refetching sha segments for %s.', filename)\n\n      await wait(1000)\n\n      segmentsJSON = fetchSha256Segments(segmentsSha256Url)\n      await segmentValidator(segment, _method, _peerId, retry + 1)\n\n      return\n    }\n\n    let hashShouldBe: string\n    let range = ''\n\n    if (typeof segmentValue === 'string') {\n      hashShouldBe = segmentValue\n    } else {\n      const captured = regex.exec(segment.range)\n      range = captured[1] + '-' + captured[2]\n\n      hashShouldBe = segmentValue[range]\n    }\n\n    if (hashShouldBe === undefined) {\n      throw new Error(`Unknown segment name ${filename}/${range} in segment validator`)\n    }\n\n    const calculatedSha = await sha256Hex(segment.data)\n    if (calculatedSha !== hashShouldBe) {\n      throw new Error(\n        `Hashes does not correspond for segment ${filename}/${range}` +\n        `(expected: ${hashShouldBe} instead of ${calculatedSha})`\n      )\n    }\n  }\n}\n\n// ---------------------------------------------------------------------------\n\nexport {\n  segmentValidatorFactory\n}\n\n// ---------------------------------------------------------------------------\n\nfunction fetchSha256Segments (url: string) {\n  return fetch(url)\n    .then(res => res.json() as Promise<SegmentsJSON>)\n    .catch(err => {\n      console.error('Cannot get sha256 segments', err)\n      return {}\n    })\n}\n\nasync function sha256Hex (data?: ArrayBuffer) {\n  if (!data) return undefined\n\n  if (window.crypto.subtle) {\n    return window.crypto.subtle.digest('SHA-256', data)\n      .then(data => bufferToHex(data))\n  }\n\n  // Fallback for non HTTPS context\n  const shaModule = await import('sha.js')\n  return new shaModule.sha256().update(Buffer.from(data)).digest('hex')\n}\n\n// Thanks: https://stackoverflow.com/a/53307879\nfunction bufferToHex (buffer?: ArrayBuffer) {\n  if (!buffer) return ''\n\n  let s = ''\n  const h = '0123456789abcdef'\n  const o = new Uint8Array(buffer)\n\n  o.forEach((v: any) => s += h[ v >> 4 ] + h[ v & 15 ])\n\n  return s\n}\n","function getStoredVolume () {\n  const value = getLocalStorage('volume')\n  if (value !== null && value !== undefined) {\n    const valueNumber = parseFloat(value)\n    if (isNaN(valueNumber)) return undefined\n\n    return valueNumber\n  }\n\n  return undefined\n}\n\nfunction getStoredP2PEnabled (): boolean {\n  const value = getLocalStorage('webtorrent_enabled')\n  if (value !== null && value !== undefined) return value === 'true'\n\n  // By default webtorrent is enabled\n  return true\n}\n\nfunction getStoredMute () {\n  const value = getLocalStorage('mute')\n  if (value !== null && value !== undefined) return value === 'true'\n\n  return undefined\n}\n\nfunction getStoredTheater () {\n  const value = getLocalStorage('theater-enabled')\n  if (value !== null && value !== undefined) return value === 'true'\n\n  return false\n}\n\nfunction saveVolumeInStore (value: number) {\n  return setLocalStorage('volume', value.toString())\n}\n\nfunction saveMuteInStore (value: boolean) {\n  return setLocalStorage('mute', value.toString())\n}\n\nfunction saveTheaterInStore (enabled: boolean) {\n  return setLocalStorage('theater-enabled', enabled.toString())\n}\n\nfunction saveAverageBandwidth (value: number) {\n  return setLocalStorage('average-bandwidth', value.toString())\n}\n\nfunction getAverageBandwidthInStore () {\n  const value = getLocalStorage('average-bandwidth')\n  if (value !== null && value !== undefined) {\n    const valueNumber = parseInt(value, 10)\n    if (isNaN(valueNumber)) return undefined\n\n    return valueNumber\n  }\n\n  return undefined\n}\n\nfunction saveLastSubtitle (language: string) {\n  return setLocalStorage('last-subtitle', language)\n}\n\nfunction getStoredLastSubtitle () {\n  return getLocalStorage('last-subtitle')\n}\n\nfunction saveVideoWatchHistory(videoUUID: string, duration: number) {\n  return setLocalStorage(`video-watch-history`, JSON.stringify({\n    ...getStoredVideoWatchHistory(),\n    [videoUUID]: {\n      duration,\n      date: `${(new Date()).toISOString()}`\n    }\n  }))\n}\n\nfunction getStoredVideoWatchHistory(videoUUID?: string) {\n  let data\n\n  try {\n    data = JSON.parse(getLocalStorage('video-watch-history'))\n  } catch (error) {\n    console.error('Cannot parse video watch history from local storage: ', error)\n  }\n\n  data = data || {}\n\n  if (videoUUID) return data[videoUUID]\n\n  return data\n}\n\nfunction cleanupVideoWatch() {\n  const data = getStoredVideoWatchHistory()\n\n  const newData = Object.keys(data).reduce((acc, videoUUID) => {\n    const date = Date.parse(data[videoUUID].date)\n\n    const diff = Math.ceil(((new Date()).getTime() - date) / (1000 * 3600 * 24))\n\n    if (diff > 30) return acc\n\n    return {\n      ...acc,\n      [videoUUID]: data[videoUUID]\n    }\n  }, {})\n\n  setLocalStorage('video-watch-history', JSON.stringify(newData))\n}\n\n// ---------------------------------------------------------------------------\n\nexport {\n  getStoredVolume,\n  getStoredP2PEnabled,\n  getStoredMute,\n  getStoredTheater,\n  saveVolumeInStore,\n  saveMuteInStore,\n  saveTheaterInStore,\n  saveAverageBandwidth,\n  getAverageBandwidthInStore,\n  saveLastSubtitle,\n  getStoredLastSubtitle,\n  saveVideoWatchHistory,\n  getStoredVideoWatchHistory,\n  cleanupVideoWatch\n}\n\n// ---------------------------------------------------------------------------\n\nconst KEY_PREFIX = 'peertube-videojs-'\n\nfunction getLocalStorage (key: string) {\n  try {\n    return localStorage.getItem(KEY_PREFIX + key)\n  } catch {\n    return undefined\n  }\n}\n\nfunction setLocalStorage (key: string, value: string) {\n  try {\n    localStorage.setItem(KEY_PREFIX + key, value)\n  } catch { /* empty */\n  }\n}\n","import 'videojs-hotkeys/videojs.hotkeys'\nimport 'videojs-dock'\nimport 'videojs-contextmenu-pt'\nimport 'videojs-contrib-quality-levels'\nimport './upnext/end-card'\nimport './upnext/upnext-plugin'\nimport './bezels/bezels-plugin'\nimport './peertube-plugin'\nimport './videojs-components/next-previous-video-button'\nimport './videojs-components/p2p-info-button'\nimport './videojs-components/peertube-link-button'\nimport './videojs-components/peertube-load-progress-bar'\nimport './videojs-components/resolution-menu-button'\nimport './videojs-components/resolution-menu-item'\nimport './videojs-components/settings-dialog'\nimport './videojs-components/settings-menu-button'\nimport './videojs-components/settings-menu-item'\nimport './videojs-components/settings-panel'\nimport './videojs-components/settings-panel-child'\nimport './videojs-components/theater-button'\nimport './playlist/playlist-plugin'\nimport videojs from 'video.js'\nimport { isDefaultLocale } from '@shared/core-utils/i18n'\nimport { VideoFile } from '@shared/models'\nimport { RedundancyUrlManager } from './p2p-media-loader/redundancy-url-manager'\nimport { segmentUrlBuilderFactory } from './p2p-media-loader/segment-url-builder'\nimport { segmentValidatorFactory } from './p2p-media-loader/segment-validator'\nimport { getStoredP2PEnabled } from './peertube-player-local-storage'\nimport {\n  NextPreviousVideoButtonOptions,\n  P2PMediaLoaderPluginOptions,\n  PlaylistPluginOptions,\n  UserWatching,\n  VideoJSCaption,\n  VideoJSPluginOptions\n} from './peertube-videojs-typings'\nimport { TranslationsManager } from './translations-manager'\nimport { buildVideoOrPlaylistEmbed, buildVideoLink, getRtcConfig, isSafari, isIOS } from './utils'\nimport { copyToClipboard } from '../../root-helpers/utils'\n\n// Change 'Playback Rate' to 'Speed' (smaller for our settings menu)\n(videojs.getComponent('PlaybackRateMenuButton') as any).prototype.controlText_ = 'Speed'\n\nconst CaptionsButton = videojs.getComponent('CaptionsButton') as any\n// Change Captions to Subtitles/CC\nCaptionsButton.prototype.controlText_ = 'Subtitles/CC'\n// We just want to display 'Off' instead of 'captions off', keep a space so the variable == true (hacky I know)\nCaptionsButton.prototype.label_ = ' '\n\nexport type PlayerMode = 'webtorrent' | 'p2p-media-loader'\n\nexport type WebtorrentOptions = {\n  videoFiles: VideoFile[]\n}\n\nexport type P2PMediaLoaderOptions = {\n  playlistUrl: string\n  segmentsSha256Url: string\n  trackerAnnounce: string[]\n  redundancyBaseUrls: string[]\n  videoFiles: VideoFile[]\n}\n\nexport interface CustomizationOptions {\n  startTime: number | string\n  stopTime: number | string\n\n  controls?: boolean\n  muted?: boolean\n  loop?: boolean\n  subtitle?: string\n  resume?: string\n\n  peertubeLink: boolean\n}\n\nexport interface CommonOptions extends CustomizationOptions {\n  playerElement: HTMLVideoElement\n  onPlayerElementChange: (element: HTMLVideoElement) => void\n\n  autoplay: boolean\n\n  nextVideo?: () => void\n  hasNextVideo?: () => boolean\n\n  previousVideo?: () => void\n  hasPreviousVideo?: () => boolean\n\n  playlist?: PlaylistPluginOptions\n\n  videoDuration: number\n  enableHotkeys: boolean\n  inactivityTimeout: number\n  poster: string\n\n  theaterButton: boolean\n  captions: boolean\n\n  videoViewUrl: string\n  embedUrl: string\n  embedTitle: string\n\n  isLive: boolean\n\n  language?: string\n\n  videoCaptions: VideoJSCaption[]\n\n  videoUUID: string\n\n  userWatching?: UserWatching\n\n  serverUrl: string\n}\n\nexport type PeertubePlayerManagerOptions = {\n  common: CommonOptions,\n  webtorrent: WebtorrentOptions,\n  p2pMediaLoader?: P2PMediaLoaderOptions\n}\n\nexport class PeertubePlayerManager {\n  private static playerElementClassName: string\n  private static onPlayerChange: (player: videojs.Player) => void\n  private static alreadyPlayed = false\n\n  static initState () {\n    PeertubePlayerManager.alreadyPlayed = false\n  }\n\n  static async initialize (mode: PlayerMode, options: PeertubePlayerManagerOptions, onPlayerChange: (player: videojs.Player) => void) {\n    let p2pMediaLoader: any\n\n    this.onPlayerChange = onPlayerChange\n    this.playerElementClassName = options.common.playerElement.className\n\n    if (mode === 'webtorrent') await import('./webtorrent/webtorrent-plugin')\n    if (mode === 'p2p-media-loader') {\n      [ p2pMediaLoader ] = await Promise.all([\n        import('p2p-media-loader-hlsjs'),\n        import('./p2p-media-loader/p2p-media-loader-plugin')\n      ])\n    }\n\n    const videojsOptions = this.getVideojsOptions(mode, options, p2pMediaLoader)\n\n    await TranslationsManager.loadLocaleInVideoJS(options.common.serverUrl, options.common.language, videojs)\n\n    const self = this\n    return new Promise(res => {\n      videojs(options.common.playerElement, videojsOptions, function (this: videojs.Player) {\n        const player = this\n\n        let alreadyFallback = false\n\n        player.tech(true).one('error', () => {\n          if (!alreadyFallback) self.maybeFallbackToWebTorrent(mode, player, options)\n          alreadyFallback = true\n        })\n\n        player.one('error', () => {\n          if (!alreadyFallback) self.maybeFallbackToWebTorrent(mode, player, options)\n          alreadyFallback = true\n        })\n\n        player.one('play', () => {\n          PeertubePlayerManager.alreadyPlayed = true\n        })\n\n        self.addContextMenu(mode, player, options.common.embedUrl, options.common.embedTitle)\n\n        player.bezels()\n\n        return res(player)\n      })\n    })\n  }\n\n  private static async maybeFallbackToWebTorrent (currentMode: PlayerMode, player: any, options: PeertubePlayerManagerOptions) {\n    if (currentMode === 'webtorrent') return\n\n    console.log('Fallback to webtorrent.')\n\n    const newVideoElement = document.createElement('video')\n    newVideoElement.className = this.playerElementClassName\n\n    // VideoJS wraps our video element inside a div\n    let currentParentPlayerElement = options.common.playerElement.parentNode\n    // Fix on IOS, don't ask me why\n    if (!currentParentPlayerElement) currentParentPlayerElement = document.getElementById(options.common.playerElement.id).parentNode\n\n    currentParentPlayerElement.parentNode.insertBefore(newVideoElement, currentParentPlayerElement)\n\n    options.common.playerElement = newVideoElement\n    options.common.onPlayerElementChange(newVideoElement)\n\n    player.dispose()\n\n    await import('./webtorrent/webtorrent-plugin')\n\n    const mode = 'webtorrent'\n    const videojsOptions = this.getVideojsOptions(mode, options)\n\n    const self = this\n    videojs(newVideoElement, videojsOptions, function (this: videojs.Player) {\n      const player = this\n\n      self.addContextMenu(mode, player, options.common.embedUrl, options.common.embedTitle)\n\n      PeertubePlayerManager.onPlayerChange(player)\n    })\n  }\n\n  private static getVideojsOptions (\n    mode: PlayerMode,\n    options: PeertubePlayerManagerOptions,\n    p2pMediaLoaderModule?: any\n  ): videojs.PlayerOptions {\n    const commonOptions = options.common\n    const isHLS = mode === 'p2p-media-loader'\n\n    let autoplay = this.getAutoPlayValue(commonOptions.autoplay)\n    let html5 = {\n      preloadTextTracks: false\n    }\n\n    const plugins: VideoJSPluginOptions = {\n      peertube: {\n        mode,\n        autoplay, // Use peertube plugin autoplay because we could get the file by webtorrent\n        videoViewUrl: commonOptions.videoViewUrl,\n        videoDuration: commonOptions.videoDuration,\n        userWatching: commonOptions.userWatching,\n        subtitle: commonOptions.subtitle,\n        videoCaptions: commonOptions.videoCaptions,\n        stopTime: commonOptions.stopTime,\n        isLive: commonOptions.isLive,\n        videoUUID: commonOptions.videoUUID\n      }\n    }\n\n    if (commonOptions.playlist) {\n      plugins.playlist = commonOptions.playlist\n    }\n\n    if (commonOptions.enableHotkeys === true) {\n      PeertubePlayerManager.addHotkeysOptions(plugins)\n    }\n\n    if (isHLS) {\n      const { hlsjs } = PeertubePlayerManager.addP2PMediaLoaderOptions(plugins, options, p2pMediaLoaderModule)\n\n      Object.assign(html5, hlsjs.html5)\n    }\n\n    if (mode === 'webtorrent') {\n      PeertubePlayerManager.addWebTorrentOptions(plugins, options)\n\n      // WebTorrent plugin handles autoplay, because we do some hackish stuff in there\n      autoplay = false\n    }\n\n    const videojsOptions = {\n      html5,\n\n      // We don't use text track settings for now\n      textTrackSettings: false as any, // FIXME: typings\n      controls: commonOptions.controls !== undefined ? commonOptions.controls : true,\n      loop: commonOptions.loop !== undefined ? commonOptions.loop : false,\n\n      muted: commonOptions.muted !== undefined\n        ? commonOptions.muted\n        : undefined, // Undefined so the player knows it has to check the local storage\n\n      autoplay: this.getAutoPlayValue(autoplay),\n\n      poster: commonOptions.poster,\n      inactivityTimeout: commonOptions.inactivityTimeout,\n      playbackRates: [ 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2 ],\n\n      plugins,\n\n      controlBar: {\n        children: this.getControlBarChildren(mode, {\n          captions: commonOptions.captions,\n          peertubeLink: commonOptions.peertubeLink,\n          theaterButton: commonOptions.theaterButton,\n\n          nextVideo: commonOptions.nextVideo,\n          hasNextVideo: commonOptions.hasNextVideo,\n\n          previousVideo: commonOptions.previousVideo,\n          hasPreviousVideo: commonOptions.hasPreviousVideo\n        }) as any // FIXME: typings\n      }\n    }\n\n    if (commonOptions.language && !isDefaultLocale(commonOptions.language)) {\n      Object.assign(videojsOptions, { language: commonOptions.language })\n    }\n\n    return videojsOptions\n  }\n\n  private static addP2PMediaLoaderOptions (\n    plugins: VideoJSPluginOptions,\n    options: PeertubePlayerManagerOptions,\n    p2pMediaLoaderModule: any\n  ) {\n    const p2pMediaLoaderOptions = options.p2pMediaLoader\n    const commonOptions = options.common\n\n    const trackerAnnounce = p2pMediaLoaderOptions.trackerAnnounce\n                                                 .filter(t => t.startsWith('ws'))\n\n    const redundancyUrlManager = new RedundancyUrlManager(options.p2pMediaLoader.redundancyBaseUrls)\n\n    const p2pMediaLoader: P2PMediaLoaderPluginOptions = {\n      redundancyUrlManager,\n      type: 'application/x-mpegURL',\n      startTime: commonOptions.startTime,\n      src: p2pMediaLoaderOptions.playlistUrl\n    }\n\n    let consumeOnly = false\n    // FIXME: typings\n    if (navigator && (navigator as any).connection && (navigator as any).connection.type === 'cellular') {\n      console.log('We are on a cellular connection: disabling seeding.')\n      consumeOnly = true\n    }\n\n    const p2pMediaLoaderConfig = {\n      loader: {\n        trackerAnnounce,\n        segmentValidator: segmentValidatorFactory(options.p2pMediaLoader.segmentsSha256Url, options.common.isLive),\n        rtcConfig: getRtcConfig(),\n        requiredSegmentsPriority: 1,\n        segmentUrlBuilder: segmentUrlBuilderFactory(redundancyUrlManager),\n        useP2P: getStoredP2PEnabled(),\n        consumeOnly\n      },\n      segments: {\n        swarmId: p2pMediaLoaderOptions.playlistUrl\n      }\n    }\n    const hlsjs = {\n      levelLabelHandler: (level: { height: number, width: number }) => {\n        const resolution = Math.min(level.height || 0, level.width || 0)\n\n        const file = p2pMediaLoaderOptions.videoFiles.find(f => f.resolution.id === resolution)\n        // We don't have files for live videos\n        if (!file) return level.height\n\n        let label = file.resolution.label\n        if (file.fps >= 50) label += file.fps\n\n        return label\n      },\n      html5: {\n        hlsjsConfig: {\n          capLevelToPlayerSize: true,\n          autoStartLoad: false,\n          liveSyncDurationCount: 5,\n          loader: new p2pMediaLoaderModule.Engine(p2pMediaLoaderConfig).createLoaderClass()\n        }\n      }\n    }\n\n    const toAssign = { p2pMediaLoader, hlsjs }\n    Object.assign(plugins, toAssign)\n\n    return toAssign\n  }\n\n  private static addWebTorrentOptions (plugins: VideoJSPluginOptions, options: PeertubePlayerManagerOptions) {\n    const commonOptions = options.common\n    const webtorrentOptions = options.webtorrent\n\n    const autoplay = this.getAutoPlayValue(commonOptions.autoplay) === 'play'\n      ? true\n      : false\n\n    const webtorrent = {\n      autoplay,\n      videoDuration: commonOptions.videoDuration,\n      playerElement: commonOptions.playerElement,\n      videoFiles: webtorrentOptions.videoFiles,\n      startTime: commonOptions.startTime\n    }\n\n    Object.assign(plugins, { webtorrent })\n  }\n\n  private static getControlBarChildren (mode: PlayerMode, options: {\n    peertubeLink: boolean\n    theaterButton: boolean\n    captions: boolean\n\n    nextVideo?: Function\n    hasNextVideo?: () => boolean\n\n    previousVideo?: Function\n    hasPreviousVideo?: () => boolean\n  }) {\n    const settingEntries = []\n    const loadProgressBar = mode === 'webtorrent' ? 'peerTubeLoadProgressBar' : 'loadProgressBar'\n\n    // Keep an order\n    settingEntries.push('playbackRateMenuButton')\n    if (options.captions === true) settingEntries.push('captionsButton')\n    settingEntries.push('resolutionMenuButton')\n\n    const children = {}\n\n    if (options.previousVideo) {\n      const buttonOptions: NextPreviousVideoButtonOptions = {\n        type: 'previous',\n        handler: options.previousVideo,\n        isDisabled: () => {\n          if (!options.hasPreviousVideo) return false\n\n          return !options.hasPreviousVideo()\n        }\n      }\n\n      Object.assign(children, {\n        'previousVideoButton': buttonOptions\n      })\n    }\n\n    Object.assign(children, { playToggle: {} })\n\n    if (options.nextVideo) {\n      const buttonOptions: NextPreviousVideoButtonOptions = {\n        type: 'next',\n        handler: options.nextVideo,\n        isDisabled: () => {\n          if (!options.hasNextVideo) return false\n\n          return !options.hasNextVideo()\n        }\n      }\n\n      Object.assign(children, {\n        'nextVideoButton': buttonOptions\n      })\n    }\n\n    Object.assign(children, {\n      'currentTimeDisplay': {},\n      'timeDivider': {},\n      'durationDisplay': {},\n      'liveDisplay': {},\n\n      'flexibleWidthSpacer': {},\n      'progressControl': {\n        children: {\n          'seekBar': {\n            children: {\n              [loadProgressBar]: {},\n              'mouseTimeDisplay': {},\n              'playProgressBar': {}\n            }\n          }\n        }\n      },\n\n      'p2PInfoButton': {},\n\n      'muteToggle': {},\n      'volumeControl': {},\n\n      'settingsButton': {\n        setup: {\n          maxHeightOffset: 40\n        },\n        entries: settingEntries\n      }\n    })\n\n    if (options.peertubeLink === true) {\n      Object.assign(children, {\n        'peerTubeLinkButton': {}\n      })\n    }\n\n    if (options.theaterButton === true) {\n      Object.assign(children, {\n        'theaterButton': {}\n      })\n    }\n\n    Object.assign(children, {\n      'fullscreenToggle': {}\n    })\n\n    return children\n  }\n\n  private static addContextMenu (mode: PlayerMode, player: videojs.Player, videoEmbedUrl: string, videoEmbedTitle: string) {\n    const content = () => {\n      const isLoopEnabled = player.options_['loop']\n      const items = [\n        {\n          icon: 'repeat',\n          label: player.localize('Play in loop') + (isLoopEnabled ? '<span class=\"vjs-icon-tick-white\"></span>' : ''),\n          listener: function () {\n            player.options_['loop'] = !isLoopEnabled\n          }\n        },\n        {\n          label: player.localize('Copy the video URL'),\n          listener: function () {\n            copyToClipboard(buildVideoLink())\n          }\n        },\n        {\n          label: player.localize('Copy the video URL at the current time'),\n          listener: function (this: videojs.Player) {\n            copyToClipboard(buildVideoLink({ startTime: this.currentTime() }))\n          }\n        },\n        {\n          icon: 'code',\n          label: player.localize('Copy embed code'),\n          listener: () => {\n            copyToClipboard(buildVideoOrPlaylistEmbed(videoEmbedUrl, videoEmbedTitle))\n          }\n        }\n      ]\n\n      if (mode === 'webtorrent') {\n        items.push({\n          label: player.localize('Copy magnet URI'),\n          listener: function (this: videojs.Player) {\n            copyToClipboard(this.webtorrent().getCurrentVideoFile().magnetUri)\n          }\n        })\n      }\n\n      return items.map(i => ({\n        ...i,\n        label: `<span class=\"vjs-icon-${i.icon || 'link-2'}\"></span>` + i.label\n      }))\n    }\n\n    // adding the menu\n    //player.contextmenuUI({ content })\n  }\n\n  private static addHotkeysOptions (plugins: VideoJSPluginOptions) {\n    const isNaked = (event: KeyboardEvent, key: string) =>\n      (!event.ctrlKey && !event.altKey && !event.metaKey && !event.shiftKey && event.key === key)\n\n    Object.assign(plugins, {\n      hotkeys: {\n        skipInitialFocus: true,\n        enableInactiveFocus: false,\n        captureDocumentHotkeys: true,\n        documentHotkeysFocusElementFilter: (e: HTMLElement) => {\n          const tagName = e.tagName.toLowerCase()\n          return e.id === 'content' || tagName === 'body' || tagName === 'video'\n        },\n\n        enableVolumeScroll: false,\n        enableModifiersForNumbers: false,\n\n        rewindKey: function (event: KeyboardEvent) {\n          return isNaked(event, 'ArrowLeft')\n        },\n\n        forwardKey: function (event: KeyboardEvent) {\n          return isNaked(event, 'ArrowRight')\n        },\n\n        fullscreenKey: function (event: KeyboardEvent) {\n          // fullscreen with the f key or Ctrl+Enter\n          return isNaked(event, 'f') || (!event.altKey && event.ctrlKey && event.key === 'Enter')\n        },\n\n        customKeys: {\n          increasePlaybackRateKey: {\n            key: function (event: KeyboardEvent) {\n              return isNaked(event, '>')\n            },\n            handler: function (player: videojs.Player) {\n              const newValue = Math.min(player.playbackRate() + 0.1, 5)\n              player.playbackRate(parseFloat(newValue.toFixed(2)))\n            }\n          },\n          decreasePlaybackRateKey: {\n            key: function (event: KeyboardEvent) {\n              return isNaked(event, '<')\n            },\n            handler: function (player: videojs.Player) {\n              const newValue = Math.max(player.playbackRate() - 0.1, 0.10)\n              player.playbackRate(parseFloat(newValue.toFixed(2)))\n            }\n          },\n          frameByFrame: {\n            key: function (event: KeyboardEvent) {\n              return isNaked(event, '.')\n            },\n            handler: function (player: videojs.Player) {\n              player.pause()\n              // Calculate movement distance (assuming 30 fps)\n              const dist = 1 / 30\n              player.currentTime(player.currentTime() + dist)\n            }\n          }\n        }\n      }\n    })\n  }\n\n  private static getAutoPlayValue (autoplay: any) {\n    if (autoplay !== true) return autoplay\n\n    // On first play, disable autoplay to avoid issues\n    // But if the player already played videos, we can safely autoplay next ones\n    if (isIOS() || isSafari()) {\n      return PeertubePlayerManager.alreadyPlayed ? 'play' : false\n    }\n\n    return 'play'\n  }\n}\n\n// ############################################################################\n\nexport {\n  videojs\n}\n","import videojs from 'video.js'\nimport './videojs-components/settings-menu-button'\nimport {\n  PeerTubePluginOptions,\n  ResolutionUpdateData,\n  UserWatching,\n  VideoJSCaption\n} from './peertube-videojs-typings'\nimport { isMobile, timeToInt } from './utils'\nimport {\n  getStoredLastSubtitle,\n  getStoredMute,\n  getStoredVolume,\n  saveLastSubtitle,\n  saveMuteInStore,\n  saveVideoWatchHistory,\n  saveVolumeInStore\n} from './peertube-player-local-storage'\n\nconst Plugin = videojs.getPlugin('plugin')\n\nclass PeerTubePlugin extends Plugin {\n  private readonly videoViewUrl: string\n  private readonly videoDuration: number\n  private readonly CONSTANTS = {\n    USER_WATCHING_VIDEO_INTERVAL: 5000 // Every 5 seconds, notify the user is watching the video\n  }\n\n  private videoCaptions: VideoJSCaption[]\n  private defaultSubtitle: string\n\n  private videoViewInterval: any\n  private userWatchingVideoInterval: any\n  private lastResolutionChange: ResolutionUpdateData\n\n  private isLive: boolean\n\n  private menuOpened = false\n  private mouseInControlBar = false\n  private readonly savedInactivityTimeout: number\n\n  constructor (player: videojs.Player, options?: PeerTubePluginOptions) {\n    super(player)\n\n    this.videoViewUrl = options.videoViewUrl\n    this.videoDuration = options.videoDuration\n    this.videoCaptions = options.videoCaptions\n    this.isLive = options.isLive\n\n    this.savedInactivityTimeout = player.options_.inactivityTimeout\n\n    if (options.autoplay) this.player.addClass('vjs-has-autoplay')\n\n    this.player.on('autoplay-failure', () => {\n      this.player.removeClass('vjs-has-autoplay')\n    })\n\n    this.player.ready(() => {\n      const playerOptions = this.player.options_\n\n      if (options.mode === 'webtorrent') {\n        this.player.webtorrent().on('resolutionChange', (_: any, d: any) => this.handleResolutionChange(d))\n        this.player.webtorrent().on('autoResolutionChange', (_: any, d: any) => this.trigger('autoResolutionChange', d))\n      }\n\n      if (options.mode === 'p2p-media-loader') {\n        this.player.p2pMediaLoader().on('resolutionChange', (_: any, d: any) => this.handleResolutionChange(d))\n      }\n\n      this.player.tech(true).on('loadedqualitydata', () => {\n        setTimeout(() => {\n          // Replay a resolution change, now we loaded all quality data\n          if (this.lastResolutionChange) this.handleResolutionChange(this.lastResolutionChange)\n        }, 0)\n      })\n\n      const volume = getStoredVolume()\n      if (volume !== undefined) this.player.volume(volume)\n\n      const muted = playerOptions.muted !== undefined ? playerOptions.muted : getStoredMute()\n      if (muted !== undefined) this.player.muted(muted)\n\n      this.defaultSubtitle = options.subtitle || getStoredLastSubtitle()\n\n      this.player.on('volumechange', () => {\n        saveVolumeInStore(this.player.volume())\n        saveMuteInStore(this.player.muted())\n      })\n\n      if (options.stopTime) {\n        const stopTime = timeToInt(options.stopTime)\n        const self = this\n\n        this.player.on('timeupdate', function onTimeUpdate () {\n          if (self.player.currentTime() > stopTime) {\n            self.player.pause()\n            self.player.trigger('stopped')\n\n            self.player.off('timeupdate', onTimeUpdate)\n          }\n        })\n      }\n\n      this.player.textTracks().on('change', () => {\n        const showing = this.player.textTracks().tracks_.find(t => {\n          return t.kind === 'captions' && t.mode === 'showing'\n        })\n\n        if (!showing) {\n          saveLastSubtitle('off')\n          return\n        }\n\n        saveLastSubtitle(showing.language)\n      })\n\n      this.player.on('sourcechange', () => this.initCaptions())\n\n      this.player.duration(options.videoDuration)\n\n      this.initializePlayer()\n      this.runViewAdd()\n\n      this.runUserWatchVideo(options.userWatching, options.videoUUID)\n    })\n  }\n\n  dispose () {\n    if (this.videoViewInterval) clearInterval(this.videoViewInterval)\n    if (this.userWatchingVideoInterval) clearInterval(this.userWatchingVideoInterval)\n  }\n\n  onMenuOpen () {\n    this.menuOpened = false\n    this.alterInactivity()\n  }\n\n  onMenuClosed () {\n    this.menuOpened = true\n    this.alterInactivity()\n  }\n\n  private initializePlayer () {\n    if (isMobile()) this.player.addClass('vjs-is-mobile')\n\n    this.initSmoothProgressBar()\n\n    this.initCaptions()\n\n    this.listenControlBarMouse()\n  }\n\n  private runViewAdd () {\n    this.clearVideoViewInterval()\n\n    // After 30 seconds (or 3/4 of the video), add a view to the video\n    let minSecondsToView = 30\n\n    if (!this.isLive && this.videoDuration < minSecondsToView) {\n      minSecondsToView = (this.videoDuration * 3) / 4\n    }\n\n    let secondsViewed = 0\n    this.videoViewInterval = setInterval(() => {\n      if (this.player && !this.player.paused()) {\n        secondsViewed += 1\n\n        if (secondsViewed > minSecondsToView) {\n          // Restart the loop if this is a live\n          if (this.isLive) {\n            secondsViewed = 0\n          } else {\n            this.clearVideoViewInterval()\n          }\n\n          this.addViewToVideo().catch(err => console.error(err))\n        }\n      }\n    }, 1000)\n  }\n\n  private runUserWatchVideo (options: UserWatching, videoUUID: string) {\n    let lastCurrentTime = 0\n\n    this.userWatchingVideoInterval = setInterval(() => {\n      const currentTime = Math.floor(this.player.currentTime())\n\n      if (currentTime - lastCurrentTime >= 1) {\n        lastCurrentTime = currentTime\n\n        if (options) {\n          this.notifyUserIsWatching(currentTime, options.url, options.authorizationHeader)\n            .catch(err => console.error('Cannot notify user is watching.', err))\n        } else {\n          saveVideoWatchHistory(videoUUID, currentTime)\n        }\n      }\n    }, this.CONSTANTS.USER_WATCHING_VIDEO_INTERVAL)\n  }\n\n  private clearVideoViewInterval () {\n    if (this.videoViewInterval !== undefined) {\n      clearInterval(this.videoViewInterval)\n      this.videoViewInterval = undefined\n    }\n  }\n\n  private addViewToVideo () {\n    if (!this.videoViewUrl) return Promise.resolve(undefined)\n\n    return fetch(this.videoViewUrl, { method: 'POST' })\n  }\n\n  private notifyUserIsWatching (currentTime: number, url: string, authorizationHeader: string) {\n    const body = new URLSearchParams()\n    body.append('currentTime', currentTime.toString())\n\n    const headers = new Headers({ 'Authorization': authorizationHeader })\n\n    return fetch(url, { method: 'PUT', body, headers })\n  }\n\n  private handleResolutionChange (data: ResolutionUpdateData) {\n    this.lastResolutionChange = data\n\n    const qualityLevels = this.player.qualityLevels()\n\n    for (let i = 0; i < qualityLevels.length; i++) {\n      if (qualityLevels[i].height === data.resolutionId) {\n        data.id = qualityLevels[i].id\n        break\n      }\n    }\n\n    this.trigger('resolutionChange', data)\n  }\n\n  private listenControlBarMouse () {\n    this.player.controlBar.on('mouseenter', () => {\n      this.mouseInControlBar = true\n      this.alterInactivity()\n    })\n\n    this.player.controlBar.on('mouseleave', () => {\n      this.mouseInControlBar = false\n      this.alterInactivity()\n    })\n  }\n\n  private alterInactivity () {\n    if (this.menuOpened) {\n      this.player.options_.inactivityTimeout = this.savedInactivityTimeout\n      return\n    }\n\n    if (!this.mouseInControlBar && !this.isTouchEnabled()) {\n      this.player.options_.inactivityTimeout = 1\n    }\n  }\n\n  private isTouchEnabled () {\n    return ('ontouchstart' in window) ||\n      navigator.maxTouchPoints > 0 ||\n      navigator.msMaxTouchPoints > 0\n  }\n\n  private initCaptions () {\n    for (const caption of this.videoCaptions) {\n      this.player.addRemoteTextTrack({\n        kind: 'captions',\n        label: caption.label,\n        language: caption.language,\n        id: caption.language,\n        src: caption.src,\n        default: this.defaultSubtitle === caption.language\n      }, false)\n    }\n\n    this.player.trigger('captionsChanged')\n  }\n\n  // Thanks: https://github.com/videojs/video.js/issues/4460#issuecomment-312861657\n  private initSmoothProgressBar () {\n    const SeekBar = videojs.getComponent('SeekBar') as any\n    SeekBar.prototype.getPercent = function getPercent () {\n      // Allows for smooth scrubbing, when player can't keep up.\n      // const time = (this.player_.scrubbing()) ?\n      //   this.player_.getCache().currentTime :\n      //   this.player_.currentTime()\n      const time = this.player_.currentTime()\n      const percent = time / this.player_.duration()\n      return percent >= 1 ? 1 : percent\n    }\n    SeekBar.prototype.handleMouseMove = function handleMouseMove (event: any) {\n      let newTime = this.calculateDistance(event) * this.player_.duration()\n      if (newTime === this.player_.duration()) {\n        newTime = newTime - 0.1\n      }\n      this.player_.currentTime(newTime)\n      this.update()\n    }\n  }\n}\n\nvideojs.registerPlugin('peertube', PeerTubePlugin)\nexport { PeerTubePlugin }\n","import videojs from 'video.js'\nimport { PlaylistPluginOptions } from '../peertube-videojs-typings'\nimport { PlaylistMenu } from './playlist-menu'\n\nconst ClickableComponent = videojs.getComponent('ClickableComponent')\n\nclass PlaylistButton extends ClickableComponent {\n  private playlistInfoElement: HTMLElement\n  private wrapper: HTMLElement\n\n  constructor (player: videojs.Player, options?: PlaylistPluginOptions & { playlistMenu: PlaylistMenu }) {\n    super(player, options as any)\n  }\n\n  createEl () {\n    this.wrapper = super.createEl('div', {\n      className: 'vjs-playlist-button',\n      innerHTML: '',\n      tabIndex: -1\n    }) as HTMLElement\n\n    const icon = super.createEl('div', {\n      className: 'vjs-playlist-icon',\n      innerHTML: '',\n      tabIndex: -1\n    })\n\n    this.playlistInfoElement = super.createEl('div', {\n      className: 'vjs-playlist-info',\n      innerHTML: '',\n      tabIndex: -1\n    }) as HTMLElement\n\n    this.wrapper.appendChild(icon)\n    this.wrapper.appendChild(this.playlistInfoElement)\n\n    this.update()\n\n    return this.wrapper\n  }\n\n  update () {\n    const options = this.options_ as PlaylistPluginOptions\n\n    this.playlistInfoElement.innerHTML = options.getCurrentPosition() + '/' + options.playlist.videosLength\n    this.wrapper.title = this.player().localize('Playlist: {1}', [ options.playlist.displayName ])\n  }\n\n  handleClick () {\n    const playlistMenu = this.getPlaylistMenu()\n    playlistMenu.open()\n  }\n\n  private getPlaylistMenu () {\n    return (this.options_ as any).playlistMenu as PlaylistMenu\n  }\n}\n\nvideojs.registerComponent('PlaylistButton', PlaylistButton)\n\nexport { PlaylistButton }\n","import videojs from 'video.js'\nimport { VideoPlaylistElement } from '@shared/models'\nimport { PlaylistItemOptions } from '../peertube-videojs-typings'\nimport { secondsToTime } from '../utils'\n\nconst Component = videojs.getComponent('Component')\n\nclass PlaylistMenuItem extends Component {\n  private element: VideoPlaylistElement\n\n  constructor (player: videojs.Player, options?: PlaylistItemOptions) {\n    super(player, options as any)\n\n    this.emitTapEvents()\n\n    this.element = options.element\n\n    this.on([ 'click', 'tap' ], () => this.switchPlaylistItem())\n    this.on('keydown', event => this.handleKeyDown(event))\n  }\n\n  createEl () {\n    const options = this.options_ as PlaylistItemOptions\n\n    const li = super.createEl('li', {\n      className: 'vjs-playlist-menu-item',\n      innerHTML: ''\n    }) as HTMLElement\n\n    if (!options.element.video) {\n      li.classList.add('vjs-disabled')\n    }\n\n    const positionBlock = super.createEl('div', {\n      className: 'item-position-block'\n    }) as HTMLElement\n\n    const position = super.createEl('div', {\n      className: 'item-position',\n      innerHTML: options.element.position\n    })\n\n    positionBlock.appendChild(position)\n    li.appendChild(positionBlock)\n\n    if (options.element.video) {\n      this.buildAvailableVideo(li, positionBlock, options)\n    } else {\n      this.buildUnavailableVideo(li)\n    }\n\n    return li\n  }\n\n  setSelected (selected: boolean) {\n    if (selected) this.addClass('vjs-selected')\n    else this.removeClass('vjs-selected')\n  }\n\n  getElement () {\n    return this.element\n  }\n\n  private buildAvailableVideo (li: HTMLElement, positionBlock: HTMLElement, options: PlaylistItemOptions) {\n    const videoElement = options.element\n\n    const player = super.createEl('div', {\n      className: 'item-player'\n    })\n\n    positionBlock.appendChild(player)\n\n    const thumbnail = super.createEl('img', {\n      src: window.location.origin + videoElement.video.thumbnailPath\n    })\n\n    const infoBlock = super.createEl('div', {\n      className: 'info-block'\n    })\n\n    const title = super.createEl('div', {\n      innerHTML: videoElement.video.name,\n      className: 'title'\n    })\n\n    const channel = super.createEl('div', {\n      innerHTML: videoElement.video.channel.displayName,\n      className: 'channel'\n    })\n\n    infoBlock.appendChild(title)\n    infoBlock.appendChild(channel)\n\n    if (videoElement.startTimestamp || videoElement.stopTimestamp) {\n      let html = ''\n\n      if (videoElement.startTimestamp) html += secondsToTime(videoElement.startTimestamp)\n      if (videoElement.stopTimestamp) html += ' - ' + secondsToTime(videoElement.stopTimestamp)\n\n      const timestamps = super.createEl('div', {\n        innerHTML: html,\n        className: 'timestamps'\n      })\n\n      infoBlock.append(timestamps)\n    }\n\n    li.append(thumbnail)\n    li.append(infoBlock)\n  }\n\n  private buildUnavailableVideo (li: HTMLElement) {\n    const block = super.createEl('div', {\n      className: 'item-unavailable',\n      innerHTML: this.player().localize('Unavailable video')\n    })\n\n    li.appendChild(block)\n  }\n\n  private handleKeyDown (event: KeyboardEvent) {\n    if (event.code === 'Space' || event.code === 'Enter') {\n      this.switchPlaylistItem()\n    }\n  }\n\n  private switchPlaylistItem () {\n    const options = this.options_ as PlaylistItemOptions\n\n    options.onClicked()\n  }\n}\n\nComponent.registerComponent('PlaylistMenuItem', PlaylistMenuItem)\n\nexport { PlaylistMenuItem }\n","import videojs from 'video.js'\nimport { VideoPlaylistElement } from '@shared/models'\nimport { PlaylistPluginOptions } from '../peertube-videojs-typings'\nimport { PlaylistMenuItem } from './playlist-menu-item'\n\nconst Component = videojs.getComponent('Component')\n\nclass PlaylistMenu extends Component {\n  private menuItems: PlaylistMenuItem[]\n\n  constructor (player: videojs.Player, options?: PlaylistPluginOptions) {\n    super(player, options as any)\n\n    const self = this\n\n    function userInactiveHandler () {\n      self.close()\n    }\n\n    this.el().addEventListener('mouseenter', () => {\n      this.player().off('userinactive', userInactiveHandler)\n    })\n\n    this.el().addEventListener('mouseleave', () => {\n      this.player().one('userinactive', userInactiveHandler)\n    })\n\n    this.player().on('click', event => {\n      let current = event.target as HTMLElement\n\n      do {\n        if (\n          current.classList.contains('vjs-playlist-menu') ||\n          current.classList.contains('vjs-playlist-button')\n        ) {\n          return\n        }\n\n        current = current.parentElement\n      } while (current)\n\n      this.close()\n    })\n  }\n\n  createEl () {\n    this.menuItems = []\n\n    const options = this.getOptions()\n\n    const menu = super.createEl('div', {\n      className: 'vjs-playlist-menu',\n      innerHTML: '',\n      tabIndex: -1\n    })\n\n    const header = super.createEl('div', {\n      className: 'header'\n    })\n\n    const headerLeft = super.createEl('div')\n\n    const leftTitle = super.createEl('div', {\n      innerHTML: options.playlist.displayName,\n      className: 'title'\n    })\n\n    const playlistChannel = options.playlist.videoChannel\n    const leftSubtitle = super.createEl('div', {\n      innerHTML: playlistChannel\n        ? this.player().localize('By {1}', [ playlistChannel.displayName ])\n        : '',\n      className: 'channel'\n    })\n\n    headerLeft.appendChild(leftTitle)\n    headerLeft.appendChild(leftSubtitle)\n\n    const tick = super.createEl('div', {\n      className: 'cross'\n    })\n    tick.addEventListener('click', () => this.close())\n\n    header.appendChild(headerLeft)\n    header.appendChild(tick)\n\n    const list = super.createEl('ol')\n\n    for (const playlistElement of options.elements) {\n      const item = new PlaylistMenuItem(this.player(), {\n        element: playlistElement,\n        onClicked: () => this.onItemClicked(playlistElement)\n      })\n\n      list.appendChild(item.el())\n\n      this.menuItems.push(item)\n    }\n\n    menu.appendChild(header)\n    menu.appendChild(list)\n\n    return menu\n  }\n\n  update () {\n    const options = this.getOptions()\n\n    this.updateSelected(options.getCurrentPosition())\n  }\n\n  open () {\n    this.player().addClass('playlist-menu-displayed')\n  }\n\n  close () {\n    this.player().removeClass('playlist-menu-displayed')\n  }\n\n  updateSelected (newPosition: number) {\n    for (const item of this.menuItems) {\n      item.setSelected(item.getElement().position === newPosition)\n    }\n  }\n\n  private getOptions () {\n    return this.options_ as PlaylistPluginOptions\n  }\n\n  private onItemClicked (element: VideoPlaylistElement) {\n    this.getOptions().onItemClicked(element)\n  }\n}\n\nComponent.registerComponent('PlaylistMenu', PlaylistMenu)\n\nexport { PlaylistMenu }\n","import videojs from 'video.js'\nimport { PlaylistPluginOptions } from '../peertube-videojs-typings'\nimport { PlaylistButton } from './playlist-button'\nimport { PlaylistMenu } from './playlist-menu'\n\nconst Plugin = videojs.getPlugin('plugin')\n\nclass PlaylistPlugin extends Plugin {\n  private playlistMenu: PlaylistMenu\n  private playlistButton: PlaylistButton\n  private options: PlaylistPluginOptions\n\n  constructor (player: videojs.Player, options?: PlaylistPluginOptions) {\n    super(player, options)\n\n    this.options = options\n\n    this.player.ready(() => {\n      player.addClass('vjs-playlist')\n    })\n\n    this.playlistMenu = new PlaylistMenu(player, options)\n    this.playlistButton = new PlaylistButton(player, Object.assign({}, options, { playlistMenu: this.playlistMenu }))\n\n    player.addChild(this.playlistMenu, options)\n    player.addChild(this.playlistButton, options)\n  }\n\n  updateSelected () {\n    this.playlistMenu.updateSelected(this.options.getCurrentPosition())\n  }\n}\n\nvideojs.registerPlugin('playlist', PlaylistPlugin)\nexport { PlaylistPlugin }\n","import videojs from 'video.js'\n\nfunction getMainTemplate (options: any) {\n  return `\n    <div class=\"vjs-upnext-top\">\n      <span class=\"vjs-upnext-headtext\">${options.headText}</span>\n      <div class=\"vjs-upnext-title\"></div>\n    </div>\n    <div class=\"vjs-upnext-autoplay-icon\">\n      <svg height=\"100%\" version=\"1.1\" viewbox=\"0 0 98 98\" width=\"100%\">\n        <circle class=\"vjs-upnext-svg-autoplay-circle\" cx=\"49\" cy=\"49\" fill=\"#000\" fill-opacity=\"0.8\" r=\"48\"></circle>\n        <circle class=\"vjs-upnext-svg-autoplay-ring\" cx=\"-49\" cy=\"49\" fill-opacity=\"0\" r=\"46.5\" stroke=\"#FFFFFF\" stroke-width=\"4\" transform=\"rotate(-90)\"></circle>\n        <polygon class=\"vjs-upnext-svg-autoplay-triangle\" fill=\"#fff\" points=\"32,27 72,49 32,71\"></polygon></svg>\n    </div>\n    <span class=\"vjs-upnext-bottom\">\n      <span class=\"vjs-upnext-cancel\">\n        <button class=\"vjs-upnext-cancel-button\" tabindex=\"0\" aria-label=\"Cancel autoplay\">${options.cancelText}</button>\n      </span>\n      <span class=\"vjs-upnext-suspended\">${options.suspendedText}</span>\n    </span>\n  `\n}\n\nexport interface EndCardOptions extends videojs.ComponentOptions {\n  next: Function,\n  getTitle: () => string\n  timeout: number\n  cancelText: string\n  headText: string\n  suspendedText: string\n  condition: () => boolean\n  suspended: () => boolean\n}\n\nconst Component = videojs.getComponent('Component')\nclass EndCard extends Component {\n  options_: EndCardOptions\n\n  dashOffsetTotal = 586\n  dashOffsetStart = 293\n  interval = 50\n  upNextEvents = new videojs.EventTarget()\n  ticks = 0\n  totalTicks: number\n\n  container: HTMLDivElement\n  title: HTMLElement\n  autoplayRing: HTMLElement\n  cancelButton: HTMLElement\n  suspendedMessage: HTMLElement\n  nextButton: HTMLElement\n\n  constructor (player: videojs.Player, options: EndCardOptions) {\n    super(player, options)\n\n    this.totalTicks = this.options_.timeout / this.interval\n\n    player.on('ended', (_: any) => {\n      if (!this.options_.condition()) return\n\n      player.addClass('vjs-upnext--showing')\n      this.showCard((canceled: boolean) => {\n        player.removeClass('vjs-upnext--showing')\n        this.container.style.display = 'none'\n        if (!canceled) {\n          this.options_.next()\n        }\n      })\n    })\n\n    player.on('playing', () => {\n      this.upNextEvents.trigger('playing')\n    })\n  }\n\n  createEl () {\n    const container = super.createEl('div', {\n      className: 'vjs-upnext-content',\n      innerHTML: getMainTemplate(this.options_)\n    }) as HTMLDivElement\n\n    this.container = container\n    container.style.display = 'none'\n\n    this.autoplayRing = container.getElementsByClassName('vjs-upnext-svg-autoplay-ring')[0] as HTMLElement\n    this.title = container.getElementsByClassName('vjs-upnext-title')[0] as HTMLElement\n    this.cancelButton = container.getElementsByClassName('vjs-upnext-cancel-button')[0] as HTMLElement\n    this.suspendedMessage = container.getElementsByClassName('vjs-upnext-suspended')[0] as HTMLElement\n    this.nextButton = container.getElementsByClassName('vjs-upnext-autoplay-icon')[0] as HTMLElement\n\n    this.cancelButton.onclick = () => {\n      this.upNextEvents.trigger('cancel')\n    }\n\n    this.nextButton.onclick = () => {\n      this.upNextEvents.trigger('next')\n    }\n\n    return container\n  }\n\n  showCard (cb: Function) {\n    let timeout: any\n\n    this.autoplayRing.setAttribute('stroke-dasharray', '' + this.dashOffsetStart)\n    this.autoplayRing.setAttribute('stroke-dashoffset', '' + -this.dashOffsetStart)\n\n    this.title.innerHTML = this.options_.getTitle()\n\n    this.upNextEvents.one('cancel', () => {\n      clearTimeout(timeout)\n      cb(true)\n    })\n\n    this.upNextEvents.one('playing', () => {\n      clearTimeout(timeout)\n      cb(true)\n    })\n\n    this.upNextEvents.one('next', () => {\n      clearTimeout(timeout)\n      cb(false)\n    })\n\n    const goToPercent = (percent: number) => {\n      const newOffset = Math.max(-this.dashOffsetTotal, - this.dashOffsetStart - percent * this.dashOffsetTotal / 2 / 100)\n      this.autoplayRing.setAttribute('stroke-dashoffset', '' + newOffset)\n    }\n\n    const tick = () => {\n      goToPercent((this.ticks++) * 100 / this.totalTicks)\n    }\n\n    const update = () => {\n      if (this.options_.suspended()) {\n        this.suspendedMessage.innerText = this.options_.suspendedText\n        goToPercent(0)\n        this.ticks = 0\n        timeout = setTimeout(update.bind(this), 300) // checks once supsended can be a bit longer\n      } else if (this.ticks >= this.totalTicks) {\n        clearTimeout(timeout)\n        cb(false)\n      } else {\n        this.suspendedMessage.innerText = ''\n        tick()\n        timeout = setTimeout(update.bind(this), this.interval)\n      }\n    }\n\n    this.container.style.display = 'block'\n    timeout = setTimeout(update.bind(this), this.interval)\n  }\n}\n\nvideojs.registerComponent('EndCard', EndCard)\n","import videojs from 'video.js'\nimport { EndCardOptions } from './end-card'\n\nconst Plugin = videojs.getPlugin('plugin')\n\nclass UpNextPlugin extends Plugin {\n\n  constructor (player: videojs.Player, options: Partial<EndCardOptions> = {}) {\n    const settings = {\n      next: options.next,\n      getTitle: options.getTitle,\n      timeout: options.timeout || 5000,\n      cancelText: options.cancelText || 'Cancel',\n      headText: options.headText || 'Up Next',\n      suspendedText: options.suspendedText || 'Autoplay is suspended',\n      condition: options.condition,\n      suspended: options.suspended\n    }\n\n    super(player)\n\n    this.player.ready(() => {\n      player.addClass('vjs-upnext')\n    })\n\n    player.addChild('EndCard', settings)\n  }\n}\n\nvideojs.registerPlugin('upnext', UpNextPlugin)\nexport { UpNextPlugin }\n","import { VideoFile } from '@shared/models'\nimport { escapeHTML } from '@shared/core-utils/renderer'\n\nfunction toTitleCase (str: string) {\n  return str.charAt(0).toUpperCase() + str.slice(1)\n}\n\nfunction isWebRTCDisabled () {\n  return !!((window as any).RTCPeerConnection || (window as any).mozRTCPeerConnection || (window as any).webkitRTCPeerConnection) === false\n}\n\nfunction isIOS () {\n  if (/iPad|iPhone|iPod/.test(navigator.platform)) {\n    return true\n  }\n\n  // Detect iPad Desktop mode\n  return !!(navigator.maxTouchPoints &&\n      navigator.maxTouchPoints > 2 &&\n      /MacIntel/.test(navigator.platform))\n}\n\nfunction isSafari () {\n  return /^((?!chrome|android).)*safari/i.test(navigator.userAgent)\n}\n\n// https://github.com/danrevah/ngx-pipes/blob/master/src/pipes/math/bytes.ts\n// Don't import all Angular stuff, just copy the code with shame\nconst dictionaryBytes: Array<{max: number, type: string}> = [\n  { max: 1024, type: 'B' },\n  { max: 1048576, type: 'KB' },\n  { max: 1073741824, type: 'MB' },\n  { max: 1.0995116e12, type: 'GB' }\n]\nfunction bytes (value: number) {\n  const format = dictionaryBytes.find(d => value < d.max) || dictionaryBytes[dictionaryBytes.length - 1]\n  const calc = Math.floor(value / (format.max / 1024)).toString()\n\n  return [ calc, format.type ]\n}\n\nfunction isMobile () {\n  return /iPhone|iPad|iPod|Android/i.test(navigator.userAgent)\n}\n\nfunction buildVideoLink (options: {\n  baseUrl?: string\n\n  startTime?: number\n  stopTime?: number\n\n  subtitle?: string\n\n  loop?: boolean\n  autoplay?: boolean\n  muted?: boolean\n\n  // Embed options\n  title?: boolean\n  warningTitle?: boolean\n  controls?: boolean\n  peertubeLink?: boolean\n} = {}) {\n  const { baseUrl } = options\n\n  const url = baseUrl\n    ? baseUrl\n    : window.location.origin + window.location.pathname.replace('/embed/', '/watch/')\n\n  const params = generateParams(window.location.search)\n\n  if (options.startTime !== undefined && options.startTime !== null) {\n    const startTimeInt = Math.floor(options.startTime)\n    params.set('start', secondsToTime(startTimeInt))\n  }\n\n  if (options.stopTime) {\n    const stopTimeInt = Math.floor(options.stopTime)\n    params.set('stop', secondsToTime(stopTimeInt))\n  }\n\n  if (options.subtitle) params.set('subtitle', options.subtitle)\n\n  if (options.loop === true) params.set('loop', '1')\n  if (options.autoplay === true) params.set('autoplay', '1')\n  if (options.muted === true) params.set('muted', '1')\n  if (options.title === false) params.set('title', '0')\n  if (options.warningTitle === false) params.set('warningTitle', '0')\n  if (options.controls === false) params.set('controls', '0')\n  if (options.peertubeLink === false) params.set('peertubeLink', '0')\n\n  return buildUrl(url, params)\n}\n\nfunction buildPlaylistLink (options: {\n  baseUrl?: string\n\n  playlistPosition: number\n}) {\n  const { baseUrl } = options\n\n  const url = baseUrl\n    ? baseUrl\n    : window.location.origin + window.location.pathname.replace('/video-playlists/embed/', '/videos/watch/playlist/')\n\n  const params = generateParams(window.location.search)\n\n  if (options.playlistPosition) params.set('playlistPosition', '' + options.playlistPosition)\n\n  return buildUrl(url, params)\n}\n\nfunction buildUrl (url: string, params: URLSearchParams) {\n  let hasParams = false\n  params.forEach(() => hasParams = true)\n\n  if (hasParams) return url + '?' + params.toString()\n\n  return url\n}\n\nfunction generateParams (url: string) {\n  const params = new URLSearchParams(window.location.search)\n  // Unused parameters in embed\n  params.delete('videoId')\n  params.delete('resume')\n\n  return params\n}\n\nfunction timeToInt (time: number | string) {\n  if (!time) return 0\n  if (typeof time === 'number') return time\n\n  const reg = /^((\\d+)[h:])?((\\d+)[m:])?((\\d+)s?)?$/\n  const matches = time.match(reg)\n\n  if (!matches) return 0\n\n  const hours = parseInt(matches[2] || '0', 10)\n  const minutes = parseInt(matches[4] || '0', 10)\n  const seconds = parseInt(matches[6] || '0', 10)\n\n  return hours * 3600 + minutes * 60 + seconds\n}\n\nfunction secondsToTime (seconds: number, full = false, symbol?: string) {\n  let time = ''\n\n  if (seconds === 0 && !full) return '0s'\n\n  const hourSymbol = (symbol || 'h')\n  const minuteSymbol = (symbol || 'm')\n  const secondsSymbol = full ? '' : 's'\n\n  const hours = Math.floor(seconds / 3600)\n  if (hours >= 1) time = hours + hourSymbol\n  else if (full) time = '0' + hourSymbol\n\n  seconds %= 3600\n  const minutes = Math.floor(seconds / 60)\n  if (minutes >= 1 && minutes < 10 && full) time += '0' + minutes + minuteSymbol\n  else if (minutes >= 1) time += minutes + minuteSymbol\n  else if (full) time += '00' + minuteSymbol\n\n  seconds %= 60\n  if (seconds >= 1 && seconds < 10 && full) time += '0' + seconds + secondsSymbol\n  else if (seconds >= 1) time += seconds + secondsSymbol\n  else if (full) time += '00'\n\n  return time\n}\n\nfunction buildVideoOrPlaylistEmbed (embedUrl: string, embedTitle: string) {\n  const title = escapeHTML(embedTitle)\n  return '<iframe width=\"560\" height=\"315\" ' +\n    'sandbox=\"allow-same-origin allow-scripts allow-popups\" ' +\n    'title=\"' + title + '\" ' +\n    'src=\"' + embedUrl + '\" ' +\n    'frameborder=\"0\" allowfullscreen>' +\n    '</iframe>'\n}\n\nfunction videoFileMaxByResolution (files: VideoFile[]) {\n  let max = files[0]\n\n  for (let i = 1; i < files.length; i++) {\n    const file = files[i]\n    if (max.resolution.id < file.resolution.id) max = file\n  }\n\n  return max\n}\n\nfunction videoFileMinByResolution (files: VideoFile[]) {\n  let min = files[0]\n\n  for (let i = 1; i < files.length; i++) {\n    const file = files[i]\n    if (min.resolution.id > file.resolution.id) min = file\n  }\n\n  return min\n}\n\nfunction getRtcConfig () {\n  return {\n    iceServers: [\n      {\n        urls: 'stun:stun.stunprotocol.org'\n      },\n      {\n        urls: 'stun:stun.framasoft.org'\n      }\n    ]\n  }\n}\n\n// ---------------------------------------------------------------------------\n\nexport {\n  getRtcConfig,\n  toTitleCase,\n  timeToInt,\n  secondsToTime,\n  isWebRTCDisabled,\n  buildPlaylistLink,\n  buildVideoLink,\n  buildVideoOrPlaylistEmbed,\n  videoFileMaxByResolution,\n  videoFileMinByResolution,\n  isMobile,\n  bytes,\n  isIOS,\n  isSafari\n}\n","import videojs from 'video.js'\nimport { NextPreviousVideoButtonOptions } from '../peertube-videojs-typings'\n\nconst Button = videojs.getComponent('Button')\n\nclass NextPreviousVideoButton extends Button {\n  private readonly nextPreviousVideoButtonOptions: NextPreviousVideoButtonOptions\n\n  constructor (player: videojs.Player, options?: NextPreviousVideoButtonOptions) {\n    super(player, options as any)\n\n    this.nextPreviousVideoButtonOptions = options\n\n    this.update()\n  }\n\n  createEl () {\n    const type = (this.options_ as NextPreviousVideoButtonOptions).type\n\n    const button = videojs.dom.createEl('button', {\n      className: 'vjs-' + type + '-video'\n    }) as HTMLButtonElement\n    const nextIcon = videojs.dom.createEl('span', {\n      className: 'icon icon-' + type\n    })\n    button.appendChild(nextIcon)\n\n    if (type === 'next') {\n      button.title = this.player_.localize('Next video')\n    } else {\n      button.title = this.player_.localize('Previous video')\n    }\n\n    return button\n  }\n\n  handleClick () {\n    this.nextPreviousVideoButtonOptions.handler()\n  }\n\n  update () {\n    const disabled = this.nextPreviousVideoButtonOptions.isDisabled()\n\n    if (disabled) this.addClass('vjs-disabled')\n    else this.removeClass('vjs-disabled')\n  }\n}\n\nvideojs.registerComponent('NextVideoButton', NextPreviousVideoButton)\nvideojs.registerComponent('PreviousVideoButton', NextPreviousVideoButton)\n","import { PlayerNetworkInfo } from '../peertube-videojs-typings'\nimport videojs from 'video.js'\nimport { bytes } from '../utils'\n\nconst Button = videojs.getComponent('Button')\nclass P2pInfoButton extends Button {\n\n  createEl () {\n    const div = videojs.dom.createEl('div', {\n      className: 'vjs-peertube'\n    })\n    const subDivWebtorrent = videojs.dom.createEl('div', {\n      className: 'vjs-peertube-hidden' // Hide the stats before we get the info\n    }) as HTMLDivElement\n    div.appendChild(subDivWebtorrent)\n\n    const downloadIcon = videojs.dom.createEl('span', {\n      className: 'icon icon-download'\n    })\n    subDivWebtorrent.appendChild(downloadIcon)\n\n    const downloadSpeedText = videojs.dom.createEl('span', {\n      className: 'download-speed-text'\n    })\n    const downloadSpeedNumber = videojs.dom.createEl('span', {\n      className: 'download-speed-number'\n    })\n    const downloadSpeedUnit = videojs.dom.createEl('span')\n    downloadSpeedText.appendChild(downloadSpeedNumber)\n    downloadSpeedText.appendChild(downloadSpeedUnit)\n    subDivWebtorrent.appendChild(downloadSpeedText)\n\n    const uploadIcon = videojs.dom.createEl('span', {\n      className: 'icon icon-upload'\n    })\n    subDivWebtorrent.appendChild(uploadIcon)\n\n    const uploadSpeedText = videojs.dom.createEl('span', {\n      className: 'upload-speed-text'\n    })\n    const uploadSpeedNumber = videojs.dom.createEl('span', {\n      className: 'upload-speed-number'\n    })\n    const uploadSpeedUnit = videojs.dom.createEl('span')\n    uploadSpeedText.appendChild(uploadSpeedNumber)\n    uploadSpeedText.appendChild(uploadSpeedUnit)\n    subDivWebtorrent.appendChild(uploadSpeedText)\n\n    const peersText = videojs.dom.createEl('span', {\n      className: 'peers-text'\n    })\n    const peersNumber = videojs.dom.createEl('span', {\n      className: 'peers-number'\n    })\n    subDivWebtorrent.appendChild(peersNumber)\n    subDivWebtorrent.appendChild(peersText)\n\n    const subDivHttp = videojs.dom.createEl('div', {\n      className: 'vjs-peertube-hidden'\n    })\n    const subDivHttpText = videojs.dom.createEl('span', {\n      className: 'http-fallback',\n      textContent: 'HTTP'\n    })\n\n    subDivHttp.appendChild(subDivHttpText)\n    div.appendChild(subDivHttp)\n\n    this.player_.on('p2pInfo', (event: any, data: PlayerNetworkInfo) => {\n      // We are in HTTP fallback\n      if (!data) {\n        subDivHttp.className = 'vjs-peertube-displayed'\n        subDivWebtorrent.className = 'vjs-peertube-hidden'\n\n        return\n      }\n\n      const p2pStats = data.p2p\n      const httpStats = data.http\n\n      const downloadSpeed = bytes(p2pStats.downloadSpeed + httpStats.downloadSpeed)\n      const uploadSpeed = bytes(p2pStats.uploadSpeed + httpStats.uploadSpeed)\n      const totalDownloaded = bytes(p2pStats.downloaded + httpStats.downloaded)\n      const totalUploaded = bytes(p2pStats.uploaded + httpStats.uploaded)\n      const numPeers = p2pStats.numPeers\n\n      subDivWebtorrent.title = this.player().localize('Total downloaded: ') + totalDownloaded.join(' ') + '\\n'\n\n      if (data.source === 'p2p-media-loader') {\n        const downloadedFromServer = bytes(httpStats.downloaded).join(' ')\n        const downloadedFromPeers = bytes(p2pStats.downloaded).join(' ')\n\n        subDivWebtorrent.title +=\n          ' * ' + this.player().localize('From servers: ') + downloadedFromServer + '\\n' +\n          ' * ' + this.player().localize('From peers: ') + downloadedFromPeers + '\\n'\n      }\n      subDivWebtorrent.title += this.player().localize('Total uploaded: ') + totalUploaded.join(' ')\n\n      downloadSpeedNumber.textContent = downloadSpeed[ 0 ]\n      downloadSpeedUnit.textContent = ' ' + downloadSpeed[ 1 ]\n\n      uploadSpeedNumber.textContent = uploadSpeed[ 0 ]\n      uploadSpeedUnit.textContent = ' ' + uploadSpeed[ 1 ]\n\n      peersNumber.textContent = numPeers.toString()\n      peersText.textContent = ' ' + (numPeers > 1 ? this.player().localize('peers') : this.player_.localize('peer'))\n\n      subDivHttp.className = 'vjs-peertube-hidden'\n      subDivWebtorrent.className = 'vjs-peertube-displayed'\n    })\n\n    return div as HTMLButtonElement\n  }\n}\n\nvideojs.registerComponent('P2PInfoButton', P2pInfoButton)\n","import { buildVideoLink } from '../utils'\nimport videojs from 'video.js'\n\nconst Button = videojs.getComponent('Button')\nclass PeerTubeLinkButton extends Button {\n\n  constructor (player: videojs.Player, options?: videojs.ComponentOptions) {\n    super(player, options)\n  }\n\n  createEl () {\n    return this.buildElement()\n  }\n\n  updateHref () {\n    this.el().setAttribute('href', buildVideoLink({ startTime: this.player().currentTime() }))\n  }\n\n  handleClick () {\n    this.player().pause()\n  }\n\n  private buildElement () {\n    const el = videojs.dom.createEl('a', {\n      href: buildVideoLink(),\n      innerHTML: 'PeerTube',\n      title: this.player().localize('Video page (new window)'),\n      className: 'vjs-peertube-link',\n      target: '_blank'\n    })\n\n    el.addEventListener('mouseenter', () => this.updateHref())\n\n    return el as HTMLButtonElement\n  }\n}\n\nvideojs.registerComponent('PeerTubeLinkButton', PeerTubeLinkButton)\n","import videojs from 'video.js'\n\nconst Component = videojs.getComponent('Component')\n\nclass PeerTubeLoadProgressBar extends Component {\n\n  constructor (player: videojs.Player, options?: videojs.ComponentOptions) {\n    super(player, options)\n\n    this.on(player, 'progress', this.update)\n  }\n\n  createEl () {\n    return super.createEl('div', {\n      className: 'vjs-load-progress',\n      innerHTML: `<span class=\"vjs-control-text\"><span>${this.localize('Loaded')}</span>: 0%</span>`\n    })\n  }\n\n  dispose () {\n    super.dispose()\n  }\n\n  update () {\n    const torrent = this.player().webtorrent().getTorrent()\n    if (!torrent) return\n\n    // FIXME: typings\n    (this.el() as HTMLElement).style.width = (torrent.progress * 100) + '%'\n  }\n\n}\n\nComponent.registerComponent('PeerTubeLoadProgressBar', PeerTubeLoadProgressBar)\n","import videojs from 'video.js'\n\nimport { LoadedQualityData } from '../peertube-videojs-typings'\nimport { ResolutionMenuItem } from './resolution-menu-item'\n\nconst Menu = videojs.getComponent('Menu')\nconst MenuButton = videojs.getComponent('MenuButton')\nclass ResolutionMenuButton extends MenuButton {\n  labelEl_: HTMLElement\n\n  constructor (player: videojs.Player, options?: videojs.MenuButtonOptions) {\n    super(player, options)\n\n    this.controlText('Quality')\n\n    player.tech(true).on('loadedqualitydata', (e: any, data: any) => this.buildQualities(data))\n\n    player.peertube().on('resolutionChange', () => setTimeout(() => this.trigger('updateLabel'), 0))\n  }\n\n  createEl () {\n    const el = super.createEl()\n\n    this.labelEl_ = videojs.dom.createEl('div', {\n      className: 'vjs-resolution-value'\n    }) as HTMLElement\n\n    el.appendChild(this.labelEl_)\n\n    return el\n  }\n\n  updateARIAAttributes () {\n    this.el().setAttribute('aria-label', 'Quality')\n  }\n\n  createMenu () {\n    return new Menu(this.player_)\n  }\n\n  buildCSSClass () {\n    return super.buildCSSClass() + ' vjs-resolution-button'\n  }\n\n  buildWrapperCSSClass () {\n    return 'vjs-resolution-control ' + super.buildWrapperCSSClass()\n  }\n\n  private addClickListener (component: any) {\n    component.on('click', () => {\n      const children = this.menu.children()\n\n      for (const child of children) {\n        if (component !== child) {\n          (child as videojs.MenuItem).selected(false)\n        }\n      }\n    })\n  }\n\n  private buildQualities (data: LoadedQualityData) {\n    // The automatic resolution item will need other labels\n    const labels: { [ id: number ]: string } = {}\n\n    data.qualityData.video.sort((a, b) => {\n      if (a.id > b.id) return -1\n      if (a.id === b.id) return 0\n      return 1\n    })\n\n    for (const d of data.qualityData.video) {\n      // Skip auto resolution, we'll add it ourselves\n      if (d.id === -1) continue\n\n      const label = d.label === '0p'\n        ? this.player().localize('Audio-only')\n        : d.label\n\n      this.menu.addChild(new ResolutionMenuItem(\n        this.player_,\n        {\n          id: d.id,\n          label,\n          selected: d.selected,\n          callback: data.qualitySwitchCallback\n        })\n      )\n\n      labels[d.id] = d.label\n    }\n\n    this.menu.addChild(new ResolutionMenuItem(\n      this.player_,\n      {\n        id: -1,\n        label: this.player_.localize('Auto'),\n        labels,\n        callback: data.qualitySwitchCallback,\n        selected: true // By default, in auto mode\n      }\n    ))\n\n    for (const m of this.menu.children()) {\n      this.addClickListener(m)\n    }\n\n    this.trigger('menuChanged')\n  }\n}\n\nvideojs.registerComponent('ResolutionMenuButton', ResolutionMenuButton)\n","import videojs from 'video.js'\nimport { AutoResolutionUpdateData, ResolutionUpdateData } from '../peertube-videojs-typings'\n\nconst MenuItem = videojs.getComponent('MenuItem')\n\nexport interface ResolutionMenuItemOptions extends videojs.MenuItemOptions {\n  labels?: { [id: number]: string }\n  id: number\n  callback: Function\n}\n\nclass ResolutionMenuItem extends MenuItem {\n  private readonly resolutionId: number\n  private readonly label: string\n  // Only used for the automatic item\n  private readonly labels: { [id: number]: string }\n  private readonly callback: Function\n\n  private autoResolutionPossible: boolean\n  private currentResolutionLabel: string\n\n  constructor (player: videojs.Player, options?: ResolutionMenuItemOptions) {\n    options.selectable = true\n\n    super(player, options)\n\n    this.autoResolutionPossible = true\n    this.currentResolutionLabel = ''\n\n    this.resolutionId = options.id\n    this.label = options.label\n    this.labels = options.labels\n    this.callback = options.callback\n\n    player.peertube().on('resolutionChange', (_: any, data: ResolutionUpdateData) => this.updateSelection(data))\n\n    // We only want to disable the \"Auto\" item\n    if (this.resolutionId === -1) {\n      player.peertube().on('autoResolutionChange', (_: any, data: AutoResolutionUpdateData) => this.updateAutoResolution(data))\n    }\n  }\n\n  handleClick (event: any) {\n    // Auto button disabled?\n    if (this.autoResolutionPossible === false && this.resolutionId === -1) return\n\n    super.handleClick(event)\n\n    this.callback(this.resolutionId, 'video')\n  }\n\n  updateSelection (data: ResolutionUpdateData) {\n    if (this.resolutionId === -1) {\n      this.currentResolutionLabel = this.labels[data.id]\n    }\n\n    // Automatic resolution only\n    if (data.auto === true) {\n      this.selected(this.resolutionId === -1)\n      return\n    }\n\n    this.selected(this.resolutionId === data.id)\n  }\n\n  updateAutoResolution (data: AutoResolutionUpdateData) {\n    // Check if the auto resolution is enabled or not\n    if (data.possible === false) {\n      this.addClass('disabled')\n    } else {\n      this.removeClass('disabled')\n    }\n\n    this.autoResolutionPossible = data.possible\n  }\n\n  getLabel () {\n    if (this.resolutionId === -1) {\n      return this.label + ' <small>' + this.currentResolutionLabel + '</small>'\n    }\n\n    return this.label\n  }\n}\nvideojs.registerComponent('ResolutionMenuItem', ResolutionMenuItem)\n\nexport { ResolutionMenuItem }\n","import videojs from 'video.js'\n\nconst Component = videojs.getComponent('Component')\n\nclass SettingsDialog extends Component {\n  constructor (player: videojs.Player) {\n    super(player)\n\n    this.hide()\n  }\n\n  /**\n   * Create the component's DOM element\n   *\n   * @return {Element}\n   * @method createEl\n   */\n  createEl () {\n    const uniqueId = this.id()\n    const dialogLabelId = 'TTsettingsDialogLabel-' + uniqueId\n    const dialogDescriptionId = 'TTsettingsDialogDescription-' + uniqueId\n\n    return super.createEl('div', {\n      className: 'vjs-settings-dialog vjs-modal-overlay',\n      innerHTML: '',\n      tabIndex: -1\n    }, {\n      'role': 'dialog',\n      'aria-labelledby': dialogLabelId,\n      'aria-describedby': dialogDescriptionId\n    })\n  }\n}\n\nComponent.registerComponent('SettingsDialog', SettingsDialog)\n\nexport { SettingsDialog }\n","// Thanks to Yanko Shterev: https://github.com/yshterev/videojs-settings-menu\nimport { SettingsMenuItem } from './settings-menu-item'\nimport { toTitleCase } from '../utils'\nimport videojs from 'video.js'\n\nimport { SettingsDialog } from './settings-dialog'\nimport { SettingsPanel } from './settings-panel'\nimport { SettingsPanelChild } from './settings-panel-child'\n\nconst Button = videojs.getComponent('Button')\nconst Menu = videojs.getComponent('Menu')\nconst Component = videojs.getComponent('Component')\n\nexport interface SettingsButtonOptions extends videojs.ComponentOptions {\n  entries: any[]\n  setup?: {\n    maxHeightOffset: number\n  }\n}\n\nclass SettingsButton extends Button {\n  dialog: SettingsDialog\n  dialogEl: HTMLElement\n  menu: videojs.Menu\n  panel: SettingsPanel\n  panelChild: SettingsPanelChild\n\n  addSettingsItemHandler: typeof SettingsButton.prototype.onAddSettingsItem\n  disposeSettingsItemHandler: typeof SettingsButton.prototype.onDisposeSettingsItem\n  playerClickHandler: typeof SettingsButton.prototype.onPlayerClick\n  userInactiveHandler: typeof SettingsButton.prototype.onUserInactive\n\n  private settingsButtonOptions: SettingsButtonOptions\n\n  constructor (player: videojs.Player, options?: SettingsButtonOptions) {\n    super(player, options)\n\n    this.settingsButtonOptions = options\n\n    this.controlText('Settings')\n\n    this.dialog = this.player().addChild('settingsDialog')\n    this.dialogEl = this.dialog.el() as HTMLElement\n    this.menu = null\n    this.panel = this.dialog.addChild('settingsPanel')\n    this.panelChild = this.panel.addChild('settingsPanelChild')\n\n    this.addClass('vjs-settings')\n    this.el().setAttribute('aria-label', 'Settings Button')\n\n    // Event handlers\n    this.addSettingsItemHandler = this.onAddSettingsItem.bind(this)\n    this.disposeSettingsItemHandler = this.onDisposeSettingsItem.bind(this)\n    this.playerClickHandler = this.onPlayerClick.bind(this)\n    this.userInactiveHandler = this.onUserInactive.bind(this)\n\n    this.buildMenu()\n    this.bindEvents()\n\n    // Prepare the dialog\n    this.player().one('play', () => this.hideDialog())\n  }\n\n  onPlayerClick (event: MouseEvent) {\n    const element = event.target as HTMLElement\n    if (element.classList.contains('vjs-settings') || element.parentElement.classList.contains('vjs-settings')) {\n      return\n    }\n\n    if (!this.dialog.hasClass('vjs-hidden')) {\n      this.hideDialog()\n    }\n  }\n\n  onDisposeSettingsItem (event: any, name: string) {\n    if (name === undefined) {\n      const children = this.menu.children()\n\n      while (children.length > 0) {\n        children[0].dispose()\n        this.menu.removeChild(children[0])\n      }\n\n      this.addClass('vjs-hidden')\n    } else {\n      const item = this.menu.getChild(name)\n\n      if (item) {\n        item.dispose()\n        this.menu.removeChild(item)\n      }\n    }\n\n    this.hideDialog()\n\n    if (this.settingsButtonOptions.entries.length === 0) {\n      this.addClass('vjs-hidden')\n    }\n  }\n\n  onAddSettingsItem (event: any, data: any) {\n    const [ entry, options ] = data\n\n    this.addMenuItem(entry, options)\n    this.removeClass('vjs-hidden')\n  }\n\n  onUserInactive () {\n    if (!this.dialog.hasClass('vjs-hidden')) {\n      this.hideDialog()\n    }\n  }\n\n  bindEvents () {\n    this.player().on('click', this.playerClickHandler)\n    this.player().on('addsettingsitem', this.addSettingsItemHandler)\n    this.player().on('disposesettingsitem', this.disposeSettingsItemHandler)\n    this.player().on('userinactive', this.userInactiveHandler)\n  }\n\n  buildCSSClass () {\n    return `vjs-icon-settings ${super.buildCSSClass()}`\n  }\n\n  handleClick () {\n    if (this.dialog.hasClass('vjs-hidden')) {\n      this.showDialog()\n    } else {\n      this.hideDialog()\n    }\n  }\n\n  showDialog () {\n    this.player().peertube().onMenuOpen();\n\n    (this.menu.el() as HTMLElement).style.opacity = '1'\n    this.dialog.show()\n\n    this.setDialogSize(this.getComponentSize(this.menu))\n  }\n\n  hideDialog () {\n    this.player_.peertube().onMenuClosed()\n\n    this.dialog.hide()\n    this.setDialogSize(this.getComponentSize(this.menu));\n    (this.menu.el() as HTMLElement).style.opacity = '1'\n    this.resetChildren()\n  }\n\n  getComponentSize (element: videojs.Component | HTMLElement) {\n    let width: number = null\n    let height: number = null\n\n    // Could be component or just DOM element\n    if (element instanceof Component) {\n      const el = element.el() as HTMLElement\n\n      width = el.offsetWidth\n      height = el.offsetHeight;\n\n      (element as any).width = width;\n      (element as any).height = height\n    } else {\n      width = element.offsetWidth\n      height = element.offsetHeight\n    }\n\n    return [ width, height ]\n  }\n\n  setDialogSize ([ width, height ]: number[]) {\n    if (typeof height !== 'number') {\n      return\n    }\n\n    const offset = this.settingsButtonOptions.setup.maxHeightOffset\n    const maxHeight = (this.player().el() as HTMLElement).offsetHeight - offset // FIXME: typings\n\n    const panelEl = this.panel.el() as HTMLElement\n\n    if (height > maxHeight) {\n      height = maxHeight\n      width += 17\n      panelEl.style.maxHeight = `${height}px`\n    } else if (panelEl.style.maxHeight !== '') {\n      panelEl.style.maxHeight = ''\n    }\n\n    this.dialogEl.style.width = `${width}px`\n    this.dialogEl.style.height = `${height}px`\n  }\n\n  buildMenu () {\n    this.menu = new Menu(this.player())\n    this.menu.addClass('vjs-main-menu')\n    const entries = this.settingsButtonOptions.entries\n\n    if (entries.length === 0) {\n      this.addClass('vjs-hidden')\n      this.panelChild.addChild(this.menu)\n      return\n    }\n\n    for (const entry of entries) {\n      this.addMenuItem(entry, this.settingsButtonOptions)\n    }\n\n    this.panelChild.addChild(this.menu)\n  }\n\n  addMenuItem (entry: any, options: any) {\n    const openSubMenu = function (this: any) {\n      if (videojs.dom.hasClass(this.el_, 'open')) {\n        videojs.dom.removeClass(this.el_, 'open')\n      } else {\n        videojs.dom.addClass(this.el_, 'open')\n      }\n    }\n\n    options.name = toTitleCase(entry)\n\n    const newOptions = Object.assign({}, options, { entry, menuButton: this })\n    const settingsMenuItem = new SettingsMenuItem(this.player(), newOptions)\n\n    this.menu.addChild(settingsMenuItem)\n\n    // Hide children to avoid sub menus stacking on top of each other\n    // or having multiple menus open\n    settingsMenuItem.on('click', videojs.bind(this, this.hideChildren))\n\n    // Whether to add or remove selected class on the settings sub menu element\n    settingsMenuItem.on('click', openSubMenu)\n  }\n\n  resetChildren () {\n    for (const menuChild of this.menu.children()) {\n      (menuChild as SettingsMenuItem).reset()\n    }\n  }\n\n  /**\n   * Hide all the sub menus\n   */\n  hideChildren () {\n    for (const menuChild of this.menu.children()) {\n      (menuChild as SettingsMenuItem).hideSubMenu()\n    }\n  }\n\n}\n\nComponent.registerComponent('SettingsButton', SettingsButton)\n\nexport { SettingsButton }\n","// Thanks to Yanko Shterev: https://github.com/yshterev/videojs-settings-menu\nimport { toTitleCase } from '../utils'\nimport videojs from 'video.js'\nimport { SettingsButton } from './settings-menu-button'\nimport { SettingsDialog } from './settings-dialog'\nimport { SettingsPanel } from './settings-panel'\nimport { SettingsPanelChild } from './settings-panel-child'\n\nconst MenuItem = videojs.getComponent('MenuItem')\nconst component = videojs.getComponent('Component')\n\nexport interface SettingsMenuItemOptions extends videojs.MenuItemOptions {\n  entry: string\n  menuButton: SettingsButton\n}\n\nclass SettingsMenuItem extends MenuItem {\n  settingsButton: SettingsButton\n  dialog: SettingsDialog\n  mainMenu: videojs.Menu\n  panel: SettingsPanel\n  panelChild: SettingsPanelChild\n  panelChildEl: HTMLElement\n  size: number[]\n  menuToLoad: string\n  subMenu: SettingsButton\n\n  submenuClickHandler: typeof SettingsMenuItem.prototype.onSubmenuClick\n  transitionEndHandler: typeof SettingsMenuItem.prototype.onTransitionEnd\n\n  settingsSubMenuTitleEl_: HTMLElement\n  settingsSubMenuValueEl_: HTMLElement\n  settingsSubMenuEl_: HTMLElement\n\n  constructor (player: videojs.Player, options?: SettingsMenuItemOptions) {\n    super(player, options)\n\n    this.settingsButton = options.menuButton\n    this.dialog = this.settingsButton.dialog\n    this.mainMenu = this.settingsButton.menu\n    this.panel = this.dialog.getChild('settingsPanel')\n    this.panelChild = this.panel.getChild('settingsPanelChild')\n    this.panelChildEl = this.panelChild.el() as HTMLElement\n\n    this.size = null\n\n    // keep state of what menu type is loading next\n    this.menuToLoad = 'mainmenu'\n\n    const subMenuName = toTitleCase(options.entry)\n    const SubMenuComponent = videojs.getComponent(subMenuName)\n\n    if (!SubMenuComponent) {\n      throw new Error(`Component ${subMenuName} does not exist`)\n    }\n\n    const newOptions = Object.assign({}, options, { entry: options.menuButton, menuButton: this })\n\n    this.subMenu = new SubMenuComponent(this.player(), newOptions) as any // FIXME: typings\n    const subMenuClass = this.subMenu.buildCSSClass().split(' ')[ 0 ]\n    this.settingsSubMenuEl_.className += ' ' + subMenuClass\n\n    this.eventHandlers()\n\n    player.ready(() => {\n      // Voodoo magic for IOS\n      setTimeout(() => {\n        // Player was destroyed\n        if (!this.player_) return\n\n        this.build()\n\n        // Update on rate change\n        player.on('ratechange', this.submenuClickHandler)\n\n        if (subMenuName === 'CaptionsButton') {\n          // Hack to regenerate captions on HTTP fallback\n          player.on('captionsChanged', () => {\n            setTimeout(() => {\n              this.settingsSubMenuEl_.innerHTML = ''\n              this.settingsSubMenuEl_.appendChild(this.subMenu.menu.el())\n              this.update()\n              this.bindClickEvents()\n            }, 0)\n          })\n        }\n\n        this.reset()\n      }, 0)\n    })\n  }\n\n  eventHandlers () {\n    this.submenuClickHandler = this.onSubmenuClick.bind(this)\n    this.transitionEndHandler = this.onTransitionEnd.bind(this)\n  }\n\n  onSubmenuClick (event: any) {\n    let target = null\n\n    if (event.type === 'tap') {\n      target = event.target\n    } else {\n      target = event.currentTarget\n    }\n\n    if (target && target.classList.contains('vjs-back-button')) {\n      this.loadMainMenu()\n      return\n    }\n\n    // To update the sub menu value on click, setTimeout is needed because\n    // updating the value is not instant\n    setTimeout(() => this.update(event), 0)\n\n    // Seems like videojs adds a vjs-hidden class on the caption menu after a click\n    // We don't need it\n    this.subMenu.menu.removeClass('vjs-hidden')\n  }\n\n  /**\n   * Create the component's DOM element\n   *\n   * @return {Element}\n   * @method createEl\n   */\n  createEl () {\n    const el = videojs.dom.createEl('li', {\n      className: 'vjs-menu-item'\n    })\n\n    this.settingsSubMenuTitleEl_ = videojs.dom.createEl('div', {\n      className: 'vjs-settings-sub-menu-title'\n    }) as HTMLElement\n\n    el.appendChild(this.settingsSubMenuTitleEl_)\n\n    this.settingsSubMenuValueEl_ = videojs.dom.createEl('div', {\n      className: 'vjs-settings-sub-menu-value'\n    }) as HTMLElement\n\n    el.appendChild(this.settingsSubMenuValueEl_)\n\n    this.settingsSubMenuEl_ = videojs.dom.createEl('div', {\n      className: 'vjs-settings-sub-menu'\n    }) as HTMLElement\n\n    return el as HTMLLIElement\n  }\n\n  /**\n   * Handle click on menu item\n   *\n   * @method handleClick\n   */\n  handleClick (event: videojs.EventTarget.Event) {\n    this.menuToLoad = 'submenu'\n    // Remove open class to ensure only the open submenu gets this class\n    videojs.dom.removeClass(this.el(), 'open')\n\n    super.handleClick(event);\n\n    (this.mainMenu.el() as HTMLElement).style.opacity = '0'\n    // Whether to add or remove vjs-hidden class on the settingsSubMenuEl element\n    if (videojs.dom.hasClass(this.settingsSubMenuEl_, 'vjs-hidden')) {\n      videojs.dom.removeClass(this.settingsSubMenuEl_, 'vjs-hidden')\n\n      // animation not played without timeout\n      setTimeout(() => {\n        this.settingsSubMenuEl_.style.opacity = '1'\n        this.settingsSubMenuEl_.style.marginRight = '0px'\n      }, 0)\n\n      this.settingsButton.setDialogSize(this.size)\n    } else {\n      videojs.dom.addClass(this.settingsSubMenuEl_, 'vjs-hidden')\n    }\n  }\n\n  /**\n   * Create back button\n   *\n   * @method createBackButton\n   */\n  createBackButton () {\n    const button = this.subMenu.menu.addChild('MenuItem', {}, 0)\n\n    button.addClass('vjs-back-button');\n    (button.el() as HTMLElement).innerHTML = this.player().localize(this.subMenu.controlText())\n  }\n\n  /**\n   * Add/remove prefixed event listener for CSS Transition\n   *\n   * @method PrefixedEvent\n   */\n  PrefixedEvent (element: any, type: any, callback: any, action = 'addEvent') {\n    const prefix = [ 'webkit', 'moz', 'MS', 'o', '' ]\n\n    for (let p = 0; p < prefix.length; p++) {\n      if (!prefix[ p ]) {\n        type = type.toLowerCase()\n      }\n\n      if (action === 'addEvent') {\n        element.addEventListener(prefix[ p ] + type, callback, false)\n      } else if (action === 'removeEvent') {\n        element.removeEventListener(prefix[ p ] + type, callback, false)\n      }\n    }\n  }\n\n  onTransitionEnd (event: any) {\n    if (event.propertyName !== 'margin-right') {\n      return\n    }\n\n    if (this.menuToLoad === 'mainmenu') {\n      // hide submenu\n      videojs.dom.addClass(this.settingsSubMenuEl_, 'vjs-hidden')\n\n      // reset opacity to 0\n      this.settingsSubMenuEl_.style.opacity = '0'\n    }\n  }\n\n  reset () {\n    videojs.dom.addClass(this.settingsSubMenuEl_, 'vjs-hidden')\n    this.settingsSubMenuEl_.style.opacity = '0'\n    this.setMargin()\n  }\n\n  loadMainMenu () {\n    const mainMenuEl = this.mainMenu.el() as HTMLElement\n    this.menuToLoad = 'mainmenu'\n    this.mainMenu.show()\n    mainMenuEl.style.opacity = '0'\n\n    // back button will always take you to main menu, so set dialog sizes\n    const mainMenuAny = this.mainMenu as any\n    this.settingsButton.setDialogSize([ mainMenuAny.width, mainMenuAny.height ])\n\n    // animation not triggered without timeout (some async stuff ?!?)\n    setTimeout(() => {\n      // animate margin and opacity before hiding the submenu\n      // this triggers CSS Transition event\n      this.setMargin()\n      mainMenuEl.style.opacity = '1'\n    }, 0)\n  }\n\n  build () {\n    this.subMenu.on('updateLabel', () => {\n      this.update()\n    })\n    this.subMenu.on('menuChanged', () => {\n      this.bindClickEvents()\n      this.setSize()\n      this.update()\n    })\n\n    this.settingsSubMenuTitleEl_.innerHTML = this.player().localize(this.subMenu.controlText())\n    this.settingsSubMenuEl_.appendChild(this.subMenu.menu.el())\n    this.panelChildEl.appendChild(this.settingsSubMenuEl_)\n    this.update()\n\n    this.createBackButton()\n    this.setSize()\n    this.bindClickEvents()\n\n    // prefixed event listeners for CSS TransitionEnd\n    this.PrefixedEvent(\n      this.settingsSubMenuEl_,\n      'TransitionEnd',\n      this.transitionEndHandler,\n      'addEvent'\n    )\n  }\n\n  update (event?: any) {\n    let target: HTMLElement = null\n    const subMenu = this.subMenu.name()\n\n    if (event && event.type === 'tap') {\n      target = event.target\n    } else if (event) {\n      target = event.currentTarget\n    }\n\n    // Playback rate menu button doesn't get a vjs-selected class\n    // or sets options_['selected'] on the selected playback rate.\n    // Thus we get the submenu value based on the labelEl of playbackRateMenuButton\n    if (subMenu === 'PlaybackRateMenuButton') {\n      const html = (this.subMenu as any).labelEl_.innerHTML\n      setTimeout(() => this.settingsSubMenuValueEl_.innerHTML = html, 250)\n    } else {\n      // Loop trough the submenu items to find the selected child\n      for (const subMenuItem of this.subMenu.menu.children_) {\n        if (!(subMenuItem instanceof component)) {\n          continue\n        }\n\n        if (subMenuItem.hasClass('vjs-selected')) {\n          const subMenuItemUntyped = subMenuItem as any\n\n          // Prefer to use the function\n          if (typeof subMenuItemUntyped.getLabel === 'function') {\n            this.settingsSubMenuValueEl_.innerHTML = subMenuItemUntyped.getLabel()\n            break\n          }\n\n          this.settingsSubMenuValueEl_.innerHTML = subMenuItemUntyped.options_.label\n        }\n      }\n    }\n\n    if (target && !target.classList.contains('vjs-back-button')) {\n      this.settingsButton.hideDialog()\n    }\n  }\n\n  bindClickEvents () {\n    for (const item of this.subMenu.menu.children()) {\n      if (!(item instanceof component)) {\n        continue\n      }\n      item.on([ 'tap', 'click' ], this.submenuClickHandler)\n    }\n  }\n\n  // save size of submenus on first init\n  // if number of submenu items change dynamically more logic will be needed\n  setSize () {\n    this.dialog.removeClass('vjs-hidden')\n    videojs.dom.removeClass(this.settingsSubMenuEl_, 'vjs-hidden')\n    this.size = this.settingsButton.getComponentSize(this.settingsSubMenuEl_)\n    this.setMargin()\n    this.dialog.addClass('vjs-hidden')\n    videojs.dom.addClass(this.settingsSubMenuEl_, 'vjs-hidden')\n  }\n\n  setMargin () {\n    if (!this.size) return\n\n    const [ width ] = this.size\n\n    this.settingsSubMenuEl_.style.marginRight = `-${width}px`\n  }\n\n  /**\n   * Hide the sub menu\n   */\n  hideSubMenu () {\n    // after removing settings item this.el_ === null\n    if (!this.el()) {\n      return\n    }\n\n    if (videojs.dom.hasClass(this.el(), 'open')) {\n      videojs.dom.addClass(this.settingsSubMenuEl_, 'vjs-hidden')\n      videojs.dom.removeClass(this.el(), 'open')\n    }\n  }\n\n}\n\n(SettingsMenuItem as any).prototype.contentElType = 'button'\nvideojs.registerComponent('SettingsMenuItem', SettingsMenuItem)\n\nexport { SettingsMenuItem }\n","import videojs from 'video.js'\n\nconst Component = videojs.getComponent('Component')\n\nclass SettingsPanelChild extends Component {\n\n  constructor (player: videojs.Player, options?: videojs.ComponentOptions) {\n    super(player, options)\n  }\n\n  createEl () {\n    return super.createEl('div', {\n      className: 'vjs-settings-panel-child',\n      innerHTML: '',\n      tabIndex: -1\n    })\n  }\n}\n\nComponent.registerComponent('SettingsPanelChild', SettingsPanelChild)\n\nexport { SettingsPanelChild }\n","import videojs from 'video.js'\n\nconst Component = videojs.getComponent('Component')\n\nclass SettingsPanel extends Component {\n\n  constructor (player: videojs.Player, options?: videojs.ComponentOptions) {\n    super(player, options)\n  }\n\n  createEl () {\n    return super.createEl('div', {\n      className: 'vjs-settings-panel',\n      innerHTML: '',\n      tabIndex: -1\n    })\n  }\n}\n\nComponent.registerComponent('SettingsPanel', SettingsPanel)\n\nexport { SettingsPanel }\n","import videojs from 'video.js'\nimport { saveTheaterInStore, getStoredTheater } from '../peertube-player-local-storage'\n\nconst Button = videojs.getComponent('Button')\nclass TheaterButton extends Button {\n\n  private static readonly THEATER_MODE_CLASS = 'vjs-theater-enabled'\n\n  constructor (player: videojs.Player, options: videojs.ComponentOptions) {\n    super(player, options)\n\n    const enabled = getStoredTheater()\n    if (enabled === true) {\n      this.player().addClass(TheaterButton.THEATER_MODE_CLASS)\n\n      this.handleTheaterChange()\n    }\n\n    this.controlText('Theater mode')\n\n    this.player().theaterEnabled = enabled\n  }\n\n  buildCSSClass () {\n    return `vjs-theater-control ${super.buildCSSClass()}`\n  }\n\n  handleTheaterChange () {\n    const theaterEnabled = this.isTheaterEnabled()\n\n    if (theaterEnabled) {\n      this.controlText('Normal mode')\n    } else {\n      this.controlText('Theater mode')\n    }\n\n    saveTheaterInStore(theaterEnabled)\n\n    this.player_.trigger('theaterChange', theaterEnabled)\n  }\n\n  handleClick () {\n    this.player_.toggleClass(TheaterButton.THEATER_MODE_CLASS)\n\n    this.handleTheaterChange()\n  }\n\n  private isTheaterEnabled () {\n    return this.player_.hasClass(TheaterButton.THEATER_MODE_CLASS)\n  }\n}\n\nvideojs.registerComponent('TheaterButton', TheaterButton)\n"],"sourceRoot":""}